
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43818487897515296
Train: epoch: 1, loss = 0.4224565222859383
Train: epoch: 1, loss = 0.4160348240037759
Train: epoch: 1, loss = 0.41203738905489445
Train: epoch: 1, loss = 0.4096155400276184
Train: epoch: 1, loss = 0.4067608888447285
Train: epoch: 1, loss = 0.4057468160454716
Train: epoch: 1, loss = 0.4031095871608704
Train: epoch: 1, loss = 0.4014894667433368
Train: epoch: 1, loss = 0.39936568221449853
Train: epoch: 1, loss = 0.3983532067185098
Train: epoch: 1, loss = 0.3964650783066948
Train: epoch: 1, loss = 0.39500168761954857
Train: epoch: 1, loss = 0.3939284733310342
Train: epoch: 1, loss = 0.3925708153992891
Train: epoch: 1, loss = 0.39160847042687236
Train: epoch: 1, loss = 0.39053872944677576
Train: epoch: 1, loss = 0.39003120112750267
Train:  Epoch 1, Loss=0.3896600492632287, AUC-ROC Macro=0.6661492548510514, AUC-ROC Micro=0.7537852479425505
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37305282677213353, AUC-ROC Macro=0.7181930555529799, AUC-ROC Micro=0.7805569321699798
Eval task: 2
Eval:  Epoch 1, Loss=0.33651956021785734, AUC-ROC Macro=0.4795994595266575, AUC-ROC Micro=0.5539229242167014
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.36749939814209936
Train: epoch: 2, loss = 0.36816934231668713
Train: epoch: 2, loss = 0.368129315028588
Train: epoch: 2, loss = 0.3687030592933297
Train: epoch: 2, loss = 0.3683256881535053
Train: epoch: 2, loss = 0.36789898158361517
Train: epoch: 2, loss = 0.3676440031932933
Train: epoch: 2, loss = 0.36824105666019025
Train: epoch: 2, loss = 0.3686642069038418
Train: epoch: 2, loss = 0.3686138047650456
Train: epoch: 2, loss = 0.36832683513110337
Train: epoch: 2, loss = 0.3681846734508872
Train: epoch: 2, loss = 0.3679915304080798
Train: epoch: 2, loss = 0.36789339060229914
Train: epoch: 2, loss = 0.36736912061770755
Train: epoch: 2, loss = 0.3673569357115775
Train: epoch: 2, loss = 0.3671739101366085
Train: epoch: 2, loss = 0.36703793057137063
Train:  Epoch 2, Loss=0.36702715969697025, AUC-ROC Macro=0.7278145175778826, AUC-ROC Micro=0.7935237164255842
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3598541058599949, AUC-ROC Macro=0.7425934387195643, AUC-ROC Micro=0.8006175995130949
Eval task: 2
Eval:  Epoch 2, Loss=0.36036622524261475, AUC-ROC Macro=0.4737723123103407, AUC-ROC Micro=0.5560254843547556
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3517288352549076
Train: epoch: 3, loss = 0.35873834021389484
Train: epoch: 3, loss = 0.3584999121228854
Train: epoch: 3, loss = 0.357249040286988
Train: epoch: 3, loss = 0.35856971579790115
Train: epoch: 3, loss = 0.3602915204813083
Train: epoch: 3, loss = 0.3609000965952873
Train: epoch: 3, loss = 0.36039263296872376
Train: epoch: 3, loss = 0.36033100782169236
Train: epoch: 3, loss = 0.36043009577691554
Train: epoch: 3, loss = 0.3606620452891697
Train: epoch: 3, loss = 0.3605040319574376
Train: epoch: 3, loss = 0.35965968545812826
Train: epoch: 3, loss = 0.3593011954479984
Train: epoch: 3, loss = 0.3593446044921875
Train: epoch: 3, loss = 0.35935241797473283
Train: epoch: 3, loss = 0.35938558694194345
Train: epoch: 3, loss = 0.359246244430542
Train:  Epoch 3, Loss=0.3591624385393583, AUC-ROC Macro=0.7462655729103129, AUC-ROC Micro=0.8056611349110185
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3597639786700408, AUC-ROC Macro=0.7489044919908104, AUC-ROC Micro=0.8035307333859206
Eval task: 2
Eval:  Epoch 3, Loss=0.3660581588745117, AUC-ROC Macro=0.46393770386235345, AUC-ROC Micro=0.5591123834480305
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3537446028739214
Train: epoch: 4, loss = 0.352858496978879
Train: epoch: 4, loss = 0.35364742919802666
Train: epoch: 4, loss = 0.3545735175348818
Train: epoch: 4, loss = 0.3541426751166582
Train: epoch: 4, loss = 0.3543777414659659
Train: epoch: 4, loss = 0.35366726987063885
Train: epoch: 4, loss = 0.35433167739771304
Train: epoch: 4, loss = 0.3544381125519673
Train: epoch: 4, loss = 0.3549332745373249
Train: epoch: 4, loss = 0.3547598268227144
Train: epoch: 4, loss = 0.3542205582745373
Train: epoch: 4, loss = 0.3543373286150969
Train: epoch: 4, loss = 0.3542001562831657
Train: epoch: 4, loss = 0.354248540515701
Train: epoch: 4, loss = 0.3542434454150498
Train: epoch: 4, loss = 0.35381208372904976
Train: epoch: 4, loss = 0.35388752763470016
Train:  Epoch 4, Loss=0.35375893113653883, AUC-ROC Macro=0.7577569030597614, AUC-ROC Micro=0.8136421465463017
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35333898663520813, AUC-ROC Macro=0.7563094683082932, AUC-ROC Micro=0.8105622185264577
Eval task: 2
Eval:  Epoch 4, Loss=0.36428012549877165, AUC-ROC Macro=0.4712738799206879, AUC-ROC Micro=0.5472847992330043
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.34310905419290066
Train: epoch: 5, loss = 0.34357845682650806
Train: epoch: 5, loss = 0.34482705709834893
Train: epoch: 5, loss = 0.34634138954803345
Train: epoch: 5, loss = 0.3470097768753767
Train: epoch: 5, loss = 0.3477691594635447
Train: epoch: 5, loss = 0.3471590870938131
Train: epoch: 5, loss = 0.34759678406640887
Train: epoch: 5, loss = 0.34865542668435306
Train: epoch: 5, loss = 0.34913582172989843
Train: epoch: 5, loss = 0.349641520306468
Train: epoch: 5, loss = 0.34957400886962814
Train: epoch: 5, loss = 0.3498852956753511
Train: epoch: 5, loss = 0.3499038535196866
Train: epoch: 5, loss = 0.3499350477308035
Train: epoch: 5, loss = 0.3499460233002901
Train: epoch: 5, loss = 0.34995249531286604
Train: epoch: 5, loss = 0.3500281946278281
Train:  Epoch 5, Loss=0.3499226020360604, AUC-ROC Macro=0.7657108082490239, AUC-ROC Micro=0.8188832172623851
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35084911187489826, AUC-ROC Macro=0.7604494909591275, AUC-ROC Micro=0.8141186702913848
Eval task: 2
Eval:  Epoch 5, Loss=0.44756597876548765, AUC-ROC Macro=0.4630427077037944, AUC-ROC Micro=0.5328644815391232
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3489815612882376
Train: epoch: 6, loss = 0.34647460795938967
Train: epoch: 6, loss = 0.3459491318712632
Train: epoch: 6, loss = 0.3461263296753168
Train: epoch: 6, loss = 0.34594209463894365
Train: epoch: 6, loss = 0.3438890993098418
Train: epoch: 6, loss = 0.34485088559133664
Train: epoch: 6, loss = 0.34573621187359094
Train: epoch: 6, loss = 0.3461828689028819
Train: epoch: 6, loss = 0.346526810914278
Train: epoch: 6, loss = 0.34697485731406646
Train: epoch: 6, loss = 0.3468711471433441
Train: epoch: 6, loss = 0.3468136702879117
Train: epoch: 6, loss = 0.3469405536087496
Train: epoch: 6, loss = 0.3470583163052797
Train: epoch: 6, loss = 0.34684752999804913
Train: epoch: 6, loss = 0.34684475708533735
Train: epoch: 6, loss = 0.34637688054392735
Train:  Epoch 6, Loss=0.34640658013841025, AUC-ROC Macro=0.7721709095666395, AUC-ROC Micro=0.8236836720372389
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.34971580654382706, AUC-ROC Macro=0.764471879813585, AUC-ROC Micro=0.8165666589183724
Eval task: 2
Eval:  Epoch 6, Loss=0.4061345010995865, AUC-ROC Macro=0.4653788488958229, AUC-ROC Micro=0.5282376239714832
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3524355006714662, AUC-ROC Macro=0.7640814932972478, AUC-ROC Micro=0.8152598262428701
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.4010280817747116, AUC-ROC Macro=0.458989232035708, AUC-ROC Micro=0.5276652235808799
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3221655160933733
Train: epoch: 1, loss = 0.313543530292809
Train: epoch: 1, loss = 0.3077585784594218
Train: epoch: 1, loss = 0.30583016194403173
Train: epoch: 1, loss = 0.3038702005594969
Train: epoch: 1, loss = 0.30170100076744955
Train: epoch: 1, loss = 0.30001037730702335
Train:  Epoch 1, Loss=0.29880475329018763, AUC-ROC Macro=0.5912315359069067, AUC-ROC Micro=0.7435417756161758
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.34695174917578697, AUC-ROC Macro=0.7568020036523222, AUC-ROC Micro=0.8117291179063045
Eval task: 2
Eval:  Epoch 1, Loss=0.2758550554513931, AUC-ROC Macro=0.6774633704415544, AUC-ROC Micro=0.7841235253273353
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.28708348229527475
Train: epoch: 2, loss = 0.2850590562820435
Train: epoch: 2, loss = 0.2840154392520587
Train: epoch: 2, loss = 0.2835215090215206
Train: epoch: 2, loss = 0.28296092595160005
Train: epoch: 2, loss = 0.2817277781665325
Train: epoch: 2, loss = 0.281387641908867
Train:  Epoch 2, Loss=0.28058607569087235, AUC-ROC Macro=0.6881253289814216, AUC-ROC Micro=0.793743238692115
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3404984151323636, AUC-ROC Macro=0.7518520066876846, AUC-ROC Micro=0.8069277756080747
Eval task: 2
Eval:  Epoch 2, Loss=0.27116388231515887, AUC-ROC Macro=0.701224572975157, AUC-ROC Micro=0.793615872195548
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2810849352180958
Train: epoch: 3, loss = 0.27850639041513203
Train: epoch: 3, loss = 0.27719640168050924
Train: epoch: 3, loss = 0.2761661276593804
Train: epoch: 3, loss = 0.2756222161203623
Train: epoch: 3, loss = 0.2745332828660806
Train: epoch: 3, loss = 0.2739759342478854
Train:  Epoch 3, Loss=0.2733191158051067, AUC-ROC Macro=0.7135039035152998, AUC-ROC Micro=0.8076349746455023
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3402195821205775, AUC-ROC Macro=0.747294386676787, AUC-ROC Micro=0.8010027879780615
Eval task: 2
Eval:  Epoch 3, Loss=0.27160887867212297, AUC-ROC Macro=0.7104248740227191, AUC-ROC Micro=0.8019249536093235
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.2676338045299053
Train: epoch: 4, loss = 0.2671712202578783
Train: epoch: 4, loss = 0.267415128176411
Train: epoch: 4, loss = 0.2652824687957764
Train: epoch: 4, loss = 0.2648034470081329
Train: epoch: 4, loss = 0.26434010724226636
Train: epoch: 4, loss = 0.2649594088005168
Train:  Epoch 4, Loss=0.2648300539753695, AUC-ROC Macro=0.7292048329616634, AUC-ROC Micro=0.8156036791018438
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3286711846788724, AUC-ROC Macro=0.7410257879266803, AUC-ROC Micro=0.7982101970641248
Eval task: 2
Eval:  Epoch 4, Loss=0.23370615988969803, AUC-ROC Macro=0.71191727371679, AUC-ROC Micro=0.8048905383351651
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.26544747143983843
Train: epoch: 5, loss = 0.26358442325145004
Train: epoch: 5, loss = 0.2624678683280945
Train: epoch: 5, loss = 0.26097216667607426
Train: epoch: 5, loss = 0.26006512071192267
Train: epoch: 5, loss = 0.25896827390417454
Train: epoch: 5, loss = 0.25856345997857194
Train:  Epoch 5, Loss=0.25856843957876746, AUC-ROC Macro=0.7443186953432276, AUC-ROC Micro=0.8226613429636362
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3385388106107712, AUC-ROC Macro=0.7364760763275678, AUC-ROC Micro=0.7940331077950736
Eval task: 2
Eval:  Epoch 5, Loss=0.25730410516262053, AUC-ROC Macro=0.7129706432860315, AUC-ROC Micro=0.8032391098443432
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.25342986777424814
Train: epoch: 6, loss = 0.25556262660771606
Train: epoch: 6, loss = 0.2537425264964501
Train: epoch: 6, loss = 0.25327398870140316
Train: epoch: 6, loss = 0.2535715262591839
Train: epoch: 6, loss = 0.25272100598861774
Train: epoch: 6, loss = 0.25216237357684546
Train:  Epoch 6, Loss=0.2517363862626751, AUC-ROC Macro=0.751591765090074, AUC-ROC Micro=0.8271320396787825
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3276590344806512, AUC-ROC Macro=0.7348051902096919, AUC-ROC Micro=0.7899777278534182
Eval task: 2
Eval:  Epoch 6, Loss=0.24246784150600434, AUC-ROC Macro=0.7157830114589209, AUC-ROC Micro=0.8064172606808884
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.396580529709657, AUC-ROC Macro=0.7316439211406248, AUC-ROC Micro=0.7877799972520763
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.23404468446969987, AUC-ROC Macro=0.7251142999023016, AUC-ROC Micro=0.8124772102101587
{'0': {'precision': 0.48850045998160074, 'recall': 0.4059633027522936, 'f1-score': 0.4434237995824635, 'support': 1308}, '1': {'precision': 0.6140350877192983, 'recall': 0.43532338308457713, 'f1-score': 0.5094614264919942, 'support': 402}, '2': {'precision': 0.3755868544600939, 'recall': 0.12158054711246201, 'f1-score': 0.18369690011481057, 'support': 658}, '3': {'precision': 0.4866666666666667, 'recall': 0.29346733668341707, 'f1-score': 0.36614420062695924, 'support': 1990}, '4': {'precision': 0.3623853211009174, 'recall': 0.19602977667493796, 'f1-score': 0.25442834138486314, 'support': 806}, '5': {'precision': 0.3181818181818182, 'recall': 0.08097686375321336, 'f1-score': 0.12909836065573768, 'support': 778}, '6': {'precision': 0.4596375617792422, 'recall': 0.21428571428571427, 'f1-score': 0.29229963331587216, 'support': 1302}, '7': {'precision': 0.19480519480519481, 'recall': 0.03537735849056604, 'f1-score': 0.059880239520958084, 'support': 424}, '8': {'precision': 0.5115354017501988, 'recall': 0.3911192214111922, 'f1-score': 0.44329541537400896, 'support': 1644}, '9': {'precision': 0.596401028277635, 'recall': 0.5711472181191531, 'f1-score': 0.5835010060362172, 'support': 2031}, '10': {'precision': 0.5402597402597402, 'recall': 0.36300174520069806, 'f1-score': 0.4342379958246346, 'support': 573}, '11': {'precision': 0.4519230769230769, 'recall': 0.27976190476190477, 'f1-score': 0.3455882352941176, 'support': 1176}, '12': {'precision': 0.5043177892918825, 'recall': 0.32994350282485874, 'f1-score': 0.3989071038251366, 'support': 1770}, '13': {'precision': 0.54818401937046, 'recall': 0.43605546995377503, 'f1-score': 0.4857326753915469, 'support': 2596}, '14': {'precision': 0.4594168636721828, 'recall': 0.3583282114320836, 'f1-score': 0.4026243093922652, 'support': 1627}, '15': {'precision': 0.2222222222222222, 'recall': 0.024793388429752067, 'f1-score': 0.0446096654275093, 'support': 484}, '16': {'precision': 0.3375, 'recall': 0.2037735849056604, 'f1-score': 0.2541176470588235, 'support': 795}, '17': {'precision': 0.3055555555555556, 'recall': 0.10110294117647059, 'f1-score': 0.15193370165745856, 'support': 544}, '18': {'precision': 0.3, 'recall': 0.017094017094017096, 'f1-score': 0.03234501347708895, 'support': 351}, '19': {'precision': 0.35384615384615387, 'recall': 0.08778625954198473, 'f1-score': 0.14067278287461774, 'support': 262}, '20': {'precision': 0.2, 'recall': 0.03197158081705151, 'f1-score': 0.055130168453292494, 'support': 563}, '21': {'precision': 0.4048140043763676, 'recall': 0.22102747909199522, 'f1-score': 0.28593508500772796, 'support': 837}, '22': {'precision': 0.6084558823529411, 'recall': 0.6095764272559853, 'f1-score': 0.6090156393744249, 'support': 1086}, '23': {'precision': 0.47238372093023256, 'recall': 0.37746806039488967, 'f1-score': 0.41962556488056807, 'support': 861}, '24': {'precision': 0.43944636678200694, 'recall': 0.2514851485148515, 'f1-score': 0.31989924433249367, 'support': 505}, 'micro avg': {'precision': 0.49623184853869245, 'recall': 0.31919757222244116, 'f1-score': 0.3884971458723077, 'support': 25373}, 'macro avg': {'precision': 0.4222424316122196, 'recall': 0.2575376177505402, 'f1-score': 0.3058241662150236, 'support': 25373}, 'weighted avg': {'precision': 0.46346568128339016, 'recall': 0.31919757222244116, 'f1-score': 0.36834618384695, 'support': 25373}, 'samples avg': {'precision': 0.3862950711217313, 'recall': 0.2879797738504942, 'f1-score': 0.3013842637617307, 'support': 25373}}
{'0': {'precision': 0.6289855072463768, 'recall': 0.3938294010889292, 'f1-score': 0.484375, 'support': 551}, '1': {'precision': 0.5857142857142857, 'recall': 0.31393568147013784, 'f1-score': 0.40877367896311073, 'support': 653}, '2': {'precision': 0.48717948717948717, 'recall': 0.04460093896713615, 'f1-score': 0.08172043010752687, 'support': 426}, '3': {'precision': 0.5652173913043478, 'recall': 0.09535452322738386, 'f1-score': 0.1631799163179916, 'support': 409}, '4': {'precision': 0.4090909090909091, 'recall': 0.036734693877551024, 'f1-score': 0.06741573033707866, 'support': 245}, '5': {'precision': 0.4461538461538462, 'recall': 0.08100558659217877, 'f1-score': 0.1371158392434988, 'support': 358}, '6': {'precision': 0.34375, 'recall': 0.045081967213114756, 'f1-score': 0.07971014492753624, 'support': 244}, '7': {'precision': 0.6770833333333334, 'recall': 0.22108843537414966, 'f1-score': 0.3333333333333333, 'support': 294}, '8': {'precision': 0.15, 'recall': 0.011406844106463879, 'f1-score': 0.021201413427561835, 'support': 263}, '9': {'precision': 0.5, 'recall': 0.007194244604316547, 'f1-score': 0.014184397163120569, 'support': 278}, '10': {'precision': 0.09090909090909091, 'recall': 0.004807692307692308, 'f1-score': 0.009132420091324202, 'support': 208}, '11': {'precision': 0.37037037037037035, 'recall': 0.040160642570281124, 'f1-score': 0.07246376811594203, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.34285714285714286, 'recall': 0.09090909090909091, 'f1-score': 0.1437125748502994, 'support': 132}, '14': {'precision': 0.7, 'recall': 0.15486725663716813, 'f1-score': 0.25362318840579706, 'support': 226}, '15': {'precision': 0.7466666666666667, 'recall': 0.5333333333333333, 'f1-score': 0.6222222222222222, 'support': 105}, '16': {'precision': 0.47619047619047616, 'recall': 0.14705882352941177, 'f1-score': 0.2247191011235955, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.5713172252533125, 'recall': 0.13596735299573362, 'f1-score': 0.2196583757866347, 'support': 5391}, 'macro avg': {'precision': 0.3008067402806533, 'recall': 0.08885476623233357, 'f1-score': 0.12467532634519757, 'support': 5391}, 'weighted avg': {'precision': 0.4353261042565076, 'recall': 0.13596735299573362, 'f1-score': 0.18921780994910134, 'support': 5391}, 'samples avg': {'precision': 0.19998976934523807, 'recall': 0.12890609499007938, 'f1-score': 0.14341131741522367, 'support': 5391}}