
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_northeast
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4367099684476852
Train: epoch: 1, loss = 0.4251347009837627
Train: epoch: 1, loss = 0.41807161827882133
Train: epoch: 1, loss = 0.4134755886346102
Train: epoch: 1, loss = 0.4107438582777977
Train: epoch: 1, loss = 0.40943088471889494
Train: epoch: 1, loss = 0.4071799505182675
Train: epoch: 1, loss = 0.40498092306777833
Train: epoch: 1, loss = 0.40287804465327
Train: epoch: 1, loss = 0.4012267178893089
Train: epoch: 1, loss = 0.4000429162112149
Train: epoch: 1, loss = 0.39862344374880193
Train: epoch: 1, loss = 0.3977867564960168
Train: epoch: 1, loss = 0.39653121604983294
Train: epoch: 1, loss = 0.3950818643470605
Train: epoch: 1, loss = 0.39367967782542107
Train: epoch: 1, loss = 0.3924504661340924
Train: epoch: 1, loss = 0.3916043684341841
Train:  Epoch 1, Loss=0.39132732464716985, AUC-ROC Macro=0.6618380224303537, AUC-ROC Micro=0.7506268621007784
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.371543121834596, AUC-ROC Macro=0.7169594607986091, AUC-ROC Micro=0.7827791965143418
Eval task: 2
Eval:  Epoch 1, Loss=0.384997621178627, AUC-ROC Macro=0.48388646670728686, AUC-ROC Micro=0.5896309370216418
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3690894010663033
Train: epoch: 2, loss = 0.37317064590752125
Train: epoch: 2, loss = 0.37046056024730206
Train: epoch: 2, loss = 0.37225582610815766
Train: epoch: 2, loss = 0.370894235804677
Train: epoch: 2, loss = 0.3712942326068878
Train: epoch: 2, loss = 0.37128707054470267
Train: epoch: 2, loss = 0.3711792526766658
Train: epoch: 2, loss = 0.37010787648459276
Train: epoch: 2, loss = 0.36917671307176353
Train: epoch: 2, loss = 0.36931948737664655
Train: epoch: 2, loss = 0.3692672892473638
Train: epoch: 2, loss = 0.36967550086860473
Train: epoch: 2, loss = 0.36939003292471173
Train: epoch: 2, loss = 0.3695794563343128
Train: epoch: 2, loss = 0.3693562032375485
Train: epoch: 2, loss = 0.36870908174882916
Train: epoch: 2, loss = 0.36883726040936177
Train:  Epoch 2, Loss=0.3687316028745765, AUC-ROC Macro=0.7238633546339319, AUC-ROC Micro=0.7907994021846478
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3627806305885315, AUC-ROC Macro=0.7352708105196946, AUC-ROC Micro=0.7955787993954513
Eval task: 2
Eval:  Epoch 2, Loss=0.3962458372116089, AUC-ROC Macro=0.4694020620145093, AUC-ROC Micro=0.5903756902419873
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3631572016328573
Train: epoch: 3, loss = 0.3630752039328218
Train: epoch: 3, loss = 0.3648243643095096
Train: epoch: 3, loss = 0.36389100082218645
Train: epoch: 3, loss = 0.36187937155365946
Train: epoch: 3, loss = 0.36103325796624025
Train: epoch: 3, loss = 0.36016790345311167
Train: epoch: 3, loss = 0.36056024570949374
Train: epoch: 3, loss = 0.36046922704411877
Train: epoch: 3, loss = 0.3600614613741636
Train: epoch: 3, loss = 0.35969743429937145
Train: epoch: 3, loss = 0.36015998483945927
Train: epoch: 3, loss = 0.3600966708992536
Train: epoch: 3, loss = 0.360404589106994
Train: epoch: 3, loss = 0.36000387245416643
Train: epoch: 3, loss = 0.3598249616427347
Train: epoch: 3, loss = 0.35995829410412733
Train: epoch: 3, loss = 0.3600865704276496
Train:  Epoch 3, Loss=0.3601646300095778, AUC-ROC Macro=0.7437618406475741, AUC-ROC Micro=0.8039476537057202
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3554017109175523, AUC-ROC Macro=0.7513086642714094, AUC-ROC Micro=0.8072952046611621
Eval task: 2
Eval:  Epoch 3, Loss=0.4170428365468979, AUC-ROC Macro=0.48288583842811966, AUC-ROC Micro=0.5734265780643965
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3520585712045431
Train: epoch: 4, loss = 0.3548086167499423
Train: epoch: 4, loss = 0.35501798945168656
Train: epoch: 4, loss = 0.3544341513328254
Train: epoch: 4, loss = 0.3547438972145319
Train: epoch: 4, loss = 0.3545949353153507
Train: epoch: 4, loss = 0.35519345962575505
Train: epoch: 4, loss = 0.354717663154006
Train: epoch: 4, loss = 0.3549608300212357
Train: epoch: 4, loss = 0.3547241817265749
Train: epoch: 4, loss = 0.35494445821101017
Train: epoch: 4, loss = 0.3547382145250837
Train: epoch: 4, loss = 0.3550249550835444
Train: epoch: 4, loss = 0.3551337723646845
Train: epoch: 4, loss = 0.3550479721178611
Train: epoch: 4, loss = 0.35522872681263834
Train: epoch: 4, loss = 0.35534870968583754
Train: epoch: 4, loss = 0.3548635221645236
Train:  Epoch 4, Loss=0.35479178416423307, AUC-ROC Macro=0.7557087765873755, AUC-ROC Micro=0.8119599626754996
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3536135678490003, AUC-ROC Macro=0.7570027434694646, AUC-ROC Micro=0.8102420657387277
Eval task: 2
Eval:  Epoch 4, Loss=0.4247656911611557, AUC-ROC Macro=0.4902678955351223, AUC-ROC Micro=0.5690891931891361
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3476918073743582
Train: epoch: 5, loss = 0.35163469195365904
Train: epoch: 5, loss = 0.35288814472655455
Train: epoch: 5, loss = 0.3514801830612123
Train: epoch: 5, loss = 0.35070303213596343
Train: epoch: 5, loss = 0.3509876115433872
Train: epoch: 5, loss = 0.3518218371112432
Train: epoch: 5, loss = 0.3511049586022273
Train: epoch: 5, loss = 0.3514195019793179
Train: epoch: 5, loss = 0.3509716355986893
Train: epoch: 5, loss = 0.35039365813474765
Train: epoch: 5, loss = 0.3504433899776389
Train: epoch: 5, loss = 0.3499676124780224
Train: epoch: 5, loss = 0.35010058883843675
Train: epoch: 5, loss = 0.34984983859707913
Train: epoch: 5, loss = 0.35015057599404825
Train: epoch: 5, loss = 0.34998111612437405
Train: epoch: 5, loss = 0.35034640521845883
Train:  Epoch 5, Loss=0.35033526016504335, AUC-ROC Macro=0.7648374966145971, AUC-ROC Micro=0.8183350601784916
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35197431842486065, AUC-ROC Macro=0.7604387490034229, AUC-ROC Micro=0.812643224375239
Eval task: 2
Eval:  Epoch 5, Loss=0.43221713602542877, AUC-ROC Macro=0.47873722554041526, AUC-ROC Micro=0.5679572165275707
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34968898616731164
Train: epoch: 6, loss = 0.34992009062319995
Train: epoch: 6, loss = 0.34913352978726225
Train: epoch: 6, loss = 0.3477599315904081
Train: epoch: 6, loss = 0.34765925803780556
Train: epoch: 6, loss = 0.34757030190279087
Train: epoch: 6, loss = 0.347234555089048
Train: epoch: 6, loss = 0.34735872646793725
Train: epoch: 6, loss = 0.3475885402245654
Train: epoch: 6, loss = 0.34781967938691377
Train: epoch: 6, loss = 0.34778177410364153
Train: epoch: 6, loss = 0.3470130454314252
Train: epoch: 6, loss = 0.3472048251502789
Train: epoch: 6, loss = 0.3463964727520943
Train: epoch: 6, loss = 0.3468768465965986
Train: epoch: 6, loss = 0.3467572519974783
Train: epoch: 6, loss = 0.3467310628163464
Train: epoch: 6, loss = 0.34688767556515004
Train:  Epoch 6, Loss=0.3468677159181008, AUC-ROC Macro=0.7717651315324572, AUC-ROC Micro=0.823077385341738
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3494699274500211, AUC-ROC Macro=0.7631381425432905, AUC-ROC Micro=0.8160732575649983
Eval task: 2
Eval:  Epoch 6, Loss=0.44040216505527496, AUC-ROC Macro=0.4871600756617214, AUC-ROC Micro=0.5866493014513237
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3521537122627099, AUC-ROC Macro=0.7625659617984216, AUC-ROC Micro=0.8153010404271955
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.4529004842042923, AUC-ROC Macro=0.47904155689834, AUC-ROC Micro=0.5990936173169892
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3427802046388388
Train:  Epoch 1, Loss=0.32601093331473974, AUC-ROC Macro=0.5670282179310275, AUC-ROC Micro=0.7368306544304946
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.43121643488605815, AUC-ROC Macro=0.7034100542059376, AUC-ROC Micro=0.6791886435740858
Eval task: 2
Eval:  Epoch 1, Loss=0.30029428005218506, AUC-ROC Macro=0.6399741136361423, AUC-ROC Micro=0.7777830934959665
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.291580408513546
Train:  Epoch 2, Loss=0.29017999427421654, AUC-ROC Macro=0.6816166123889319, AUC-ROC Micro=0.8081429970892144
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.4457699271539847, AUC-ROC Macro=0.6776573030057126, AUC-ROC Micro=0.6518448356759835
Eval task: 2
Eval:  Epoch 2, Loss=0.2861761599779129, AUC-ROC Macro=0.6974776893579339, AUC-ROC Micro=0.8097594596320241
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.27543850779533385
Train:  Epoch 3, Loss=0.275937834835119, AUC-ROC Macro=0.7317670268307522, AUC-ROC Micro=0.8333143675407189
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.4539085576931636, AUC-ROC Macro=0.6664139730128581, AUC-ROC Micro=0.6428788642586103
Eval task: 2
Eval:  Epoch 3, Loss=0.2834703028202057, AUC-ROC Macro=0.7096754368076725, AUC-ROC Micro=0.814672600093416
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.2678003911674023
Train:  Epoch 4, Loss=0.26695416356479773, AUC-ROC Macro=0.7621742725165199, AUC-ROC Micro=0.8469762069508654
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.4599160763124625, AUC-ROC Macro=0.6585996620994494, AUC-ROC Micro=0.6389069018625135
Eval task: 2
Eval:  Epoch 4, Loss=0.27845196425914764, AUC-ROC Macro=0.7143847728483635, AUC-ROC Micro=0.821461053581776
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2615461723506451
Train:  Epoch 5, Loss=0.26044057415619054, AUC-ROC Macro=0.7817851905602449, AUC-ROC Micro=0.85594968370144
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.47037310401598614, AUC-ROC Macro=0.6510605078623499, AUC-ROC Micro=0.6369725206737102
Eval task: 2
Eval:  Epoch 5, Loss=0.2762778252363205, AUC-ROC Macro=0.7232560800632933, AUC-ROC Micro=0.8274107289441338
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.252455139271915
Train:  Epoch 6, Loss=0.2541095518209612, AUC-ROC Macro=0.7972731288830163, AUC-ROC Micro=0.8647788822899145
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.4732314733167489, AUC-ROC Macro=0.6435872115602705, AUC-ROC Micro=0.6372236771916497
Eval task: 2
Eval:  Epoch 6, Loss=0.27671508491039276, AUC-ROC Macro=0.7204400358148229, AUC-ROC Micro=0.8251139467905251
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.4751518542567889, AUC-ROC Macro=0.6459587715501438, AUC-ROC Micro=0.6388819768447097
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.28814931213855743, AUC-ROC Macro=0.7111137529669633, AUC-ROC Micro=0.8210526449563292
{'0': {'precision': 0.367182246133154, 'recall': 0.41743119266055045, 'f1-score': 0.3906976744186046, 'support': 1308}, '1': {'precision': 0.30670926517571884, 'recall': 0.47761194029850745, 'f1-score': 0.37354085603112835, 'support': 402}, '2': {'precision': 0.2, 'recall': 0.010638297872340425, 'f1-score': 0.020202020202020204, 'support': 658}, '3': {'precision': 0.33248666497332996, 'recall': 0.657788944723618, 'f1-score': 0.44170744052640454, 'support': 1990}, '4': {'precision': 0.30434782608695654, 'recall': 0.043424317617866005, 'f1-score': 0.0760043431053203, 'support': 806}, '5': {'precision': 0.16908212560386474, 'recall': 0.04498714652956298, 'f1-score': 0.07106598984771574, 'support': 778}, '6': {'precision': 0.37669376693766937, 'recall': 0.10675883256528418, 'f1-score': 0.1663674446439258, 'support': 1302}, '7': {'precision': 0.1875, 'recall': 0.007075471698113208, 'f1-score': 0.013636363636363637, 'support': 424}, '8': {'precision': 0.6779661016949152, 'recall': 0.024330900243309004, 'f1-score': 0.04697592483852027, 'support': 1644}, '9': {'precision': 0.6744186046511628, 'recall': 0.028557360905957656, 'f1-score': 0.0547945205479452, 'support': 2031}, '10': {'precision': 0.4574468085106383, 'recall': 0.07504363001745201, 'f1-score': 0.12893553223388307, 'support': 573}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1176}, '12': {'precision': 0.6666666666666666, 'recall': 0.0011299435028248588, 'f1-score': 0.0022560631697687537, 'support': 1770}, '13': {'precision': 0.3387096774193548, 'recall': 0.016178736517719568, 'f1-score': 0.030882352941176472, 'support': 2596}, '14': {'precision': 0.2607843137254902, 'recall': 0.08174554394591273, 'f1-score': 0.12447356106691625, 'support': 1627}, '15': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 484}, '16': {'precision': 0.5, 'recall': 0.0012578616352201257, 'f1-score': 0.002509410288582183, 'support': 795}, '17': {'precision': 0.21365638766519823, 'recall': 0.17830882352941177, 'f1-score': 0.19438877755511022, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.3333333333333333, 'recall': 0.003816793893129771, 'f1-score': 0.007547169811320754, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.9032258064516129, 'recall': 0.02578268876611418, 'f1-score': 0.050134288272157566, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 1.0, 'recall': 0.0019801980198019802, 'f1-score': 0.003952569169960474, 'support': 505}, 'micro avg': {'precision': 0.33210874357090375, 'recall': 0.1068852717455563, 'f1-score': 0.16172217418527685, 'support': 25373}, 'macro avg': {'precision': 0.3308083838011626, 'recall': 0.08815394499770786, 'f1-score': 0.08800289209227297, 'support': 25373}, 'weighted avg': {'precision': 0.38074390121348245, 'recall': 0.1068852717455563, 'f1-score': 0.10277334034803065, 'support': 25373}, 'samples avg': {'precision': 0.22597985646081345, 'recall': 0.0888491603435882, 'f1-score': 0.11552614447362626, 'support': 25373}}
{'0': {'precision': 0.7258064516129032, 'recall': 0.34615384615384615, 'f1-score': 0.46875000000000006, 'support': 130}, '1': {'precision': 0.5369127516778524, 'recall': 0.5882352941176471, 'f1-score': 0.5614035087719298, 'support': 136}, '2': {'precision': 0.4642857142857143, 'recall': 0.0948905109489051, 'f1-score': 0.1575757575757576, 'support': 137}, '3': {'precision': 0.6615969581749049, 'recall': 0.8169014084507042, 'f1-score': 0.73109243697479, 'support': 213}, '4': {'precision': 0.5, 'recall': 0.08, 'f1-score': 0.13793103448275865, 'support': 75}, '5': {'precision': 0.5833333333333334, 'recall': 0.07446808510638298, 'f1-score': 0.1320754716981132, 'support': 94}, '6': {'precision': 0.625, 'recall': 0.06756756756756757, 'f1-score': 0.12195121951219512, 'support': 74}, '7': {'precision': 0.4, 'recall': 0.2, 'f1-score': 0.26666666666666666, 'support': 40}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 65}, '10': {'precision': 1.0, 'recall': 0.015873015873015872, 'f1-score': 0.03125, 'support': 63}, '11': {'precision': 0.3333333333333333, 'recall': 0.017857142857142856, 'f1-score': 0.03389830508474576, 'support': 56}, '12': {'precision': 1.0, 'recall': 0.019230769230769232, 'f1-score': 0.03773584905660378, 'support': 52}, '13': {'precision': 0.42857142857142855, 'recall': 0.10909090909090909, 'f1-score': 0.17391304347826086, 'support': 55}, '14': {'precision': 0.5862068965517241, 'recall': 0.2698412698412698, 'f1-score': 0.3695652173913043, 'support': 63}, '15': {'precision': 1.0, 'recall': 0.10526315789473684, 'f1-score': 0.1904761904761905, 'support': 19}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '17': {'precision': 0.5333333333333333, 'recall': 0.2926829268292683, 'f1-score': 0.37795275590551186, 'support': 82}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, 'micro avg': {'precision': 0.6, 'recall': 0.25374105400130126, 'f1-score': 0.35665294924554186, 'support': 1537}, 'macro avg': {'precision': 0.3751352080349811, 'recall': 0.12392223615848662, 'f1-score': 0.1516894982829931, 'support': 1537}, 'weighted avg': {'precision': 0.5096864438996639, 'recall': 0.25374105400130126, 'f1-score': 0.2799858443844082, 'support': 1537}, 'samples avg': {'precision': 0.3968098958333333, 'recall': 0.23782164558531743, 'f1-score': 0.2745204448329448, 'support': 1537}}