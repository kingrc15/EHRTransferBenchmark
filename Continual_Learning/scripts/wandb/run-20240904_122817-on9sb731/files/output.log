
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4375946633517742
Train: epoch: 1, loss = 0.4233424714952707
Train: epoch: 1, loss = 0.4163901827236017
Train: epoch: 1, loss = 0.4140403667837381
Train: epoch: 1, loss = 0.412892595410347
Train: epoch: 1, loss = 0.41065546445548534
Train: epoch: 1, loss = 0.4089126681429999
Train: epoch: 1, loss = 0.40765728667378426
Train: epoch: 1, loss = 0.4062326409419378
Train: epoch: 1, loss = 0.40408523502200844
Train: epoch: 1, loss = 0.4020844745703719
Train: epoch: 1, loss = 0.400360059539477
Train: epoch: 1, loss = 0.3990339144032735
Train: epoch: 1, loss = 0.3977137435067977
Train: epoch: 1, loss = 0.39703933731714885
Train: epoch: 1, loss = 0.39547853111755105
Train: epoch: 1, loss = 0.3943292640412555
Train: epoch: 1, loss = 0.39325136656562487
Train:  Epoch 1, Loss=0.39307087194817697, AUC-ROC Macro=0.6555447831908596, AUC-ROC Micro=0.7474052506747745
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.372116735825936, AUC-ROC Macro=0.7161792592302311, AUC-ROC Micro=0.7806433322287789
Eval task: 2
Eval:  Epoch 1, Loss=0.32378921285271645, AUC-ROC Macro=0.4946921809519909, AUC-ROC Micro=0.5829206234811027
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37939413599669936
Train: epoch: 2, loss = 0.37787595998495815
Train: epoch: 2, loss = 0.3758203064153592
Train: epoch: 2, loss = 0.375769121311605
Train: epoch: 2, loss = 0.37435516072809694
Train: epoch: 2, loss = 0.37464831591894227
Train: epoch: 2, loss = 0.37443833159548895
Train: epoch: 2, loss = 0.3736661509424448
Train: epoch: 2, loss = 0.3731247388654285
Train: epoch: 2, loss = 0.37273651544749736
Train: epoch: 2, loss = 0.3721502873911099
Train: epoch: 2, loss = 0.3719240696169436
Train: epoch: 2, loss = 0.37125728266170394
Train: epoch: 2, loss = 0.37079817100295
Train: epoch: 2, loss = 0.37069099756578605
Train: epoch: 2, loss = 0.3705186867201701
Train: epoch: 2, loss = 0.37024777450543994
Train: epoch: 2, loss = 0.3697623818409112
Train:  Epoch 2, Loss=0.36980234025788106, AUC-ROC Macro=0.7206523364029698, AUC-ROC Micro=0.7890423880581197
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36238058904806775, AUC-ROC Macro=0.7355907672841154, AUC-ROC Micro=0.7975314971024113
Eval task: 2
Eval:  Epoch 2, Loss=0.31076605245471, AUC-ROC Macro=0.4949799283800659, AUC-ROC Micro=0.5642518182519805
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3617887920886278
Train: epoch: 3, loss = 0.360654147900641
Train: epoch: 3, loss = 0.36061634610096616
Train: epoch: 3, loss = 0.3635589566640556
Train: epoch: 3, loss = 0.36287447038292886
Train: epoch: 3, loss = 0.3631670298675696
Train: epoch: 3, loss = 0.3637922534559454
Train: epoch: 3, loss = 0.3632475257851183
Train: epoch: 3, loss = 0.3631126061826944
Train: epoch: 3, loss = 0.3629345803037286
Train: epoch: 3, loss = 0.3621668706224723
Train: epoch: 3, loss = 0.3627888284251094
Train: epoch: 3, loss = 0.3621146307312525
Train: epoch: 3, loss = 0.3619855104493243
Train: epoch: 3, loss = 0.36183793225387734
Train: epoch: 3, loss = 0.3618890858022496
Train: epoch: 3, loss = 0.36152462805895247
Train: epoch: 3, loss = 0.36148547417587706
Train:  Epoch 3, Loss=0.3614107856118781, AUC-ROC Macro=0.7410834952161965, AUC-ROC Micro=0.8022309334152835
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3588605970144272, AUC-ROC Macro=0.7453091177958459, AUC-ROC Micro=0.8029408865202052
Eval task: 2
Eval:  Epoch 3, Loss=0.3326440155506134, AUC-ROC Macro=0.4741352752231772, AUC-ROC Micro=0.551119868646773
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3559437683224678
Train: epoch: 4, loss = 0.35539066571742295
Train: epoch: 4, loss = 0.3563789343337218
Train: epoch: 4, loss = 0.3566598037071526
Train: epoch: 4, loss = 0.3573985391557217
Train: epoch: 4, loss = 0.35654488248129684
Train: epoch: 4, loss = 0.3569199634449823
Train: epoch: 4, loss = 0.3576612294092774
Train: epoch: 4, loss = 0.3571672796871927
Train: epoch: 4, loss = 0.3575129073932767
Train: epoch: 4, loss = 0.35788567480038513
Train: epoch: 4, loss = 0.3573515487027665
Train: epoch: 4, loss = 0.35713803252921655
Train: epoch: 4, loss = 0.3568328469725592
Train: epoch: 4, loss = 0.3563877242058516
Train: epoch: 4, loss = 0.3564225003216416
Train: epoch: 4, loss = 0.3563399015410858
Train: epoch: 4, loss = 0.35608348452382615
Train:  Epoch 4, Loss=0.35604580107917133, AUC-ROC Macro=0.7528000734574637, AUC-ROC Micro=0.8101611799813537
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3558584252993266, AUC-ROC Macro=0.7522447033620636, AUC-ROC Micro=0.8077658310938973
Eval task: 2
Eval:  Epoch 4, Loss=0.3482557088136673, AUC-ROC Macro=0.4751682975824997, AUC-ROC Micro=0.5503823629760674
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.35114517956972124
Train: epoch: 5, loss = 0.35180535282939673
Train: epoch: 5, loss = 0.3514900710930427
Train: epoch: 5, loss = 0.35262504138052464
Train: epoch: 5, loss = 0.3531236338764429
Train: epoch: 5, loss = 0.35268958006054163
Train: epoch: 5, loss = 0.3515804219139474
Train: epoch: 5, loss = 0.3509170396905392
Train: epoch: 5, loss = 0.3521060562796063
Train: epoch: 5, loss = 0.351870326936245
Train: epoch: 5, loss = 0.3522668351029808
Train: epoch: 5, loss = 0.35143605232859654
Train: epoch: 5, loss = 0.35102984317220176
Train: epoch: 5, loss = 0.35096790263695377
Train: epoch: 5, loss = 0.35070067206521827
Train: epoch: 5, loss = 0.35085601582657544
Train: epoch: 5, loss = 0.3513490478212343
Train: epoch: 5, loss = 0.3513940079137683
Train:  Epoch 5, Loss=0.35151846918896734, AUC-ROC Macro=0.7618968725071409, AUC-ROC Micro=0.8165955147732856
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35308627287546795, AUC-ROC Macro=0.7575990662131702, AUC-ROC Micro=0.8114797334489018
Eval task: 2
Eval:  Epoch 5, Loss=0.34950538724660873, AUC-ROC Macro=0.4744710583952866, AUC-ROC Micro=0.5548983307860667
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34303823463618754
Train: epoch: 6, loss = 0.3468002548441291
Train: epoch: 6, loss = 0.34667629110316434
Train: epoch: 6, loss = 0.34605997739359734
Train: epoch: 6, loss = 0.3466026368588209
Train: epoch: 6, loss = 0.3473367879291375
Train: epoch: 6, loss = 0.3479982120224408
Train: epoch: 6, loss = 0.34812757424078883
Train: epoch: 6, loss = 0.3484117353128062
Train: epoch: 6, loss = 0.3493583289757371
Train: epoch: 6, loss = 0.3495906355164268
Train: epoch: 6, loss = 0.3493559642881155
Train: epoch: 6, loss = 0.3490271916469702
Train: epoch: 6, loss = 0.34892282933528934
Train: epoch: 6, loss = 0.3481284897228082
Train: epoch: 6, loss = 0.3480656160414219
Train: epoch: 6, loss = 0.3474999759740689
Train: epoch: 6, loss = 0.34793633406360946
Train:  Epoch 6, Loss=0.3480925852661459, AUC-ROC Macro=0.7690182222477335, AUC-ROC Micro=0.8213434041655022
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35129736984769505, AUC-ROC Macro=0.7611710648031287, AUC-ROC Micro=0.8136500858572799
Eval task: 2
Eval:  Epoch 6, Loss=0.3627398610115051, AUC-ROC Macro=0.4715518415408205, AUC-ROC Micro=0.5510655886276918
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35333367933829624, AUC-ROC Macro=0.7621271716421311, AUC-ROC Micro=0.8136739051799889
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3604735769331455, AUC-ROC Macro=0.4819270499690765, AUC-ROC Micro=0.5512884264706546
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3143888594210148
Train: epoch: 1, loss = 0.3019130007177591
Train: epoch: 1, loss = 0.29911294000844163
Train: epoch: 1, loss = 0.29512089615687725
Train: epoch: 1, loss = 0.2928692127019167
Train: epoch: 1, loss = 0.29080834611008566
Train:  Epoch 1, Loss=0.29005157328980485, AUC-ROC Macro=0.5887528220821691, AUC-ROC Micro=0.7452529687835407
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3462160527706146, AUC-ROC Macro=0.7553971149805982, AUC-ROC Micro=0.8101463448215673
Eval task: 2
Eval:  Epoch 1, Loss=0.26615335419774055, AUC-ROC Macro=0.6661528999548147, AUC-ROC Micro=0.7882867360425743
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.28197981283068657
Train: epoch: 2, loss = 0.2819611092284322
Train: epoch: 2, loss = 0.2812538469831149
Train: epoch: 2, loss = 0.2802339925803244
Train: epoch: 2, loss = 0.2792215246707201
Train: epoch: 2, loss = 0.27832201392700273
Train:  Epoch 2, Loss=0.2773976759203531, AUC-ROC Macro=0.6734707942290359, AUC-ROC Micro=0.794624228414345
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.34184419239560765, AUC-ROC Macro=0.7480241809253001, AUC-ROC Micro=0.8050985102376167
Eval task: 2
Eval:  Epoch 2, Loss=0.27120563201606274, AUC-ROC Macro=0.692235474626802, AUC-ROC Micro=0.8000223071943209
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.26882892444729806
Train: epoch: 3, loss = 0.27169045254588126
Train: epoch: 3, loss = 0.27208640376726784
Train: epoch: 3, loss = 0.2706715194322169
Train: epoch: 3, loss = 0.2697746056765318
Train: epoch: 3, loss = 0.26922530634949604
Train:  Epoch 3, Loss=0.2687261035706271, AUC-ROC Macro=0.7013604616455507, AUC-ROC Micro=0.8086796981167985
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.33509918053944904, AUC-ROC Macro=0.7440015641538948, AUC-ROC Micro=0.7999891052426719
Eval task: 2
Eval:  Epoch 3, Loss=0.2748064771294594, AUC-ROC Macro=0.7107947295677403, AUC-ROC Micro=0.8082060682202871
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.26548988357186315
Train: epoch: 4, loss = 0.26428264237940313
Train: epoch: 4, loss = 0.26282685754199825
Train: epoch: 4, loss = 0.2623686622083187
Train: epoch: 4, loss = 0.26248349127173426
Train: epoch: 4, loss = 0.2618860475718975
Train:  Epoch 4, Loss=0.2614652422175268, AUC-ROC Macro=0.7229397935379401, AUC-ROC Micro=0.8184791065674119
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.32624901334444684, AUC-ROC Macro=0.7396866949110923, AUC-ROC Micro=0.797701790785051
Eval task: 2
Eval:  Epoch 4, Loss=0.2355408202856779, AUC-ROC Macro=0.7195961052873912, AUC-ROC Micro=0.8141732119348648
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2562840098142624
Train: epoch: 5, loss = 0.2556745720282197
Train: epoch: 5, loss = 0.2555103521794081
Train: epoch: 5, loss = 0.25511710366234186
Train: epoch: 5, loss = 0.2553894379138947
Train: epoch: 5, loss = 0.2560379168018699
Train:  Epoch 5, Loss=0.2551463891653847, AUC-ROC Macro=0.7380435242352541, AUC-ROC Micro=0.8265311252162061
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3316879893342654, AUC-ROC Macro=0.7380498027107052, AUC-ROC Micro=0.7951695943567068
Eval task: 2
Eval:  Epoch 5, Loss=0.27584802731871605, AUC-ROC Macro=0.7268368027794517, AUC-ROC Micro=0.8171358683501643
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.24966199591755867
Train: epoch: 6, loss = 0.24953398067504168
Train: epoch: 6, loss = 0.24911749144395193
Train: epoch: 6, loss = 0.24883711325004698
Train: epoch: 6, loss = 0.24889879924058914
Train: epoch: 6, loss = 0.2491851261879007
Train:  Epoch 6, Loss=0.24877714026348755, AUC-ROC Macro=0.7499099953618942, AUC-ROC Micro=0.8320883923119101
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3400678609808286, AUC-ROC Macro=0.7325984398152837, AUC-ROC Micro=0.7901735885075793
Eval task: 2
Eval:  Epoch 6, Loss=0.25087010860443115, AUC-ROC Macro=0.725558156107246, AUC-ROC Micro=0.8167612671343354
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.39052018399039906, AUC-ROC Macro=0.7304337515861321, AUC-ROC Micro=0.7887365461958318
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2134137526154518, AUC-ROC Macro=0.7162082197304666, AUC-ROC Micro=0.8173653685725938
{'0': {'precision': 0.5201958384332925, 'recall': 0.32492354740061163, 'f1-score': 0.4, 'support': 1308}, '1': {'precision': 0.642512077294686, 'recall': 0.3308457711442786, 'f1-score': 0.4367816091954023, 'support': 402}, '2': {'precision': 0.35014836795252224, 'recall': 0.17933130699088146, 'f1-score': 0.23718592964824123, 'support': 658}, '3': {'precision': 0.49365853658536585, 'recall': 0.2542713567839196, 'f1-score': 0.33565505804311774, 'support': 1990}, '4': {'precision': 0.3367003367003367, 'recall': 0.12406947890818859, 'f1-score': 0.1813236627379873, 'support': 806}, '5': {'precision': 0.3333333333333333, 'recall': 0.056555269922879174, 'f1-score': 0.09670329670329669, 'support': 778}, '6': {'precision': 0.46730462519936206, 'recall': 0.2250384024577573, 'f1-score': 0.303784344219803, 'support': 1302}, '7': {'precision': 0.19298245614035087, 'recall': 0.025943396226415096, 'f1-score': 0.04573804573804574, 'support': 424}, '8': {'precision': 0.5, 'recall': 0.35279805352798055, 'f1-score': 0.4136947218259629, 'support': 1644}, '9': {'precision': 0.6085997794928335, 'recall': 0.5435745937961596, 'f1-score': 0.5742522756827048, 'support': 2031}, '10': {'precision': 0.5873493975903614, 'recall': 0.3403141361256545, 'f1-score': 0.430939226519337, 'support': 573}, '11': {'precision': 0.4353448275862069, 'recall': 0.3435374149659864, 'f1-score': 0.3840304182509506, 'support': 1176}, '12': {'precision': 0.4844559585492228, 'recall': 0.42259887005649716, 'f1-score': 0.4514182257091129, 'support': 1770}, '13': {'precision': 0.5196964221178171, 'recall': 0.5539291217257319, 'f1-score': 0.5362670147305612, 'support': 2596}, '14': {'precision': 0.4942263279445728, 'recall': 0.26306084818684694, 'f1-score': 0.34336141195346975, 'support': 1627}, '15': {'precision': 0.16666666666666666, 'recall': 0.02066115702479339, 'f1-score': 0.03676470588235294, 'support': 484}, '16': {'precision': 0.358974358974359, 'recall': 0.12327044025157233, 'f1-score': 0.18352059925093633, 'support': 795}, '17': {'precision': 0.32989690721649484, 'recall': 0.058823529411764705, 'f1-score': 0.0998439937597504, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.3888888888888889, 'recall': 0.026717557251908396, 'f1-score': 0.049999999999999996, 'support': 262}, '20': {'precision': 0.15625, 'recall': 0.008880994671403197, 'f1-score': 0.016806722689075633, 'support': 563}, '21': {'precision': 0.4578313253012048, 'recall': 0.2270011947431302, 'f1-score': 0.30351437699680506, 'support': 837}, '22': {'precision': 0.6098696461824954, 'recall': 0.6031307550644567, 'f1-score': 0.6064814814814814, 'support': 1086}, '23': {'precision': 0.5431861804222649, 'recall': 0.32868757259001163, 'f1-score': 0.40955137481910275, 'support': 861}, '24': {'precision': 0.5209125475285171, 'recall': 0.2712871287128713, 'f1-score': 0.3567708333333333, 'support': 505}, 'micro avg': {'precision': 0.5070854078896975, 'recall': 0.31308871635202773, 'f1-score': 0.3871439362557567, 'support': 25373}, 'macro avg': {'precision': 0.4199593922440462, 'recall': 0.240370075917668, 'f1-score': 0.2893755731668332, 'support': 25373}, 'weighted avg': {'precision': 0.4651165180844537, 'recall': 0.31308871635202773, 'f1-score': 0.36022271420189633, 'support': 25373}, 'samples avg': {'precision': 0.39419567181408, 'recall': 0.2856155446817786, 'f1-score': 0.30135123604387354, 'support': 25373}}
{'0': {'precision': 0.6057692307692307, 'recall': 0.3014354066985646, 'f1-score': 0.402555910543131, 'support': 418}, '1': {'precision': 0.6666666666666666, 'recall': 0.1111111111111111, 'f1-score': 0.1904761904761905, 'support': 216}, '2': {'precision': 0.25, 'recall': 0.006944444444444444, 'f1-score': 0.013513513513513514, 'support': 288}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 252}, '4': {'precision': 0.5757575757575758, 'recall': 0.06597222222222222, 'f1-score': 0.11838006230529596, 'support': 288}, '5': {'precision': 0.35294117647058826, 'recall': 0.022304832713754646, 'f1-score': 0.04195804195804196, 'support': 269}, '6': {'precision': 0.5, 'recall': 0.0353356890459364, 'f1-score': 0.066006600660066, 'support': 283}, '7': {'precision': 0.7361111111111112, 'recall': 0.41568627450980394, 'f1-score': 0.531328320802005, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.43478260869565216, 'recall': 0.0423728813559322, 'f1-score': 0.0772200772200772, 'support': 236}, '10': {'precision': 0.6428571428571429, 'recall': 0.04918032786885246, 'f1-score': 0.09137055837563451, 'support': 183}, '11': {'precision': 0.7142857142857143, 'recall': 0.023923444976076555, 'f1-score': 0.046296296296296294, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.29411764705882354, 'recall': 0.04504504504504504, 'f1-score': 0.078125, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.725, 'recall': 0.6444444444444445, 'f1-score': 0.6823529411764706, 'support': 90}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.6178861788617886, 'recall': 0.09997369113391213, 'f1-score': 0.17210144927536233, 'support': 3801}, 'macro avg': {'precision': 0.25993155494690023, 'recall': 0.07055024497744751, 'f1-score': 0.09358334053306888, 'support': 3801}, 'weighted avg': {'precision': 0.4016347161241559, 'recall': 0.09997369113391213, 'f1-score': 0.13879405332865402, 'support': 3801}, 'samples avg': {'precision': 0.16949598524305556, 'recall': 0.11763102213541665, 'f1-score': 0.13067068565115442, 'support': 3801}}