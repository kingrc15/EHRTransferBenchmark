
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.42979118689894674
Train: epoch: 1, loss = 0.41848632488399745
Train: epoch: 1, loss = 0.4159216553221146
Train: epoch: 1, loss = 0.4116948592104018
Train: epoch: 1, loss = 0.41014103198051455
Train: epoch: 1, loss = 0.4096763995538155
Train: epoch: 1, loss = 0.4085352025713239
Train: epoch: 1, loss = 0.408046949384734
Train: epoch: 1, loss = 0.4064329592966371
Train: epoch: 1, loss = 0.4039421605616808
Train: epoch: 1, loss = 0.40231781210411677
Train: epoch: 1, loss = 0.4003189808006088
Train: epoch: 1, loss = 0.3996193296290361
Train: epoch: 1, loss = 0.3981062572449446
Train: epoch: 1, loss = 0.3965588252544403
Train: epoch: 1, loss = 0.39514914829283954
Train: epoch: 1, loss = 0.3940243455197881
Train: epoch: 1, loss = 0.3929482511596547
Train:  Epoch 1, Loss=0.39274083529578313, AUC-ROC Macro=0.6567733433470994, AUC-ROC Micro=0.747984434873124
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3735281092425187, AUC-ROC Macro=0.715913984874488, AUC-ROC Micro=0.7798978231322578
Eval task: 2
Eval:  Epoch 1, Loss=0.3404825240373611, AUC-ROC Macro=0.485528173805744, AUC-ROC Micro=0.5608518925591379
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3746196374297142
Train: epoch: 2, loss = 0.3725280584022403
Train: epoch: 2, loss = 0.37328686150411766
Train: epoch: 2, loss = 0.3744596254266799
Train: epoch: 2, loss = 0.3756394052803516
Train: epoch: 2, loss = 0.3742539189880093
Train: epoch: 2, loss = 0.37295156240463256
Train: epoch: 2, loss = 0.372866124920547
Train: epoch: 2, loss = 0.37201982973350417
Train: epoch: 2, loss = 0.3714437424466014
Train: epoch: 2, loss = 0.37160701461813667
Train: epoch: 2, loss = 0.3710931387419502
Train: epoch: 2, loss = 0.37090341694653034
Train: epoch: 2, loss = 0.3709085467777082
Train: epoch: 2, loss = 0.3701815392673016
Train: epoch: 2, loss = 0.36980730411130935
Train: epoch: 2, loss = 0.3696000302977422
Train: epoch: 2, loss = 0.36899829303638804
Train:  Epoch 2, Loss=0.36868428165586586, AUC-ROC Macro=0.7239614835149524, AUC-ROC Micro=0.7909579173968482
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3674912055333455, AUC-ROC Macro=0.7352927356093449, AUC-ROC Micro=0.79243877068039
Eval task: 2
Eval:  Epoch 2, Loss=0.3385987639427185, AUC-ROC Macro=0.4874183229315001, AUC-ROC Micro=0.5666082404593842
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.35507032200694083
Train: epoch: 3, loss = 0.36022434022277594
Train: epoch: 3, loss = 0.36234167384604615
Train: epoch: 3, loss = 0.36089629961177705
Train: epoch: 3, loss = 0.3618442322611809
Train: epoch: 3, loss = 0.36143328274289765
Train: epoch: 3, loss = 0.36113010244710103
Train: epoch: 3, loss = 0.3609842046070844
Train: epoch: 3, loss = 0.3609853785981735
Train: epoch: 3, loss = 0.3606152478605509
Train: epoch: 3, loss = 0.3605932451175018
Train: epoch: 3, loss = 0.3607872761785984
Train: epoch: 3, loss = 0.3602312002445643
Train: epoch: 3, loss = 0.36015228374728137
Train: epoch: 3, loss = 0.3598628632525603
Train: epoch: 3, loss = 0.3602863774308935
Train: epoch: 3, loss = 0.3603516924775699
Train: epoch: 3, loss = 0.36025872870451875
Train:  Epoch 3, Loss=0.36038755328023536, AUC-ROC Macro=0.7433157486692831, AUC-ROC Micro=0.8038285595355399
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35668622702360153, AUC-ROC Macro=0.7504823259187381, AUC-ROC Micro=0.8068894169238119
Eval task: 2
Eval:  Epoch 3, Loss=0.3704449772834778, AUC-ROC Macro=0.46314249892398374, AUC-ROC Micro=0.5516761000482997
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.36257321774959567
Train: epoch: 4, loss = 0.35939089734107255
Train: epoch: 4, loss = 0.3568441777924697
Train: epoch: 4, loss = 0.3565619326941669
Train: epoch: 4, loss = 0.35613042023777963
Train: epoch: 4, loss = 0.35615771791587275
Train: epoch: 4, loss = 0.35618549580020564
Train: epoch: 4, loss = 0.3570704597700387
Train: epoch: 4, loss = 0.35644469674262735
Train: epoch: 4, loss = 0.3563313257396221
Train: epoch: 4, loss = 0.35588390183042395
Train: epoch: 4, loss = 0.3550749449742337
Train: epoch: 4, loss = 0.35528154087181274
Train: epoch: 4, loss = 0.355177861813988
Train: epoch: 4, loss = 0.3548393053064744
Train: epoch: 4, loss = 0.3548339016828686
Train: epoch: 4, loss = 0.35438016657881877
Train: epoch: 4, loss = 0.35466317583703333
Train:  Epoch 4, Loss=0.35482809192706377, AUC-ROC Macro=0.7551160505670924, AUC-ROC Micro=0.8119612646780311
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.355522529532512, AUC-ROC Macro=0.7525811959414096, AUC-ROC Micro=0.8077471465347862
Eval task: 2
Eval:  Epoch 4, Loss=0.36705868542194364, AUC-ROC Macro=0.4695793207783516, AUC-ROC Micro=0.5435754900247929
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3473244367539883
Train: epoch: 5, loss = 0.34949744716286657
Train: epoch: 5, loss = 0.3523487344880899
Train: epoch: 5, loss = 0.35292559396475554
Train: epoch: 5, loss = 0.3515193435549736
Train: epoch: 5, loss = 0.35137176853915053
Train: epoch: 5, loss = 0.3509519192150661
Train: epoch: 5, loss = 0.3514408445172012
Train: epoch: 5, loss = 0.35086594502131147
Train: epoch: 5, loss = 0.35091870549321175
Train: epoch: 5, loss = 0.3507965534315868
Train: epoch: 5, loss = 0.3520540894009173
Train: epoch: 5, loss = 0.35116149292542387
Train: epoch: 5, loss = 0.3509597030069147
Train: epoch: 5, loss = 0.35122796592116357
Train: epoch: 5, loss = 0.35102368920110166
Train: epoch: 5, loss = 0.35108212705482456
Train: epoch: 5, loss = 0.3507573782155911
Train:  Epoch 5, Loss=0.3507563105261224, AUC-ROC Macro=0.7640001893601722, AUC-ROC Micro=0.8177069172379713
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35299400488535565, AUC-ROC Macro=0.7581961833543492, AUC-ROC Micro=0.811074781759033
Eval task: 2
Eval:  Epoch 5, Loss=0.38806034028530123, AUC-ROC Macro=0.46661774727516364, AUC-ROC Micro=0.5431788128005879
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3473746179789305
Train: epoch: 6, loss = 0.3492715403810143
Train: epoch: 6, loss = 0.348176134377718
Train: epoch: 6, loss = 0.34750312063843014
Train: epoch: 6, loss = 0.3476103256046772
Train: epoch: 6, loss = 0.3481072714428107
Train: epoch: 6, loss = 0.347916423955134
Train: epoch: 6, loss = 0.3481610145792365
Train: epoch: 6, loss = 0.34770649981167584
Train: epoch: 6, loss = 0.3471861032620072
Train: epoch: 6, loss = 0.34718606169250876
Train: epoch: 6, loss = 0.34675855612382295
Train: epoch: 6, loss = 0.3467241539404942
Train: epoch: 6, loss = 0.34713980367673297
Train: epoch: 6, loss = 0.34706448449691135
Train: epoch: 6, loss = 0.3471898785652593
Train: epoch: 6, loss = 0.347417438990053
Train: epoch: 6, loss = 0.34743140264931655
Train:  Epoch 6, Loss=0.347320138030582, AUC-ROC Macro=0.7705376980969154, AUC-ROC Micro=0.8224529603952037
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35072703659534454, AUC-ROC Macro=0.7626963833020115, AUC-ROC Micro=0.8150297330880167
Eval task: 2
Eval:  Epoch 6, Loss=0.39210346937179563, AUC-ROC Macro=0.4733789076745884, AUC-ROC Micro=0.529418265211323
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3532307595014572, AUC-ROC Macro=0.7622342696618638, AUC-ROC Micro=0.8143956816823276
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.394425293803215, AUC-ROC Macro=0.456917184295629, AUC-ROC Micro=0.5257256874697928
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.30037940219044684
Train: epoch: 1, loss = 0.2935286259278655
Train: epoch: 1, loss = 0.2873190221687158
Train: epoch: 1, loss = 0.28354696596041323
Train: epoch: 1, loss = 0.2808954650014639
Train: epoch: 1, loss = 0.2777829714119434
Train: epoch: 1, loss = 0.27577055250959737
Train:  Epoch 1, Loss=0.2733609487579881, AUC-ROC Macro=0.6134885058035847, AUC-ROC Micro=0.7520451621814103
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3526969725886981, AUC-ROC Macro=0.7454002986819002, AUC-ROC Micro=0.8031784796967308
Eval task: 2
Eval:  Epoch 1, Loss=0.2626171916723251, AUC-ROC Macro=0.6929062266691964, AUC-ROC Micro=0.7927357815443007
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2561926793307066
Train: epoch: 2, loss = 0.25784059312194585
Train: epoch: 2, loss = 0.25909544525047146
Train: epoch: 2, loss = 0.25838324075564745
Train: epoch: 2, loss = 0.25832253508269787
Train: epoch: 2, loss = 0.25793893227974574
Train: epoch: 2, loss = 0.25841089747846124
Train:  Epoch 2, Loss=0.2573634820377821, AUC-ROC Macro=0.7016481926451648, AUC-ROC Micro=0.8016134142176317
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3558831413586934, AUC-ROC Macro=0.7428764318115347, AUC-ROC Micro=0.8005263022277825
Eval task: 2
Eval:  Epoch 2, Loss=0.25885463654994967, AUC-ROC Macro=0.7103729640878198, AUC-ROC Micro=0.8051568716871753
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.24835913605988025
Train: epoch: 3, loss = 0.2518237745016813
Train: epoch: 3, loss = 0.25285165722171465
Train: epoch: 3, loss = 0.2529211059398949
Train: epoch: 3, loss = 0.25313980811834336
Train: epoch: 3, loss = 0.25239346623420716
Train: epoch: 3, loss = 0.25262489769075597
Train:  Epoch 3, Loss=0.2517509495102531, AUC-ROC Macro=0.7291731844099365, AUC-ROC Micro=0.8153201298859714
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35585076982776326, AUC-ROC Macro=0.7403912402041164, AUC-ROC Micro=0.7985283201160824
Eval task: 2
Eval:  Epoch 3, Loss=0.25653251707553865, AUC-ROC Macro=0.7224143459383913, AUC-ROC Micro=0.810969661478681
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.2478602785617113
Train: epoch: 4, loss = 0.24927266895771027
Train: epoch: 4, loss = 0.2491393554955721
Train: epoch: 4, loss = 0.24918299986049533
Train: epoch: 4, loss = 0.24874702313542366
Train: epoch: 4, loss = 0.24831186930338542
Train: epoch: 4, loss = 0.24805581075804575
Train:  Epoch 4, Loss=0.2474688983099996, AUC-ROC Macro=0.7483461728105035, AUC-ROC Micro=0.8246658294834339
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3528064750134945, AUC-ROC Macro=0.7456316203403724, AUC-ROC Micro=0.8028039170754908
Eval task: 2
Eval:  Epoch 4, Loss=0.25452339500188825, AUC-ROC Macro=0.7281182504206001, AUC-ROC Micro=0.8139149680393516
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.24517818450927734
Train: epoch: 5, loss = 0.24577792096883058
Train: epoch: 5, loss = 0.24562678364415963
Train: epoch: 5, loss = 0.24529660800471903
Train: epoch: 5, loss = 0.24454790687561034
Train: epoch: 5, loss = 0.24500206702699265
Train: epoch: 5, loss = 0.2446456392322268
Train:  Epoch 5, Loss=0.24391856622836147, AUC-ROC Macro=0.7609580923780718, AUC-ROC Micro=0.8314079148322047
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35418664415677387, AUC-ROC Macro=0.7409438804378329, AUC-ROC Micro=0.8000292344352109
Eval task: 2
Eval:  Epoch 5, Loss=0.25289289504289625, AUC-ROC Macro=0.7332283224172584, AUC-ROC Micro=0.8182335946594002
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.23714653484523296
Train: epoch: 6, loss = 0.24083504289388658
Train: epoch: 6, loss = 0.24227915003895759
Train: epoch: 6, loss = 0.2418289684690535
Train: epoch: 6, loss = 0.24201869867742062
Train: epoch: 6, loss = 0.24188150577247142
Train: epoch: 6, loss = 0.24165344815169063
Train:  Epoch 6, Loss=0.2409155687009032, AUC-ROC Macro=0.7733061333592578, AUC-ROC Micro=0.8374630808887729
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3560137674212456, AUC-ROC Macro=0.7391079649446588, AUC-ROC Micro=0.7985454493102162
Eval task: 2
Eval:  Epoch 6, Loss=0.252657362818718, AUC-ROC Macro=0.7384812624494848, AUC-ROC Micro=0.8196918068789254
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.369076586018006, AUC-ROC Macro=0.7389729779649379, AUC-ROC Micro=0.7976034793292232
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.23051266223192216, AUC-ROC Macro=0.7407517648188275, AUC-ROC Micro=0.8212355853189646
{'0': {'precision': 0.4939870490286771, 'recall': 0.40825688073394495, 'f1-score': 0.4470489744663039, 'support': 1308}, '1': {'precision': 0.6542056074766355, 'recall': 0.3482587064676617, 'f1-score': 0.45454545454545453, 'support': 402}, '2': {'precision': 0.45454545454545453, 'recall': 0.030395136778115502, 'f1-score': 0.05698005698005698, 'support': 658}, '3': {'precision': 0.4898291293734744, 'recall': 0.30251256281407035, 'f1-score': 0.3740292016154085, 'support': 1990}, '4': {'precision': 0.4337078651685393, 'recall': 0.23945409429280398, 'f1-score': 0.3085531574740208, 'support': 806}, '5': {'precision': 0.3076923076923077, 'recall': 0.015424164524421594, 'f1-score': 0.02937576499388005, 'support': 778}, '6': {'precision': 0.5486111111111112, 'recall': 0.12135176651305683, 'f1-score': 0.19874213836477989, 'support': 1302}, '7': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 424}, '8': {'precision': 0.527363184079602, 'recall': 0.38686131386861317, 'f1-score': 0.44631578947368417, 'support': 1644}, '9': {'precision': 0.6123778501628665, 'recall': 0.5553914327917282, 'f1-score': 0.5824941905499613, 'support': 2031}, '10': {'precision': 0.5623409669211196, 'recall': 0.3856893542757417, 'f1-score': 0.4575569358178054, 'support': 573}, '11': {'precision': 0.47854077253218885, 'recall': 0.18962585034013604, 'f1-score': 0.27161997563946405, 'support': 1176}, '12': {'precision': 0.5029126213592233, 'recall': 0.29265536723163843, 'f1-score': 0.37, 'support': 1770}, '13': {'precision': 0.5773684210526315, 'recall': 0.4225731895223421, 'f1-score': 0.48798932384341637, 'support': 2596}, '14': {'precision': 0.48992248062015503, 'recall': 0.38844499078057776, 'f1-score': 0.43332190606787796, 'support': 1627}, '15': {'precision': 0.1111111111111111, 'recall': 0.002066115702479339, 'f1-score': 0.004056795131845843, 'support': 484}, '16': {'precision': 0.39563106796116504, 'recall': 0.2050314465408805, 'f1-score': 0.27009113504556753, 'support': 795}, '17': {'precision': 0.45614035087719296, 'recall': 0.04779411764705882, 'f1-score': 0.086522462562396, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.44680851063829785, 'recall': 0.08015267175572519, 'f1-score': 0.13592233009708737, 'support': 262}, '20': {'precision': 0.16666666666666666, 'recall': 0.0017761989342806395, 'f1-score': 0.00351493848857645, 'support': 563}, '21': {'precision': 0.45958429561200925, 'recall': 0.23775388291517324, 'f1-score': 0.31338582677165355, 'support': 837}, '22': {'precision': 0.6503719447396387, 'recall': 0.56353591160221, 'f1-score': 0.6038480513073508, 'support': 1086}, '23': {'precision': 0.5258064516129032, 'recall': 0.3786295005807201, 'f1-score': 0.4402430790006752, 'support': 861}, '24': {'precision': 0.6405228758169934, 'recall': 0.19405940594059407, 'f1-score': 0.29787234042553196, 'support': 505}, 'micro avg': {'precision': 0.5344218264065592, 'recall': 0.29799393055610296, 'f1-score': 0.38263201842058653, 'support': 25373}, 'macro avg': {'precision': 0.4394419238463986, 'recall': 0.23190776250215897, 'f1-score': 0.28296119314651197, 'support': 25373}, 'weighted avg': {'precision': 0.4872321067780937, 'recall': 0.29799393055610296, 'f1-score': 0.35287984629251057, 'support': 25373}, 'samples avg': {'precision': 0.39720939370597574, 'recall': 0.26349087256931353, 'f1-score': 0.2911698398622297, 'support': 25373}}
{'0': {'precision': 0.6296296296296297, 'recall': 0.5553539019963702, 'f1-score': 0.5901639344262295, 'support': 551}, '1': {'precision': 0.5904059040590406, 'recall': 0.2450229709035222, 'f1-score': 0.34632034632034636, 'support': 653}, '2': {'precision': 0.4, 'recall': 0.004694835680751174, 'f1-score': 0.009280742459396751, 'support': 426}, '3': {'precision': 0.45454545454545453, 'recall': 0.02444987775061125, 'f1-score': 0.046403712296983764, 'support': 409}, '4': {'precision': 0.35, 'recall': 0.02857142857142857, 'f1-score': 0.05283018867924528, 'support': 245}, '5': {'precision': 0.7272727272727273, 'recall': 0.0446927374301676, 'f1-score': 0.08421052631578949, 'support': 358}, '6': {'precision': 0.5, 'recall': 0.02459016393442623, 'f1-score': 0.046875, 'support': 244}, '7': {'precision': 0.6987951807228916, 'recall': 0.19727891156462585, 'f1-score': 0.3076923076923077, 'support': 294}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 263}, '9': {'precision': 0.6666666666666666, 'recall': 0.007194244604316547, 'f1-score': 0.014234875444839859, 'support': 278}, '10': {'precision': 0.4, 'recall': 0.009615384615384616, 'f1-score': 0.018779342723004695, 'support': 208}, '11': {'precision': 0.5, 'recall': 0.04417670682730924, 'f1-score': 0.08118081180811808, 'support': 249}, '12': {'precision': 0.5, 'recall': 0.004608294930875576, 'f1-score': 0.0091324200913242, 'support': 217}, '13': {'precision': 0.4583333333333333, 'recall': 0.08333333333333333, 'f1-score': 0.14102564102564102, 'support': 132}, '14': {'precision': 0.7272727272727273, 'recall': 0.10619469026548672, 'f1-score': 0.18532818532818532, 'support': 226}, '15': {'precision': 0.8, 'recall': 0.49523809523809526, 'f1-score': 0.611764705882353, 'support': 105}, '16': {'precision': 0.5769230769230769, 'recall': 0.11029411764705882, 'f1-score': 0.18518518518518517, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.6186594202898551, 'recall': 0.12669263587460583, 'f1-score': 0.2103156274056967, 'support': 5391}, 'macro avg': {'precision': 0.3591937880170219, 'recall': 0.07941238781175053, 'f1-score': 0.109216317027158, 'support': 5391}, 'weighted avg': {'precision': 0.491780374668938, 'recall': 0.12669263587460583, 'f1-score': 0.16680193313015954, 'support': 5391}, 'samples avg': {'precision': 0.21396158854166672, 'recall': 0.1263371155753968, 'f1-score': 0.1447921913156288, 'support': 5391}}