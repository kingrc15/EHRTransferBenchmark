
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_northeast
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4245695747435093
Train: epoch: 1, loss = 0.41844065256416796
Train: epoch: 1, loss = 0.4136737904449304
Train: epoch: 1, loss = 0.4112404996342957
Train: epoch: 1, loss = 0.41033636139333246
Train: epoch: 1, loss = 0.408222971521318
Train: epoch: 1, loss = 0.40577122073088373
Train: epoch: 1, loss = 0.40220285528339444
Train: epoch: 1, loss = 0.4008907718376981
Train: epoch: 1, loss = 0.3994442169591784
Train: epoch: 1, loss = 0.3981387126784433
Train: epoch: 1, loss = 0.3971675834991038
Train: epoch: 1, loss = 0.39591613200421516
Train: epoch: 1, loss = 0.3947470058553985
Train: epoch: 1, loss = 0.39362364368637404
Train: epoch: 1, loss = 0.3928746706340462
Train: epoch: 1, loss = 0.3919709536915316
Train: epoch: 1, loss = 0.39136419171674386
Train:  Epoch 1, Loss=0.3912913016315199, AUC-ROC Macro=0.6603195596353564, AUC-ROC Micro=0.7508014309107341
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3713739402592182, AUC-ROC Macro=0.7189187450501087, AUC-ROC Micro=0.7826227555144651
Eval task: 2
Eval:  Epoch 1, Loss=0.3841838836669922, AUC-ROC Macro=0.48905897780151053, AUC-ROC Micro=0.6100033214697356
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.36584420174360277
Train: epoch: 2, loss = 0.3667356200516224
Train: epoch: 2, loss = 0.3694169313708941
Train: epoch: 2, loss = 0.36837948456406594
Train: epoch: 2, loss = 0.369820160806179
Train: epoch: 2, loss = 0.37055386540790397
Train: epoch: 2, loss = 0.3702522045161043
Train: epoch: 2, loss = 0.36983069257810713
Train: epoch: 2, loss = 0.36909479269550904
Train: epoch: 2, loss = 0.36883535765856507
Train: epoch: 2, loss = 0.3690933892401782
Train: epoch: 2, loss = 0.36915757122139137
Train: epoch: 2, loss = 0.36917679345378507
Train: epoch: 2, loss = 0.36918990679085256
Train: epoch: 2, loss = 0.3691640268663565
Train: epoch: 2, loss = 0.3688584105297923
Train: epoch: 2, loss = 0.3691417705180014
Train: epoch: 2, loss = 0.36931171922220124
Train:  Epoch 2, Loss=0.36919369519470085, AUC-ROC Macro=0.7228322758402292, AUC-ROC Micro=0.7900163730135277
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36321746185421944, AUC-ROC Macro=0.7362931676855553, AUC-ROC Micro=0.796596079339222
Eval task: 2
Eval:  Epoch 2, Loss=0.4057534784078598, AUC-ROC Macro=0.4813914145661408, AUC-ROC Micro=0.5882923708511095
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36314296156167986
Train: epoch: 3, loss = 0.3624588414654136
Train: epoch: 3, loss = 0.3639679059386253
Train: epoch: 3, loss = 0.36440049186348916
Train: epoch: 3, loss = 0.363912682428956
Train: epoch: 3, loss = 0.36249084160973627
Train: epoch: 3, loss = 0.36272938310035635
Train: epoch: 3, loss = 0.36278099099174144
Train: epoch: 3, loss = 0.3632100946870115
Train: epoch: 3, loss = 0.3629716928675771
Train: epoch: 3, loss = 0.3630690305273641
Train: epoch: 3, loss = 0.36314862017830213
Train: epoch: 3, loss = 0.3623111315931265
Train: epoch: 3, loss = 0.36226116737616915
Train: epoch: 3, loss = 0.3615105235129595
Train: epoch: 3, loss = 0.3614181866450235
Train: epoch: 3, loss = 0.3614975929391735
Train: epoch: 3, loss = 0.36131388135254383
Train:  Epoch 3, Loss=0.3609916307274093, AUC-ROC Macro=0.7423799137898512, AUC-ROC Micro=0.802930370177348
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3578758661945661, AUC-ROC Macro=0.7480297273143954, AUC-ROC Micro=0.8040041984373518
Eval task: 2
Eval:  Epoch 3, Loss=0.42991015315055847, AUC-ROC Macro=0.47965466475548824, AUC-ROC Micro=0.5793292861927004
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3541585872322321
Train: epoch: 4, loss = 0.3576660214364529
Train: epoch: 4, loss = 0.3568247203777234
Train: epoch: 4, loss = 0.3564349533058703
Train: epoch: 4, loss = 0.35622672773897646
Train: epoch: 4, loss = 0.35562587205320595
Train: epoch: 4, loss = 0.3560385495317834
Train: epoch: 4, loss = 0.3564224200509489
Train: epoch: 4, loss = 0.3558902008831501
Train: epoch: 4, loss = 0.35578899989277124
Train: epoch: 4, loss = 0.3557299687171524
Train: epoch: 4, loss = 0.35575070154542726
Train: epoch: 4, loss = 0.3557542413530441
Train: epoch: 4, loss = 0.3558240450492927
Train: epoch: 4, loss = 0.3555660660068194
Train: epoch: 4, loss = 0.3554929150920361
Train: epoch: 4, loss = 0.35510472433093715
Train: epoch: 4, loss = 0.3551190630056792
Train:  Epoch 4, Loss=0.3552202834308657, AUC-ROC Macro=0.7547670086353472, AUC-ROC Micro=0.811425239080263
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35308382908503216, AUC-ROC Macro=0.7562116973440931, AUC-ROC Micro=0.8111255412968542
Eval task: 2
Eval:  Epoch 4, Loss=0.4410158097743988, AUC-ROC Macro=0.4803556098575232, AUC-ROC Micro=0.5787226914021806
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3487661897391081
Train: epoch: 5, loss = 0.3509802893176675
Train: epoch: 5, loss = 0.3520661719143391
Train: epoch: 5, loss = 0.3528088725730777
Train: epoch: 5, loss = 0.3524751393198967
Train: epoch: 5, loss = 0.3505440284560124
Train: epoch: 5, loss = 0.3504166808298656
Train: epoch: 5, loss = 0.35001981175504626
Train: epoch: 5, loss = 0.3505440139522155
Train: epoch: 5, loss = 0.3507104129269719
Train: epoch: 5, loss = 0.3509398901462555
Train: epoch: 5, loss = 0.3513878731057048
Train: epoch: 5, loss = 0.35092585895497064
Train: epoch: 5, loss = 0.3508526241992201
Train: epoch: 5, loss = 0.35068788900971415
Train: epoch: 5, loss = 0.3509116845205426
Train: epoch: 5, loss = 0.35053929267122463
Train: epoch: 5, loss = 0.35039940487593413
Train:  Epoch 5, Loss=0.3504910179733211, AUC-ROC Macro=0.7644874251744206, AUC-ROC Micro=0.8182210827509437
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3517824100951354, AUC-ROC Macro=0.7600302906688157, AUC-ROC Micro=0.8129388104680852
Eval task: 2
Eval:  Epoch 5, Loss=0.461216077208519, AUC-ROC Macro=0.4768822099126122, AUC-ROC Micro=0.573392151503877
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3481060905009508
Train: epoch: 6, loss = 0.34752709973603485
Train: epoch: 6, loss = 0.34607160786787666
Train: epoch: 6, loss = 0.34742768965661525
Train: epoch: 6, loss = 0.34811742217838765
Train: epoch: 6, loss = 0.34643903261671466
Train: epoch: 6, loss = 0.3458810029072421
Train: epoch: 6, loss = 0.3448928521480411
Train: epoch: 6, loss = 0.34525870576500894
Train: epoch: 6, loss = 0.34531246158480644
Train: epoch: 6, loss = 0.3458408297395164
Train: epoch: 6, loss = 0.3466561190535625
Train: epoch: 6, loss = 0.34670234066935685
Train: epoch: 6, loss = 0.34653338605271916
Train: epoch: 6, loss = 0.34667871755858265
Train: epoch: 6, loss = 0.34687723714858293
Train: epoch: 6, loss = 0.3470857305737103
Train: epoch: 6, loss = 0.34714554201811554
Train:  Epoch 6, Loss=0.3470252554722321, AUC-ROC Macro=0.7710865127259103, AUC-ROC Micro=0.8229718243589623
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35141925017038983, AUC-ROC Macro=0.7625476578014972, AUC-ROC Micro=0.8147078138278875
Eval task: 2
Eval:  Epoch 6, Loss=0.4679400622844696, AUC-ROC Macro=0.4679737719931524, AUC-ROC Micro=0.5659239995391302
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3535714273651441, AUC-ROC Macro=0.7620837417954108, AUC-ROC Micro=0.8145560082264927
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.47957345843315125, AUC-ROC Macro=0.4753467278094428, AUC-ROC Micro=0.579196476553285
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.34672984808683394
Train:  Epoch 1, Loss=0.3399563156993153, AUC-ROC Macro=0.5570256819470574, AUC-ROC Micro=0.7255539105799587
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.34787912915150326, AUC-ROC Macro=0.7598406305147465, AUC-ROC Micro=0.8131759668385183
Eval task: 2
Eval:  Epoch 1, Loss=0.33415913581848145, AUC-ROC Macro=0.5967562883821227, AUC-ROC Micro=0.761874796930019
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.3182421462237835
Train:  Epoch 2, Loss=0.3185792650554636, AUC-ROC Macro=0.646647353210155, AUC-ROC Micro=0.7958109351666566
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.34457968423763913, AUC-ROC Macro=0.7598083847629842, AUC-ROC Micro=0.8138999117775563
Eval task: 2
Eval:  Epoch 2, Loss=0.32512448728084564, AUC-ROC Macro=0.6477800189379386, AUC-ROC Micro=0.7893818900977575
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.30701286002993583
Train:  Epoch 3, Loss=0.3103352246424144, AUC-ROC Macro=0.68781243836595, AUC-ROC Micro=0.817557356406894
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.34267812594771385, AUC-ROC Macro=0.7582662598374296, AUC-ROC Micro=0.812735552051042
Eval task: 2
Eval:  Epoch 3, Loss=0.3190586119890213, AUC-ROC Macro=0.6640578059748775, AUC-ROC Micro=0.8023122590329176
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.3016407437622547
Train:  Epoch 4, Loss=0.303481306241646, AUC-ROC Macro=0.7230689089714025, AUC-ROC Micro=0.8321647441194986
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.34186627467473346, AUC-ROC Macro=0.7565936360343355, AUC-ROC Micro=0.8107748373845038
Eval task: 2
Eval:  Epoch 4, Loss=0.31615301966667175, AUC-ROC Macro=0.6762224308394105, AUC-ROC Micro=0.8108087763733228
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2976226333528757
Train:  Epoch 5, Loss=0.29825586974205165, AUC-ROC Macro=0.7429648815969432, AUC-ROC Micro=0.8415932495232742
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.33976122985283536, AUC-ROC Macro=0.75522724333188, AUC-ROC Micro=0.809744932751217
Eval task: 2
Eval:  Epoch 5, Loss=0.3093589246273041, AUC-ROC Macro=0.6884507571024711, AUC-ROC Micro=0.8163771971727292
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.29091479934751985
Train:  Epoch 6, Loss=0.2931923191251449, AUC-ROC Macro=0.7605216917265827, AUC-ROC Micro=0.8497539590103016
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.33863769595821697, AUC-ROC Macro=0.7537037200692192, AUC-ROC Micro=0.8082237834752337
Eval task: 2
Eval:  Epoch 6, Loss=0.3062865138053894, AUC-ROC Macro=0.6945311973468543, AUC-ROC Micro=0.8211487727232634
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.36094051226973534, AUC-ROC Macro=0.7525546417559218, AUC-ROC Micro=0.8067544940538658
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.29347391426563263, AUC-ROC Macro=0.6852492558084637, AUC-ROC Micro=0.8125447000273984
{'0': {'precision': 0.5610119047619048, 'recall': 0.2882262996941896, 'f1-score': 0.3808080808080808, 'support': 1308}, '1': {'precision': 0.6213235294117647, 'recall': 0.42039800995024873, 'f1-score': 0.5014836795252225, 'support': 402}, '2': {'precision': 0.46153846153846156, 'recall': 0.0547112462006079, 'f1-score': 0.09782608695652174, 'support': 658}, '3': {'precision': 0.5046728971962616, 'recall': 0.2984924623115578, 'f1-score': 0.3751184085885696, 'support': 1990}, '4': {'precision': 0.4788732394366197, 'recall': 0.08436724565756824, 'f1-score': 0.14345991561181437, 'support': 806}, '5': {'precision': 0.5625, 'recall': 0.011568123393316195, 'f1-score': 0.02267002518891688, 'support': 778}, '6': {'precision': 0.5198237885462555, 'recall': 0.18125960061443933, 'f1-score': 0.2687927107061503, 'support': 1302}, '7': {'precision': 0.3157894736842105, 'recall': 0.014150943396226415, 'f1-score': 0.02708803611738149, 'support': 424}, '8': {'precision': 0.5302663438256658, 'recall': 0.39963503649635035, 'f1-score': 0.45577523413111337, 'support': 1644}, '9': {'precision': 0.6356132075471698, 'recall': 0.5307730182176268, 'f1-score': 0.5784813522940704, 'support': 2031}, '10': {'precision': 0.6262975778546713, 'recall': 0.3158813263525305, 'f1-score': 0.41995359628770296, 'support': 573}, '11': {'precision': 0.5131578947368421, 'recall': 0.2653061224489796, 'f1-score': 0.3497757847533633, 'support': 1176}, '12': {'precision': 0.5859375, 'recall': 0.2966101694915254, 'f1-score': 0.3938484621155289, 'support': 1770}, '13': {'precision': 0.5835336538461539, 'recall': 0.37403697996918334, 'f1-score': 0.45586854460093895, 'support': 2596}, '14': {'precision': 0.5386503067484663, 'recall': 0.2698217578365089, 'f1-score': 0.3595413595413595, 'support': 1627}, '15': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 484}, '16': {'precision': 0.358974358974359, 'recall': 0.10566037735849057, 'f1-score': 0.16326530612244897, 'support': 795}, '17': {'precision': 0.5352112676056338, 'recall': 0.06985294117647059, 'f1-score': 0.12357723577235773, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.4117647058823529, 'recall': 0.05343511450381679, 'f1-score': 0.0945945945945946, 'support': 262}, '20': {'precision': 0.2926829268292683, 'recall': 0.021314387211367674, 'f1-score': 0.039735099337748346, 'support': 563}, '21': {'precision': 0.5431034482758621, 'recall': 0.22580645161290322, 'f1-score': 0.3189873417721519, 'support': 837}, '22': {'precision': 0.6637458926615553, 'recall': 0.5580110497237569, 'f1-score': 0.6063031515757878, 'support': 1086}, '23': {'precision': 0.6267409470752089, 'recall': 0.2613240418118467, 'f1-score': 0.3688524590163935, 'support': 861}, '24': {'precision': 0.5849056603773585, 'recall': 0.18415841584158416, 'f1-score': 0.28012048192771083, 'support': 505}, 'micro avg': {'precision': 0.5672706403213905, 'recall': 0.27269144366058407, 'f1-score': 0.3683257918552036, 'support': 25373}, 'macro avg': {'precision': 0.4822447594726419, 'recall': 0.21139204485084384, 'f1-score': 0.2730370778938372, 'support': 25373}, 'weighted avg': {'precision': 0.5257106273878271, 'recall': 0.27269144366058407, 'f1-score': 0.3419227205956573, 'support': 25373}, 'samples avg': {'precision': 0.3838392596083026, 'recall': 0.2413574910853461, 'f1-score': 0.27150874252346147, 'support': 25373}}
{'0': {'precision': 0.6166666666666667, 'recall': 0.2846153846153846, 'f1-score': 0.3894736842105263, 'support': 130}, '1': {'precision': 0.5714285714285714, 'recall': 0.6176470588235294, 'f1-score': 0.5936395759717314, 'support': 136}, '2': {'precision': 0.38181818181818183, 'recall': 0.15328467153284672, 'f1-score': 0.21875, 'support': 137}, '3': {'precision': 0.6842105263157895, 'recall': 0.6713615023474179, 'f1-score': 0.6777251184834123, 'support': 213}, '4': {'precision': 0.6363636363636364, 'recall': 0.09333333333333334, 'f1-score': 0.1627906976744186, 'support': 75}, '5': {'precision': 0.5294117647058824, 'recall': 0.09574468085106383, 'f1-score': 0.16216216216216217, 'support': 94}, '6': {'precision': 0.5714285714285714, 'recall': 0.10810810810810811, 'f1-score': 0.18181818181818182, 'support': 74}, '7': {'precision': 0.375, 'recall': 0.075, 'f1-score': 0.12499999999999999, 'support': 40}, '8': {'precision': 0.5, 'recall': 0.02666666666666667, 'f1-score': 0.05063291139240507, 'support': 75}, '9': {'precision': 1.0, 'recall': 0.015384615384615385, 'f1-score': 0.030303030303030307, 'support': 65}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 63}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 56}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 52}, '13': {'precision': 0.625, 'recall': 0.09090909090909091, 'f1-score': 0.15873015873015875, 'support': 55}, '14': {'precision': 0.75, 'recall': 0.09523809523809523, 'f1-score': 0.16901408450704225, 'support': 63}, '15': {'precision': 1.0, 'recall': 0.10526315789473684, 'f1-score': 0.1904761904761905, 'support': 19}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '17': {'precision': 0.5, 'recall': 0.012195121951219513, 'f1-score': 0.023809523809523808, 'support': 82}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, 'micro avg': {'precision': 0.6014625228519196, 'recall': 0.21405335068314899, 'f1-score': 0.3157389635316698, 'support': 1537}, 'macro avg': {'precision': 0.34965311674909194, 'recall': 0.09779005950624434, 'f1-score': 0.12537301278155133, 'support': 1537}, 'weighted avg': {'precision': 0.4911057763764778, 'recall': 0.21405335068314899, 'f1-score': 0.24874072380580295, 'support': 1537}, 'samples avg': {'precision': 0.33064546130952377, 'recall': 0.18218858506944444, 'f1-score': 0.21655288071303697, 'support': 1537}}