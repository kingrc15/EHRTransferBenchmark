
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4332623605430126
Train: epoch: 1, loss = 0.423370318710804
Train: epoch: 1, loss = 0.4167425960799058
Train: epoch: 1, loss = 0.41389294032007456
Train: epoch: 1, loss = 0.4111590376496315
Train: epoch: 1, loss = 0.4090401055415471
Train: epoch: 1, loss = 0.4071303383367402
Train: epoch: 1, loss = 0.40595371086150406
Train: epoch: 1, loss = 0.40419088414145843
Train: epoch: 1, loss = 0.40299432416260245
Train: epoch: 1, loss = 0.4011415134505792
Train: epoch: 1, loss = 0.39932136729359624
Train: epoch: 1, loss = 0.3968181071717006
Train: epoch: 1, loss = 0.3953142591672284
Train: epoch: 1, loss = 0.39450088310738407
Train: epoch: 1, loss = 0.39304311376996337
Train: epoch: 1, loss = 0.3920670131550116
Train: epoch: 1, loss = 0.3912724076418413
Train:  Epoch 1, Loss=0.3909957057268192, AUC-ROC Macro=0.6617318984147588, AUC-ROC Micro=0.7512204836963421
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37145373101035756, AUC-ROC Macro=0.7204254564208997, AUC-ROC Micro=0.7818878502195722
Eval task: 2
Eval:  Epoch 1, Loss=0.3493448793888092, AUC-ROC Macro=0.4796248070047527, AUC-ROC Micro=0.5550002060757109
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.36934842258691786
Train: epoch: 2, loss = 0.3680164057016373
Train: epoch: 2, loss = 0.3671035127838453
Train: epoch: 2, loss = 0.3682252315990627
Train: epoch: 2, loss = 0.36756319691240785
Train: epoch: 2, loss = 0.3682143698384364
Train: epoch: 2, loss = 0.3681624922156334
Train: epoch: 2, loss = 0.3686096067074686
Train: epoch: 2, loss = 0.3684362366464403
Train: epoch: 2, loss = 0.36855993489176037
Train: epoch: 2, loss = 0.36816042089326817
Train: epoch: 2, loss = 0.36835985651860637
Train: epoch: 2, loss = 0.3685651731147216
Train: epoch: 2, loss = 0.36850953300616573
Train: epoch: 2, loss = 0.36815550878147285
Train: epoch: 2, loss = 0.3681526823807508
Train: epoch: 2, loss = 0.367700329304618
Train: epoch: 2, loss = 0.36730089558495416
Train:  Epoch 2, Loss=0.3671838695412008, AUC-ROC Macro=0.7273213746235911, AUC-ROC Micro=0.793179841358232
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3606308462719123, AUC-ROC Macro=0.7413374968411136, AUC-ROC Micro=0.7993581362034035
Eval task: 2
Eval:  Epoch 2, Loss=0.35623919367790224, AUC-ROC Macro=0.47702465162391966, AUC-ROC Micro=0.5476335675976797
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.35940035820007327
Train: epoch: 3, loss = 0.3603525124490261
Train: epoch: 3, loss = 0.3603103189170361
Train: epoch: 3, loss = 0.36071589970961215
Train: epoch: 3, loss = 0.36095105181634424
Train: epoch: 3, loss = 0.36093727976083756
Train: epoch: 3, loss = 0.3612094539829663
Train: epoch: 3, loss = 0.36063048167154194
Train: epoch: 3, loss = 0.36025704177717366
Train: epoch: 3, loss = 0.36053389783203604
Train: epoch: 3, loss = 0.3601895534111695
Train: epoch: 3, loss = 0.36049654270832737
Train: epoch: 3, loss = 0.3605499273653214
Train: epoch: 3, loss = 0.3600390788593463
Train: epoch: 3, loss = 0.36000117926299574
Train: epoch: 3, loss = 0.35956562638748435
Train: epoch: 3, loss = 0.35955057564465437
Train: epoch: 3, loss = 0.35958354694975747
Train:  Epoch 3, Loss=0.3596628735126593, AUC-ROC Macro=0.7446804571659859, AUC-ROC Micro=0.8047066814834397
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35727285345395404, AUC-ROC Macro=0.7495549611698822, AUC-ROC Micro=0.8054849715561574
Eval task: 2
Eval:  Epoch 3, Loss=0.358935084939003, AUC-ROC Macro=0.4682692932122003, AUC-ROC Micro=0.5544357745542756
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3576852045208216
Train: epoch: 4, loss = 0.35571283858269453
Train: epoch: 4, loss = 0.3549732774247726
Train: epoch: 4, loss = 0.3557451356202364
Train: epoch: 4, loss = 0.3553197409510612
Train: epoch: 4, loss = 0.35478967712571224
Train: epoch: 4, loss = 0.3557725205165999
Train: epoch: 4, loss = 0.35467798812314866
Train: epoch: 4, loss = 0.35524738882150914
Train: epoch: 4, loss = 0.35471143513917924
Train: epoch: 4, loss = 0.3546359577165409
Train: epoch: 4, loss = 0.354894635733217
Train: epoch: 4, loss = 0.3546545191453053
Train: epoch: 4, loss = 0.353972327810313
Train: epoch: 4, loss = 0.3543328316062689
Train: epoch: 4, loss = 0.35444833611603827
Train: epoch: 4, loss = 0.3540372024783317
Train: epoch: 4, loss = 0.3542831338569522
Train:  Epoch 4, Loss=0.35419991767915904, AUC-ROC Macro=0.7571127614602229, AUC-ROC Micro=0.8128990476921122
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35199815407395363, AUC-ROC Macro=0.7580341381756363, AUC-ROC Micro=0.8126930381207641
Eval task: 2
Eval:  Epoch 4, Loss=0.36199767887592316, AUC-ROC Macro=0.47315226450046827, AUC-ROC Micro=0.5402347009274038
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.35120334252715113
Train: epoch: 5, loss = 0.34853561632335184
Train: epoch: 5, loss = 0.3493446305642525
Train: epoch: 5, loss = 0.3508946562744677
Train: epoch: 5, loss = 0.3507406176328659
Train: epoch: 5, loss = 0.35085515569895503
Train: epoch: 5, loss = 0.35008101783692835
Train: epoch: 5, loss = 0.349503279235214
Train: epoch: 5, loss = 0.34998437117371295
Train: epoch: 5, loss = 0.3498100373446941
Train: epoch: 5, loss = 0.35012374658476225
Train: epoch: 5, loss = 0.3504996127386888
Train: epoch: 5, loss = 0.3508841947179574
Train: epoch: 5, loss = 0.3505727529046791
Train: epoch: 5, loss = 0.3501353097955386
Train: epoch: 5, loss = 0.3500361570483074
Train: epoch: 5, loss = 0.3501091006047585
Train: epoch: 5, loss = 0.34978104231258234
Train:  Epoch 5, Loss=0.34977219452409664, AUC-ROC Macro=0.7659114758618544, AUC-ROC Micro=0.8190871295971613
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35258380820353824, AUC-ROC Macro=0.7595433552543527, AUC-ROC Micro=0.8130511236524877
Eval task: 2
Eval:  Epoch 5, Loss=0.3949867308139801, AUC-ROC Macro=0.471494776829147, AUC-ROC Micro=0.5405604707699139
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34065936602652075
Train: epoch: 6, loss = 0.34608428332954644
Train: epoch: 6, loss = 0.3468684154252211
Train: epoch: 6, loss = 0.34462015092372894
Train: epoch: 6, loss = 0.345059065669775
Train: epoch: 6, loss = 0.34426862965027494
Train: epoch: 6, loss = 0.3445398350379297
Train: epoch: 6, loss = 0.34392612223513425
Train: epoch: 6, loss = 0.3444759768082036
Train: epoch: 6, loss = 0.34574083037674425
Train: epoch: 6, loss = 0.3464766157012094
Train: epoch: 6, loss = 0.3461385445172588
Train: epoch: 6, loss = 0.34596236214614834
Train: epoch: 6, loss = 0.34583648329866784
Train: epoch: 6, loss = 0.3464476328343153
Train: epoch: 6, loss = 0.34663788062985984
Train: epoch: 6, loss = 0.3463820931403076
Train: epoch: 6, loss = 0.3463011183755265
Train:  Epoch 6, Loss=0.3463473248665149, AUC-ROC Macro=0.772582105865418, AUC-ROC Micro=0.8237985989866681
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3503118467827638, AUC-ROC Macro=0.7634926754914487, AUC-ROC Micro=0.8158963549782403
Eval task: 2
Eval:  Epoch 6, Loss=0.40131546556949615, AUC-ROC Macro=0.4712121059061516, AUC-ROC Micro=0.5289367320773827
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.353071669737498, AUC-ROC Macro=0.7632608634801535, AUC-ROC Micro=0.8149278204702539
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.4009585291147232, AUC-ROC Macro=0.46055215299959756, AUC-ROC Micro=0.5260658669840956
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2873507381230593
Train: epoch: 1, loss = 0.2732080916315317
Train: epoch: 1, loss = 0.26461782823006313
Train: epoch: 1, loss = 0.25979437299072744
Train: epoch: 1, loss = 0.2570034976452589
Train: epoch: 1, loss = 0.25491051641603313
Train: epoch: 1, loss = 0.25279035595910887
Train:  Epoch 1, Loss=0.2523246364020483, AUC-ROC Macro=0.642361086517333, AUC-ROC Micro=0.7680542653343227
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4724658615887165, AUC-ROC Macro=0.622980726482638, AUC-ROC Micro=0.6310519537262503
Eval task: 2
Eval:  Epoch 1, Loss=0.24073109924793243, AUC-ROC Macro=0.700667081808804, AUC-ROC Micro=0.7972454226171519
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.23669327042996882
Train: epoch: 2, loss = 0.23661694634705782
Train: epoch: 2, loss = 0.23671606332063674
Train: epoch: 2, loss = 0.23567075952887534
Train: epoch: 2, loss = 0.23539053943753244
Train: epoch: 2, loss = 0.23519966995964448
Train: epoch: 2, loss = 0.2355832601977246
Train:  Epoch 2, Loss=0.235596286437599, AUC-ROC Macro=0.7210786925141622, AUC-ROC Micro=0.8102288262941302
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.49572351823250455, AUC-ROC Macro=0.6046291597961159, AUC-ROC Micro=0.606140269111465
Eval task: 2
Eval:  Epoch 2, Loss=0.2341303199529648, AUC-ROC Macro=0.7284824521391612, AUC-ROC Micro=0.8127462973159486
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.22935582645237446
Train: epoch: 3, loss = 0.22919148162007333
Train: epoch: 3, loss = 0.22846260669330756
Train: epoch: 3, loss = 0.22829043846577407
Train: epoch: 3, loss = 0.22907875072956085
Train: epoch: 3, loss = 0.22915215995783608
Train: epoch: 3, loss = 0.2298502694762179
Train:  Epoch 3, Loss=0.22981183643732175, AUC-ROC Macro=0.7456871864132789, AUC-ROC Micro=0.823271759331567
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.512578704704841, AUC-ROC Macro=0.5898591958498791, AUC-ROC Micro=0.6024255387807331
Eval task: 2
Eval:  Epoch 3, Loss=0.2346325099468231, AUC-ROC Macro=0.7295902569837953, AUC-ROC Micro=0.8116648545401002
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.22728880517184735
Train: epoch: 4, loss = 0.2255084260366857
Train: epoch: 4, loss = 0.2273271224523584
Train: epoch: 4, loss = 0.22732385260052979
Train: epoch: 4, loss = 0.22733257769793272
Train: epoch: 4, loss = 0.22697309663519263
Train: epoch: 4, loss = 0.22627453324518035
Train:  Epoch 4, Loss=0.22557147805365976, AUC-ROC Macro=0.7624417330836135, AUC-ROC Micro=0.8325727566166994
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5274338386952877, AUC-ROC Macro=0.5835946609694357, AUC-ROC Micro=0.5947763055136851
Eval task: 2
Eval:  Epoch 4, Loss=0.23098786771297455, AUC-ROC Macro=0.7382920246619001, AUC-ROC Micro=0.8205142767124753
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.21909251846373082
Train: epoch: 5, loss = 0.2196380171738565
Train: epoch: 5, loss = 0.21989223655313253
Train: epoch: 5, loss = 0.22027004731819033
Train: epoch: 5, loss = 0.2210580658018589
Train: epoch: 5, loss = 0.2217908531303207
Train: epoch: 5, loss = 0.22192740175340858
Train:  Epoch 5, Loss=0.22217112929078964, AUC-ROC Macro=0.7770150270184101, AUC-ROC Micro=0.8394485254714226
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5239145879944166, AUC-ROC Macro=0.5814570643336332, AUC-ROC Micro=0.5981626161831753
Eval task: 2
Eval:  Epoch 5, Loss=0.22970658391714097, AUC-ROC Macro=0.739232582836395, AUC-ROC Micro=0.8238970406345839
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.21288825638592243
Train: epoch: 6, loss = 0.2173502841219306
Train: epoch: 6, loss = 0.21774503542731205
Train: epoch: 6, loss = 0.2169971651956439
Train: epoch: 6, loss = 0.21790301340818405
Train: epoch: 6, loss = 0.21878828514367343
Train: epoch: 6, loss = 0.21889684963971376
Train:  Epoch 6, Loss=0.21859293577307606, AUC-ROC Macro=0.7878757619069761, AUC-ROC Micro=0.8465497376418432
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5554065679510435, AUC-ROC Macro=0.5670898300650157, AUC-ROC Micro=0.5821479886753249
Eval task: 2
Eval:  Epoch 6, Loss=0.23098617196083068, AUC-ROC Macro=0.7362837172961142, AUC-ROC Micro=0.821671766547978
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5603491365909576, AUC-ROC Macro=0.5687519147505813, AUC-ROC Micro=0.5820466086697094
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.22705188542604446, AUC-ROC Macro=0.7530186535338862, AUC-ROC Micro=0.8269637410671405
{'0': {'precision': 0.31737493275954815, 'recall': 0.4510703363914373, 'f1-score': 0.3725923586990843, 'support': 1308}, '1': {'precision': 0.1416539050535988, 'recall': 0.4601990049751244, 'f1-score': 0.21662763466042156, 'support': 402}, '2': {'precision': 0.10256410256410256, 'recall': 0.0060790273556231, 'f1-score': 0.011477761836441894, 'support': 658}, '3': {'precision': 0.4418604651162791, 'recall': 0.13366834170854272, 'f1-score': 0.20524691358024694, 'support': 1990}, '4': {'precision': 0.2751937984496124, 'recall': 0.0880893300248139, 'f1-score': 0.13345864661654133, 'support': 806}, '5': {'precision': 0.15555555555555556, 'recall': 0.02699228791773779, 'f1-score': 0.04600219058050384, 'support': 778}, '6': {'precision': 0.3474320241691843, 'recall': 0.08832565284178187, 'f1-score': 0.14084507042253522, 'support': 1302}, '7': {'precision': 0.125, 'recall': 0.0023584905660377358, 'f1-score': 0.004629629629629629, 'support': 424}, '8': {'precision': 0.6521739130434783, 'recall': 0.01824817518248175, 'f1-score': 0.03550295857988165, 'support': 1644}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2031}, '10': {'precision': 0.2765957446808511, 'recall': 0.02268760907504363, 'f1-score': 0.04193548387096774, 'support': 573}, '11': {'precision': 0.037037037037037035, 'recall': 0.0008503401360544217, 'f1-score': 0.0016625103906899416, 'support': 1176}, '12': {'precision': 0.36363636363636365, 'recall': 0.0022598870056497176, 'f1-score': 0.004491858506457047, 'support': 1770}, '13': {'precision': 0.3383458646616541, 'recall': 0.03466872110939907, 'f1-score': 0.06289308176100629, 'support': 2596}, '14': {'precision': 0.11435832274459974, 'recall': 0.05531653349723417, 'f1-score': 0.07456503728251863, 'support': 1627}, '15': {'precision': 0.06701030927835051, 'recall': 0.026859504132231406, 'f1-score': 0.038348082595870206, 'support': 484}, '16': {'precision': 0.06779661016949153, 'recall': 0.025157232704402517, 'f1-score': 0.03669724770642201, 'support': 795}, '17': {'precision': 0.5, 'recall': 0.001838235294117647, 'f1-score': 0.003663003663003663, 'support': 544}, '18': {'precision': 0.2, 'recall': 0.002849002849002849, 'f1-score': 0.0056179775280898875, 'support': 351}, '19': {'precision': 0.75, 'recall': 0.022900763358778626, 'f1-score': 0.044444444444444446, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.24434098571199228, 'recall': 0.059985023450124145, 'f1-score': 0.09632301753053603, 'support': 25373}, 'macro avg': {'precision': 0.2109435579567883, 'recall': 0.058816739045019786, 'f1-score': 0.059228075694190245, 'support': 25373}, 'weighted avg': {'precision': 0.2315192941579872, 'recall': 0.059985023450124145, 'f1-score': 0.06933995286425, 'support': 25373}, 'samples avg': {'precision': 0.12638288225446428, 'recall': 0.045972026244027624, 'f1-score': 0.06128385243995279, 'support': 25373}}
{'0': {'precision': 0.6745283018867925, 'recall': 0.5190562613430127, 'f1-score': 0.5866666666666667, 'support': 551}, '1': {'precision': 0.5789473684210527, 'recall': 0.28637059724349156, 'f1-score': 0.3831967213114754, 'support': 653}, '2': {'precision': 0.4722222222222222, 'recall': 0.03990610328638498, 'f1-score': 0.07359307359307359, 'support': 426}, '3': {'precision': 0.5543478260869565, 'recall': 0.12469437652811736, 'f1-score': 0.2035928143712575, 'support': 409}, '4': {'precision': 0.4166666666666667, 'recall': 0.04081632653061224, 'f1-score': 0.07434944237918215, 'support': 245}, '5': {'precision': 0.5272727272727272, 'recall': 0.08100558659217877, 'f1-score': 0.14043583535108958, 'support': 358}, '6': {'precision': 0.6666666666666666, 'recall': 0.01639344262295082, 'f1-score': 0.032, 'support': 244}, '7': {'precision': 0.6692307692307692, 'recall': 0.29591836734693877, 'f1-score': 0.410377358490566, 'support': 294}, '8': {'precision': 0.6, 'recall': 0.011406844106463879, 'f1-score': 0.02238805970149254, 'support': 263}, '9': {'precision': 0.7837837837837838, 'recall': 0.10431654676258993, 'f1-score': 0.18412698412698414, 'support': 278}, '10': {'precision': 0.5, 'recall': 0.004807692307692308, 'f1-score': 0.009523809523809525, 'support': 208}, '11': {'precision': 0.5294117647058824, 'recall': 0.07228915662650602, 'f1-score': 0.127208480565371, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 1.0, 'recall': 0.015151515151515152, 'f1-score': 0.02985074626865672, 'support': 132}, '14': {'precision': 0.7142857142857143, 'recall': 0.13274336283185842, 'f1-score': 0.2238805970149254, 'support': 226}, '15': {'precision': 0.7157894736842105, 'recall': 0.6476190476190476, 'f1-score': 0.68, 'support': 105}, '16': {'precision': 0.6060606060606061, 'recall': 0.14705882352941177, 'f1-score': 0.23668639053254437, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.6283582089552239, 'recall': 0.15618623631979225, 'f1-score': 0.25018570791858563, 'support': 5391}, 'macro avg': {'precision': 0.400368555638962, 'recall': 0.10158216201715091, 'f1-score': 0.1367150791958838, 'support': 5391}, 'weighted avg': {'precision': 0.5361540096207748, 'recall': 0.15618623631979225, 'f1-score': 0.21033377415856475, 'support': 5391}, 'samples avg': {'precision': 0.24544270833333331, 'recall': 0.15463030133928574, 'f1-score': 0.1738534599081474, 'support': 5391}}