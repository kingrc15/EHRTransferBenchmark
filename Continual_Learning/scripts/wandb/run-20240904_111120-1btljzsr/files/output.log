
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4371806469559669
Train: epoch: 1, loss = 0.42485726937651636
Train: epoch: 1, loss = 0.4176006986200809
Train: epoch: 1, loss = 0.4136436389386654
Train: epoch: 1, loss = 0.41154243290424347
Train: epoch: 1, loss = 0.41014112057785196
Train: epoch: 1, loss = 0.40795407134507383
Train: epoch: 1, loss = 0.40622616794891653
Train: epoch: 1, loss = 0.4043319926576482
Train: epoch: 1, loss = 0.402129497051239
Train: epoch: 1, loss = 0.3997878723659299
Train: epoch: 1, loss = 0.39844702505196133
Train: epoch: 1, loss = 0.39691744130391343
Train: epoch: 1, loss = 0.395007897402559
Train: epoch: 1, loss = 0.3940948214630286
Train: epoch: 1, loss = 0.3929831625148654
Train: epoch: 1, loss = 0.3915467452739968
Train: epoch: 1, loss = 0.3903019403542082
Train:  Epoch 1, Loss=0.3900736593609182, AUC-ROC Macro=0.6647934299646824, AUC-ROC Micro=0.7528278191960698
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.36977370207508403, AUC-ROC Macro=0.7208240840380964, AUC-ROC Micro=0.7855095110492288
Eval task: 2
Eval:  Epoch 1, Loss=0.34017291367053987, AUC-ROC Macro=0.47518967510507565, AUC-ROC Micro=0.55957605300945
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3765077782422304
Train: epoch: 2, loss = 0.3716627763956785
Train: epoch: 2, loss = 0.3718901098271211
Train: epoch: 2, loss = 0.37389856718480585
Train: epoch: 2, loss = 0.3733910470157862
Train: epoch: 2, loss = 0.37197563665608563
Train: epoch: 2, loss = 0.3707787325339658
Train: epoch: 2, loss = 0.3697481616120786
Train: epoch: 2, loss = 0.3694629754126072
Train: epoch: 2, loss = 0.36957670268416404
Train: epoch: 2, loss = 0.3692229014906016
Train: epoch: 2, loss = 0.3686124873968462
Train: epoch: 2, loss = 0.36865528666629244
Train: epoch: 2, loss = 0.3677961570130927
Train: epoch: 2, loss = 0.36789367271463075
Train: epoch: 2, loss = 0.3676960003003478
Train: epoch: 2, loss = 0.36759252072257154
Train: epoch: 2, loss = 0.3670349427809318
Train:  Epoch 2, Loss=0.36708937260839675, AUC-ROC Macro=0.7281288827257316, AUC-ROC Micro=0.7933225537906718
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36151334767540294, AUC-ROC Macro=0.7397031239916213, AUC-ROC Micro=0.7982393247659068
Eval task: 2
Eval:  Epoch 2, Loss=0.3535138785839081, AUC-ROC Macro=0.4682459719031094, AUC-ROC Micro=0.5398806920140579
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3655348087102175
Train: epoch: 3, loss = 0.3591634402796626
Train: epoch: 3, loss = 0.3606096396843592
Train: epoch: 3, loss = 0.36065793052315714
Train: epoch: 3, loss = 0.36055591827630995
Train: epoch: 3, loss = 0.36144858176509537
Train: epoch: 3, loss = 0.36002822004258633
Train: epoch: 3, loss = 0.36074728224426506
Train: epoch: 3, loss = 0.36085764043860963
Train: epoch: 3, loss = 0.3606892482191324
Train: epoch: 3, loss = 0.360350014987317
Train: epoch: 3, loss = 0.3598184265010059
Train: epoch: 3, loss = 0.359402179809717
Train: epoch: 3, loss = 0.3592233826645783
Train: epoch: 3, loss = 0.35929295543332895
Train: epoch: 3, loss = 0.3587859536940232
Train: epoch: 3, loss = 0.35876169230131544
Train: epoch: 3, loss = 0.35885314208765823
Train:  Epoch 3, Loss=0.35895792831518714, AUC-ROC Macro=0.7462910526688425, AUC-ROC Micro=0.8057306733858339
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3554909850160281, AUC-ROC Macro=0.7511990318175692, AUC-ROC Micro=0.807525176083622
Eval task: 2
Eval:  Epoch 3, Loss=0.617006367444992, AUC-ROC Macro=0.4634261633729113, AUC-ROC Micro=0.513422900220505
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3566750281304121
Train: epoch: 4, loss = 0.35444846272468566
Train: epoch: 4, loss = 0.35271610451241336
Train: epoch: 4, loss = 0.3522596522793174
Train: epoch: 4, loss = 0.35202141442894935
Train: epoch: 4, loss = 0.3521033172185222
Train: epoch: 4, loss = 0.35244950193379604
Train: epoch: 4, loss = 0.3531082888226956
Train: epoch: 4, loss = 0.35256291915973026
Train: epoch: 4, loss = 0.3521337451264262
Train: epoch: 4, loss = 0.3525035484744744
Train: epoch: 4, loss = 0.3528826935651402
Train: epoch: 4, loss = 0.3527988268320377
Train: epoch: 4, loss = 0.3524688959387796
Train: epoch: 4, loss = 0.3527095478177071
Train: epoch: 4, loss = 0.352996223680675
Train: epoch: 4, loss = 0.3529323301551973
Train: epoch: 4, loss = 0.35304933690362506
Train:  Epoch 4, Loss=0.35331420412022846, AUC-ROC Macro=0.7585066195014564, AUC-ROC Micro=0.8141606053628462
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3544568804403146, AUC-ROC Macro=0.7589701344923186, AUC-ROC Micro=0.8131184614872068
Eval task: 2
Eval:  Epoch 4, Loss=0.37565518617630006, AUC-ROC Macro=0.45666660473163545, AUC-ROC Micro=0.5204345258063924
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3530335708707571
Train: epoch: 5, loss = 0.351048626229167
Train: epoch: 5, loss = 0.3493502686669429
Train: epoch: 5, loss = 0.3499666835926473
Train: epoch: 5, loss = 0.34985486944019795
Train: epoch: 5, loss = 0.34903046869983273
Train: epoch: 5, loss = 0.3489836983808449
Train: epoch: 5, loss = 0.3498394908662885
Train: epoch: 5, loss = 0.3504488699800438
Train: epoch: 5, loss = 0.3505590535774827
Train: epoch: 5, loss = 0.35057201443748043
Train: epoch: 5, loss = 0.350523864676555
Train: epoch: 5, loss = 0.35046509287105154
Train: epoch: 5, loss = 0.35009091767349415
Train: epoch: 5, loss = 0.35015762586394944
Train: epoch: 5, loss = 0.34988134941551835
Train: epoch: 5, loss = 0.34960757812156396
Train: epoch: 5, loss = 0.34958048397468194
Train:  Epoch 5, Loss=0.3495832157950116, AUC-ROC Macro=0.7657341582065048, AUC-ROC Micro=0.8193881938176617
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35186933974425, AUC-ROC Macro=0.7610073457190295, AUC-ROC Micro=0.8136217630025443
Eval task: 2
Eval:  Epoch 5, Loss=0.3720846712589264, AUC-ROC Macro=0.47055886889190474, AUC-ROC Micro=0.5341349497234369
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34092419818043707
Train: epoch: 6, loss = 0.3396028534322977
Train: epoch: 6, loss = 0.344080941999952
Train: epoch: 6, loss = 0.34510006913915275
Train: epoch: 6, loss = 0.345406699180603
Train: epoch: 6, loss = 0.3451580786332488
Train: epoch: 6, loss = 0.3448148360848427
Train: epoch: 6, loss = 0.34555389805696907
Train: epoch: 6, loss = 0.3459742779698637
Train: epoch: 6, loss = 0.3457210821211338
Train: epoch: 6, loss = 0.34608852628957143
Train: epoch: 6, loss = 0.34552985032399497
Train: epoch: 6, loss = 0.34534851264495114
Train: epoch: 6, loss = 0.3456078897682684
Train: epoch: 6, loss = 0.34584972233573597
Train: epoch: 6, loss = 0.34589317299891265
Train: epoch: 6, loss = 0.34651874640408686
Train: epoch: 6, loss = 0.34615087658994725
Train:  Epoch 6, Loss=0.34631826590472814, AUC-ROC Macro=0.7722976720357583, AUC-ROC Micro=0.8238189778725891
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3483724258840084, AUC-ROC Macro=0.7657571436052015, AUC-ROC Micro=0.8175380858643979
Eval task: 2
Eval:  Epoch 6, Loss=0.41039371490478516, AUC-ROC Macro=0.46691686154560685, AUC-ROC Micro=0.5281651152672472
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3511977655192216, AUC-ROC Macro=0.7649595875888816, AUC-ROC Micro=0.8165014666122994
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.40512276291847227, AUC-ROC Macro=0.46932666083324087, AUC-ROC Micro=0.5334529452024127
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3208391969650984
Train: epoch: 1, loss = 0.3136016020551324
Train: epoch: 1, loss = 0.30962124295532706
Train: epoch: 1, loss = 0.3054978874139488
Train: epoch: 1, loss = 0.30361099502444266
Train: epoch: 1, loss = 0.30124043056120475
Train: epoch: 1, loss = 0.299576291931527
Train:  Epoch 1, Loss=0.29784925961566455, AUC-ROC Macro=0.5977428977773824, AUC-ROC Micro=0.7403990788853678
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3441498267153899, AUC-ROC Macro=0.7550065820163664, AUC-ROC Micro=0.8090481506626755
Eval task: 2
Eval:  Epoch 1, Loss=0.29138372242450716, AUC-ROC Macro=0.659427230816701, AUC-ROC Micro=0.779873876936629
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.28800628550350665
Train: epoch: 2, loss = 0.2887458046153188
Train: epoch: 2, loss = 0.28752273018161456
Train: epoch: 2, loss = 0.2856508162990212
Train: epoch: 2, loss = 0.28456517311930657
Train: epoch: 2, loss = 0.2840072595452269
Train: epoch: 2, loss = 0.28350644193589686
Train:  Epoch 2, Loss=0.2832819136237704, AUC-ROC Macro=0.6798339205545697, AUC-ROC Micro=0.7921062953104566
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3471541553735733, AUC-ROC Macro=0.7497762112545857, AUC-ROC Micro=0.8064547706466426
Eval task: 2
Eval:  Epoch 2, Loss=0.26933514028787614, AUC-ROC Macro=0.6991943918211629, AUC-ROC Micro=0.7990360180151939
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2760291872918606
Train: epoch: 3, loss = 0.2764005093276501
Train: epoch: 3, loss = 0.27498075284063817
Train: epoch: 3, loss = 0.27594199830666183
Train: epoch: 3, loss = 0.27522031438350675
Train: epoch: 3, loss = 0.27451249384631715
Train: epoch: 3, loss = 0.2739944027896438
Train:  Epoch 3, Loss=0.27337887123324234, AUC-ROC Macro=0.7084134792176897, AUC-ROC Micro=0.8073629419751505
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3298024671773116, AUC-ROC Macro=0.7468014884714607, AUC-ROC Micro=0.8024150873179461
Eval task: 2
Eval:  Epoch 3, Loss=0.2677105590701103, AUC-ROC Macro=0.7104138518887575, AUC-ROC Micro=0.8084203717542779
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.26695630565285683
Train: epoch: 4, loss = 0.2664994437247515
Train: epoch: 4, loss = 0.2662644406656424
Train: epoch: 4, loss = 0.26537261409685015
Train: epoch: 4, loss = 0.2660557758361101
Train: epoch: 4, loss = 0.26539863801250857
Train: epoch: 4, loss = 0.2654052232844489
Train:  Epoch 4, Loss=0.26484264977935995, AUC-ROC Macro=0.729125425203665, AUC-ROC Micro=0.8171475006859206
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3344024841984113, AUC-ROC Macro=0.7394561861805176, AUC-ROC Micro=0.7953340159932667
Eval task: 2
Eval:  Epoch 4, Loss=0.2571392059326172, AUC-ROC Macro=0.7186466838783658, AUC-ROC Micro=0.8104303609492911
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.26498023882508276
Train: epoch: 5, loss = 0.2627966646105051
Train: epoch: 5, loss = 0.2632521960387627
Train: epoch: 5, loss = 0.26089027056470515
Train: epoch: 5, loss = 0.26001846764981745
Train: epoch: 5, loss = 0.25971369836479424
Train: epoch: 5, loss = 0.25909947713570936
Train:  Epoch 5, Loss=0.25880601314762364, AUC-ROC Macro=0.7440012647851861, AUC-ROC Micro=0.8234573838413501
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.32046370084087056, AUC-ROC Macro=0.7365174461278542, AUC-ROC Micro=0.7925354647096303
Eval task: 2
Eval:  Epoch 5, Loss=0.25563953816890717, AUC-ROC Macro=0.7127140880986618, AUC-ROC Micro=0.806712595938488
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2517886795848608
Train: epoch: 6, loss = 0.25259347800165416
Train: epoch: 6, loss = 0.25249677884082
Train: epoch: 6, loss = 0.2514844607375562
Train: epoch: 6, loss = 0.2505525526404381
Train: epoch: 6, loss = 0.25129406216243905
Train: epoch: 6, loss = 0.25125708157462734
Train:  Epoch 6, Loss=0.250963163646354, AUC-ROC Macro=0.7525392631309796, AUC-ROC Micro=0.8285155821993959
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.34859899431467056, AUC-ROC Macro=0.7298182799592144, AUC-ROC Micro=0.7841751100376249
Eval task: 2
Eval:  Epoch 6, Loss=0.24549293518066406, AUC-ROC Macro=0.723130247017489, AUC-ROC Micro=0.8113427475652923
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.39890049149592716, AUC-ROC Macro=0.7293199822922092, AUC-ROC Micro=0.782776351291844
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.23305019736289978, AUC-ROC Macro=0.7292975928214861, AUC-ROC Micro=0.8152620496954246
{'0': {'precision': 0.5130813953488372, 'recall': 0.2698776758409786, 'f1-score': 0.3537074148296594, 'support': 1308}, '1': {'precision': 0.6053639846743295, 'recall': 0.39303482587064675, 'f1-score': 0.4766214177978884, 'support': 402}, '2': {'precision': 0.40669856459330145, 'recall': 0.12917933130699089, 'f1-score': 0.19607843137254902, 'support': 658}, '3': {'precision': 0.5258264462809917, 'recall': 0.2557788944723618, 'f1-score': 0.3441514536849222, 'support': 1990}, '4': {'precision': 0.436426116838488, 'recall': 0.1575682382133995, 'f1-score': 0.23154056517775748, 'support': 806}, '5': {'precision': 0.36809815950920244, 'recall': 0.07712082262210797, 'f1-score': 0.12752391073326247, 'support': 778}, '6': {'precision': 0.46572934973637964, 'recall': 0.20353302611367127, 'f1-score': 0.28327097808658475, 'support': 1302}, '7': {'precision': 0.26666666666666666, 'recall': 0.02830188679245283, 'f1-score': 0.0511727078891258, 'support': 424}, '8': {'precision': 0.5022573363431151, 'recall': 0.2706812652068126, 'f1-score': 0.3517786561264822, 'support': 1644}, '9': {'precision': 0.6483271375464684, 'recall': 0.4293451501723289, 'f1-score': 0.5165876777251185, 'support': 2031}, '10': {'precision': 0.5787878787878787, 'recall': 0.3333333333333333, 'f1-score': 0.4230343300110741, 'support': 573}, '11': {'precision': 0.43023255813953487, 'recall': 0.31462585034013607, 'f1-score': 0.36345776031434185, 'support': 1176}, '12': {'precision': 0.5133843212237094, 'recall': 0.30338983050847457, 'f1-score': 0.3813920454545454, 'support': 1770}, '13': {'precision': 0.5320738137082601, 'recall': 0.4664869029275809, 'f1-score': 0.49712643678160917, 'support': 2596}, '14': {'precision': 0.5148387096774194, 'recall': 0.24523663183773817, 'f1-score': 0.33222314737718567, 'support': 1627}, '15': {'precision': 0.1864406779661017, 'recall': 0.022727272727272728, 'f1-score': 0.040515653775322284, 'support': 484}, '16': {'precision': 0.4090909090909091, 'recall': 0.15849056603773584, 'f1-score': 0.228467815049864, 'support': 795}, '17': {'precision': 0.35555555555555557, 'recall': 0.08823529411764706, 'f1-score': 0.14138438880706924, 'support': 544}, '18': {'precision': 0.3333333333333333, 'recall': 0.017094017094017096, 'f1-score': 0.032520325203252036, 'support': 351}, '19': {'precision': 0.7692307692307693, 'recall': 0.03816793893129771, 'f1-score': 0.07272727272727274, 'support': 262}, '20': {'precision': 0.17857142857142858, 'recall': 0.008880994671403197, 'f1-score': 0.01692047377326565, 'support': 563}, '21': {'precision': 0.46257197696737046, 'recall': 0.28793309438470727, 'f1-score': 0.3549337260677466, 'support': 837}, '22': {'precision': 0.6372340425531915, 'recall': 0.5515653775322283, 'f1-score': 0.5913129318854887, 'support': 1086}, '23': {'precision': 0.5321100917431193, 'recall': 0.2694541231126597, 'f1-score': 0.3577486507324595, 'support': 861}, '24': {'precision': 0.5020576131687243, 'recall': 0.24158415841584158, 'f1-score': 0.32620320855614976, 'support': 505}, 'micro avg': {'precision': 0.521434429285022, 'recall': 0.275647341662397, 'f1-score': 0.3606455937709483, 'support': 25373}, 'macro avg': {'precision': 0.46695955349020346, 'recall': 0.22246506010335299, 'f1-score': 0.2836960551975999, 'support': 25373}, 'weighted avg': {'precision': 0.4931450674400098, 'recall': 0.275647341662397, 'f1-score': 0.342021161312873, 'support': 25373}, 'samples avg': {'precision': 0.3810380356767076, 'recall': 0.24971361824173752, 'f1-score': 0.2754859440518412, 'support': 25373}}
{'0': {'precision': 0.6139240506329114, 'recall': 0.5281306715063521, 'f1-score': 0.5678048780487805, 'support': 551}, '1': {'precision': 0.5548780487804879, 'recall': 0.2787136294027565, 'f1-score': 0.3710499490316004, 'support': 653}, '2': {'precision': 0.391304347826087, 'recall': 0.02112676056338028, 'f1-score': 0.04008908685968819, 'support': 426}, '3': {'precision': 0.6666666666666666, 'recall': 0.10268948655256724, 'f1-score': 0.17796610169491525, 'support': 409}, '4': {'precision': 0.5333333333333333, 'recall': 0.0326530612244898, 'f1-score': 0.06153846153846154, 'support': 245}, '5': {'precision': 0.5833333333333334, 'recall': 0.03910614525139665, 'f1-score': 0.07329842931937172, 'support': 358}, '6': {'precision': 0.4, 'recall': 0.01639344262295082, 'f1-score': 0.031496062992125984, 'support': 244}, '7': {'precision': 0.6209150326797386, 'recall': 0.3231292517006803, 'f1-score': 0.42505592841163314, 'support': 294}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 263}, '9': {'precision': 0.2, 'recall': 0.0035971223021582736, 'f1-score': 0.00706713780918728, 'support': 278}, '10': {'precision': 1.0, 'recall': 0.004807692307692308, 'f1-score': 0.009569377990430623, 'support': 208}, '11': {'precision': 0.6666666666666666, 'recall': 0.008032128514056224, 'f1-score': 0.015873015873015872, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.5, 'recall': 0.022727272727272728, 'f1-score': 0.04347826086956522, 'support': 132}, '14': {'precision': 0.7441860465116279, 'recall': 0.1415929203539823, 'f1-score': 0.2379182156133829, 'support': 226}, '15': {'precision': 0.75, 'recall': 0.37142857142857144, 'f1-score': 0.4968152866242038, 'support': 105}, '16': {'precision': 0.5483870967741935, 'recall': 0.125, 'f1-score': 0.20359281437125748, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.5996758508914101, 'recall': 0.13726581339269153, 'f1-score': 0.22339622641509435, 'support': 5391}, 'macro avg': {'precision': 0.35094378492820183, 'recall': 0.08076512625833228, 'f1-score': 0.11050452028190481, 'support': 5391}, 'weighted avg': {'precision': 0.4779698660496631, 'recall': 0.13726581339269153, 'f1-score': 0.17923609443760005, 'support': 5391}, 'samples avg': {'precision': 0.21639973958333333, 'recall': 0.13422464037698412, 'f1-score': 0.15038763753607504, 'support': 5391}}