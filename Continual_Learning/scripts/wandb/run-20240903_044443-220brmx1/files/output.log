
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest_baseline
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4274000093340874
Train: epoch: 1, loss = 0.4224683179706335
Train: epoch: 1, loss = 0.4147988528509935
Train: epoch: 1, loss = 0.4094884158670902
Train: epoch: 1, loss = 0.40703929859399796
Train: epoch: 1, loss = 0.4045515109350284
Train: epoch: 1, loss = 0.40167865883026804
Train: epoch: 1, loss = 0.4002028013579547
Train: epoch: 1, loss = 0.3985743302686347
Train: epoch: 1, loss = 0.3971375552639365
Train: epoch: 1, loss = 0.396112946075472
Train: epoch: 1, loss = 0.39558201423535744
Train: epoch: 1, loss = 0.394077374533965
Train: epoch: 1, loss = 0.39238566996795793
Train: epoch: 1, loss = 0.39162863372762996
Train: epoch: 1, loss = 0.3905530121177435
Train: epoch: 1, loss = 0.3898279429621556
Train: epoch: 1, loss = 0.38853844281699923
Train:  Epoch 1, Loss=0.38804637460219554, AUC-ROC Macro=0.6709909685075136, AUC-ROC Micro=0.7568916689305447
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.371976883461078, AUC-ROC Macro=0.7197382154499388, AUC-ROC Micro=0.7833807558061032
Eval task: 2
Eval:  Epoch 1, Loss=0.3066156953573227, AUC-ROC Macro=0.4901465205305143, AUC-ROC Micro=0.5654781181935487
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3757476795464754
Train: epoch: 2, loss = 0.3727639380469918
Train: epoch: 2, loss = 0.371142255961895
Train: epoch: 2, loss = 0.36968592382967475
Train: epoch: 2, loss = 0.37059992396831515
Train: epoch: 2, loss = 0.36976667152096826
Train: epoch: 2, loss = 0.36991119791354454
Train: epoch: 2, loss = 0.3694914795923978
Train: epoch: 2, loss = 0.3691534142527315
Train: epoch: 2, loss = 0.36859001382440326
Train: epoch: 2, loss = 0.3682339965281161
Train: epoch: 2, loss = 0.3684489181513588
Train: epoch: 2, loss = 0.368307873956286
Train: epoch: 2, loss = 0.3685235017857381
Train: epoch: 2, loss = 0.368159860710303
Train: epoch: 2, loss = 0.3678720043040812
Train: epoch: 2, loss = 0.3675291445851326
Train: epoch: 2, loss = 0.36727057914767003
Train:  Epoch 2, Loss=0.3672336689305102, AUC-ROC Macro=0.727330549693918, AUC-ROC Micro=0.7931466312732574
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36140477905670804, AUC-ROC Macro=0.740025905978799, AUC-ROC Micro=0.7985044565951854
Eval task: 2
Eval:  Epoch 2, Loss=0.33006200194358826, AUC-ROC Macro=0.48603621337267044, AUC-ROC Micro=0.5739474821250865
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3557015443593264
Train: epoch: 3, loss = 0.3573583310842514
Train: epoch: 3, loss = 0.35876087496678033
Train: epoch: 3, loss = 0.36108787020668387
Train: epoch: 3, loss = 0.3617453646510839
Train: epoch: 3, loss = 0.361564778846999
Train: epoch: 3, loss = 0.36133128640907153
Train: epoch: 3, loss = 0.3609145230427384
Train: epoch: 3, loss = 0.35983006527026495
Train: epoch: 3, loss = 0.35930832605063917
Train: epoch: 3, loss = 0.36030274616046387
Train: epoch: 3, loss = 0.35992590674509606
Train: epoch: 3, loss = 0.3598853017619023
Train: epoch: 3, loss = 0.3597823163388031
Train: epoch: 3, loss = 0.35990783856312436
Train: epoch: 3, loss = 0.3600499411020428
Train: epoch: 3, loss = 0.35936392390990957
Train: epoch: 3, loss = 0.35918384294543
Train:  Epoch 3, Loss=0.35909259864611504, AUC-ROC Macro=0.7464724383889911, AUC-ROC Micro=0.8057082278536293
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3569677546620369, AUC-ROC Macro=0.7492214999822069, AUC-ROC Micro=0.8054607213671809
Eval task: 2
Eval:  Epoch 3, Loss=0.3363080210983753, AUC-ROC Macro=0.4969907983719317, AUC-ROC Micro=0.5710982160459321
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.35977115541696547
Train: epoch: 4, loss = 0.3582209500297904
Train: epoch: 4, loss = 0.35886964994172255
Train: epoch: 4, loss = 0.35734051959589125
Train: epoch: 4, loss = 0.35686954429745676
Train: epoch: 4, loss = 0.3566988256449501
Train: epoch: 4, loss = 0.35622591757348604
Train: epoch: 4, loss = 0.3563739262335002
Train: epoch: 4, loss = 0.35589747541480593
Train: epoch: 4, loss = 0.35549244218319653
Train: epoch: 4, loss = 0.3543449924683029
Train: epoch: 4, loss = 0.35368936295931536
Train: epoch: 4, loss = 0.35425005790705866
Train: epoch: 4, loss = 0.3549087204677718
Train: epoch: 4, loss = 0.35440273824334145
Train: epoch: 4, loss = 0.35434685989283027
Train: epoch: 4, loss = 0.3540668371144463
Train: epoch: 4, loss = 0.3540232781031066
Train:  Epoch 4, Loss=0.3539618185809535, AUC-ROC Macro=0.7572367088269032, AUC-ROC Micro=0.8132619654979633
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3545374758541584, AUC-ROC Macro=0.7563225800135879, AUC-ROC Micro=0.8109997007834805
Eval task: 2
Eval:  Epoch 4, Loss=0.3245561197400093, AUC-ROC Macro=0.4741918516649834, AUC-ROC Micro=0.5539517797757342
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3467145162820816
Train: epoch: 5, loss = 0.3487360948696733
Train: epoch: 5, loss = 0.34974010626475016
Train: epoch: 5, loss = 0.3506545032188296
Train: epoch: 5, loss = 0.35093790605664255
Train: epoch: 5, loss = 0.3510361425081889
Train: epoch: 5, loss = 0.350255203257714
Train: epoch: 5, loss = 0.3504317452106625
Train: epoch: 5, loss = 0.350345446103149
Train: epoch: 5, loss = 0.3503569681942463
Train: epoch: 5, loss = 0.35032369768755
Train: epoch: 5, loss = 0.35019885569189985
Train: epoch: 5, loss = 0.3498388009575697
Train: epoch: 5, loss = 0.3498925892795835
Train: epoch: 5, loss = 0.34998310120403764
Train: epoch: 5, loss = 0.35004547238815575
Train: epoch: 5, loss = 0.34969321180354146
Train: epoch: 5, loss = 0.3498385705384943
Train:  Epoch 5, Loss=0.3497916155758067, AUC-ROC Macro=0.765820748371788, AUC-ROC Micro=0.8192101437051299
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35153136029839516, AUC-ROC Macro=0.7617997504718892, AUC-ROC Micro=0.8141335027609478
Eval task: 2
Eval:  Epoch 5, Loss=0.33952436596155167, AUC-ROC Macro=0.48735109814305766, AUC-ROC Micro=0.5672221186767686
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3410535684973002
Train: epoch: 6, loss = 0.34142866637557745
Train: epoch: 6, loss = 0.3434476413577795
Train: epoch: 6, loss = 0.34601619496941566
Train: epoch: 6, loss = 0.345376337453723
Train: epoch: 6, loss = 0.3454333599532644
Train: epoch: 6, loss = 0.34636222662670274
Train: epoch: 6, loss = 0.345717952363193
Train: epoch: 6, loss = 0.3455550264649921
Train: epoch: 6, loss = 0.3462501033693552
Train: epoch: 6, loss = 0.3463286998867989
Train: epoch: 6, loss = 0.3465267539645235
Train: epoch: 6, loss = 0.3460172677670534
Train: epoch: 6, loss = 0.3462467650058014
Train: epoch: 6, loss = 0.3462194327265024
Train: epoch: 6, loss = 0.3462508907821029
Train: epoch: 6, loss = 0.34641071987940986
Train: epoch: 6, loss = 0.3462932031808628
Train:  Epoch 6, Loss=0.34617557907308266, AUC-ROC Macro=0.7730021839166021, AUC-ROC Micro=0.8240263904650283
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.350405253469944, AUC-ROC Macro=0.7650504610197211, AUC-ROC Micro=0.8157733339907591
Eval task: 2
Eval:  Epoch 6, Loss=0.37739526107907295, AUC-ROC Macro=0.48283604026306665, AUC-ROC Micro=0.5632870564308974
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35340390478571254, AUC-ROC Macro=0.7641129890002044, AUC-ROC Micro=0.814684935082712
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.37368130311369896, AUC-ROC Macro=0.48880930059797956, AUC-ROC Micro=0.5610739409130031
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2632140503823757
Train: epoch: 1, loss = 0.2493056243285537
Train: epoch: 1, loss = 0.24248966348667939
Train: epoch: 1, loss = 0.2380019560456276
Train: epoch: 1, loss = 0.23505167300999164
Train: epoch: 1, loss = 0.23206324201077222
Train:  Epoch 1, Loss=0.23016704143029856, AUC-ROC Macro=0.6221708743494699, AUC-ROC Micro=0.7677181934421354
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4989728902777036, AUC-ROC Macro=0.666258498736422, AUC-ROC Micro=0.6524601136904307
Eval task: 2
Eval:  Epoch 1, Loss=0.21607805043458939, AUC-ROC Macro=0.7045806078005497, AUC-ROC Micro=0.8075419064430407
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.218135858848691
Train: epoch: 2, loss = 0.21692465798929333
Train: epoch: 2, loss = 0.21558930506308874
Train: epoch: 2, loss = 0.21483604308217763
Train: epoch: 2, loss = 0.21379821515083314
Train: epoch: 2, loss = 0.21325519006078442
Train:  Epoch 2, Loss=0.2131947398843298, AUC-ROC Macro=0.7150455891188875, AUC-ROC Micro=0.8148819938939631
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.52100903292497, AUC-ROC Macro=0.6493061257752026, AUC-ROC Micro=0.6442469570834156
Eval task: 2
Eval:  Epoch 2, Loss=0.2126620952039957, AUC-ROC Macro=0.7221779633333818, AUC-ROC Micro=0.8172472393029024
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2109211416170001
Train: epoch: 3, loss = 0.20777493776753544
Train: epoch: 3, loss = 0.2074156300847729
Train: epoch: 3, loss = 0.20715849289670588
Train: epoch: 3, loss = 0.20762634263187646
Train: epoch: 3, loss = 0.20773383460318048
Train:  Epoch 3, Loss=0.20793616403348425, AUC-ROC Macro=0.7440847695884439, AUC-ROC Micro=0.8277636218578897
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5269030369818211, AUC-ROC Macro=0.6293522508083149, AUC-ROC Micro=0.6298787964083745
Eval task: 2
Eval:  Epoch 3, Loss=0.21016243286430836, AUC-ROC Macro=0.7307797728402834, AUC-ROC Micro=0.8229914117637497
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.20835875809192658
Train: epoch: 4, loss = 0.208071355111897
Train: epoch: 4, loss = 0.20518205538392068
Train: epoch: 4, loss = 0.20488265103660525
Train: epoch: 4, loss = 0.20521787560731172
Train: epoch: 4, loss = 0.2041385612078011
Train:  Epoch 4, Loss=0.20389076272163625, AUC-ROC Macro=0.7617303359241911, AUC-ROC Micro=0.8372632597589731
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5576164697607359, AUC-ROC Macro=0.6146792652540646, AUC-ROC Micro=0.6136017366074047
Eval task: 2
Eval:  Epoch 4, Loss=0.20990276522934437, AUC-ROC Macro=0.7350308245836297, AUC-ROC Micro=0.8240820606038888
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.19930813193321228
Train: epoch: 5, loss = 0.20167272007092835
Train: epoch: 5, loss = 0.20103431922694048
Train: epoch: 5, loss = 0.2014128835685551
Train: epoch: 5, loss = 0.20148171092569828
Train: epoch: 5, loss = 0.20156281081959604
Train:  Epoch 5, Loss=0.20064320902861849, AUC-ROC Macro=0.775499634151295, AUC-ROC Micro=0.8441478896314039
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5501391775906086, AUC-ROC Macro=0.6135274227370486, AUC-ROC Micro=0.6201603881560641
Eval task: 2
Eval:  Epoch 5, Loss=0.20963197015225887, AUC-ROC Macro=0.7358075480347989, AUC-ROC Micro=0.8250451414700862
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.1976485078036785
Train: epoch: 6, loss = 0.1978385004028678
Train: epoch: 6, loss = 0.1977412024512887
Train: epoch: 6, loss = 0.1973232022114098
Train: epoch: 6, loss = 0.1970651613175869
Train: epoch: 6, loss = 0.1969135559660693
Train:  Epoch 6, Loss=0.19753955737057247, AUC-ROC Macro=0.7879827160981834, AUC-ROC Micro=0.8507664865882083
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5567342216769854, AUC-ROC Macro=0.6013423673611151, AUC-ROC Micro=0.6065452946889314
Eval task: 2
Eval:  Epoch 6, Loss=0.2080162726342678, AUC-ROC Macro=0.7352449667465575, AUC-ROC Micro=0.8275330469996832
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5578863049546877, AUC-ROC Macro=0.6036357090910157, AUC-ROC Micro=0.6095612458277752
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.21017958410084248, AUC-ROC Macro=0.732887827763254, AUC-ROC Micro=0.8254486162879106
{'0': {'precision': 0.3468038207200588, 'recall': 0.36085626911314983, 'f1-score': 0.353690520794305, 'support': 1308}, '1': {'precision': 0.47368421052631576, 'recall': 0.022388059701492536, 'f1-score': 0.04275534441805225, 'support': 402}, '2': {'precision': 0.16964285714285715, 'recall': 0.028875379939209727, 'f1-score': 0.04935064935064935, 'support': 658}, '3': {'precision': 0.5555555555555556, 'recall': 0.007537688442211055, 'f1-score': 0.014873574615765987, 'support': 1990}, '4': {'precision': 0.16666666666666666, 'recall': 0.07444168734491315, 'f1-score': 0.10291595197255574, 'support': 806}, '5': {'precision': 0.11666666666666667, 'recall': 0.008997429305912597, 'f1-score': 0.016706443914081145, 'support': 778}, '6': {'precision': 0.4583333333333333, 'recall': 0.09293394777265745, 'f1-score': 0.1545338441890166, 'support': 1302}, '7': {'precision': 0.0776255707762557, 'recall': 0.04009433962264151, 'f1-score': 0.052877138413685854, 'support': 424}, '8': {'precision': 0.75, 'recall': 0.005474452554744526, 'f1-score': 0.010869565217391304, 'support': 1644}, '9': {'precision': 0.808695652173913, 'recall': 0.04579025110782865, 'f1-score': 0.08667287977632804, 'support': 2031}, '10': {'precision': 0.15283842794759825, 'recall': 0.06108202443280977, 'f1-score': 0.08728179551122195, 'support': 573}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1176}, '12': {'precision': 0.4074074074074074, 'recall': 0.012429378531073447, 'f1-score': 0.024122807017543862, 'support': 1770}, '13': {'precision': 0.31896551724137934, 'recall': 0.028505392912172575, 'f1-score': 0.05233380480905234, 'support': 2596}, '14': {'precision': 0.6, 'recall': 0.0018438844499078057, 'f1-score': 0.0036764705882352945, 'support': 1627}, '15': {'precision': 0.07936507936507936, 'recall': 0.010330578512396695, 'f1-score': 0.018281535648994516, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 0.6428571428571429, 'recall': 0.016544117647058824, 'f1-score': 0.03225806451612903, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.3125, 'recall': 0.019083969465648856, 'f1-score': 0.03597122302158274, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.3074739829706717, 'recall': 0.038426674023568363, 'f1-score': 0.06831558295964127, 'support': 25373}, 'macro avg': {'precision': 0.2575043163352092, 'recall': 0.033488354034233156, 'f1-score': 0.045566864550983646, 'support': 25373}, 'weighted avg': {'precision': 0.34187400443282273, 'recall': 0.038426674023568363, 'f1-score': 0.052249640952809845, 'support': 25373}, 'samples avg': {'precision': 0.093894611338459, 'recall': 0.026652219935480503, 'f1-score': 0.038563312527321876, 'support': 25373}}
{'0': {'precision': 0.632258064516129, 'recall': 0.23444976076555024, 'f1-score': 0.3420593368237347, 'support': 418}, '1': {'precision': 0.5675675675675675, 'recall': 0.09722222222222222, 'f1-score': 0.16600790513833993, 'support': 216}, '2': {'precision': 0.4375, 'recall': 0.024305555555555556, 'f1-score': 0.046052631578947366, 'support': 288}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 252}, '4': {'precision': 0.4090909090909091, 'recall': 0.0625, 'f1-score': 0.10843373493975904, 'support': 288}, '5': {'precision': 0.625, 'recall': 0.03717472118959108, 'f1-score': 0.07017543859649124, 'support': 269}, '6': {'precision': 0.38461538461538464, 'recall': 0.0176678445229682, 'f1-score': 0.033783783783783786, 'support': 283}, '7': {'precision': 0.8389830508474576, 'recall': 0.38823529411764707, 'f1-score': 0.5308310991957105, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.5806451612903226, 'recall': 0.07627118644067797, 'f1-score': 0.1348314606741573, 'support': 236}, '10': {'precision': 0.7142857142857143, 'recall': 0.0273224043715847, 'f1-score': 0.05263157894736842, 'support': 183}, '11': {'precision': 0.8, 'recall': 0.03827751196172249, 'f1-score': 0.0730593607305936, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.5, 'recall': 0.06306306306306306, 'f1-score': 0.11199999999999999, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.8169014084507042, 'recall': 0.6444444444444445, 'f1-score': 0.7204968944099378, 'support': 90}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 1.0, 'recall': 0.016666666666666666, 'f1-score': 0.03278688524590164, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.6586270871985158, 'recall': 0.09339647461194422, 'f1-score': 0.16359447004608296, 'support': 3801}, 'macro avg': {'precision': 0.3322738904265675, 'recall': 0.06910402701286773, 'f1-score': 0.096926004402589, 'support': 3801}, 'weighted avg': {'precision': 0.4592412916948538, 'recall': 0.09339647461194422, 'f1-score': 0.13762053712669697, 'support': 3801}, 'samples avg': {'precision': 0.1603515625, 'recall': 0.11356084914434524, 'f1-score': 0.12540496341765872, 'support': 3801}}