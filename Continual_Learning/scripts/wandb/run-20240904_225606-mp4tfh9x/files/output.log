
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4329123179614544
Train: epoch: 1, loss = 0.423874052837491
Train: epoch: 1, loss = 0.41813659007350606
Train: epoch: 1, loss = 0.4142604761198163
Train: epoch: 1, loss = 0.4116510075926781
Train: epoch: 1, loss = 0.41035176686942576
Train: epoch: 1, loss = 0.40826844570892196
Train: epoch: 1, loss = 0.40602311011403797
Train: epoch: 1, loss = 0.4037952939338154
Train: epoch: 1, loss = 0.4019234162569046
Train: epoch: 1, loss = 0.3996745411103422
Train: epoch: 1, loss = 0.39841561395674946
Train: epoch: 1, loss = 0.39644445311564663
Train: epoch: 1, loss = 0.3950337257821645
Train: epoch: 1, loss = 0.3936972789466381
Train: epoch: 1, loss = 0.3930505708465353
Train: epoch: 1, loss = 0.3921785382006098
Train: epoch: 1, loss = 0.39069056934780544
Train:  Epoch 1, Loss=0.39037442197758926, AUC-ROC Macro=0.6638486311800637, AUC-ROC Micro=0.7523621322568113
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3694907786945502, AUC-ROC Macro=0.7193998127384507, AUC-ROC Micro=0.7857083906947513
Eval task: 2
Eval:  Epoch 1, Loss=0.32384921610355377, AUC-ROC Macro=0.49056512364080207, AUC-ROC Micro=0.5618022362562346
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37479271240532397
Train: epoch: 2, loss = 0.37706583324819803
Train: epoch: 2, loss = 0.37549315022925533
Train: epoch: 2, loss = 0.3738863293081522
Train: epoch: 2, loss = 0.3718926407247782
Train: epoch: 2, loss = 0.3718225134909153
Train: epoch: 2, loss = 0.37156223564275676
Train: epoch: 2, loss = 0.3714202261902392
Train: epoch: 2, loss = 0.36989775156809224
Train: epoch: 2, loss = 0.3695798663571477
Train: epoch: 2, loss = 0.36956092177466915
Train: epoch: 2, loss = 0.36975039311374225
Train: epoch: 2, loss = 0.36929936218720216
Train: epoch: 2, loss = 0.36911522050521206
Train: epoch: 2, loss = 0.3688614880889654
Train: epoch: 2, loss = 0.3689140297705308
Train: epoch: 2, loss = 0.36889023456065095
Train: epoch: 2, loss = 0.3685144351795316
Train:  Epoch 2, Loss=0.36855521005239245, AUC-ROC Macro=0.7236324141972132, AUC-ROC Micro=0.7909692037596723
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36107762654622394, AUC-ROC Macro=0.7391030582772654, AUC-ROC Micro=0.7988202273516476
Eval task: 2
Eval:  Epoch 2, Loss=0.3274845816195011, AUC-ROC Macro=0.507190042619319, AUC-ROC Micro=0.5747987669051968
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36283964484930037
Train: epoch: 3, loss = 0.3631557536497712
Train: epoch: 3, loss = 0.3647417738785346
Train: epoch: 3, loss = 0.362831466961652
Train: epoch: 3, loss = 0.3623276774287224
Train: epoch: 3, loss = 0.3618110586330295
Train: epoch: 3, loss = 0.36157073181654725
Train: epoch: 3, loss = 0.3615480001363903
Train: epoch: 3, loss = 0.3610276985251241
Train: epoch: 3, loss = 0.36070952221006153
Train: epoch: 3, loss = 0.36073054390874776
Train: epoch: 3, loss = 0.3601293429546058
Train: epoch: 3, loss = 0.3603404949146968
Train: epoch: 3, loss = 0.3601489386281797
Train: epoch: 3, loss = 0.3598072548409303
Train: epoch: 3, loss = 0.3596340404683724
Train: epoch: 3, loss = 0.3597567173268865
Train: epoch: 3, loss = 0.3599560838234093
Train:  Epoch 3, Loss=0.36003655744210267, AUC-ROC Macro=0.7441028531938061, AUC-ROC Micro=0.8043630117053037
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35613270103931427, AUC-ROC Macro=0.7488078081019549, AUC-ROC Micro=0.8065143114770903
Eval task: 2
Eval:  Epoch 3, Loss=0.36182811483740807, AUC-ROC Macro=0.4914381298386472, AUC-ROC Micro=0.5592832400535759
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3527942747622728
Train: epoch: 4, loss = 0.3552984079346061
Train: epoch: 4, loss = 0.35552743208905063
Train: epoch: 4, loss = 0.35603195168077945
Train: epoch: 4, loss = 0.35511606669425966
Train: epoch: 4, loss = 0.35455940863738455
Train: epoch: 4, loss = 0.3546226202696562
Train: epoch: 4, loss = 0.35500043177977203
Train: epoch: 4, loss = 0.35462959953480294
Train: epoch: 4, loss = 0.3549501399919391
Train: epoch: 4, loss = 0.3550353657183322
Train: epoch: 4, loss = 0.35377142058685423
Train: epoch: 4, loss = 0.35382298266085294
Train: epoch: 4, loss = 0.35406792508172136
Train: epoch: 4, loss = 0.3542816531807184
Train: epoch: 4, loss = 0.3544300255132839
Train: epoch: 4, loss = 0.35425541126991017
Train: epoch: 4, loss = 0.35437555495649575
Train:  Epoch 4, Loss=0.3543512191813216, AUC-ROC Macro=0.7566092437884322, AUC-ROC Micro=0.8128522205879982
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35450586304068565, AUC-ROC Macro=0.755826109813448, AUC-ROC Micro=0.8101487655717488
Eval task: 2
Eval:  Epoch 4, Loss=0.339239951223135, AUC-ROC Macro=0.4828420751665896, AUC-ROC Micro=0.5626564242496084
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.34414290331304076
Train: epoch: 5, loss = 0.34692643221467734
Train: epoch: 5, loss = 0.34680590979754927
Train: epoch: 5, loss = 0.34946193024516103
Train: epoch: 5, loss = 0.348523969322443
Train: epoch: 5, loss = 0.34841503214091063
Train: epoch: 5, loss = 0.3484595426917076
Train: epoch: 5, loss = 0.3492202867101878
Train: epoch: 5, loss = 0.3489365805023246
Train: epoch: 5, loss = 0.3490979051738977
Train: epoch: 5, loss = 0.34927086765793236
Train: epoch: 5, loss = 0.3495165837183595
Train: epoch: 5, loss = 0.3493451408927257
Train: epoch: 5, loss = 0.34926433678716423
Train: epoch: 5, loss = 0.34961123832066854
Train: epoch: 5, loss = 0.34975684612989427
Train: epoch: 5, loss = 0.3499693347338368
Train: epoch: 5, loss = 0.35014046834160883
Train:  Epoch 5, Loss=0.35022025915292593, AUC-ROC Macro=0.7647463427314753, AUC-ROC Micro=0.8184981255394211
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35158638159434, AUC-ROC Macro=0.7598546500911629, AUC-ROC Micro=0.8133845173771349
Eval task: 2
Eval:  Epoch 5, Loss=0.4000408574938774, AUC-ROC Macro=0.4858350723054775, AUC-ROC Micro=0.564061179508199
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3428259834647179
Train: epoch: 6, loss = 0.34378885477781296
Train: epoch: 6, loss = 0.3437350508322318
Train: epoch: 6, loss = 0.343372287042439
Train: epoch: 6, loss = 0.3445475841611624
Train: epoch: 6, loss = 0.34507050514221194
Train: epoch: 6, loss = 0.34577555830989565
Train: epoch: 6, loss = 0.3454257714189589
Train: epoch: 6, loss = 0.3458107826858759
Train: epoch: 6, loss = 0.3463930248245597
Train: epoch: 6, loss = 0.34682373385537757
Train: epoch: 6, loss = 0.34704187080884974
Train: epoch: 6, loss = 0.34665116721620925
Train: epoch: 6, loss = 0.3470282854512334
Train: epoch: 6, loss = 0.3469486797899008
Train: epoch: 6, loss = 0.3470822781417519
Train: epoch: 6, loss = 0.3467595272248282
Train: epoch: 6, loss = 0.34698021157334247
Train:  Epoch 6, Loss=0.34707807241545785, AUC-ROC Macro=0.7714936541174129, AUC-ROC Micro=0.8229154643831994
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3499102480709553, AUC-ROC Macro=0.7643938724737583, AUC-ROC Micro=0.8167763731866529
Eval task: 2
Eval:  Epoch 6, Loss=0.5976016446948051, AUC-ROC Macro=0.4834694618823303, AUC-ROC Micro=0.5256050851631879
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3524905554950237, AUC-ROC Macro=0.7647408945037825, AUC-ROC Micro=0.8157715084686621
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.597252644598484, AUC-ROC Macro=0.4912337419795674, AUC-ROC Micro=0.5266301879326911
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.27603187516331673
Train: epoch: 1, loss = 0.2576004411652684
Train: epoch: 1, loss = 0.24713136638204256
Train: epoch: 1, loss = 0.24138480096124112
Train: epoch: 1, loss = 0.23711836854368448
Train: epoch: 1, loss = 0.2340286728553474
Train:  Epoch 1, Loss=0.23224222606010372, AUC-ROC Macro=0.6277208597590533, AUC-ROC Micro=0.7644338715203562
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.48588644216458005, AUC-ROC Macro=0.6677108827623937, AUC-ROC Micro=0.6499101126794278
Eval task: 2
Eval:  Epoch 1, Loss=0.2162885945290327, AUC-ROC Macro=0.703310830582716, AUC-ROC Micro=0.8091037316924364
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2176419059932232
Train: epoch: 2, loss = 0.21730926096439362
Train: epoch: 2, loss = 0.21584354743361472
Train: epoch: 2, loss = 0.21572755752131342
Train: epoch: 2, loss = 0.21397053617984058
Train: epoch: 2, loss = 0.2135348028751711
Train:  Epoch 2, Loss=0.21288743711556618, AUC-ROC Macro=0.716572185662869, AUC-ROC Micro=0.8160801560380393
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.5249194192389647, AUC-ROC Macro=0.6357094310232079, AUC-ROC Micro=0.6273738741276014
Eval task: 2
Eval:  Epoch 2, Loss=0.21287819929420948, AUC-ROC Macro=0.7195581419364818, AUC-ROC Micro=0.8184891600981093
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.20705712724477052
Train: epoch: 3, loss = 0.2054577556811273
Train: epoch: 3, loss = 0.20729431471476953
Train: epoch: 3, loss = 0.20709746174514293
Train: epoch: 3, loss = 0.20704985954612493
Train: epoch: 3, loss = 0.2074459421696762
Train:  Epoch 3, Loss=0.20778031973760344, AUC-ROC Macro=0.7432166400595144, AUC-ROC Micro=0.8286325313114644
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5260502124826113, AUC-ROC Macro=0.6237547568932945, AUC-ROC Micro=0.6266173767345369
Eval task: 2
Eval:  Epoch 3, Loss=0.2098032422363758, AUC-ROC Macro=0.7236852836767733, AUC-ROC Micro=0.8238039366889403
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.20072789877653122
Train: epoch: 4, loss = 0.2021291720494628
Train: epoch: 4, loss = 0.20337628157188495
Train: epoch: 4, loss = 0.20389092539437115
Train: epoch: 4, loss = 0.2040325559005141
Train: epoch: 4, loss = 0.2046787731225292
Train:  Epoch 4, Loss=0.20425056975415687, AUC-ROC Macro=0.7604563006230197, AUC-ROC Micro=0.8365879222895186
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5450314246118069, AUC-ROC Macro=0.6078174839354884, AUC-ROC Micro=0.6132494203621184
Eval task: 2
Eval:  Epoch 4, Loss=0.2088365387171507, AUC-ROC Macro=0.726447792012001, AUC-ROC Micro=0.826062107988245
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.20057623397558927
Train: epoch: 5, loss = 0.20014334248378873
Train: epoch: 5, loss = 0.2010657828177015
Train: epoch: 5, loss = 0.20218272732570766
Train: epoch: 5, loss = 0.2014156991839409
Train: epoch: 5, loss = 0.2012476289831102
Train:  Epoch 5, Loss=0.201111897737033, AUC-ROC Macro=0.7735944432346166, AUC-ROC Micro=0.8433856494614257
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5578415766358376, AUC-ROC Macro=0.6052648166818433, AUC-ROC Micro=0.6062860949782121
Eval task: 2
Eval:  Epoch 5, Loss=0.20922191254794598, AUC-ROC Macro=0.7303388998425687, AUC-ROC Micro=0.8260257199299028
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.19705255396664142
Train: epoch: 6, loss = 0.1985192140005529
Train: epoch: 6, loss = 0.1987823174521327
Train: epoch: 6, loss = 0.1982836411241442
Train: epoch: 6, loss = 0.19832695401459932
Train: epoch: 6, loss = 0.19831749374667804
Train:  Epoch 6, Loss=0.19843940171583785, AUC-ROC Macro=0.7860496165447916, AUC-ROC Micro=0.849504674567267
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5624021291732788, AUC-ROC Macro=0.5940651337841861, AUC-ROC Micro=0.5981897090267254
Eval task: 2
Eval:  Epoch 6, Loss=0.2097050528973341, AUC-ROC Macro=0.7313780747938367, AUC-ROC Micro=0.8259690261602953
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5679826562603315, AUC-ROC Macro=0.5930307239909851, AUC-ROC Micro=0.5979068710877136
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.21132158115506172, AUC-ROC Macro=0.7309349225787911, AUC-ROC Micro=0.8232586733572078
{'0': {'precision': 0.30334051724137934, 'recall': 0.4304281345565749, 'f1-score': 0.35587863463969666, 'support': 1308}, '1': {'precision': 0.2535211267605634, 'recall': 0.04477611940298507, 'f1-score': 0.07610993657505284, 'support': 402}, '2': {'precision': 0.25, 'recall': 0.001519756838905775, 'f1-score': 0.0030211480362537764, 'support': 658}, '3': {'precision': 0.4657534246575342, 'recall': 0.017085427135678392, 'f1-score': 0.03296170625302957, 'support': 1990}, '4': {'precision': 0.2236024844720497, 'recall': 0.08933002481389578, 'f1-score': 0.12765957446808512, 'support': 806}, '5': {'precision': 0.14, 'recall': 0.008997429305912597, 'f1-score': 0.016908212560386472, 'support': 778}, '6': {'precision': 0.4105263157894737, 'recall': 0.08986175115207373, 'f1-score': 0.1474480151228733, 'support': 1302}, '7': {'precision': 0.0730593607305936, 'recall': 0.03773584905660377, 'f1-score': 0.049766718506998445, 'support': 424}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1644}, '9': {'precision': 0.6666666666666666, 'recall': 0.0009847365829640572, 'f1-score': 0.0019665683382497543, 'support': 2031}, '10': {'precision': 0.125, 'recall': 0.010471204188481676, 'f1-score': 0.01932367149758454, 'support': 573}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1176}, '12': {'precision': 0.5789473684210527, 'recall': 0.0062146892655367235, 'f1-score': 0.012297372833985467, 'support': 1770}, '13': {'precision': 0.3472222222222222, 'recall': 0.01926040061633282, 'f1-score': 0.0364963503649635, 'support': 2596}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1627}, '15': {'precision': 0.09154929577464789, 'recall': 0.026859504132231406, 'f1-score': 0.04153354632587859, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 0.5882352941176471, 'recall': 0.01838235294117647, 'f1-score': 0.035650623885918005, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.125, 'recall': 0.003816793893129771, 'f1-score': 0.007407407407407407, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.281479217603912, 'recall': 0.036298427462263035, 'f1-score': 0.0643044161284692, 'support': 25373}, 'macro avg': {'precision': 0.18569696307415323, 'recall': 0.03222896695529932, 'f1-score': 0.03857717947265454, 'support': 25373}, 'weighted avg': {'precision': 0.2440969073156183, 'recall': 0.036298427462263035, 'f1-score': 0.042005601477026366, 'support': 25373}, 'samples avg': {'precision': 0.09261754035152986, 'recall': 0.02443589271843523, 'f1-score': 0.03594732476065771, 'support': 25373}}
{'0': {'precision': 0.6274509803921569, 'recall': 0.3827751196172249, 'f1-score': 0.475482912332838, 'support': 418}, '1': {'precision': 0.576271186440678, 'recall': 0.1574074074074074, 'f1-score': 0.24727272727272726, 'support': 216}, '2': {'precision': 0.5454545454545454, 'recall': 0.020833333333333332, 'f1-score': 0.04013377926421404, 'support': 288}, '3': {'precision': 1.0, 'recall': 0.003968253968253968, 'f1-score': 0.007905138339920948, 'support': 252}, '4': {'precision': 0.525, 'recall': 0.07291666666666667, 'f1-score': 0.12804878048780488, 'support': 288}, '5': {'precision': 0.5, 'recall': 0.02973977695167286, 'f1-score': 0.056140350877192984, 'support': 269}, '6': {'precision': 0.6363636363636364, 'recall': 0.024734982332155476, 'f1-score': 0.047619047619047616, 'support': 283}, '7': {'precision': 0.7548387096774194, 'recall': 0.4588235294117647, 'f1-score': 0.5707317073170731, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.6222222222222222, 'recall': 0.11864406779661017, 'f1-score': 0.199288256227758, 'support': 236}, '10': {'precision': 0.75, 'recall': 0.01639344262295082, 'f1-score': 0.0320855614973262, 'support': 183}, '11': {'precision': 0.8571428571428571, 'recall': 0.05741626794258373, 'f1-score': 0.10762331838565023, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.5, 'recall': 0.02702702702702703, 'f1-score': 0.05128205128205129, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.6907216494845361, 'recall': 0.7444444444444445, 'f1-score': 0.716577540106952, 'support': 90}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.6531468531468532, 'recall': 0.12286240463036043, 'f1-score': 0.20682019486271033, 'support': 3801}, 'macro avg': {'precision': 0.3434186314871221, 'recall': 0.08460497278088383, 'f1-score': 0.10720764684042226, 'support': 3801}, 'weighted avg': {'precision': 0.5353899040425093, 'recall': 0.12286240463036043, 'f1-score': 0.16371671002698812, 'support': 3801}, 'samples avg': {'precision': 0.21102701822916664, 'recall': 0.14495442708333334, 'f1-score': 0.1613943917410714, 'support': 3801}}