
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4362641276419163
Train: epoch: 1, loss = 0.42008371636271474
Train: epoch: 1, loss = 0.4169540329277515
Train: epoch: 1, loss = 0.41419583272188903
Train: epoch: 1, loss = 0.41269627967476846
Train: epoch: 1, loss = 0.4098070511470238
Train: epoch: 1, loss = 0.40723053112626073
Train: epoch: 1, loss = 0.4054295230098069
Train: epoch: 1, loss = 0.4036178686552577
Train: epoch: 1, loss = 0.4022144001945853
Train: epoch: 1, loss = 0.401294643194838
Train: epoch: 1, loss = 0.400060299107184
Train: epoch: 1, loss = 0.3985079753284271
Train: epoch: 1, loss = 0.39711081705987455
Train: epoch: 1, loss = 0.3957414832363526
Train: epoch: 1, loss = 0.3944933419302106
Train: epoch: 1, loss = 0.3933143499405945
Train: epoch: 1, loss = 0.39224731530580254
Train:  Epoch 1, Loss=0.3922476988388942, AUC-ROC Macro=0.6590150549943177, AUC-ROC Micro=0.7491125770636755
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37310922394196194, AUC-ROC Macro=0.7162856427841569, AUC-ROC Micro=0.7789557543986919
Eval task: 2
Eval:  Epoch 1, Loss=0.3462769567966461, AUC-ROC Macro=0.4760004155702082, AUC-ROC Micro=0.5596834456426256
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3744552957266569
Train: epoch: 2, loss = 0.3732608945295215
Train: epoch: 2, loss = 0.3705743090560039
Train: epoch: 2, loss = 0.37056523287668824
Train: epoch: 2, loss = 0.37107250352203847
Train: epoch: 2, loss = 0.3697598903005322
Train: epoch: 2, loss = 0.3703210803440639
Train: epoch: 2, loss = 0.3705504666082561
Train: epoch: 2, loss = 0.36975214671757484
Train: epoch: 2, loss = 0.3691602428331971
Train: epoch: 2, loss = 0.3693219039115039
Train: epoch: 2, loss = 0.36929375350475313
Train: epoch: 2, loss = 0.36887245280238296
Train: epoch: 2, loss = 0.36866449897310566
Train: epoch: 2, loss = 0.36842305927971997
Train: epoch: 2, loss = 0.3681773847015575
Train: epoch: 2, loss = 0.36818297334453637
Train: epoch: 2, loss = 0.3679323818700181
Train:  Epoch 2, Loss=0.36787215085111113, AUC-ROC Macro=0.7261807934473206, AUC-ROC Micro=0.7921321854819533
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3617110289633274, AUC-ROC Macro=0.7387081379680405, AUC-ROC Micro=0.797464471272044
Eval task: 2
Eval:  Epoch 2, Loss=0.3507505714893341, AUC-ROC Macro=0.4744762599477934, AUC-ROC Micro=0.5483635263801734
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36486704483628274
Train: epoch: 3, loss = 0.36518145244568584
Train: epoch: 3, loss = 0.3664376912514369
Train: epoch: 3, loss = 0.36469808645546437
Train: epoch: 3, loss = 0.3647806398719549
Train: epoch: 3, loss = 0.364094015173614
Train: epoch: 3, loss = 0.3634235518425703
Train: epoch: 3, loss = 0.3628998885396868
Train: epoch: 3, loss = 0.3625887087318632
Train: epoch: 3, loss = 0.36150677674263715
Train: epoch: 3, loss = 0.36153220285746185
Train: epoch: 3, loss = 0.36074268812934557
Train: epoch: 3, loss = 0.36019565951938814
Train: epoch: 3, loss = 0.3600642795594675
Train: epoch: 3, loss = 0.35990961973369123
Train: epoch: 3, loss = 0.3602929011918604
Train: epoch: 3, loss = 0.36039334115298355
Train: epoch: 3, loss = 0.36010395326962075
Train:  Epoch 3, Loss=0.3600799615811079, AUC-ROC Macro=0.7442748318163893, AUC-ROC Micro=0.8043132006546416
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35567638898889226, AUC-ROC Macro=0.751308786429267, AUC-ROC Micro=0.8071406852045042
Eval task: 2
Eval:  Epoch 3, Loss=0.37873628437519075, AUC-ROC Macro=0.4674695067123977, AUC-ROC Micro=0.5209881893794016
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.35768697440624236
Train: epoch: 4, loss = 0.35339105036109686
Train: epoch: 4, loss = 0.35345846571028233
Train: epoch: 4, loss = 0.35304346824064853
Train: epoch: 4, loss = 0.3556580893844366
Train: epoch: 4, loss = 0.3549186367293199
Train: epoch: 4, loss = 0.3549151696264744
Train: epoch: 4, loss = 0.35387861003167925
Train: epoch: 4, loss = 0.3541665353626013
Train: epoch: 4, loss = 0.3541374119818211
Train: epoch: 4, loss = 0.3544787660105662
Train: epoch: 4, loss = 0.354779158513993
Train: epoch: 4, loss = 0.3548123929305719
Train: epoch: 4, loss = 0.35460870158459457
Train: epoch: 4, loss = 0.35416343874732653
Train: epoch: 4, loss = 0.35404456897173076
Train: epoch: 4, loss = 0.3545254642121932
Train: epoch: 4, loss = 0.3545360290134946
Train:  Epoch 4, Loss=0.35441046607596244, AUC-ROC Macro=0.7563409167804416, AUC-ROC Micro=0.8125581422076995
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3531655396024386, AUC-ROC Macro=0.7569303885609238, AUC-ROC Micro=0.8110214530749309
Eval task: 2
Eval:  Epoch 4, Loss=0.4856704890727997, AUC-ROC Macro=0.4686216231871899, AUC-ROC Micro=0.5198236149525384
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3475079870223999
Train: epoch: 5, loss = 0.3482168337330222
Train: epoch: 5, loss = 0.3478204301993052
Train: epoch: 5, loss = 0.3484711150825024
Train: epoch: 5, loss = 0.34924496346712114
Train: epoch: 5, loss = 0.35001030294845503
Train: epoch: 5, loss = 0.3484076031297445
Train: epoch: 5, loss = 0.3486980301141739
Train: epoch: 5, loss = 0.34857227342824143
Train: epoch: 5, loss = 0.34920369026809933
Train: epoch: 5, loss = 0.34935774868862196
Train: epoch: 5, loss = 0.3493871968239546
Train: epoch: 5, loss = 0.3493233621349702
Train: epoch: 5, loss = 0.34998660534620285
Train: epoch: 5, loss = 0.35010433684786163
Train: epoch: 5, loss = 0.3502702420577407
Train: epoch: 5, loss = 0.350088414615568
Train: epoch: 5, loss = 0.35003309183650544
Train:  Epoch 5, Loss=0.349980548228973, AUC-ROC Macro=0.7653265526094855, AUC-ROC Micro=0.8187715314364944
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35102711617946625, AUC-ROC Macro=0.7627612089597291, AUC-ROC Micro=0.8143641815484973
Eval task: 2
Eval:  Epoch 5, Loss=0.38096822500228883, AUC-ROC Macro=0.47416222565457306, AUC-ROC Micro=0.5316141433661234
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34431353241205215
Train: epoch: 6, loss = 0.3463047247007489
Train: epoch: 6, loss = 0.3463533032188813
Train: epoch: 6, loss = 0.34743962068110706
Train: epoch: 6, loss = 0.34549780513346195
Train: epoch: 6, loss = 0.3473293445756038
Train: epoch: 6, loss = 0.34632726832159927
Train: epoch: 6, loss = 0.34634632780216634
Train: epoch: 6, loss = 0.3460746779872311
Train: epoch: 6, loss = 0.34638624323904516
Train: epoch: 6, loss = 0.34633328769694677
Train: epoch: 6, loss = 0.3466912880415718
Train: epoch: 6, loss = 0.3467253375225342
Train: epoch: 6, loss = 0.3465021518671087
Train: epoch: 6, loss = 0.3467166898449262
Train: epoch: 6, loss = 0.34673360409680754
Train: epoch: 6, loss = 0.3465892916742493
Train: epoch: 6, loss = 0.34662536113212505
Train:  Epoch 6, Loss=0.34654094932629514, AUC-ROC Macro=0.7726020839724871, AUC-ROC Micro=0.8235403427890572
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3508677196999391, AUC-ROC Macro=0.7632860392504723, AUC-ROC Micro=0.8150774231860118
Eval task: 2
Eval:  Epoch 6, Loss=0.4211039781570435, AUC-ROC Macro=0.47423552950404096, AUC-ROC Micro=0.5440787308510154
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3531126069525878, AUC-ROC Macro=0.7637718967514294, AUC-ROC Micro=0.8147528918217717
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.4146198183298111, AUC-ROC Macro=0.473244242953166, AUC-ROC Micro=0.5434057077763419
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.33591016083955766
Train: epoch: 1, loss = 0.3225811754912138
Train: epoch: 1, loss = 0.31440366943677267
Train: epoch: 1, loss = 0.31068516036495564
Train: epoch: 1, loss = 0.30733136358857155
Train: epoch: 1, loss = 0.30468726040174565
Train: epoch: 1, loss = 0.30250681350273745
Train:  Epoch 1, Loss=0.30073361729537146, AUC-ROC Macro=0.587367609097362, AUC-ROC Micro=0.7345428817434226
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3507131263613701, AUC-ROC Macro=0.7553128702639812, AUC-ROC Micro=0.8070091581401753
Eval task: 2
Eval:  Epoch 1, Loss=0.28659827411174776, AUC-ROC Macro=0.6768306931383539, AUC-ROC Micro=0.7849601139082507
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.286686390414834
Train: epoch: 2, loss = 0.28768399700522423
Train: epoch: 2, loss = 0.285158078695337
Train: epoch: 2, loss = 0.2838733169808984
Train: epoch: 2, loss = 0.28367297574877737
Train: epoch: 2, loss = 0.2831931580727299
Train: epoch: 2, loss = 0.28265753655561376
Train:  Epoch 2, Loss=0.28231028215037374, AUC-ROC Macro=0.6841774964871444, AUC-ROC Micro=0.7926886316138368
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.34318364039063454, AUC-ROC Macro=0.7531860948945706, AUC-ROC Micro=0.8076260793775412
Eval task: 2
Eval:  Epoch 2, Loss=0.26969940811395643, AUC-ROC Macro=0.7004535398619691, AUC-ROC Micro=0.7967443694244799
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2763442920893431
Train: epoch: 3, loss = 0.27696673076599837
Train: epoch: 3, loss = 0.2756235307703416
Train: epoch: 3, loss = 0.2741322283633053
Train: epoch: 3, loss = 0.27361506113409995
Train: epoch: 3, loss = 0.2728220643475652
Train: epoch: 3, loss = 0.27299467705190184
Train:  Epoch 3, Loss=0.27305611513733885, AUC-ROC Macro=0.7136491340980861, AUC-ROC Micro=0.8060618965399713
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3408471867442131, AUC-ROC Macro=0.7447405825399871, AUC-ROC Micro=0.7977778765387971
Eval task: 2
Eval:  Epoch 3, Loss=0.26684159934520724, AUC-ROC Macro=0.714797672699544, AUC-ROC Micro=0.8014559079542152
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.26505059853196145
Train: epoch: 4, loss = 0.2657488325983286
Train: epoch: 4, loss = 0.2661249482134978
Train: epoch: 4, loss = 0.26525597892701624
Train: epoch: 4, loss = 0.26556910608708856
Train: epoch: 4, loss = 0.26471481325725715
Train: epoch: 4, loss = 0.26453070687396185
Train:  Epoch 4, Loss=0.26489078662217735, AUC-ROC Macro=0.7319742953059911, AUC-ROC Micro=0.8159671263477455
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3342067052920659, AUC-ROC Macro=0.7418397756504166, AUC-ROC Micro=0.7972435766926017
Eval task: 2
Eval:  Epoch 4, Loss=0.2727744743227959, AUC-ROC Macro=0.7163425375270767, AUC-ROC Micro=0.8039052458365021
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2579773236066103
Train: epoch: 5, loss = 0.25852185562253
Train: epoch: 5, loss = 0.25763444259762763
Train: epoch: 5, loss = 0.2574354029260576
Train: epoch: 5, loss = 0.25774118573963645
Train: epoch: 5, loss = 0.2572760396450758
Train: epoch: 5, loss = 0.2576605616084167
Train:  Epoch 5, Loss=0.2570249359646732, AUC-ROC Macro=0.7441728915164013, AUC-ROC Micro=0.8222729140651929
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.328262060880661, AUC-ROC Macro=0.7350160971843469, AUC-ROC Micro=0.7904383758902628
Eval task: 2
Eval:  Epoch 5, Loss=0.25000971257686616, AUC-ROC Macro=0.7197693292421357, AUC-ROC Micro=0.8085260464331525
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.25345918372273446
Train: epoch: 6, loss = 0.2528274125978351
Train: epoch: 6, loss = 0.25196846629182496
Train: epoch: 6, loss = 0.251740317363292
Train: epoch: 6, loss = 0.2512859327048063
Train: epoch: 6, loss = 0.25132994998246433
Train: epoch: 6, loss = 0.25131830498576163
Train:  Epoch 6, Loss=0.250477495931173, AUC-ROC Macro=0.7547605616990442, AUC-ROC Micro=0.8280992531864815
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3283916153013706, AUC-ROC Macro=0.7312278042361412, AUC-ROC Micro=0.785872685511632
Eval task: 2
Eval:  Epoch 6, Loss=0.23601518124341964, AUC-ROC Macro=0.720957915452012, AUC-ROC Micro=0.8081412751050849
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.39991946890950203, AUC-ROC Macro=0.73125984059093, AUC-ROC Micro=0.7849514650201851
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2349383369088173, AUC-ROC Macro=0.7218992553255701, AUC-ROC Micro=0.8093478125072725
{'0': {'precision': 0.4978902953586498, 'recall': 0.2706422018348624, 'f1-score': 0.3506686478454681, 'support': 1308}, '1': {'precision': 0.5628930817610063, 'recall': 0.44527363184079605, 'f1-score': 0.4972222222222223, 'support': 402}, '2': {'precision': 0.3942307692307692, 'recall': 0.18693009118541035, 'f1-score': 0.2536082474226804, 'support': 658}, '3': {'precision': 0.483492296404989, 'recall': 0.33115577889447234, 'f1-score': 0.39308082314345355, 'support': 1990}, '4': {'precision': 0.38498789346246975, 'recall': 0.19727047146401985, 'f1-score': 0.2608695652173913, 'support': 806}, '5': {'precision': 0.25547445255474455, 'recall': 0.04498714652956298, 'f1-score': 0.07650273224043716, 'support': 778}, '6': {'precision': 0.47619047619047616, 'recall': 0.2073732718894009, 'f1-score': 0.2889245585874799, 'support': 1302}, '7': {'precision': 0.3125, 'recall': 0.03537735849056604, 'f1-score': 0.0635593220338983, 'support': 424}, '8': {'precision': 0.49420289855072463, 'recall': 0.4148418491484185, 'f1-score': 0.45105820105820105, 'support': 1644}, '9': {'precision': 0.6359252561784208, 'recall': 0.5194485475135401, 'f1-score': 0.5718157181571815, 'support': 2031}, '10': {'precision': 0.5607734806629834, 'recall': 0.3542757417102967, 'f1-score': 0.43422459893048126, 'support': 573}, '11': {'precision': 0.3958762886597938, 'recall': 0.32653061224489793, 'f1-score': 0.35787511649580617, 'support': 1176}, '12': {'precision': 0.5245901639344263, 'recall': 0.3254237288135593, 'f1-score': 0.401673640167364, 'support': 1770}, '13': {'precision': 0.5273851590106007, 'recall': 0.45993836671802774, 'f1-score': 0.49135802469135803, 'support': 2596}, '14': {'precision': 0.47038327526132406, 'recall': 0.33189920098340503, 'f1-score': 0.38918918918918916, 'support': 1627}, '15': {'precision': 0.24390243902439024, 'recall': 0.02066115702479339, 'f1-score': 0.0380952380952381, 'support': 484}, '16': {'precision': 0.34352941176470586, 'recall': 0.18364779874213835, 'f1-score': 0.23934426229508196, 'support': 795}, '17': {'precision': 0.34415584415584416, 'recall': 0.0974264705882353, 'f1-score': 0.1518624641833811, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.3382352941176471, 'recall': 0.08778625954198473, 'f1-score': 0.1393939393939394, 'support': 262}, '20': {'precision': 0.2714285714285714, 'recall': 0.03374777975133215, 'f1-score': 0.060031595576619266, 'support': 563}, '21': {'precision': 0.46983546617915906, 'recall': 0.3070489844683393, 'f1-score': 0.3713872832369942, 'support': 837}, '22': {'precision': 0.6175580221997982, 'recall': 0.56353591160221, 'f1-score': 0.5893115069812229, 'support': 1086}, '23': {'precision': 0.5268022181146026, 'recall': 0.3310104529616725, 'f1-score': 0.40656205420827396, 'support': 861}, '24': {'precision': 0.52, 'recall': 0.2316831683168317, 'f1-score': 0.32054794520547947, 'support': 505}, 'micro avg': {'precision': 0.502591983815906, 'recall': 0.31332518819217275, 'f1-score': 0.3860066519385303, 'support': 25373}, 'macro avg': {'precision': 0.4260897221682438, 'recall': 0.252316639290351, 'f1-score': 0.3039266758631537, 'support': 25373}, 'weighted avg': {'precision': 0.4695691609802782, 'recall': 0.31332518819217275, 'f1-score': 0.36642489241783277, 'support': 25373}, 'samples avg': {'precision': 0.3882240381507959, 'recall': 0.2823512864248445, 'f1-score': 0.2997618876865195, 'support': 25373}}
{'0': {'precision': 0.6233480176211453, 'recall': 0.5136116152450091, 'f1-score': 0.56318407960199, 'support': 551}, '1': {'precision': 0.5875, 'recall': 0.21592649310872894, 'f1-score': 0.3157894736842105, 'support': 653}, '2': {'precision': 0.45454545454545453, 'recall': 0.035211267605633804, 'f1-score': 0.06535947712418301, 'support': 426}, '3': {'precision': 0.5897435897435898, 'recall': 0.05623471882640587, 'f1-score': 0.10267857142857145, 'support': 409}, '4': {'precision': 0.3333333333333333, 'recall': 0.02040816326530612, 'f1-score': 0.03846153846153846, 'support': 245}, '5': {'precision': 0.3902439024390244, 'recall': 0.0446927374301676, 'f1-score': 0.08020050125313283, 'support': 358}, '6': {'precision': 0.3, 'recall': 0.012295081967213115, 'f1-score': 0.023622047244094484, 'support': 244}, '7': {'precision': 0.6592592592592592, 'recall': 0.30272108843537415, 'f1-score': 0.4149184149184149, 'support': 294}, '8': {'precision': 0.5, 'recall': 0.0076045627376425855, 'f1-score': 0.014981273408239702, 'support': 263}, '9': {'precision': 0.6, 'recall': 0.01079136690647482, 'f1-score': 0.021201413427561835, 'support': 278}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 208}, '11': {'precision': 0.47368421052631576, 'recall': 0.03614457831325301, 'f1-score': 0.06716417910447761, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.4666666666666667, 'recall': 0.10606060606060606, 'f1-score': 0.1728395061728395, 'support': 132}, '14': {'precision': 0.6756756756756757, 'recall': 0.11061946902654868, 'f1-score': 0.19011406844106463, 'support': 226}, '15': {'precision': 0.7586206896551724, 'recall': 0.41904761904761906, 'f1-score': 0.5398773006134969, 'support': 105}, '16': {'precision': 0.5517241379310345, 'recall': 0.11764705882352941, 'f1-score': 0.19393939393939394, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.5925925925925926, 'recall': 0.1276201075867186, 'f1-score': 0.21001221001221002, 'support': 5391}, 'macro avg': {'precision': 0.3185737974958669, 'recall': 0.08036065707198048, 'f1-score': 0.11217324955292839, 'support': 5391}, 'weighted avg': {'precision': 0.45178625149489365, 'recall': 0.1276201075867186, 'f1-score': 0.17207376996658494, 'support': 5391}, 'samples avg': {'precision': 0.20093680245535714, 'recall': 0.12503627232142858, 'f1-score': 0.14019341042433872, 'support': 5391}}