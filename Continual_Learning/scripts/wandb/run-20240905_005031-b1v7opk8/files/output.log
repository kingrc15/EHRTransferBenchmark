
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.44136250391602516
Train: epoch: 1, loss = 0.4245371512323618
Train: epoch: 1, loss = 0.42034096255898473
Train: epoch: 1, loss = 0.4155556597560644
Train: epoch: 1, loss = 0.4134921388924122
Train: epoch: 1, loss = 0.41185049163798493
Train: epoch: 1, loss = 0.40879345382962906
Train: epoch: 1, loss = 0.40692157476209107
Train: epoch: 1, loss = 0.4056027386503087
Train: epoch: 1, loss = 0.40316024837642905
Train: epoch: 1, loss = 0.4013555740971457
Train: epoch: 1, loss = 0.3995442302835484
Train: epoch: 1, loss = 0.39843497231029545
Train: epoch: 1, loss = 0.3969767357355782
Train: epoch: 1, loss = 0.3958224994540215
Train: epoch: 1, loss = 0.39476919000502675
Train: epoch: 1, loss = 0.3934350414617973
Train: epoch: 1, loss = 0.3925770079013374
Train:  Epoch 1, Loss=0.3923185769105569, AUC-ROC Macro=0.65735036147285, AUC-ROC Micro=0.7488414941433645
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3720204159617424, AUC-ROC Macro=0.7137661022790893, AUC-ROC Micro=0.7812844274391331
Eval task: 2
Eval:  Epoch 1, Loss=0.2997300289571285, AUC-ROC Macro=0.514233803472242, AUC-ROC Micro=0.566289325764744
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3688636590540409
Train: epoch: 2, loss = 0.3716978297382593
Train: epoch: 2, loss = 0.37211436291535693
Train: epoch: 2, loss = 0.374455857463181
Train: epoch: 2, loss = 0.3740264461636543
Train: epoch: 2, loss = 0.372400702573359
Train: epoch: 2, loss = 0.3721447615112577
Train: epoch: 2, loss = 0.37167562457732856
Train: epoch: 2, loss = 0.3712840949661202
Train: epoch: 2, loss = 0.37088989159464836
Train: epoch: 2, loss = 0.37065101242200893
Train: epoch: 2, loss = 0.3704863175563514
Train: epoch: 2, loss = 0.37005844069214966
Train: epoch: 2, loss = 0.37006323667509217
Train: epoch: 2, loss = 0.3698766819834709
Train: epoch: 2, loss = 0.3699555873405188
Train: epoch: 2, loss = 0.3694567554049632
Train: epoch: 2, loss = 0.3689996408422788
Train:  Epoch 2, Loss=0.3687745505785331, AUC-ROC Macro=0.7236456103888511, AUC-ROC Micro=0.7908823861076357
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3643044978380203, AUC-ROC Macro=0.7376345084461958, AUC-ROC Micro=0.7947021495922286
Eval task: 2
Eval:  Epoch 2, Loss=0.32575031369924545, AUC-ROC Macro=0.4826125487212771, AUC-ROC Micro=0.5897816156554102
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.361852043941617
Train: epoch: 3, loss = 0.36566882342100143
Train: epoch: 3, loss = 0.36321346993247666
Train: epoch: 3, loss = 0.3630463421717286
Train: epoch: 3, loss = 0.36303052060306074
Train: epoch: 3, loss = 0.3626266876980662
Train: epoch: 3, loss = 0.36192901706056935
Train: epoch: 3, loss = 0.36154326660558583
Train: epoch: 3, loss = 0.3620350196378099
Train: epoch: 3, loss = 0.3619603404253721
Train: epoch: 3, loss = 0.3619217418201945
Train: epoch: 3, loss = 0.3619741667682926
Train: epoch: 3, loss = 0.36185414711443276
Train: epoch: 3, loss = 0.3610043629471745
Train: epoch: 3, loss = 0.3607768840988477
Train: epoch: 3, loss = 0.36082923359703273
Train: epoch: 3, loss = 0.36038993004928616
Train: epoch: 3, loss = 0.36038077665285934
Train:  Epoch 3, Loss=0.3604658180648445, AUC-ROC Macro=0.7430460888595105, AUC-ROC Micro=0.8036588121778891
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35792122781276703, AUC-ROC Macro=0.7483392139246436, AUC-ROC Micro=0.8048837265971385
Eval task: 2
Eval:  Epoch 3, Loss=0.32133447006344795, AUC-ROC Macro=0.49150333623456693, AUC-ROC Micro=0.5626044628854363
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.35249625504016874
Train: epoch: 4, loss = 0.35192415479570627
Train: epoch: 4, loss = 0.3531062057862679
Train: epoch: 4, loss = 0.35382023522630335
Train: epoch: 4, loss = 0.35418109577894213
Train: epoch: 4, loss = 0.35425871167331935
Train: epoch: 4, loss = 0.35455982033695493
Train: epoch: 4, loss = 0.35383661270141603
Train: epoch: 4, loss = 0.3540707678347826
Train: epoch: 4, loss = 0.3549151914939284
Train: epoch: 4, loss = 0.35442174426533957
Train: epoch: 4, loss = 0.35420406628400086
Train: epoch: 4, loss = 0.35454074800014496
Train: epoch: 4, loss = 0.35470408184719937
Train: epoch: 4, loss = 0.354851366619269
Train: epoch: 4, loss = 0.3547711324412376
Train: epoch: 4, loss = 0.35470952231217834
Train: epoch: 4, loss = 0.3545459212652511
Train:  Epoch 4, Loss=0.35456791200393284, AUC-ROC Macro=0.7559352795209631, AUC-ROC Micro=0.8122080573210135
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35384531194965047, AUC-ROC Macro=0.7562498976439188, AUC-ROC Micro=0.8099266605396028
Eval task: 2
Eval:  Epoch 4, Loss=0.32904207333922386, AUC-ROC Macro=0.4831261839779743, AUC-ROC Micro=0.5710107896102936
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.34475386142730713
Train: epoch: 5, loss = 0.34555534515529873
Train: epoch: 5, loss = 0.34630116599301497
Train: epoch: 5, loss = 0.3461414139904082
Train: epoch: 5, loss = 0.3476430341601372
Train: epoch: 5, loss = 0.34820394589255255
Train: epoch: 5, loss = 0.3481509565136262
Train: epoch: 5, loss = 0.34846615601330994
Train: epoch: 5, loss = 0.34925386572877565
Train: epoch: 5, loss = 0.3486112177371979
Train: epoch: 5, loss = 0.34865932525558907
Train: epoch: 5, loss = 0.3489284588644902
Train: epoch: 5, loss = 0.3485546732980471
Train: epoch: 5, loss = 0.3491307622300727
Train: epoch: 5, loss = 0.34954298730194566
Train: epoch: 5, loss = 0.34994151097722354
Train: epoch: 5, loss = 0.3501146501521854
Train: epoch: 5, loss = 0.35018345485544866
Train:  Epoch 5, Loss=0.3504039379348103, AUC-ROC Macro=0.7649001222265412, AUC-ROC Micro=0.8181648005526649
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3516610289613406, AUC-ROC Macro=0.7602867816430537, AUC-ROC Micro=0.8133665223321187
Eval task: 2
Eval:  Epoch 5, Loss=0.34685295820236206, AUC-ROC Macro=0.4888286475908774, AUC-ROC Micro=0.5785114424556923
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34174470230937004
Train: epoch: 6, loss = 0.34911355800926686
Train: epoch: 6, loss = 0.3483761497586966
Train: epoch: 6, loss = 0.3473201766982675
Train: epoch: 6, loss = 0.3475510722249746
Train: epoch: 6, loss = 0.3475831633930405
Train: epoch: 6, loss = 0.3484122695986714
Train: epoch: 6, loss = 0.34794571679085495
Train: epoch: 6, loss = 0.34766711574461723
Train: epoch: 6, loss = 0.34716825576871635
Train: epoch: 6, loss = 0.3466276380555196
Train: epoch: 6, loss = 0.346793888596197
Train: epoch: 6, loss = 0.3466259551392152
Train: epoch: 6, loss = 0.3463380733770984
Train: epoch: 6, loss = 0.3464349109282096
Train: epoch: 6, loss = 0.3462217931775376
Train: epoch: 6, loss = 0.34613617499961574
Train: epoch: 6, loss = 0.3466377879761987
Train:  Epoch 6, Loss=0.3466964959843546, AUC-ROC Macro=0.7722456408283227, AUC-ROC Micro=0.8232635176488652
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3509286430974801, AUC-ROC Macro=0.762521812058571, AUC-ROC Micro=0.8142401554723708
Eval task: 2
Eval:  Epoch 6, Loss=0.33960186317563057, AUC-ROC Macro=0.4766345655322468, AUC-ROC Micro=0.5474789763028378
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3541764169931412, AUC-ROC Macro=0.7627901622530344, AUC-ROC Micro=0.812387353842331
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.33881641551852226, AUC-ROC Macro=0.4941097389762802, AUC-ROC Micro=0.5454273562774465
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2552441343665123
Train: epoch: 1, loss = 0.24538032945245505
Train: epoch: 1, loss = 0.23867600994805496
Train: epoch: 1, loss = 0.236081460788846
Train: epoch: 1, loss = 0.23244182746112346
Train: epoch: 1, loss = 0.23100972726941107
Train:  Epoch 1, Loss=0.23006661187247188, AUC-ROC Macro=0.6260226035373888, AUC-ROC Micro=0.7683431404324998
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.49152076865235966, AUC-ROC Macro=0.6398543635368693, AUC-ROC Micro=0.6429659085054988
Eval task: 2
Eval:  Epoch 1, Loss=0.21875840798020363, AUC-ROC Macro=0.695393614331953, AUC-ROC Micro=0.802187763063496
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.21601643398404122
Train: epoch: 2, loss = 0.21674596719443798
Train: epoch: 2, loss = 0.21652929179370403
Train: epoch: 2, loss = 0.21580761302262544
Train: epoch: 2, loss = 0.21569818083941936
Train: epoch: 2, loss = 0.21471803907305
Train:  Epoch 2, Loss=0.21438171532319925, AUC-ROC Macro=0.7111432242559478, AUC-ROC Micro=0.8124218033479491
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.5062062678237756, AUC-ROC Macro=0.6226493315499153, AUC-ROC Micro=0.6298766856446062
Eval task: 2
Eval:  Epoch 2, Loss=0.21222899667918682, AUC-ROC Macro=0.7261956304256557, AUC-ROC Micro=0.8177613122264397
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2073419775813818
Train: epoch: 3, loss = 0.20797717159613968
Train: epoch: 3, loss = 0.2075718765084942
Train: epoch: 3, loss = 0.2082347899209708
Train: epoch: 3, loss = 0.2085495248809457
Train: epoch: 3, loss = 0.2090136270597577
Train:  Epoch 3, Loss=0.20886897782759606, AUC-ROC Macro=0.7413633859850769, AUC-ROC Micro=0.8261761284048139
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5342624547580878, AUC-ROC Macro=0.6012799642766044, AUC-ROC Micro=0.6098869137619497
Eval task: 2
Eval:  Epoch 3, Loss=0.21130802296102047, AUC-ROC Macro=0.7268948443047769, AUC-ROC Micro=0.820079894415224
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.2025967714190483
Train: epoch: 4, loss = 0.20433606302365662
Train: epoch: 4, loss = 0.20480734958002964
Train: epoch: 4, loss = 0.2045247184112668
Train: epoch: 4, loss = 0.20554828317463397
Train: epoch: 4, loss = 0.20538628933951258
Train:  Epoch 4, Loss=0.20488221239000448, AUC-ROC Macro=0.7597805106957365, AUC-ROC Micro=0.8352010183171658
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5083678041895231, AUC-ROC Macro=0.6104181565008602, AUC-ROC Micro=0.6211539360553985
Eval task: 2
Eval:  Epoch 4, Loss=0.2123372107744217, AUC-ROC Macro=0.7281294132582579, AUC-ROC Micro=0.8178435307785552
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.20093102440237998
Train: epoch: 5, loss = 0.20076178098097444
Train: epoch: 5, loss = 0.20154350567609072
Train: epoch: 5, loss = 0.2013251980394125
Train: epoch: 5, loss = 0.20061848308146
Train: epoch: 5, loss = 0.20081077905371786
Train:  Epoch 5, Loss=0.2015773199091853, AUC-ROC Macro=0.7750322479288708, AUC-ROC Micro=0.8424049643373517
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5344413742423058, AUC-ROC Macro=0.5997576216843732, AUC-ROC Micro=0.6103900594303375
Eval task: 2
Eval:  Epoch 5, Loss=0.20971492677927017, AUC-ROC Macro=0.7316003082512746, AUC-ROC Micro=0.8246660903387445
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.19902600739151238
Train: epoch: 6, loss = 0.2005864444747567
Train: epoch: 6, loss = 0.19939460517217716
Train: epoch: 6, loss = 0.1978047101572156
Train: epoch: 6, loss = 0.19788821376115084
Train: epoch: 6, loss = 0.19836505307505528
Train:  Epoch 6, Loss=0.19866355989482212, AUC-ROC Macro=0.784841640366514, AUC-ROC Micro=0.8481660776779693
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5469711025555929, AUC-ROC Macro=0.5937435073389762, AUC-ROC Micro=0.6067019860684195
Eval task: 2
Eval:  Epoch 6, Loss=0.2093004807829857, AUC-ROC Macro=0.7378024335168579, AUC-ROC Micro=0.826935211618711
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.552430714170138, AUC-ROC Macro=0.5919839071730338, AUC-ROC Micro=0.6062509306755289
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.21088912151753902, AUC-ROC Macro=0.7280050748082582, AUC-ROC Micro=0.8238279920240713
{'0': {'precision': 0.28050108932461876, 'recall': 0.3937308868501529, 'f1-score': 0.3276081424936387, 'support': 1308}, '1': {'precision': 0.4266666666666667, 'recall': 0.07960199004975124, 'f1-score': 0.1341719077568134, 'support': 402}, '2': {'precision': 0.18518518518518517, 'recall': 0.007598784194528876, 'f1-score': 0.014598540145985403, 'support': 658}, '3': {'precision': 0.7058823529411765, 'recall': 0.006030150753768844, 'f1-score': 0.011958146487294468, 'support': 1990}, '4': {'precision': 0.2994350282485876, 'recall': 0.06575682382133995, 'f1-score': 0.10783316378433366, 'support': 806}, '5': {'precision': 0.1794871794871795, 'recall': 0.017994858611825194, 'f1-score': 0.03271028037383177, 'support': 778}, '6': {'precision': 0.38095238095238093, 'recall': 0.11059907834101383, 'f1-score': 0.17142857142857143, 'support': 1302}, '7': {'precision': 0.03535353535353535, 'recall': 0.01650943396226415, 'f1-score': 0.022508038585209, 'support': 424}, '8': {'precision': 0.7142857142857143, 'recall': 0.0030413625304136255, 'f1-score': 0.006056935190793459, 'support': 1644}, '9': {'precision': 1.0, 'recall': 0.0009847365829640572, 'f1-score': 0.0019675356615838665, 'support': 2031}, '10': {'precision': 0.30434782608695654, 'recall': 0.04886561954624782, 'f1-score': 0.08421052631578949, 'support': 573}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1176}, '12': {'precision': 0.4274193548387097, 'recall': 0.029943502824858758, 'f1-score': 0.0559662090813094, 'support': 1770}, '13': {'precision': 0.34574468085106386, 'recall': 0.025038520801232665, 'f1-score': 0.04669540229885057, 'support': 2596}, '14': {'precision': 1.0, 'recall': 0.001229256299938537, 'f1-score': 0.0024554941682013503, 'support': 1627}, '15': {'precision': 0.08695652173913043, 'recall': 0.01652892561983471, 'f1-score': 0.02777777777777778, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 0.5, 'recall': 0.003676470588235294, 'f1-score': 0.0072992700729927005, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.3333333333333333, 'recall': 0.003816793893129771, 'f1-score': 0.007547169811320754, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.28666465074085273, 'recall': 0.037362550742915696, 'f1-score': 0.06610878661087866, 'support': 25373}, 'macro avg': {'precision': 0.28822203397176954, 'recall': 0.033237887810860005, 'f1-score': 0.04251172445737189, 'support': 25373}, 'weighted avg': {'precision': 0.3948737427376806, 'recall': 0.037362550742915696, 'f1-score': 0.04598715532243881, 'support': 25373}, 'samples avg': {'precision': 0.09737684461805556, 'recall': 0.025870514980406985, 'f1-score': 0.038274080803755606, 'support': 25373}}
{'0': {'precision': 0.6125, 'recall': 0.35167464114832536, 'f1-score': 0.44680851063829785, 'support': 418}, '1': {'precision': 0.5555555555555556, 'recall': 0.09259259259259259, 'f1-score': 0.15873015873015875, 'support': 216}, '2': {'precision': 0.375, 'recall': 0.03125, 'f1-score': 0.057692307692307696, 'support': 288}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 252}, '4': {'precision': 0.5645161290322581, 'recall': 0.12152777777777778, 'f1-score': 0.19999999999999998, 'support': 288}, '5': {'precision': 0.5, 'recall': 0.03345724907063197, 'f1-score': 0.0627177700348432, 'support': 269}, '6': {'precision': 0.4473684210526316, 'recall': 0.06007067137809187, 'f1-score': 0.10591900311526478, 'support': 283}, '7': {'precision': 0.8372093023255814, 'recall': 0.4235294117647059, 'f1-score': 0.5625, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.7647058823529411, 'recall': 0.05508474576271186, 'f1-score': 0.10276679841897232, 'support': 236}, '10': {'precision': 1.0, 'recall': 0.01092896174863388, 'f1-score': 0.021621621621621623, 'support': 183}, '11': {'precision': 0.631578947368421, 'recall': 0.05741626794258373, 'f1-score': 0.10526315789473684, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.5, 'recall': 0.04504504504504504, 'f1-score': 0.08264462809917356, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.7311827956989247, 'recall': 0.7555555555555555, 'f1-score': 0.7431693989071038, 'support': 90}, '16': {'precision': 1.0, 'recall': 0.028985507246376812, 'f1-score': 0.05633802816901409, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.645021645021645, 'recall': 0.11760063141278611, 'f1-score': 0.19893190921228304, 'support': 3801}, 'macro avg': {'precision': 0.3407846813354525, 'recall': 0.08268473708132129, 'f1-score': 0.10824685533285977, 'support': 3801}, 'weighted avg': {'precision': 0.47539498033686023, 'recall': 0.11760063141278611, 'f1-score': 0.16198541413229253, 'support': 3801}, 'samples avg': {'precision': 0.19677734375, 'recall': 0.1363130115327381, 'f1-score': 0.15197327628968255, 'support': 3801}}