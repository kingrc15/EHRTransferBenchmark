
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4406223438680172
Train: epoch: 1, loss = 0.4273651288449764
Train: epoch: 1, loss = 0.42083547145128253
Train: epoch: 1, loss = 0.4173919135704637
Train: epoch: 1, loss = 0.41455100461840627
Train: epoch: 1, loss = 0.4130173659572999
Train: epoch: 1, loss = 0.41199724022831236
Train: epoch: 1, loss = 0.41020747350528836
Train: epoch: 1, loss = 0.4084444659617212
Train: epoch: 1, loss = 0.4062505514770746
Train: epoch: 1, loss = 0.4041356680339033
Train: epoch: 1, loss = 0.4025830338026086
Train: epoch: 1, loss = 0.4009789373782965
Train: epoch: 1, loss = 0.398920422270894
Train: epoch: 1, loss = 0.39751788415014744
Train: epoch: 1, loss = 0.39640881299041214
Train: epoch: 1, loss = 0.39469184237367966
Train: epoch: 1, loss = 0.39393806994789177
Train:  Epoch 1, Loss=0.39345590705749317, AUC-ROC Macro=0.6530526122968112, AUC-ROC Micro=0.7462360635485644
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37287647152940434, AUC-ROC Macro=0.7175445836459986, AUC-ROC Micro=0.7812314081205398
Eval task: 2
Eval:  Epoch 1, Loss=0.3210216388106346, AUC-ROC Macro=0.48728138482213085, AUC-ROC Micro=0.5787115320256951
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3658296091109514
Train: epoch: 2, loss = 0.37069362454116345
Train: epoch: 2, loss = 0.37141474343836306
Train: epoch: 2, loss = 0.3715668087080121
Train: epoch: 2, loss = 0.37175857338309287
Train: epoch: 2, loss = 0.3720378055671851
Train: epoch: 2, loss = 0.37199445049677576
Train: epoch: 2, loss = 0.37106398890726267
Train: epoch: 2, loss = 0.3707617964843909
Train: epoch: 2, loss = 0.3705379507765174
Train: epoch: 2, loss = 0.3705127541314472
Train: epoch: 2, loss = 0.37079563962916534
Train: epoch: 2, loss = 0.3703738043858455
Train: epoch: 2, loss = 0.36973865821425406
Train: epoch: 2, loss = 0.3696575445284446
Train: epoch: 2, loss = 0.36974591663572937
Train: epoch: 2, loss = 0.3693047601641978
Train: epoch: 2, loss = 0.36934275024053126
Train:  Epoch 2, Loss=0.3692852412492801, AUC-ROC Macro=0.7229093082229047, AUC-ROC Micro=0.7899563344776747
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.363130575666825, AUC-ROC Macro=0.7343232068883002, AUC-ROC Micro=0.7957356756491598
Eval task: 2
Eval:  Epoch 2, Loss=0.3139319196343422, AUC-ROC Macro=0.4823637984707066, AUC-ROC Micro=0.5646837257650706
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.35964084073901176
Train: epoch: 3, loss = 0.36097663823515175
Train: epoch: 3, loss = 0.3607771231234074
Train: epoch: 3, loss = 0.36195229459553957
Train: epoch: 3, loss = 0.36260039350390433
Train: epoch: 3, loss = 0.3618628623833259
Train: epoch: 3, loss = 0.3617127410109554
Train: epoch: 3, loss = 0.3618352532200515
Train: epoch: 3, loss = 0.3624264561550485
Train: epoch: 3, loss = 0.36205219163000585
Train: epoch: 3, loss = 0.3617446660453623
Train: epoch: 3, loss = 0.362076884880662
Train: epoch: 3, loss = 0.3618240465109165
Train: epoch: 3, loss = 0.3616992864438466
Train: epoch: 3, loss = 0.3614320045262575
Train: epoch: 3, loss = 0.36148854926228524
Train: epoch: 3, loss = 0.36160735300796876
Train: epoch: 3, loss = 0.361384581848979
Train:  Epoch 3, Loss=0.3613103951918773, AUC-ROC Macro=0.7407239379946953, AUC-ROC Micro=0.8023045735028165
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3580362026890119, AUC-ROC Macro=0.7464538645804766, AUC-ROC Micro=0.8045295541587987
Eval task: 2
Eval:  Epoch 3, Loss=0.3280798941850662, AUC-ROC Macro=0.48274005664366504, AUC-ROC Micro=0.5501771941813185
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.35615909986197947
Train: epoch: 4, loss = 0.3571116747707129
Train: epoch: 4, loss = 0.3566091002772252
Train: epoch: 4, loss = 0.3560155355744064
Train: epoch: 4, loss = 0.3566963755488396
Train: epoch: 4, loss = 0.3560962452242772
Train: epoch: 4, loss = 0.3557316498671259
Train: epoch: 4, loss = 0.3564623848907649
Train: epoch: 4, loss = 0.3568572742740313
Train: epoch: 4, loss = 0.3572858830243349
Train: epoch: 4, loss = 0.35692011501978743
Train: epoch: 4, loss = 0.3567204182098309
Train: epoch: 4, loss = 0.3564295306171362
Train: epoch: 4, loss = 0.35586356928838153
Train: epoch: 4, loss = 0.3553655398686727
Train: epoch: 4, loss = 0.3549440291384235
Train: epoch: 4, loss = 0.3550605451008853
Train: epoch: 4, loss = 0.3552892880100343
Train:  Epoch 4, Loss=0.3552583783752898, AUC-ROC Macro=0.7544465422330155, AUC-ROC Micro=0.8113188417914506
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.353985504557689, AUC-ROC Macro=0.7557334908528138, AUC-ROC Micro=0.8091784332797969
Eval task: 2
Eval:  Epoch 4, Loss=0.3371639810502529, AUC-ROC Macro=0.48057532460662644, AUC-ROC Micro=0.5503041887846254
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3477118398994207
Train: epoch: 5, loss = 0.34836761359125373
Train: epoch: 5, loss = 0.3487886144717534
Train: epoch: 5, loss = 0.34920576894655825
Train: epoch: 5, loss = 0.3486181816160679
Train: epoch: 5, loss = 0.34892871290445326
Train: epoch: 5, loss = 0.3495282239786216
Train: epoch: 5, loss = 0.3502206559292972
Train: epoch: 5, loss = 0.35010090260042087
Train: epoch: 5, loss = 0.3495347493290901
Train: epoch: 5, loss = 0.34978857983242384
Train: epoch: 5, loss = 0.3498215734834472
Train: epoch: 5, loss = 0.3499069213294066
Train: epoch: 5, loss = 0.35052243614303213
Train: epoch: 5, loss = 0.35047657208144667
Train: epoch: 5, loss = 0.3509602985717356
Train: epoch: 5, loss = 0.3510121139840168
Train: epoch: 5, loss = 0.35066089779552484
Train:  Epoch 5, Loss=0.35068238115514444, AUC-ROC Macro=0.7639462980199566, AUC-ROC Micro=0.8177724646138488
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35195253665248555, AUC-ROC Macro=0.7593964540849014, AUC-ROC Micro=0.8129940046588036
Eval task: 2
Eval:  Epoch 5, Loss=0.34817173331975937, AUC-ROC Macro=0.4659515506938973, AUC-ROC Micro=0.5477192577558825
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3451170902699232
Train: epoch: 6, loss = 0.34756787851452825
Train: epoch: 6, loss = 0.34731388740241526
Train: epoch: 6, loss = 0.34683030176907775
Train: epoch: 6, loss = 0.3463170073479414
Train: epoch: 6, loss = 0.3453934383143981
Train: epoch: 6, loss = 0.3456804462522268
Train: epoch: 6, loss = 0.34562188970856367
Train: epoch: 6, loss = 0.34610940410859053
Train: epoch: 6, loss = 0.3457273349761963
Train: epoch: 6, loss = 0.3456813712079417
Train: epoch: 6, loss = 0.3461594861249129
Train: epoch: 6, loss = 0.3464092490248955
Train: epoch: 6, loss = 0.34639046030917336
Train: epoch: 6, loss = 0.34655969370901585
Train: epoch: 6, loss = 0.3467601032461971
Train: epoch: 6, loss = 0.3468840400567826
Train: epoch: 6, loss = 0.34709664608455365
Train:  Epoch 6, Loss=0.34708236592447655, AUC-ROC Macro=0.7714942001255877, AUC-ROC Micro=0.8228279640094153
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35116223245859146, AUC-ROC Macro=0.7618761603419086, AUC-ROC Micro=0.8148879195040968
Eval task: 2
Eval:  Epoch 6, Loss=0.35361478477716446, AUC-ROC Macro=0.4747860264299411, AUC-ROC Micro=0.5492000335698718
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.352992232888937, AUC-ROC Macro=0.7635498384963185, AUC-ROC Micro=0.8151583185965307
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.354524876922369, AUC-ROC Macro=0.48104569297540506, AUC-ROC Micro=0.5446749012823617
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.29242545686662197
Train: epoch: 1, loss = 0.2787146504595876
Train: epoch: 1, loss = 0.27242743166784444
Train: epoch: 1, loss = 0.2681418203003705
Train: epoch: 1, loss = 0.2668661851286888
Train: epoch: 1, loss = 0.25973758872598407
Train:  Epoch 1, Loss=0.25579419376561247, AUC-ROC Macro=0.6016813525395527, AUC-ROC Micro=0.7546555358164956
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3732617336014907, AUC-ROC Macro=0.7263149829440699, AUC-ROC Micro=0.7775386374632556
Eval task: 2
Eval:  Epoch 1, Loss=0.2584053799510002, AUC-ROC Macro=0.6807832103887743, AUC-ROC Micro=0.7944937808277267
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.24847104847431184
Train: epoch: 2, loss = 0.24885147549211978
Train: epoch: 2, loss = 0.24919875246783096
Train: epoch: 2, loss = 0.24905039766803383
Train: epoch: 2, loss = 0.24904292129725217
Train: epoch: 2, loss = 0.24349561837191383
Train:  Epoch 2, Loss=0.24075513930466075, AUC-ROC Macro=0.694576436561507, AUC-ROC Micro=0.8075408558765775
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3702366737027963, AUC-ROC Macro=0.7310235860639059, AUC-ROC Micro=0.7842971996688324
Eval task: 2
Eval:  Epoch 2, Loss=0.2525095287710428, AUC-ROC Macro=0.7063627752470242, AUC-ROC Micro=0.8108743617454854
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.24363432310521602
Train: epoch: 3, loss = 0.24283376559615136
Train: epoch: 3, loss = 0.2426631321012974
Train: epoch: 3, loss = 0.24207745231688022
Train: epoch: 3, loss = 0.24339721608161927
Train: epoch: 3, loss = 0.2388094687772294
Train:  Epoch 3, Loss=0.23593308271181254, AUC-ROC Macro=0.7237668259816187, AUC-ROC Micro=0.8207820783644186
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.36025390898187953, AUC-ROC Macro=0.7393573007557621, AUC-ROC Micro=0.7953858329309106
Eval task: 2
Eval:  Epoch 3, Loss=0.24719050154089928, AUC-ROC Macro=0.7226274113409816, AUC-ROC Micro=0.8172089521291402
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.23632925562560558
Train: epoch: 4, loss = 0.23780044097453357
Train: epoch: 4, loss = 0.2386283770451943
Train: epoch: 4, loss = 0.23871199402958154
Train: epoch: 4, loss = 0.2397481897175312
Train: epoch: 4, loss = 0.234894961801668
Train:  Epoch 4, Loss=0.2321857842843124, AUC-ROC Macro=0.7465107777692325, AUC-ROC Micro=0.8303382692549119
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35795729731520015, AUC-ROC Macro=0.7433479529136564, AUC-ROC Micro=0.7995679940557763
Eval task: 2
Eval:  Epoch 4, Loss=0.24679976142942905, AUC-ROC Macro=0.7225822297290283, AUC-ROC Micro=0.8194447619736835
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.23311959069222213
Train: epoch: 5, loss = 0.2335949786566198
Train: epoch: 5, loss = 0.23454962112009525
Train: epoch: 5, loss = 0.2358131117001176
Train: epoch: 5, loss = 0.2376795347183943
Train: epoch: 5, loss = 0.23240334505215288
Train:  Epoch 5, Loss=0.22884865913737953, AUC-ROC Macro=0.7608445351370072, AUC-ROC Micro=0.83809340662875
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3603970818221569, AUC-ROC Macro=0.737964779435545, AUC-ROC Micro=0.793460995349844
Eval task: 2
Eval:  Epoch 5, Loss=0.24417275376617908, AUC-ROC Macro=0.7332810633896885, AUC-ROC Micro=0.8239850127293035
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.23411952875554562
Train: epoch: 6, loss = 0.23091346820816397
Train: epoch: 6, loss = 0.23148827966302632
Train: epoch: 6, loss = 0.23225035406649114
Train: epoch: 6, loss = 0.23312943959981203
Train: epoch: 6, loss = 0.22860551571473478
Train:  Epoch 6, Loss=0.22569490719528099, AUC-ROC Macro=0.7713366087528962, AUC-ROC Micro=0.8438214574646348
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3640890245636304, AUC-ROC Macro=0.7319430309414071, AUC-ROC Micro=0.7851341437361685
Eval task: 2
Eval:  Epoch 6, Loss=0.2426320556551218, AUC-ROC Macro=0.7261586103152305, AUC-ROC Micro=0.822529890356599
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3785044066607952, AUC-ROC Macro=0.7309697415990546, AUC-ROC Micro=0.7829501319471541
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2126611080020666, AUC-ROC Macro=0.7248409675306235, AUC-ROC Micro=0.8185104361730694
{'0': {'precision': 0.4994110718492344, 'recall': 0.3241590214067278, 'f1-score': 0.3931386184515531, 'support': 1308}, '1': {'precision': 0.5362776025236593, 'recall': 0.4228855721393035, 'f1-score': 0.4728789986091795, 'support': 402}, '2': {'precision': 0.44642857142857145, 'recall': 0.07598784194528875, 'f1-score': 0.12987012987012986, 'support': 658}, '3': {'precision': 0.4682634730538922, 'recall': 0.392964824120603, 'f1-score': 0.4273224043715847, 'support': 1990}, '4': {'precision': 0.42592592592592593, 'recall': 0.08560794044665013, 'f1-score': 0.1425619834710744, 'support': 806}, '5': {'precision': 0.36666666666666664, 'recall': 0.056555269922879174, 'f1-score': 0.09799554565701558, 'support': 778}, '6': {'precision': 0.6208791208791209, 'recall': 0.08678955453149001, 'f1-score': 0.1522911051212938, 'support': 1302}, '7': {'precision': 0.15476190476190477, 'recall': 0.030660377358490566, 'f1-score': 0.05118110236220473, 'support': 424}, '8': {'precision': 0.5222222222222223, 'recall': 0.34306569343065696, 'f1-score': 0.4140969162995595, 'support': 1644}, '9': {'precision': 0.6194491287240023, 'recall': 0.5425898572131955, 'f1-score': 0.578477690288714, 'support': 2031}, '10': {'precision': 0.6047430830039525, 'recall': 0.2670157068062827, 'f1-score': 0.3704600484261501, 'support': 573}, '11': {'precision': 0.47139588100686497, 'recall': 0.17517006802721088, 'f1-score': 0.2554246745195289, 'support': 1176}, '12': {'precision': 0.5198347107438016, 'recall': 0.3553672316384181, 'f1-score': 0.4221476510067114, 'support': 1770}, '13': {'precision': 0.5308880308880309, 'recall': 0.423728813559322, 'f1-score': 0.4712939160239931, 'support': 2596}, '14': {'precision': 0.5644599303135889, 'recall': 0.19913952059004303, 'f1-score': 0.29441163107678325, 'support': 1627}, '15': {'precision': 0.0625, 'recall': 0.004132231404958678, 'f1-score': 0.007751937984496124, 'support': 484}, '16': {'precision': 0.3873239436619718, 'recall': 0.06918238993710692, 'f1-score': 0.11739594450373533, 'support': 795}, '17': {'precision': 0.5, 'recall': 0.03308823529411765, 'f1-score': 0.06206896551724138, 'support': 544}, '18': {'precision': 0.3333333333333333, 'recall': 0.002849002849002849, 'f1-score': 0.005649717514124295, 'support': 351}, '19': {'precision': 0.4473684210526316, 'recall': 0.0648854961832061, 'f1-score': 0.11333333333333333, 'support': 262}, '20': {'precision': 0.5, 'recall': 0.007104795737122558, 'f1-score': 0.014010507880910685, 'support': 563}, '21': {'precision': 0.5161290322580645, 'recall': 0.17204301075268819, 'f1-score': 0.25806451612903225, 'support': 837}, '22': {'precision': 0.6600790513833992, 'recall': 0.4613259668508287, 'f1-score': 0.5430894308943089, 'support': 1086}, '23': {'precision': 0.6470588235294118, 'recall': 0.1916376306620209, 'f1-score': 0.2956989247311828, 'support': 861}, '24': {'precision': 0.562962962962963, 'recall': 0.1504950495049505, 'f1-score': 0.2375, 'support': 505}, 'micro avg': {'precision': 0.5343183984747378, 'recall': 0.26508493280258544, 'f1-score': 0.3543636890492875, 'support': 25373}, 'macro avg': {'precision': 0.4787345156869286, 'recall': 0.19753724409250262, 'f1-score': 0.2531246277617536, 'support': 25373}, 'weighted avg': {'precision': 0.5102786426296029, 'recall': 0.26508493280258544, 'f1-score': 0.32396735284612843, 'support': 25373}, 'samples avg': {'precision': 0.347338072942321, 'recall': 0.23603416543946762, 'f1-score': 0.25603600610273447, 'support': 25373}}
{'0': {'precision': 0.6199261992619927, 'recall': 0.4019138755980861, 'f1-score': 0.4876632801161103, 'support': 418}, '1': {'precision': 0.5217391304347826, 'recall': 0.1111111111111111, 'f1-score': 0.183206106870229, 'support': 216}, '2': {'precision': 0.4, 'recall': 0.006944444444444444, 'f1-score': 0.013651877133105802, 'support': 288}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 252}, '4': {'precision': 0.4, 'recall': 0.06944444444444445, 'f1-score': 0.1183431952662722, 'support': 288}, '5': {'precision': 0.5454545454545454, 'recall': 0.04460966542750929, 'f1-score': 0.08247422680412371, 'support': 269}, '6': {'precision': 0.5, 'recall': 0.0176678445229682, 'f1-score': 0.034129692832764506, 'support': 283}, '7': {'precision': 0.8715596330275229, 'recall': 0.37254901960784315, 'f1-score': 0.5219780219780221, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.5869565217391305, 'recall': 0.11440677966101695, 'f1-score': 0.19148936170212766, 'support': 236}, '10': {'precision': 0.5, 'recall': 0.01639344262295082, 'f1-score': 0.031746031746031744, 'support': 183}, '11': {'precision': 0.75, 'recall': 0.028708133971291867, 'f1-score': 0.055299539170506916, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.6666666666666666, 'recall': 0.8, 'f1-score': 0.7272727272727272, 'support': 90}, '16': {'precision': 1.0, 'recall': 0.014492753623188406, 'f1-score': 0.02857142857142857, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.6313497822931785, 'recall': 0.11444356748224152, 'f1-score': 0.1937639198218263, 'support': 3801}, 'macro avg': {'precision': 0.2944921078633856, 'recall': 0.07992966060139418, 'f1-score': 0.099033019578538, 'support': 3801}, 'weighted avg': {'precision': 0.42843239193505706, 'recall': 0.11444356748224152, 'f1-score': 0.15163472970106226, 'support': 3801}, 'samples avg': {'precision': 0.199462890625, 'recall': 0.1360595703125, 'f1-score': 0.1519046843998016, 'support': 3801}}