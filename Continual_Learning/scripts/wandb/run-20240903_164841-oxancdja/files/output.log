
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.42104787833988666
Train: epoch: 1, loss = 0.41599269811064005
Train: epoch: 1, loss = 0.41514046790699166
Train: epoch: 1, loss = 0.41142848486080763
Train: epoch: 1, loss = 0.4093000015169382
Train: epoch: 1, loss = 0.40793106937160095
Train: epoch: 1, loss = 0.4069155896242176
Train: epoch: 1, loss = 0.405241508660838
Train: epoch: 1, loss = 0.4034349984013372
Train: epoch: 1, loss = 0.40188974257558585
Train: epoch: 1, loss = 0.40042267399078063
Train: epoch: 1, loss = 0.39901553113013505
Train: epoch: 1, loss = 0.398025297579857
Train: epoch: 1, loss = 0.39703925041747945
Train: epoch: 1, loss = 0.39587102374931177
Train: epoch: 1, loss = 0.3943244509259239
Train: epoch: 1, loss = 0.39290784018004643
Train: epoch: 1, loss = 0.3919092689909869
Train:  Epoch 1, Loss=0.39149331657091774, AUC-ROC Macro=0.6618333109448018, AUC-ROC Micro=0.7505102755823266
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3729432250062625, AUC-ROC Macro=0.7172254773626169, AUC-ROC Micro=0.779892784029139
Eval task: 2
Eval:  Epoch 1, Loss=0.3077542595565319, AUC-ROC Macro=0.48493898658830636, AUC-ROC Micro=0.5432481387172526
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3636597426235676
Train: epoch: 2, loss = 0.36757852148264647
Train: epoch: 2, loss = 0.36739038420220216
Train: epoch: 2, loss = 0.36915802417322996
Train: epoch: 2, loss = 0.3686960013061762
Train: epoch: 2, loss = 0.3691243079180519
Train: epoch: 2, loss = 0.36907517722674776
Train: epoch: 2, loss = 0.3678591384086758
Train: epoch: 2, loss = 0.3674279729442464
Train: epoch: 2, loss = 0.3669414803162217
Train: epoch: 2, loss = 0.3670717338133942
Train: epoch: 2, loss = 0.36734276021520296
Train: epoch: 2, loss = 0.36728180304169655
Train: epoch: 2, loss = 0.36732331916689875
Train: epoch: 2, loss = 0.367053554619352
Train: epoch: 2, loss = 0.3672473887214437
Train: epoch: 2, loss = 0.3671538293931414
Train: epoch: 2, loss = 0.3673545290074415
Train:  Epoch 2, Loss=0.36725094035955574, AUC-ROC Macro=0.7274700189850404, AUC-ROC Micro=0.7932428299530816
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3591503786544005, AUC-ROC Macro=0.744037337003768, AUC-ROC Micro=0.8018327400433987
Eval task: 2
Eval:  Epoch 2, Loss=0.3319669999182224, AUC-ROC Macro=0.4789940268030917, AUC-ROC Micro=0.5624939394024657
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3639199189096689
Train: epoch: 3, loss = 0.36220799945294857
Train: epoch: 3, loss = 0.36142066289981206
Train: epoch: 3, loss = 0.36073632169514896
Train: epoch: 3, loss = 0.3578282646536827
Train: epoch: 3, loss = 0.357230893522501
Train: epoch: 3, loss = 0.35710510091057845
Train: epoch: 3, loss = 0.35810991580598056
Train: epoch: 3, loss = 0.35913874270187485
Train: epoch: 3, loss = 0.3588874718621373
Train: epoch: 3, loss = 0.35854184413498097
Train: epoch: 3, loss = 0.35895347988853854
Train: epoch: 3, loss = 0.3584573455154896
Train: epoch: 3, loss = 0.3585488145000168
Train: epoch: 3, loss = 0.35870542137821515
Train: epoch: 3, loss = 0.3583496782137081
Train: epoch: 3, loss = 0.3586648037942017
Train: epoch: 3, loss = 0.35858536285658676
Train:  Epoch 3, Loss=0.3585323394893581, AUC-ROC Macro=0.7471100505268812, AUC-ROC Micro=0.806478405292711
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3567439764738083, AUC-ROC Macro=0.7513800428941947, AUC-ROC Micro=0.8066708870579485
Eval task: 2
Eval:  Epoch 3, Loss=0.3320794627070427, AUC-ROC Macro=0.47954154022969286, AUC-ROC Micro=0.5668259894912966
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3551020173728466
Train: epoch: 4, loss = 0.3574100597575307
Train: epoch: 4, loss = 0.35752110615372656
Train: epoch: 4, loss = 0.35539378399029375
Train: epoch: 4, loss = 0.35454182571172715
Train: epoch: 4, loss = 0.354714664456745
Train: epoch: 4, loss = 0.3545746012032032
Train: epoch: 4, loss = 0.35490438805893065
Train: epoch: 4, loss = 0.354795590730177
Train: epoch: 4, loss = 0.35474348440021275
Train: epoch: 4, loss = 0.3545711637965657
Train: epoch: 4, loss = 0.35404868016640345
Train: epoch: 4, loss = 0.35466298272403385
Train: epoch: 4, loss = 0.3549387175696237
Train: epoch: 4, loss = 0.3547968301276366
Train: epoch: 4, loss = 0.3538998812576756
Train: epoch: 4, loss = 0.3538153960643446
Train: epoch: 4, loss = 0.3536309228506353
Train:  Epoch 4, Loss=0.35360096462771423, AUC-ROC Macro=0.7578966862582253, AUC-ROC Micro=0.813687588276652
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3532523314158122, AUC-ROC Macro=0.7571979176797928, AUC-ROC Micro=0.8110765876588478
Eval task: 2
Eval:  Epoch 4, Loss=0.3365480899810791, AUC-ROC Macro=0.48068003033151674, AUC-ROC Micro=0.5490733941766655
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.35475123308598994
Train: epoch: 5, loss = 0.3556664215400815
Train: epoch: 5, loss = 0.35170879706740377
Train: epoch: 5, loss = 0.35164304010570047
Train: epoch: 5, loss = 0.3520424975305796
Train: epoch: 5, loss = 0.35188543212910495
Train: epoch: 5, loss = 0.35146544568240645
Train: epoch: 5, loss = 0.3514641895052046
Train: epoch: 5, loss = 0.35085476367837853
Train: epoch: 5, loss = 0.3504641374275088
Train: epoch: 5, loss = 0.35025298909707503
Train: epoch: 5, loss = 0.3498780655240019
Train: epoch: 5, loss = 0.34985056630120825
Train: epoch: 5, loss = 0.3496153357837881
Train: epoch: 5, loss = 0.34987925302485623
Train: epoch: 5, loss = 0.3497380249388516
Train: epoch: 5, loss = 0.34962158374050084
Train: epoch: 5, loss = 0.34962060566577646
Train:  Epoch 5, Loss=0.3497183509402805, AUC-ROC Macro=0.7660172165673871, AUC-ROC Micro=0.8191770540753673
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35108404109875363, AUC-ROC Macro=0.7605487786461101, AUC-ROC Micro=0.8139391391067704
Eval task: 2
Eval:  Epoch 5, Loss=0.34502602368593216, AUC-ROC Macro=0.47318794598279973, AUC-ROC Micro=0.5544192362681886
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34696534551680086
Train: epoch: 6, loss = 0.3486276550590992
Train: epoch: 6, loss = 0.3455360081543525
Train: epoch: 6, loss = 0.3464651348628104
Train: epoch: 6, loss = 0.34696272207796575
Train: epoch: 6, loss = 0.3468566603337725
Train: epoch: 6, loss = 0.3471891968271562
Train: epoch: 6, loss = 0.34706549265421927
Train: epoch: 6, loss = 0.3474685724824667
Train: epoch: 6, loss = 0.34655072253942487
Train: epoch: 6, loss = 0.34651465416631916
Train: epoch: 6, loss = 0.3463809606184562
Train: epoch: 6, loss = 0.34630929905061536
Train: epoch: 6, loss = 0.3464311848580837
Train: epoch: 6, loss = 0.34611987494428953
Train: epoch: 6, loss = 0.3462421402614564
Train: epoch: 6, loss = 0.3462845521025798
Train: epoch: 6, loss = 0.3463547247979376
Train:  Epoch 6, Loss=0.3465041598234421, AUC-ROC Macro=0.7722689923791007, AUC-ROC Micro=0.8235506481871739
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3496921857198079, AUC-ROC Macro=0.7631564494779985, AUC-ROC Micro=0.8159925817770834
Eval task: 2
Eval:  Epoch 6, Loss=0.3561386950314045, AUC-ROC Macro=0.47576634958285047, AUC-ROC Micro=0.5774231374428315
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3514806168774764, AUC-ROC Macro=0.7651668058917146, AUC-ROC Micro=0.8165229964788936
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3545660972595215, AUC-ROC Macro=0.48486485827036474, AUC-ROC Micro=0.5792291038768602
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2826334157586098
Train: epoch: 1, loss = 0.2732176695019007
Train: epoch: 1, loss = 0.2688536146779855
Train: epoch: 1, loss = 0.26678518587723377
Train: epoch: 1, loss = 0.26494267424941065
Train: epoch: 1, loss = 0.25983426968256634
Train:  Epoch 1, Loss=0.257090796317373, AUC-ROC Macro=0.5896129262687532, AUC-ROC Micro=0.7461304905077011
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3930058740079403, AUC-ROC Macro=0.7020915779583418, AUC-ROC Micro=0.7548511845277344
Eval task: 2
Eval:  Epoch 1, Loss=0.2579585164785385, AUC-ROC Macro=0.6779020827240404, AUC-ROC Micro=0.7850531689946065
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.25032767742872236
Train: epoch: 2, loss = 0.25134213488548995
Train: epoch: 2, loss = 0.25159412356714406
Train: epoch: 2, loss = 0.2513749806024134
Train: epoch: 2, loss = 0.25196801491081716
Train: epoch: 2, loss = 0.24711827490478755
Train:  Epoch 2, Loss=0.2439847856358797, AUC-ROC Macro=0.6802269496666683, AUC-ROC Micro=0.794553854255031
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36100078125794727, AUC-ROC Macro=0.7447306240016678, AUC-ROC Micro=0.7981545064605126
Eval task: 2
Eval:  Epoch 2, Loss=0.2457045279443264, AUC-ROC Macro=0.7026454295856874, AUC-ROC Micro=0.8017622912861666
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.24645210824906827
Train: epoch: 3, loss = 0.2466127215884626
Train: epoch: 3, loss = 0.24612679875145355
Train: epoch: 3, loss = 0.24574099156074225
Train: epoch: 3, loss = 0.24680903102457524
Train: epoch: 3, loss = 0.2414409069592754
Train:  Epoch 3, Loss=0.238810839263824, AUC-ROC Macro=0.7091210145380797, AUC-ROC Micro=0.8083583438953639
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3613637052476406, AUC-ROC Macro=0.741126476750761, AUC-ROC Micro=0.7945436540204123
Eval task: 2
Eval:  Epoch 3, Loss=0.242539394646883, AUC-ROC Macro=0.711808818273808, AUC-ROC Micro=0.8079573987743931
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.24196941733360292
Train: epoch: 4, loss = 0.2438165857642889
Train: epoch: 4, loss = 0.24235906784733136
Train: epoch: 4, loss = 0.24214534463360907
Train: epoch: 4, loss = 0.2425143234729767
Train: epoch: 4, loss = 0.2369538338109851
Train:  Epoch 4, Loss=0.23503258884532646, AUC-ROC Macro=0.7257191802736982, AUC-ROC Micro=0.817628805368001
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3587746632595857, AUC-ROC Macro=0.7436287816887054, AUC-ROC Micro=0.7989327145444473
Eval task: 2
Eval:  Epoch 4, Loss=0.24282857030630112, AUC-ROC Macro=0.7155634425531189, AUC-ROC Micro=0.8111449395434926
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.23843762308359145
Train: epoch: 5, loss = 0.24034370508044958
Train: epoch: 5, loss = 0.24091444694747527
Train: epoch: 5, loss = 0.23980503383092583
Train: epoch: 5, loss = 0.2392004965096712
Train: epoch: 5, loss = 0.23372264940912524
Train:  Epoch 5, Loss=0.2312345009355645, AUC-ROC Macro=0.7395154284278849, AUC-ROC Micro=0.8258754841466738
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3581407355765502, AUC-ROC Macro=0.7387692358330682, AUC-ROC Micro=0.7955252170719905
Eval task: 2
Eval:  Epoch 5, Loss=0.24091965705156326, AUC-ROC Macro=0.7193960211785363, AUC-ROC Micro=0.8165408354929781
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2395230943709612
Train: epoch: 6, loss = 0.2377713220566511
Train: epoch: 6, loss = 0.2355142380669713
Train: epoch: 6, loss = 0.23524945015087723
Train: epoch: 6, loss = 0.23635474814474583
Train: epoch: 6, loss = 0.23144394993782044
Train:  Epoch 6, Loss=0.22860791594926866, AUC-ROC Macro=0.7553189497677176, AUC-ROC Micro=0.8329353093739197
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35530229037006694, AUC-ROC Macro=0.7402822524856782, AUC-ROC Micro=0.7961474534043846
Eval task: 2
Eval:  Epoch 6, Loss=0.23679612576961517, AUC-ROC Macro=0.7292627820554125, AUC-ROC Micro=0.8204958929908932
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.36984435717264813, AUC-ROC Macro=0.7406081680811308, AUC-ROC Micro=0.7957173036489253
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2128436639904976, AUC-ROC Macro=0.7239823308242523, AUC-ROC Micro=0.8194076207369724
{'0': {'precision': 0.55625, 'recall': 0.34021406727828746, 'f1-score': 0.4222011385199241, 'support': 1308}, '1': {'precision': 0.6585365853658537, 'recall': 0.26865671641791045, 'f1-score': 0.38162544169611307, 'support': 402}, '2': {'precision': 0.44036697247706424, 'recall': 0.0729483282674772, 'f1-score': 0.12516297262059975, 'support': 658}, '3': {'precision': 0.5166487647690655, 'recall': 0.24170854271356784, 'f1-score': 0.32933926737418695, 'support': 1990}, '4': {'precision': 0.3939393939393939, 'recall': 0.16129032258064516, 'f1-score': 0.22887323943661975, 'support': 806}, '5': {'precision': 0.39849624060150374, 'recall': 0.06812339331619537, 'f1-score': 0.11635565312843028, 'support': 778}, '6': {'precision': 0.5555555555555556, 'recall': 0.1728110599078341, 'f1-score': 0.2636203866432338, 'support': 1302}, '7': {'precision': 0.23076923076923078, 'recall': 0.007075471698113208, 'f1-score': 0.013729977116704805, 'support': 424}, '8': {'precision': 0.5015174506828528, 'recall': 0.40206812652068125, 'f1-score': 0.4463200540175557, 'support': 1644}, '9': {'precision': 0.6395806028833552, 'recall': 0.48055145248645986, 'f1-score': 0.5487770593196514, 'support': 2031}, '10': {'precision': 0.6161290322580645, 'recall': 0.3333333333333333, 'f1-score': 0.4326160815402038, 'support': 573}, '11': {'precision': 0.5078947368421053, 'recall': 0.1641156462585034, 'f1-score': 0.2480719794344473, 'support': 1176}, '12': {'precision': 0.568407960199005, 'recall': 0.25819209039548024, 'f1-score': 0.3550893550893551, 'support': 1770}, '13': {'precision': 0.5944005743000718, 'recall': 0.3189522342064715, 'f1-score': 0.4151416395086488, 'support': 2596}, '14': {'precision': 0.5693581780538303, 'recall': 0.16902274124154887, 'f1-score': 0.2606635071090047, 'support': 1627}, '15': {'precision': 0.16666666666666666, 'recall': 0.002066115702479339, 'f1-score': 0.004081632653061225, 'support': 484}, '16': {'precision': 0.40625, 'recall': 0.13081761006289308, 'f1-score': 0.19790675547098005, 'support': 795}, '17': {'precision': 0.4421052631578947, 'recall': 0.07720588235294118, 'f1-score': 0.13145539906103287, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.5, 'recall': 0.04198473282442748, 'f1-score': 0.07746478873239436, 'support': 262}, '20': {'precision': 0.16666666666666666, 'recall': 0.0017761989342806395, 'f1-score': 0.00351493848857645, 'support': 563}, '21': {'precision': 0.5231958762886598, 'recall': 0.24253285543608125, 'f1-score': 0.3314285714285714, 'support': 837}, '22': {'precision': 0.6838235294117647, 'recall': 0.5138121546961326, 'f1-score': 0.586750788643533, 'support': 1086}, '23': {'precision': 0.5879732739420935, 'recall': 0.30662020905923343, 'f1-score': 0.4030534351145038, 'support': 861}, '24': {'precision': 0.513986013986014, 'recall': 0.29108910891089107, 'f1-score': 0.3716814159292035, 'support': 505}, 'micro avg': {'precision': 0.5607108465376871, 'recall': 0.252433689354826, 'f1-score': 0.34813566692031744, 'support': 25373}, 'macro avg': {'precision': 0.4695407427526685, 'recall': 0.20267873578407478, 'f1-score': 0.2677970191230614, 'support': 25373}, 'weighted avg': {'precision': 0.5172251585140696, 'recall': 0.252433689354826, 'f1-score': 0.32665207478545183, 'support': 25373}, 'samples avg': {'precision': 0.3603066918252465, 'recall': 0.22092420665059684, 'f1-score': 0.24968814129895642, 'support': 25373}}
{'0': {'precision': 0.6040955631399317, 'recall': 0.423444976076555, 'f1-score': 0.4978902953586498, 'support': 418}, '1': {'precision': 0.6521739130434783, 'recall': 0.1388888888888889, 'f1-score': 0.22900763358778628, 'support': 216}, '2': {'precision': 0.6666666666666666, 'recall': 0.006944444444444444, 'f1-score': 0.013745704467353952, 'support': 288}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 252}, '4': {'precision': 0.36363636363636365, 'recall': 0.09722222222222222, 'f1-score': 0.15342465753424658, 'support': 288}, '5': {'precision': 0.47619047619047616, 'recall': 0.03717472118959108, 'f1-score': 0.06896551724137931, 'support': 269}, '6': {'precision': 0.42105263157894735, 'recall': 0.028268551236749116, 'f1-score': 0.052980132450331126, 'support': 283}, '7': {'precision': 0.7910447761194029, 'recall': 0.41568627450980394, 'f1-score': 0.544987146529563, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.5882352941176471, 'recall': 0.0423728813559322, 'f1-score': 0.07905138339920949, 'support': 236}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 183}, '11': {'precision': 0.75, 'recall': 0.014354066985645933, 'f1-score': 0.028169014084507046, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.5384615384615384, 'recall': 0.06306306306306306, 'f1-score': 0.1129032258064516, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.6320754716981132, 'recall': 0.7444444444444445, 'f1-score': 0.6836734693877551, 'support': 90}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.6095238095238096, 'recall': 0.11786372007366483, 'f1-score': 0.19753086419753085, 'support': 3801}, 'macro avg': {'precision': 0.2593453077861026, 'recall': 0.08047458137669362, 'f1-score': 0.09859192719388934, 'support': 3801}, 'weighted avg': {'precision': 0.4081315145260482, 'recall': 0.11786372007366483, 'f1-score': 0.15176322054539362, 'support': 3801}, 'samples avg': {'precision': 0.1990478515625, 'recall': 0.1393281482514881, 'f1-score': 0.15386672247023808, 'support': 3801}}