
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43169403716921806
Train: epoch: 1, loss = 0.4189180791378021
Train: epoch: 1, loss = 0.4143290272851785
Train: epoch: 1, loss = 0.411032062061131
Train: epoch: 1, loss = 0.4109628814458847
Train: epoch: 1, loss = 0.40899603967865306
Train: epoch: 1, loss = 0.4069771704716342
Train: epoch: 1, loss = 0.40470284666866063
Train: epoch: 1, loss = 0.4031104160183006
Train: epoch: 1, loss = 0.40201075468957426
Train: epoch: 1, loss = 0.4008328475193544
Train: epoch: 1, loss = 0.39963681779801846
Train: epoch: 1, loss = 0.39796174060839873
Train: epoch: 1, loss = 0.3970022743408169
Train: epoch: 1, loss = 0.39589657927552857
Train: epoch: 1, loss = 0.3945841249683872
Train: epoch: 1, loss = 0.39332359091762237
Train: epoch: 1, loss = 0.39213607263233924
Train:  Epoch 1, Loss=0.39179390391732893, AUC-ROC Macro=0.6598270492213097, AUC-ROC Micro=0.7499326678932835
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3710109715660413, AUC-ROC Macro=0.7173525296324218, AUC-ROC Micro=0.7826594812207279
Eval task: 2
Eval:  Epoch 1, Loss=0.3311042994260788, AUC-ROC Macro=0.48828710787457086, AUC-ROC Micro=0.5561654818692383
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3737372078746557
Train: epoch: 2, loss = 0.369840856641531
Train: epoch: 2, loss = 0.36862182420988876
Train: epoch: 2, loss = 0.36935218766331673
Train: epoch: 2, loss = 0.36919032016396525
Train: epoch: 2, loss = 0.36964740718404454
Train: epoch: 2, loss = 0.3697701776453427
Train: epoch: 2, loss = 0.3692058994155377
Train: epoch: 2, loss = 0.3692808430310753
Train: epoch: 2, loss = 0.36916942191123964
Train: epoch: 2, loss = 0.3695446496253664
Train: epoch: 2, loss = 0.36919637261579435
Train: epoch: 2, loss = 0.36910051718354225
Train: epoch: 2, loss = 0.36874456864914723
Train: epoch: 2, loss = 0.36850263925890125
Train: epoch: 2, loss = 0.36824027021881195
Train: epoch: 2, loss = 0.3682774292589987
Train: epoch: 2, loss = 0.3680127452851997
Train:  Epoch 2, Loss=0.36805274989462305, AUC-ROC Macro=0.725664538664776, AUC-ROC Micro=0.7920153866854853
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3612946569919586, AUC-ROC Macro=0.7409601174981529, AUC-ROC Micro=0.7990925092030394
Eval task: 2
Eval:  Epoch 2, Loss=0.3552883923053741, AUC-ROC Macro=0.471644810256202, AUC-ROC Micro=0.5476182841088203
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3636100359261036
Train: epoch: 3, loss = 0.3668365266174078
Train: epoch: 3, loss = 0.36274569630622866
Train: epoch: 3, loss = 0.36338365089148283
Train: epoch: 3, loss = 0.36196152283251287
Train: epoch: 3, loss = 0.36143481723964216
Train: epoch: 3, loss = 0.36092114675257886
Train: epoch: 3, loss = 0.36188832465559245
Train: epoch: 3, loss = 0.3620133751216862
Train: epoch: 3, loss = 0.36183118468523023
Train: epoch: 3, loss = 0.36170862478966065
Train: epoch: 3, loss = 0.3612945424579084
Train: epoch: 3, loss = 0.3617451480948008
Train: epoch: 3, loss = 0.3614752705608095
Train: epoch: 3, loss = 0.36133615505695343
Train: epoch: 3, loss = 0.3610738239530474
Train: epoch: 3, loss = 0.3605798727317768
Train: epoch: 3, loss = 0.36023919337739546
Train:  Epoch 3, Loss=0.36016764737601975, AUC-ROC Macro=0.7442391105848181, AUC-ROC Micro=0.8042532996803065
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35719191407163936, AUC-ROC Macro=0.7483013604187525, AUC-ROC Micro=0.8051085763362229
Eval task: 2
Eval:  Epoch 3, Loss=0.3676682382822037, AUC-ROC Macro=0.46558023648442437, AUC-ROC Micro=0.5312652804351563
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3607478090375662
Train: epoch: 4, loss = 0.3542113921418786
Train: epoch: 4, loss = 0.35475066512823106
Train: epoch: 4, loss = 0.35187360242009164
Train: epoch: 4, loss = 0.3518644223064184
Train: epoch: 4, loss = 0.3530461544170976
Train: epoch: 4, loss = 0.35353940694459846
Train: epoch: 4, loss = 0.35456488776020706
Train: epoch: 4, loss = 0.35502553974588713
Train: epoch: 4, loss = 0.3545524828284979
Train: epoch: 4, loss = 0.35451558967882935
Train: epoch: 4, loss = 0.3544992043512563
Train: epoch: 4, loss = 0.35432092803028914
Train: epoch: 4, loss = 0.354945121130773
Train: epoch: 4, loss = 0.35482109619180363
Train: epoch: 4, loss = 0.3549787062918767
Train: epoch: 4, loss = 0.3548778576535337
Train: epoch: 4, loss = 0.35503056188424426
Train:  Epoch 4, Loss=0.3551931325961382, AUC-ROC Macro=0.754983312664138, AUC-ROC Micro=0.8115980487849782
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35340161621570587, AUC-ROC Macro=0.7552284778725264, AUC-ROC Micro=0.8105325178853414
Eval task: 2
Eval:  Epoch 4, Loss=0.38409633934497833, AUC-ROC Macro=0.4657434121349658, AUC-ROC Micro=0.5327122030155457
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.353026714399457
Train: epoch: 5, loss = 0.3521257437765598
Train: epoch: 5, loss = 0.3503539003431797
Train: epoch: 5, loss = 0.3509481885097921
Train: epoch: 5, loss = 0.35163281528651713
Train: epoch: 5, loss = 0.3512362024684747
Train: epoch: 5, loss = 0.351447741783091
Train: epoch: 5, loss = 0.3514014654606581
Train: epoch: 5, loss = 0.3517360264145666
Train: epoch: 5, loss = 0.35166065439581873
Train: epoch: 5, loss = 0.35116107829592447
Train: epoch: 5, loss = 0.3511227309331298
Train: epoch: 5, loss = 0.35112211866447557
Train: epoch: 5, loss = 0.3512840191594192
Train: epoch: 5, loss = 0.351089682896932
Train: epoch: 5, loss = 0.3511626578355208
Train: epoch: 5, loss = 0.35111916525398984
Train: epoch: 5, loss = 0.35106978963232705
Train:  Epoch 5, Loss=0.35112372072333964, AUC-ROC Macro=0.7634246126991445, AUC-ROC Micro=0.8173300694204032
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3514941061536471, AUC-ROC Macro=0.760461469076719, AUC-ROC Micro=0.8140371233749019
Eval task: 2
Eval:  Epoch 5, Loss=0.38981570601463317, AUC-ROC Macro=0.47177959606732967, AUC-ROC Micro=0.5447190329083603
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34680060811340807
Train: epoch: 6, loss = 0.3417605333775282
Train: epoch: 6, loss = 0.3441137671470642
Train: epoch: 6, loss = 0.34501488715410233
Train: epoch: 6, loss = 0.3467278168946505
Train: epoch: 6, loss = 0.34818835884332655
Train: epoch: 6, loss = 0.3481674197954791
Train: epoch: 6, loss = 0.34756289440207183
Train: epoch: 6, loss = 0.34742388928102125
Train: epoch: 6, loss = 0.34755461851507424
Train: epoch: 6, loss = 0.3469731536710804
Train: epoch: 6, loss = 0.34688430634637674
Train: epoch: 6, loss = 0.34705889102358084
Train: epoch: 6, loss = 0.34746031253465587
Train: epoch: 6, loss = 0.3471951855619748
Train: epoch: 6, loss = 0.3475927483756095
Train: epoch: 6, loss = 0.34765933230081025
Train: epoch: 6, loss = 0.34731439639710715
Train:  Epoch 6, Loss=0.3475255627509875, AUC-ROC Macro=0.7705282683043245, AUC-ROC Micro=0.8223582640296387
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3503091633319855, AUC-ROC Macro=0.7627988162218479, AUC-ROC Micro=0.8151745369464793
Eval task: 2
Eval:  Epoch 6, Loss=0.39861395955085754, AUC-ROC Macro=0.469372724125228, AUC-ROC Micro=0.5262520423363832
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35289118563135463, AUC-ROC Macro=0.7632416211942551, AUC-ROC Micro=0.8144325434818297
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3954701006412506, AUC-ROC Macro=0.466197642805686, AUC-ROC Micro=0.5306337407293459
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.30103126235306266
Train: epoch: 1, loss = 0.2896262642741203
Train: epoch: 1, loss = 0.28440816146632036
Train: epoch: 1, loss = 0.28009134348481896
Train: epoch: 1, loss = 0.27710189986228945
Train: epoch: 1, loss = 0.274215421328942
Train: epoch: 1, loss = 0.2721191336108105
Train:  Epoch 1, Loss=0.2707478367449502, AUC-ROC Macro=0.6281608809913617, AUC-ROC Micro=0.7588656867510541
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3633001943429311, AUC-ROC Macro=0.7438475826220485, AUC-ROC Micro=0.8006344267925701
Eval task: 2
Eval:  Epoch 1, Loss=0.25146334916353225, AUC-ROC Macro=0.7022591924551097, AUC-ROC Micro=0.7948866918512463
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.26146947138011456
Train: epoch: 2, loss = 0.2577382945641875
Train: epoch: 2, loss = 0.2566272699087858
Train: epoch: 2, loss = 0.25596283122897145
Train: epoch: 2, loss = 0.25570599284768103
Train: epoch: 2, loss = 0.25571864252289134
Train: epoch: 2, loss = 0.2556024410149881
Train:  Epoch 2, Loss=0.2544572501545622, AUC-ROC Macro=0.710265957040549, AUC-ROC Micro=0.8057136368731294
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3605824187397957, AUC-ROC Macro=0.7475316917577763, AUC-ROC Micro=0.8048135271702683
Eval task: 2
Eval:  Epoch 2, Loss=0.24578444063663482, AUC-ROC Macro=0.7218841662211257, AUC-ROC Micro=0.8069671226889673
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.24668067768216134
Train: epoch: 3, loss = 0.2479077896475792
Train: epoch: 3, loss = 0.2477962902933359
Train: epoch: 3, loss = 0.24789302034303545
Train: epoch: 3, loss = 0.24853440600633622
Train: epoch: 3, loss = 0.24848999843001365
Train: epoch: 3, loss = 0.24931925264852386
Train:  Epoch 3, Loss=0.24895300514945126, AUC-ROC Macro=0.7352412189653492, AUC-ROC Micro=0.8190257887275455
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.36053547884027165, AUC-ROC Macro=0.7491672676797154, AUC-ROC Micro=0.8033357166957694
Eval task: 2
Eval:  Epoch 3, Loss=0.24269385933876036, AUC-ROC Macro=0.7300888890969329, AUC-ROC Micro=0.8140377970435582
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.24652313344180585
Train: epoch: 4, loss = 0.24336771320551634
Train: epoch: 4, loss = 0.2434134764969349
Train: epoch: 4, loss = 0.2446609535627067
Train: epoch: 4, loss = 0.24518029928207397
Train: epoch: 4, loss = 0.24559446406240265
Train: epoch: 4, loss = 0.2460404868211065
Train:  Epoch 4, Loss=0.24505753195062197, AUC-ROC Macro=0.7543883207662135, AUC-ROC Micro=0.8279075565782674
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3606765841444333, AUC-ROC Macro=0.7481090843015785, AUC-ROC Micro=0.8024826480572668
Eval task: 2
Eval:  Epoch 4, Loss=0.24068618267774583, AUC-ROC Macro=0.7351842971548868, AUC-ROC Micro=0.8168368710189069
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.24202640794217586
Train: epoch: 5, loss = 0.2417982194572687
Train: epoch: 5, loss = 0.2405999507009983
Train: epoch: 5, loss = 0.24127262778580189
Train: epoch: 5, loss = 0.2417410261258483
Train: epoch: 5, loss = 0.2418655091089507
Train: epoch: 5, loss = 0.2421983506477305
Train:  Epoch 5, Loss=0.24177825719975568, AUC-ROC Macro=0.7679116553320132, AUC-ROC Micro=0.8353939362871777
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.36328181127707165, AUC-ROC Macro=0.7456419711177007, AUC-ROC Micro=0.7991691814007857
Eval task: 2
Eval:  Epoch 5, Loss=0.24076394736766815, AUC-ROC Macro=0.7386051756316437, AUC-ROC Micro=0.8198539675799958
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.23692487239837645
Train: epoch: 6, loss = 0.23791372556239365
Train: epoch: 6, loss = 0.23850441350291174
Train: epoch: 6, loss = 0.2391083330102265
Train: epoch: 6, loss = 0.2394958961904049
Train: epoch: 6, loss = 0.239166187706093
Train: epoch: 6, loss = 0.2390607383634363
Train:  Epoch 6, Loss=0.23834328509025138, AUC-ROC Macro=0.7776968485975445, AUC-ROC Micro=0.840908923094123
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3621349558234215, AUC-ROC Macro=0.7446827794536146, AUC-ROC Micro=0.7981891595886144
Eval task: 2
Eval:  Epoch 6, Loss=0.23743143677711487, AUC-ROC Macro=0.7435029913586133, AUC-ROC Micro=0.8204977859272906
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3666958324611187, AUC-ROC Macro=0.7453779911957062, AUC-ROC Micro=0.7985561492240283
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.22826650142669677, AUC-ROC Macro=0.7457273951014939, AUC-ROC Micro=0.824208887866358
{'0': {'precision': 0.5423476968796433, 'recall': 0.2790519877675841, 'f1-score': 0.3685007571933367, 'support': 1308}, '1': {'precision': 0.5786350148367952, 'recall': 0.48507462686567165, 'f1-score': 0.5277401894451962, 'support': 402}, '2': {'precision': 0.618421052631579, 'recall': 0.07142857142857142, 'f1-score': 0.12806539509536785, 'support': 658}, '3': {'precision': 0.4987674609695974, 'recall': 0.3050251256281407, 'f1-score': 0.3785469285937013, 'support': 1990}, '4': {'precision': 0.47601476014760147, 'recall': 0.1600496277915633, 'f1-score': 0.23955431754874654, 'support': 806}, '5': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 778}, '6': {'precision': 0.47950089126559714, 'recall': 0.206605222734255, 'f1-score': 0.28878153515834676, 'support': 1302}, '7': {'precision': 0.3125, 'recall': 0.03537735849056604, 'f1-score': 0.0635593220338983, 'support': 424}, '8': {'precision': 0.5264207377866401, 'recall': 0.32116788321167883, 'f1-score': 0.39894219871552705, 'support': 1644}, '9': {'precision': 0.6530072703238599, 'recall': 0.48645987198424423, 'f1-score': 0.5575620767494356, 'support': 2031}, '10': {'precision': 0.6259259259259259, 'recall': 0.2949389179755672, 'f1-score': 0.40094899169632264, 'support': 573}, '11': {'precision': 0.492619926199262, 'recall': 0.22704081632653061, 'f1-score': 0.3108265424912689, 'support': 1176}, '12': {'precision': 0.5542635658914729, 'recall': 0.3231638418079096, 'f1-score': 0.40827980014275517, 'support': 1770}, '13': {'precision': 0.5957324106113033, 'recall': 0.39791987673343604, 'f1-score': 0.47713625866050813, 'support': 2596}, '14': {'precision': 0.5045126353790613, 'recall': 0.3435771358328211, 'f1-score': 0.40877513711151736, 'support': 1627}, '15': {'precision': 0.2903225806451613, 'recall': 0.01859504132231405, 'f1-score': 0.03495145631067961, 'support': 484}, '16': {'precision': 0.44609665427509293, 'recall': 0.1509433962264151, 'f1-score': 0.22556390977443608, 'support': 795}, '17': {'precision': 0.4606741573033708, 'recall': 0.07536764705882353, 'f1-score': 0.12954186413902052, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.6, 'recall': 0.011450381679389313, 'f1-score': 0.022471910112359553, 'support': 262}, '20': {'precision': 0.3333333333333333, 'recall': 0.03907637655417407, 'f1-score': 0.0699523052464229, 'support': 563}, '21': {'precision': 0.5379537953795379, 'recall': 0.19474313022700118, 'f1-score': 0.28596491228070176, 'support': 837}, '22': {'precision': 0.6946182728410513, 'recall': 0.511049723756906, 'f1-score': 0.5888594164456233, 'support': 1086}, '23': {'precision': 0.554140127388535, 'recall': 0.30313588850174217, 'f1-score': 0.3918918918918919, 'support': 861}, '24': {'precision': 0.5384615384615384, 'recall': 0.29108910891089107, 'f1-score': 0.37789203084832906, 'support': 505}, 'micro avg': {'precision': 0.5564395431272154, 'recall': 0.27840617979742244, 'f1-score': 0.3711253546285594, 'support': 25373}, 'macro avg': {'precision': 0.47657079233903843, 'recall': 0.22129326235264787, 'f1-score': 0.28337236590741577, 'support': 25373}, 'weighted avg': {'precision': 0.5125261203115753, 'recall': 0.27840617979742244, 'f1-score': 0.34906249336510925, 'support': 25373}, 'samples avg': {'precision': 0.37043145430596597, 'recall': 0.2499704136264913, 'f1-score': 0.2714401895426493, 'support': 25373}}
{'0': {'precision': 0.6566265060240963, 'recall': 0.3956442831215971, 'f1-score': 0.493771234428086, 'support': 551}, '1': {'precision': 0.5993150684931506, 'recall': 0.2679938744257274, 'f1-score': 0.37037037037037035, 'support': 653}, '2': {'precision': 0.5, 'recall': 0.023474178403755867, 'f1-score': 0.04484304932735426, 'support': 426}, '3': {'precision': 0.4925373134328358, 'recall': 0.08068459657701711, 'f1-score': 0.13865546218487396, 'support': 409}, '4': {'precision': 0.37777777777777777, 'recall': 0.06938775510204082, 'f1-score': 0.11724137931034483, 'support': 245}, '5': {'precision': 0.6190476190476191, 'recall': 0.036312849162011177, 'f1-score': 0.06860158311345647, 'support': 358}, '6': {'precision': 0.6, 'recall': 0.012295081967213115, 'f1-score': 0.024096385542168676, 'support': 244}, '7': {'precision': 0.6864406779661016, 'recall': 0.2755102040816326, 'f1-score': 0.39320388349514557, 'support': 294}, '8': {'precision': 0.5, 'recall': 0.0038022813688212928, 'f1-score': 0.007547169811320754, 'support': 263}, '9': {'precision': 0.7333333333333333, 'recall': 0.07913669064748201, 'f1-score': 0.14285714285714285, 'support': 278}, '10': {'precision': 0.3333333333333333, 'recall': 0.004807692307692308, 'f1-score': 0.009478672985781991, 'support': 208}, '11': {'precision': 1.0, 'recall': 0.024096385542168676, 'f1-score': 0.047058823529411764, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.4230769230769231, 'recall': 0.08333333333333333, 'f1-score': 0.13924050632911392, 'support': 132}, '14': {'precision': 0.7435897435897436, 'recall': 0.12831858407079647, 'f1-score': 0.2188679245283019, 'support': 226}, '15': {'precision': 0.7857142857142857, 'recall': 0.5238095238095238, 'f1-score': 0.6285714285714286, 'support': 105}, '16': {'precision': 0.5909090909090909, 'recall': 0.09558823529411764, 'f1-score': 0.16455696202531644, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.6243194192377496, 'recall': 0.1276201075867186, 'f1-score': 0.2119205298013245, 'support': 5391}, 'macro avg': {'precision': 0.38566806690793165, 'recall': 0.08416782196859723, 'f1-score': 0.12035847913638474, 'support': 5391}, 'weighted avg': {'precision': 0.5324524096637069, 'recall': 0.1276201075867186, 'f1-score': 0.18106288937175274, 'support': 5391}, 'samples avg': {'precision': 0.2060345643939394, 'recall': 0.12507440476190473, 'f1-score': 0.1413603106962482, 'support': 5391}}