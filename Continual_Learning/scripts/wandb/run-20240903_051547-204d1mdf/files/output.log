
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest_baseline
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43226788520812987
Train: epoch: 1, loss = 0.42192644834518434
Train: epoch: 1, loss = 0.417046424249808
Train: epoch: 1, loss = 0.4147757397592068
Train: epoch: 1, loss = 0.41245605927705764
Train: epoch: 1, loss = 0.409975552012523
Train: epoch: 1, loss = 0.4076611305134637
Train: epoch: 1, loss = 0.40578443167731165
Train: epoch: 1, loss = 0.40422551899320547
Train: epoch: 1, loss = 0.40156009875983
Train: epoch: 1, loss = 0.4001415620947426
Train: epoch: 1, loss = 0.398934336360544
Train: epoch: 1, loss = 0.3975103622732254
Train: epoch: 1, loss = 0.39650278417659657
Train: epoch: 1, loss = 0.3952169111768405
Train: epoch: 1, loss = 0.3940121440635994
Train: epoch: 1, loss = 0.3928625860766453
Train: epoch: 1, loss = 0.39194468243254554
Train:  Epoch 1, Loss=0.39150153332693965, AUC-ROC Macro=0.6598343964051244, AUC-ROC Micro=0.75026057427815
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.370741531252861, AUC-ROC Macro=0.7176192004486407, AUC-ROC Micro=0.7823847514545968
Eval task: 2
Eval:  Epoch 1, Loss=0.3143753632903099, AUC-ROC Macro=0.494990419319884, AUC-ROC Micro=0.5830620586336195
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3681135796010494
Train: epoch: 2, loss = 0.37206851426512005
Train: epoch: 2, loss = 0.3730536961058776
Train: epoch: 2, loss = 0.3730976085923612
Train: epoch: 2, loss = 0.37209219942986965
Train: epoch: 2, loss = 0.3724937618523836
Train: epoch: 2, loss = 0.3727416629344225
Train: epoch: 2, loss = 0.37237104343250393
Train: epoch: 2, loss = 0.3724190905607409
Train: epoch: 2, loss = 0.371387219466269
Train: epoch: 2, loss = 0.37116147478195755
Train: epoch: 2, loss = 0.37136462635671097
Train: epoch: 2, loss = 0.3710499292955949
Train: epoch: 2, loss = 0.3704221134419952
Train: epoch: 2, loss = 0.3703029792010784
Train: epoch: 2, loss = 0.3697115655243397
Train: epoch: 2, loss = 0.36946652228779653
Train: epoch: 2, loss = 0.3693376652316915
Train:  Epoch 2, Loss=0.36924301324135217, AUC-ROC Macro=0.7225276303055648, AUC-ROC Micro=0.7898816855176405
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3640732690691948, AUC-ROC Macro=0.7369931014168308, AUC-ROC Micro=0.7954953869723522
Eval task: 2
Eval:  Epoch 2, Loss=0.33075254037976265, AUC-ROC Macro=0.4930908630011308, AUC-ROC Micro=0.5723976612989349
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36250895626842977
Train: epoch: 3, loss = 0.360320182479918
Train: epoch: 3, loss = 0.3615353721380234
Train: epoch: 3, loss = 0.36291267031803726
Train: epoch: 3, loss = 0.3624492349177599
Train: epoch: 3, loss = 0.3628414657091101
Train: epoch: 3, loss = 0.36341165357402394
Train: epoch: 3, loss = 0.363390936832875
Train: epoch: 3, loss = 0.3630962403366963
Train: epoch: 3, loss = 0.362131144694984
Train: epoch: 3, loss = 0.361905600448901
Train: epoch: 3, loss = 0.36187751347819963
Train: epoch: 3, loss = 0.36146491872003444
Train: epoch: 3, loss = 0.361069700957409
Train: epoch: 3, loss = 0.36112794398268067
Train: epoch: 3, loss = 0.3608657021168619
Train: epoch: 3, loss = 0.36062301512588474
Train: epoch: 3, loss = 0.36054806822703944
Train:  Epoch 3, Loss=0.36064363171504094, AUC-ROC Macro=0.7426578987668706, AUC-ROC Micro=0.8033664587850282
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3578491633137067, AUC-ROC Macro=0.748227984644931, AUC-ROC Micro=0.8041024473658911
Eval task: 2
Eval:  Epoch 3, Loss=0.3351772800087929, AUC-ROC Macro=0.47503594403758453, AUC-ROC Micro=0.5687384378762622
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.36513455033302306
Train: epoch: 4, loss = 0.3628612553328276
Train: epoch: 4, loss = 0.3606535980850458
Train: epoch: 4, loss = 0.35882465304806827
Train: epoch: 4, loss = 0.3589211100637913
Train: epoch: 4, loss = 0.35773044935117165
Train: epoch: 4, loss = 0.3580008530829634
Train: epoch: 4, loss = 0.35734140425920485
Train: epoch: 4, loss = 0.35656809387935534
Train: epoch: 4, loss = 0.35615542279928925
Train: epoch: 4, loss = 0.3562206754765727
Train: epoch: 4, loss = 0.3559741073536376
Train: epoch: 4, loss = 0.35498475956802183
Train: epoch: 4, loss = 0.3550872260012797
Train: epoch: 4, loss = 0.35551023079951605
Train: epoch: 4, loss = 0.35577575917355714
Train: epoch: 4, loss = 0.3552449541363646
Train: epoch: 4, loss = 0.3551610799920228
Train:  Epoch 4, Loss=0.3552493187851376, AUC-ROC Macro=0.7544527320962041, AUC-ROC Micro=0.8113409654731805
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35270513345797855, AUC-ROC Macro=0.757035816524096, AUC-ROC Micro=0.8118233947555624
Eval task: 2
Eval:  Epoch 4, Loss=0.33694908022880554, AUC-ROC Macro=0.48417286256817005, AUC-ROC Micro=0.5586824035667928
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3473223547637463
Train: epoch: 5, loss = 0.3487782984226942
Train: epoch: 5, loss = 0.3491002672413985
Train: epoch: 5, loss = 0.3495619964785874
Train: epoch: 5, loss = 0.3498999444544315
Train: epoch: 5, loss = 0.34964995173116525
Train: epoch: 5, loss = 0.34977483134184567
Train: epoch: 5, loss = 0.3506151341833174
Train: epoch: 5, loss = 0.3509347912917535
Train: epoch: 5, loss = 0.3509264883473516
Train: epoch: 5, loss = 0.35136979861692946
Train: epoch: 5, loss = 0.351485870461911
Train: epoch: 5, loss = 0.3519516905397177
Train: epoch: 5, loss = 0.35177248401833433
Train: epoch: 5, loss = 0.3518873937875032
Train: epoch: 5, loss = 0.35127189812250437
Train: epoch: 5, loss = 0.35107585722470985
Train: epoch: 5, loss = 0.3512069137063291
Train:  Epoch 5, Loss=0.35115238968938844, AUC-ROC Macro=0.7630270207558623, AUC-ROC Micro=0.8171048341699916
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35104843601584435, AUC-ROC Macro=0.7604380612050968, AUC-ROC Micro=0.8142021507034919
Eval task: 2
Eval:  Epoch 5, Loss=0.3345928117632866, AUC-ROC Macro=0.4755817213429324, AUC-ROC Micro=0.5515461767061506
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3488578759133816
Train: epoch: 6, loss = 0.3504297863692045
Train: epoch: 6, loss = 0.3490088794628779
Train: epoch: 6, loss = 0.34928487149998544
Train: epoch: 6, loss = 0.3489321861714125
Train: epoch: 6, loss = 0.3491875674203038
Train: epoch: 6, loss = 0.3500588644083057
Train: epoch: 6, loss = 0.3494508470967412
Train: epoch: 6, loss = 0.3490966398186154
Train: epoch: 6, loss = 0.3477626283019781
Train: epoch: 6, loss = 0.3474505852027373
Train: epoch: 6, loss = 0.34695659185449285
Train: epoch: 6, loss = 0.34690496469919496
Train: epoch: 6, loss = 0.3469998965518815
Train: epoch: 6, loss = 0.3470041015893221
Train: epoch: 6, loss = 0.3473293566890061
Train: epoch: 6, loss = 0.34750922193860306
Train: epoch: 6, loss = 0.3476638042098946
Train:  Epoch 6, Loss=0.3476593594815996, AUC-ROC Macro=0.7702362244291803, AUC-ROC Micro=0.8220276290264333
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35042310133576393, AUC-ROC Macro=0.7629246574733035, AUC-ROC Micro=0.8149853106535079
Eval task: 2
Eval:  Epoch 6, Loss=0.33443964645266533, AUC-ROC Macro=0.47708855371147235, AUC-ROC Micro=0.5425493956983968
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3526145915190379, AUC-ROC Macro=0.7620793573938554, AUC-ROC Micro=0.814469248834605
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3348826617002487, AUC-ROC Macro=0.4870165647108064, AUC-ROC Micro=0.5407907121127171
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.25659928560256956
Train: epoch: 1, loss = 0.24694377452135086
Train: epoch: 1, loss = 0.24159430727362632
Train: epoch: 1, loss = 0.23863564029335976
Train: epoch: 1, loss = 0.2367328440696001
Train: epoch: 1, loss = 0.23442305325220028
Train:  Epoch 1, Loss=0.23276166179863125, AUC-ROC Macro=0.6115829119767909, AUC-ROC Micro=0.7579402920348849
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.495465071250995, AUC-ROC Macro=0.6676688888039195, AUC-ROC Micro=0.6390916913294231
Eval task: 2
Eval:  Epoch 1, Loss=0.2208607718348503, AUC-ROC Macro=0.6877904511550723, AUC-ROC Micro=0.7952783672198829
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2189504536241293
Train: epoch: 2, loss = 0.22013835014775396
Train: epoch: 2, loss = 0.21705232753107945
Train: epoch: 2, loss = 0.21700082142837346
Train: epoch: 2, loss = 0.21692306589335203
Train: epoch: 2, loss = 0.21601503533000746
Train:  Epoch 2, Loss=0.21628482573475513, AUC-ROC Macro=0.7071915680062242, AUC-ROC Micro=0.8073418266921092
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.49606796478231746, AUC-ROC Macro=0.6485431766874905, AUC-ROC Micro=0.6440370169612387
Eval task: 2
Eval:  Epoch 2, Loss=0.2136162333190441, AUC-ROC Macro=0.7161979561212353, AUC-ROC Micro=0.8140042382102928
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.21046171333640815
Train: epoch: 3, loss = 0.21076802926138044
Train: epoch: 3, loss = 0.20896898911645015
Train: epoch: 3, loss = 0.20971995572559535
Train: epoch: 3, loss = 0.20936455964297057
Train: epoch: 3, loss = 0.20954954653357466
Train:  Epoch 3, Loss=0.21038000769885334, AUC-ROC Macro=0.7357005872983785, AUC-ROC Micro=0.8224768784786836
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5229046878715357, AUC-ROC Macro=0.6339322688037763, AUC-ROC Micro=0.6260007403369646
Eval task: 2
Eval:  Epoch 3, Loss=0.21076537668704987, AUC-ROC Macro=0.723814554619479, AUC-ROC Micro=0.8215724592888528
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.20985304698348045
Train: epoch: 4, loss = 0.20673884155228733
Train: epoch: 4, loss = 0.20522851058592398
Train: epoch: 4, loss = 0.20610215747728944
Train: epoch: 4, loss = 0.20547049600630998
Train: epoch: 4, loss = 0.20655002496515712
Train:  Epoch 4, Loss=0.20651615783850827, AUC-ROC Macro=0.7533145037947694, AUC-ROC Micro=0.8317960144216847
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5707555587093035, AUC-ROC Macro=0.5941303422386163, AUC-ROC Micro=0.5936020852078489
Eval task: 2
Eval:  Epoch 4, Loss=0.2104728315025568, AUC-ROC Macro=0.726996886253235, AUC-ROC Micro=0.8220688164582366
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.20203846294432878
Train: epoch: 5, loss = 0.20195730607956647
Train: epoch: 5, loss = 0.20309884585440158
Train: epoch: 5, loss = 0.20228974575176836
Train: epoch: 5, loss = 0.20289474161714316
Train: epoch: 5, loss = 0.2030059915098051
Train:  Epoch 5, Loss=0.20290556256906614, AUC-ROC Macro=0.7678598236192401, AUC-ROC Micro=0.8397818046278279
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5564454346895218, AUC-ROC Macro=0.6042848846669525, AUC-ROC Micro=0.6098097824055605
Eval task: 2
Eval:  Epoch 5, Loss=0.2098348420113325, AUC-ROC Macro=0.7356740155977284, AUC-ROC Micro=0.8245942344120062
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.19720516223460435
Train: epoch: 6, loss = 0.1982517969608307
Train: epoch: 6, loss = 0.19946825539072355
Train: epoch: 6, loss = 0.19944837110117078
Train: epoch: 6, loss = 0.19984664206206798
Train: epoch: 6, loss = 0.19964563060551882
Train:  Epoch 6, Loss=0.19994593085129045, AUC-ROC Macro=0.7815761538521295, AUC-ROC Micro=0.8463154863154273
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5774121905366579, AUC-ROC Macro=0.589937601560115, AUC-ROC Micro=0.5883392240546585
Eval task: 2
Eval:  Epoch 6, Loss=0.20753083564341068, AUC-ROC Macro=0.7376748141169667, AUC-ROC Micro=0.829842533572347
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5812567099928856, AUC-ROC Macro=0.5912216098957768, AUC-ROC Micro=0.5895220990823342
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.20957276597619057, AUC-ROC Macro=0.7348135455449177, AUC-ROC Micro=0.8261693834169022
{'0': {'precision': 0.21880717160629345, 'recall': 0.45718654434250766, 'f1-score': 0.2959663449641178, 'support': 1308}, '1': {'precision': 0.4636363636363636, 'recall': 0.2537313432835821, 'f1-score': 0.3279742765273312, 'support': 402}, '2': {'precision': 0.26666666666666666, 'recall': 0.0060790273556231, 'f1-score': 0.01188707280832095, 'support': 658}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1990}, '4': {'precision': 0.21637426900584794, 'recall': 0.04590570719602978, 'f1-score': 0.07574206755373593, 'support': 806}, '5': {'precision': 0.20689655172413793, 'recall': 0.007712082262210797, 'f1-score': 0.01486988847583643, 'support': 778}, '6': {'precision': 0.43103448275862066, 'recall': 0.09600614439324116, 'f1-score': 0.15703517587939697, 'support': 1302}, '7': {'precision': 0.07380073800738007, 'recall': 0.04716981132075472, 'f1-score': 0.05755395683453238, 'support': 424}, '8': {'precision': 0.6923076923076923, 'recall': 0.010948905109489052, 'f1-score': 0.02155688622754491, 'support': 1644}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2031}, '10': {'precision': 0.14184397163120568, 'recall': 0.034904013961605584, 'f1-score': 0.05602240896358543, 'support': 573}, '11': {'precision': 0.3333333333333333, 'recall': 0.0017006802721088435, 'f1-score': 0.0033840947546531297, 'support': 1176}, '12': {'precision': 0.5, 'recall': 0.011299435028248588, 'f1-score': 0.022099447513812154, 'support': 1770}, '13': {'precision': 0.35406698564593303, 'recall': 0.028505392912172575, 'f1-score': 0.05276292335115864, 'support': 2596}, '14': {'precision': 1.0, 'recall': 0.0018438844499078057, 'f1-score': 0.0036809815950920245, 'support': 1627}, '15': {'precision': 0.07317073170731707, 'recall': 0.012396694214876033, 'f1-score': 0.02120141342756184, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 1.0, 'recall': 0.003676470588235294, 'f1-score': 0.007326007326007326, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.20689655172413793, 'recall': 0.022900763358778626, 'f1-score': 0.041237113402061855, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 1.0, 'recall': 0.003683241252302026, 'f1-score': 0.007339449541284404, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.2449122807017544, 'recall': 0.041264336105308795, 'f1-score': 0.0706287101996762, 'support': 25373}, 'macro avg': {'precision': 0.28715342039019714, 'recall': 0.04182600565206695, 'f1-score': 0.04710558036584134, 'support': 25373}, 'weighted avg': {'precision': 0.3286217522630315, 'recall': 0.041264336105308795, 'f1-score': 0.04394001779677926, 'support': 25373}, 'samples avg': {'precision': 0.11756766183035715, 'recall': 0.03100578272553801, 'f1-score': 0.04563634790900991, 'support': 25373}}
{'0': {'precision': 0.610738255033557, 'recall': 0.4354066985645933, 'f1-score': 0.5083798882681564, 'support': 418}, '1': {'precision': 0.5072463768115942, 'recall': 0.16203703703703703, 'f1-score': 0.2456140350877193, 'support': 216}, '2': {'precision': 0.5, 'recall': 0.006944444444444444, 'f1-score': 0.0136986301369863, 'support': 288}, '3': {'precision': 1.0, 'recall': 0.003968253968253968, 'f1-score': 0.007905138339920948, 'support': 252}, '4': {'precision': 0.5111111111111111, 'recall': 0.0798611111111111, 'f1-score': 0.13813813813813813, 'support': 288}, '5': {'precision': 0.5238095238095238, 'recall': 0.040892193308550186, 'f1-score': 0.07586206896551724, 'support': 269}, '6': {'precision': 0.4583333333333333, 'recall': 0.038869257950530034, 'f1-score': 0.07166123778501628, 'support': 283}, '7': {'precision': 0.7867647058823529, 'recall': 0.4196078431372549, 'f1-score': 0.5473145780051152, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.625, 'recall': 0.1271186440677966, 'f1-score': 0.2112676056338028, 'support': 236}, '10': {'precision': 0.6363636363636364, 'recall': 0.03825136612021858, 'f1-score': 0.07216494845360824, 'support': 183}, '11': {'precision': 0.68, 'recall': 0.08133971291866028, 'f1-score': 0.1452991452991453, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.5, 'recall': 0.018018018018018018, 'f1-score': 0.034782608695652174, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.8208955223880597, 'recall': 0.6111111111111112, 'f1-score': 0.7006369426751594, 'support': 90}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.6405835543766578, 'recall': 0.1270718232044199, 'f1-score': 0.21207464324917674, 'support': 3801}, 'macro avg': {'precision': 0.32641049858932675, 'recall': 0.08253702767030319, 'f1-score': 0.11090899861935749, 'support': 3801}, 'weighted avg': {'precision': 0.5037482361754531, 'recall': 0.1270718232044199, 'f1-score': 0.17150218613686177, 'support': 3801}, 'samples avg': {'precision': 0.21037597656249998, 'recall': 0.14513346354166667, 'f1-score': 0.16130758618551586, 'support': 3801}}