
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43071443408727644
Train: epoch: 1, loss = 0.4192024382203817
Train: epoch: 1, loss = 0.41448127950231234
Train: epoch: 1, loss = 0.411220240034163
Train: epoch: 1, loss = 0.41047365698218347
Train: epoch: 1, loss = 0.40879408292472363
Train: epoch: 1, loss = 0.40566880549703327
Train: epoch: 1, loss = 0.40392903903499244
Train: epoch: 1, loss = 0.40246938568022517
Train: epoch: 1, loss = 0.4009663622379303
Train: epoch: 1, loss = 0.40013814504173667
Train: epoch: 1, loss = 0.39911911558359864
Train: epoch: 1, loss = 0.398185419056278
Train: epoch: 1, loss = 0.39760563283094336
Train: epoch: 1, loss = 0.39687017757197224
Train: epoch: 1, loss = 0.3960896159010008
Train: epoch: 1, loss = 0.39540095386697965
Train: epoch: 1, loss = 0.39435181530399455
Train:  Epoch 1, Loss=0.39406609195317976, AUC-ROC Macro=0.6527872690466607, AUC-ROC Micro=0.7456126202981236
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37427864347894985, AUC-ROC Macro=0.7123015970248059, AUC-ROC Micro=0.7784447842510228
Eval task: 2
Eval:  Epoch 1, Loss=0.32874621748924254, AUC-ROC Macro=0.49595888730221455, AUC-ROC Micro=0.5788357991099893
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3765654671192169
Train: epoch: 2, loss = 0.3783607628569007
Train: epoch: 2, loss = 0.3760379255066315
Train: epoch: 2, loss = 0.3772489883005619
Train: epoch: 2, loss = 0.37451133811473847
Train: epoch: 2, loss = 0.3743913396075368
Train: epoch: 2, loss = 0.37374375436987195
Train: epoch: 2, loss = 0.3729661497566849
Train: epoch: 2, loss = 0.37217435467574334
Train: epoch: 2, loss = 0.37203116791695356
Train: epoch: 2, loss = 0.37229461811482906
Train: epoch: 2, loss = 0.37200744592274226
Train: epoch: 2, loss = 0.3714389666055258
Train: epoch: 2, loss = 0.3715678716876677
Train: epoch: 2, loss = 0.37090660684307414
Train: epoch: 2, loss = 0.3711318587046117
Train: epoch: 2, loss = 0.37098280020934693
Train: epoch: 2, loss = 0.3703846829343173
Train:  Epoch 2, Loss=0.3702421191981715, AUC-ROC Macro=0.7204737855838731, AUC-ROC Micro=0.7885570932763197
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3622630337874095, AUC-ROC Macro=0.7367218520758984, AUC-ROC Micro=0.7972826089026765
Eval task: 2
Eval:  Epoch 2, Loss=0.35076271295547484, AUC-ROC Macro=0.4704599264475799, AUC-ROC Micro=0.5452561662935633
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36298396736383437
Train: epoch: 3, loss = 0.36232365723699334
Train: epoch: 3, loss = 0.3625082030147314
Train: epoch: 3, loss = 0.3646144162118435
Train: epoch: 3, loss = 0.36402255572378633
Train: epoch: 3, loss = 0.36268603019416334
Train: epoch: 3, loss = 0.3625838241513286
Train: epoch: 3, loss = 0.36226000644266604
Train: epoch: 3, loss = 0.362459200380577
Train: epoch: 3, loss = 0.36203033465147016
Train: epoch: 3, loss = 0.36166335463523863
Train: epoch: 3, loss = 0.3614311812321345
Train: epoch: 3, loss = 0.36188885973050045
Train: epoch: 3, loss = 0.3617502450410809
Train: epoch: 3, loss = 0.36135027832786243
Train: epoch: 3, loss = 0.3611057916795835
Train: epoch: 3, loss = 0.3609823355516967
Train: epoch: 3, loss = 0.36133095904770823
Train:  Epoch 3, Loss=0.3612783723937141, AUC-ROC Macro=0.7413645616999905, AUC-ROC Micro=0.8024382696726947
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.357439295699199, AUC-ROC Macro=0.7491525934858768, AUC-ROC Micro=0.8051433041280527
Eval task: 2
Eval:  Epoch 3, Loss=0.3506861090660095, AUC-ROC Macro=0.4742642423672427, AUC-ROC Micro=0.5336577288124026
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3562212973088026
Train: epoch: 4, loss = 0.3552835086360574
Train: epoch: 4, loss = 0.35575798355042937
Train: epoch: 4, loss = 0.35515095986425876
Train: epoch: 4, loss = 0.35457860866189
Train: epoch: 4, loss = 0.3553072613477707
Train: epoch: 4, loss = 0.35601097494363787
Train: epoch: 4, loss = 0.3563003984093666
Train: epoch: 4, loss = 0.3567088138312101
Train: epoch: 4, loss = 0.3560700844973326
Train: epoch: 4, loss = 0.3560147132114931
Train: epoch: 4, loss = 0.35536626394838094
Train: epoch: 4, loss = 0.3554610493607246
Train: epoch: 4, loss = 0.3555339673321162
Train: epoch: 4, loss = 0.3558936167110999
Train: epoch: 4, loss = 0.3554465300031006
Train: epoch: 4, loss = 0.35541596688768445
Train: epoch: 4, loss = 0.3555064290182458
Train:  Epoch 4, Loss=0.3553689576825525, AUC-ROC Macro=0.7543470753630576, AUC-ROC Micro=0.8112354493352022
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3542533454795678, AUC-ROC Macro=0.7558769323402281, AUC-ROC Micro=0.8097948799911414
Eval task: 2
Eval:  Epoch 4, Loss=0.3598505318164825, AUC-ROC Macro=0.46472355389977765, AUC-ROC Micro=0.5271305111757262
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3483166050165892
Train: epoch: 5, loss = 0.35050660230219366
Train: epoch: 5, loss = 0.35041946028669674
Train: epoch: 5, loss = 0.351749703399837
Train: epoch: 5, loss = 0.35151678970456124
Train: epoch: 5, loss = 0.35018135849386456
Train: epoch: 5, loss = 0.3509843918255397
Train: epoch: 5, loss = 0.350692628454417
Train: epoch: 5, loss = 0.35092008363869454
Train: epoch: 5, loss = 0.3515210225954652
Train: epoch: 5, loss = 0.35211367998610843
Train: epoch: 5, loss = 0.35170343233272433
Train: epoch: 5, loss = 0.3517843296722724
Train: epoch: 5, loss = 0.3517594353854656
Train: epoch: 5, loss = 0.3519940018554529
Train: epoch: 5, loss = 0.351663800124079
Train: epoch: 5, loss = 0.35144712639643866
Train: epoch: 5, loss = 0.35137848770452873
Train:  Epoch 5, Loss=0.35125586761572425, AUC-ROC Macro=0.7628647376079151, AUC-ROC Micro=0.8171076088114723
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3510533372561137, AUC-ROC Macro=0.7604099903340669, AUC-ROC Micro=0.8144028269352663
Eval task: 2
Eval:  Epoch 5, Loss=0.37310398519039156, AUC-ROC Macro=0.4708374575958366, AUC-ROC Micro=0.5392910270537612
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3445636651664972
Train: epoch: 6, loss = 0.34637420304119587
Train: epoch: 6, loss = 0.34533763880530993
Train: epoch: 6, loss = 0.3467355483211577
Train: epoch: 6, loss = 0.34683603978157046
Train: epoch: 6, loss = 0.34727050602436066
Train: epoch: 6, loss = 0.3468431701191834
Train: epoch: 6, loss = 0.3477235360909253
Train: epoch: 6, loss = 0.3482460352778435
Train: epoch: 6, loss = 0.34832507449388506
Train: epoch: 6, loss = 0.34833411209962584
Train: epoch: 6, loss = 0.34815978425865374
Train: epoch: 6, loss = 0.34805968480614513
Train: epoch: 6, loss = 0.34769018473369734
Train: epoch: 6, loss = 0.3476233726988236
Train: epoch: 6, loss = 0.3478283930476755
Train: epoch: 6, loss = 0.3477188707844299
Train: epoch: 6, loss = 0.34763749500115715
Train:  Epoch 6, Loss=0.3474676909334639, AUC-ROC Macro=0.7708692258298939, AUC-ROC Micro=0.8223568961752787
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3499419415990512, AUC-ROC Macro=0.7622363454649432, AUC-ROC Micro=0.8154451501178809
Eval task: 2
Eval:  Epoch 6, Loss=0.38640551567077636, AUC-ROC Macro=0.4683396175877539, AUC-ROC Micro=0.5217493897124956
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.352710735052824, AUC-ROC Macro=0.7620913409468733, AUC-ROC Micro=0.8144807399850018
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.384768882393837, AUC-ROC Macro=0.45307406875103395, AUC-ROC Micro=0.517760017491266
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2984811333566904
Train: epoch: 1, loss = 0.2879963316768408
Train: epoch: 1, loss = 0.2827054852743944
Train: epoch: 1, loss = 0.2795098662190139
Train: epoch: 1, loss = 0.27779425367712973
Train: epoch: 1, loss = 0.274916782391568
Train: epoch: 1, loss = 0.2729534719245774
Train:  Epoch 1, Loss=0.271441463234788, AUC-ROC Macro=0.6085936254676199, AUC-ROC Micro=0.7520791166134536
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.35966189578175545, AUC-ROC Macro=0.7466971966796215, AUC-ROC Micro=0.8012071604524341
Eval task: 2
Eval:  Epoch 1, Loss=0.2637463822960854, AUC-ROC Macro=0.6731386577614831, AUC-ROC Micro=0.7884544171954302
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.25427803277969363
Train: epoch: 2, loss = 0.25638558868318795
Train: epoch: 2, loss = 0.2577765062948068
Train: epoch: 2, loss = 0.25783284634351733
Train: epoch: 2, loss = 0.25687744373083116
Train: epoch: 2, loss = 0.2567061109592517
Train: epoch: 2, loss = 0.25593721422765936
Train:  Epoch 2, Loss=0.25592332165981396, AUC-ROC Macro=0.6961219274436824, AUC-ROC Micro=0.8003360795578363
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3558374692996343, AUC-ROC Macro=0.7472413336574694, AUC-ROC Micro=0.8027690276933477
Eval task: 2
Eval:  Epoch 2, Loss=0.25687343180179595, AUC-ROC Macro=0.7067181111868365, AUC-ROC Micro=0.8041745202001873
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2470215781033039
Train: epoch: 3, loss = 0.24985490832477808
Train: epoch: 3, loss = 0.2507823725044727
Train: epoch: 3, loss = 0.25031609127298
Train: epoch: 3, loss = 0.25099089795351026
Train: epoch: 3, loss = 0.2508171008341014
Train: epoch: 3, loss = 0.2508770876111729
Train:  Epoch 3, Loss=0.2500033486516653, AUC-ROC Macro=0.7276911603153948, AUC-ROC Micro=0.8158400926883522
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3533420003950596, AUC-ROC Macro=0.7507512119226207, AUC-ROC Micro=0.8068674906239642
Eval task: 2
Eval:  Epoch 3, Loss=0.2539929702877998, AUC-ROC Macro=0.7159338744676088, AUC-ROC Micro=0.8092656746189825
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.24343441903591156
Train: epoch: 4, loss = 0.24609243001788855
Train: epoch: 4, loss = 0.246480786104997
Train: epoch: 4, loss = 0.24725996432825922
Train: epoch: 4, loss = 0.24780962288379668
Train: epoch: 4, loss = 0.24762831308568517
Train: epoch: 4, loss = 0.2476940488974963
Train:  Epoch 4, Loss=0.24674988789221874, AUC-ROC Macro=0.7488964204229899, AUC-ROC Micro=0.8245416993604315
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35512371237079304, AUC-ROC Macro=0.7496731323572015, AUC-ROC Micro=0.8050002079113179
Eval task: 2
Eval:  Epoch 4, Loss=0.25200367867946627, AUC-ROC Macro=0.7276572031796499, AUC-ROC Micro=0.8143829104210556
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2447468590736389
Train: epoch: 5, loss = 0.24229623176157475
Train: epoch: 5, loss = 0.24340907603502274
Train: epoch: 5, loss = 0.24359506975859405
Train: epoch: 5, loss = 0.24378444933891297
Train: epoch: 5, loss = 0.24356145658840736
Train: epoch: 5, loss = 0.2433345079421997
Train:  Epoch 5, Loss=0.24285235880924283, AUC-ROC Macro=0.7610907885551189, AUC-ROC Micro=0.8317641824398236
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3560770973563194, AUC-ROC Macro=0.7465107458148655, AUC-ROC Micro=0.801224472813302
Eval task: 2
Eval:  Epoch 5, Loss=0.2508984461426735, AUC-ROC Macro=0.7311223468742364, AUC-ROC Micro=0.8153116837993205
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.24293721050024034
Train: epoch: 6, loss = 0.24039878930896522
Train: epoch: 6, loss = 0.24194350641220808
Train: epoch: 6, loss = 0.2418993019964546
Train: epoch: 6, loss = 0.2413230650946498
Train: epoch: 6, loss = 0.2411070579352478
Train: epoch: 6, loss = 0.2409641772242529
Train:  Epoch 6, Loss=0.23955415894886284, AUC-ROC Macro=0.7737824831518398, AUC-ROC Micro=0.8382649836743993
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35657063374916714, AUC-ROC Macro=0.7447722032947419, AUC-ROC Micro=0.8016565226244062
Eval task: 2
Eval:  Epoch 6, Loss=0.2498748630285263, AUC-ROC Macro=0.7311991618631484, AUC-ROC Micro=0.8178296043086294
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.36829306185245514, AUC-ROC Macro=0.742342518839725, AUC-ROC Micro=0.7982506969791583
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.23025496751070024, AUC-ROC Macro=0.7398124161232204, AUC-ROC Micro=0.8202230509254527
{'0': {'precision': 0.50418410041841, 'recall': 0.36850152905198774, 'f1-score': 0.42579505300353354, 'support': 1308}, '1': {'precision': 0.6797752808988764, 'recall': 0.3009950248756219, 'f1-score': 0.41724137931034483, 'support': 402}, '2': {'precision': 0.16666666666666666, 'recall': 0.001519756838905775, 'f1-score': 0.0030120481927710845, 'support': 658}, '3': {'precision': 0.5301507537688442, 'recall': 0.21206030150753769, 'f1-score': 0.30294328786791097, 'support': 1990}, '4': {'precision': 0.47391304347826085, 'recall': 0.13523573200992556, 'f1-score': 0.21042471042471045, 'support': 806}, '5': {'precision': 0.3013698630136986, 'recall': 0.028277634961439587, 'f1-score': 0.05170387779083431, 'support': 778}, '6': {'precision': 0.6294642857142857, 'recall': 0.10829493087557604, 'f1-score': 0.18479685452162517, 'support': 1302}, '7': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 424}, '8': {'precision': 0.5264187866927593, 'recall': 0.32725060827250607, 'f1-score': 0.4036009002250563, 'support': 1644}, '9': {'precision': 0.641358024691358, 'recall': 0.5115706548498277, 'f1-score': 0.5691591344837031, 'support': 2031}, '10': {'precision': 0.6895161290322581, 'recall': 0.29842931937172773, 'f1-score': 0.4165651644336176, 'support': 573}, '11': {'precision': 0.5098468271334792, 'recall': 0.19812925170068027, 'f1-score': 0.28536436007348437, 'support': 1176}, '12': {'precision': 0.5463576158940397, 'recall': 0.2796610169491525, 'f1-score': 0.3699551569506726, 'support': 1770}, '13': {'precision': 0.5396527451900516, 'recall': 0.44298921417565484, 'f1-score': 0.48656653268457795, 'support': 2596}, '14': {'precision': 0.5256410256410257, 'recall': 0.27719729563614015, 'f1-score': 0.3629778672032193, 'support': 1627}, '15': {'precision': 0.1875, 'recall': 0.006198347107438017, 'f1-score': 0.012, 'support': 484}, '16': {'precision': 0.41263940520446096, 'recall': 0.13962264150943396, 'f1-score': 0.20864661654135339, 'support': 795}, '17': {'precision': 0.37037037037037035, 'recall': 0.01838235294117647, 'f1-score': 0.03502626970227671, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.48, 'recall': 0.04580152671755725, 'f1-score': 0.08362369337979095, 'support': 262}, '20': {'precision': 0.25, 'recall': 0.0053285968028419185, 'f1-score': 0.010434782608695653, 'support': 563}, '21': {'precision': 0.5190217391304348, 'recall': 0.22819593787335724, 'f1-score': 0.31701244813278007, 'support': 837}, '22': {'precision': 0.6503340757238307, 'recall': 0.5377532228360957, 'f1-score': 0.5887096774193548, 'support': 1086}, '23': {'precision': 0.5962059620596206, 'recall': 0.25551684088269455, 'f1-score': 0.35772357723577236, 'support': 861}, '24': {'precision': 0.5459183673469388, 'recall': 0.21188118811881188, 'f1-score': 0.30527817403708984, 'support': 505}, 'micro avg': {'precision': 0.5566212350664648, 'recall': 0.2607496157332598, 'f1-score': 0.3551356719181943, 'support': 25373}, 'macro avg': {'precision': 0.45105220272278684, 'recall': 0.19755171703464364, 'f1-score': 0.256342462648927, 'support': 25373}, 'weighted avg': {'precision': 0.5019437953034139, 'recall': 0.2607496157332598, 'f1-score': 0.3258417359260149, 'support': 25373}, 'samples avg': {'precision': 0.3564990144946199, 'recall': 0.2275116072206491, 'f1-score': 0.2551831541157407, 'support': 25373}}
{'0': {'precision': 0.6342494714587738, 'recall': 0.5444646098003629, 'f1-score': 0.5859375, 'support': 551}, '1': {'precision': 0.5407239819004525, 'recall': 0.3660030627871363, 'f1-score': 0.43652968036529677, 'support': 653}, '2': {'precision': 0.5, 'recall': 0.009389671361502348, 'f1-score': 0.018433179723502304, 'support': 426}, '3': {'precision': 0.525, 'recall': 0.05134474327628362, 'f1-score': 0.0935412026726058, 'support': 409}, '4': {'precision': 0.42857142857142855, 'recall': 0.04897959183673469, 'f1-score': 0.08791208791208792, 'support': 245}, '5': {'precision': 0.4666666666666667, 'recall': 0.05865921787709497, 'f1-score': 0.10421836228287842, 'support': 358}, '6': {'precision': 0.3684210526315789, 'recall': 0.028688524590163935, 'f1-score': 0.0532319391634981, 'support': 244}, '7': {'precision': 0.6854838709677419, 'recall': 0.2891156462585034, 'f1-score': 0.4066985645933014, 'support': 294}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 263}, '9': {'precision': 0.7536231884057971, 'recall': 0.18705035971223022, 'f1-score': 0.2997118155619597, 'support': 278}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 208}, '11': {'precision': 0.375, 'recall': 0.012048192771084338, 'f1-score': 0.02334630350194553, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.6, 'recall': 0.045454545454545456, 'f1-score': 0.08450704225352113, 'support': 132}, '14': {'precision': 0.8333333333333334, 'recall': 0.11061946902654868, 'f1-score': 0.19531250000000003, 'support': 226}, '15': {'precision': 0.6966292134831461, 'recall': 0.5904761904761905, 'f1-score': 0.6391752577319587, 'support': 105}, '16': {'precision': 0.6, 'recall': 0.08823529411764706, 'f1-score': 0.15384615384615385, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.6038406827880513, 'recall': 0.15748469671675014, 'f1-score': 0.24981609533617774, 'support': 5391}, 'macro avg': {'precision': 0.3203080882967568, 'recall': 0.09722116477384113, 'f1-score': 0.1272960635843484, 'support': 5391}, 'weighted avg': {'precision': 0.44870052451380876, 'recall': 0.15748469671675014, 'f1-score': 0.19994214143507874, 'support': 5391}, 'samples avg': {'precision': 0.2584505208333333, 'recall': 0.15936817956349209, 'f1-score': 0.17909096545815295, 'support': 5391}}