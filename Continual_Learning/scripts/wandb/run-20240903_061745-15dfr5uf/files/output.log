
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest_baseline
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4367527873814106
Train: epoch: 1, loss = 0.4212607149779797
Train: epoch: 1, loss = 0.41688127572337785
Train: epoch: 1, loss = 0.4139709074795246
Train: epoch: 1, loss = 0.41237433275580404
Train: epoch: 1, loss = 0.40982528949777286
Train: epoch: 1, loss = 0.4066479341260025
Train: epoch: 1, loss = 0.40418445263057945
Train: epoch: 1, loss = 0.40211578177081214
Train: epoch: 1, loss = 0.4000887374356389
Train: epoch: 1, loss = 0.3979935678162358
Train: epoch: 1, loss = 0.39645339009041586
Train: epoch: 1, loss = 0.39537572377003155
Train: epoch: 1, loss = 0.3947739246540836
Train: epoch: 1, loss = 0.3933381396085024
Train: epoch: 1, loss = 0.3922265626862645
Train: epoch: 1, loss = 0.3909877010741655
Train: epoch: 1, loss = 0.38999482546829517
Train:  Epoch 1, Loss=0.38970444890372774, AUC-ROC Macro=0.6659193789109621, AUC-ROC Micro=0.7537671667599418
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3703090747197469, AUC-ROC Macro=0.7213498865745157, AUC-ROC Micro=0.7844181483886046
Eval task: 2
Eval:  Epoch 1, Loss=0.32649068161845207, AUC-ROC Macro=0.49276753359987074, AUC-ROC Micro=0.5952279682207675
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3646000153571367
Train: epoch: 2, loss = 0.36673185966908933
Train: epoch: 2, loss = 0.3670064546664556
Train: epoch: 2, loss = 0.36870881587266924
Train: epoch: 2, loss = 0.36936943569779396
Train: epoch: 2, loss = 0.3688420777147015
Train: epoch: 2, loss = 0.37030883182372365
Train: epoch: 2, loss = 0.36972726983949544
Train: epoch: 2, loss = 0.36891706539524927
Train: epoch: 2, loss = 0.36878525422513486
Train: epoch: 2, loss = 0.36781682141125205
Train: epoch: 2, loss = 0.3676719331058363
Train: epoch: 2, loss = 0.36748301638433567
Train: epoch: 2, loss = 0.36764083629740135
Train: epoch: 2, loss = 0.36750533218185105
Train: epoch: 2, loss = 0.3672172232111916
Train: epoch: 2, loss = 0.36726557616363553
Train: epoch: 2, loss = 0.36689385384735135
Train:  Epoch 2, Loss=0.3667175969751472, AUC-ROC Macro=0.7284810391739371, AUC-ROC Micro=0.7939924062664782
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36064861714839935, AUC-ROC Macro=0.7424364007620373, AUC-ROC Micro=0.8001948149894276
Eval task: 2
Eval:  Epoch 2, Loss=0.32569827884435654, AUC-ROC Macro=0.4975879688504719, AUC-ROC Micro=0.5743905409977932
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3548622984439135
Train: epoch: 3, loss = 0.3569320426508784
Train: epoch: 3, loss = 0.3594730488459269
Train: epoch: 3, loss = 0.3583988929353654
Train: epoch: 3, loss = 0.3590795425325632
Train: epoch: 3, loss = 0.3582005205377936
Train: epoch: 3, loss = 0.3596580375411681
Train: epoch: 3, loss = 0.35938728286884725
Train: epoch: 3, loss = 0.35907454349100587
Train: epoch: 3, loss = 0.35921127916872503
Train: epoch: 3, loss = 0.35916327732530506
Train: epoch: 3, loss = 0.35911689763888716
Train: epoch: 3, loss = 0.3591311860141846
Train: epoch: 3, loss = 0.3585115799573915
Train: epoch: 3, loss = 0.3583187469691038
Train: epoch: 3, loss = 0.35864284402690827
Train: epoch: 3, loss = 0.358503712073845
Train: epoch: 3, loss = 0.35827176023688584
Train:  Epoch 3, Loss=0.3583981641204948, AUC-ROC Macro=0.7479918419765219, AUC-ROC Micro=0.8067223769324665
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35582735762000084, AUC-ROC Macro=0.7526890247738877, AUC-ROC Micro=0.8079014244597174
Eval task: 2
Eval:  Epoch 3, Loss=0.333822850137949, AUC-ROC Macro=0.48653948292014404, AUC-ROC Micro=0.580267231998552
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3553141478449106
Train: epoch: 4, loss = 0.35521752513945104
Train: epoch: 4, loss = 0.35588548744718235
Train: epoch: 4, loss = 0.3543739953264594
Train: epoch: 4, loss = 0.3552631008476019
Train: epoch: 4, loss = 0.3536888775229454
Train: epoch: 4, loss = 0.3540138252824545
Train: epoch: 4, loss = 0.35362859928049145
Train: epoch: 4, loss = 0.35337382870415845
Train: epoch: 4, loss = 0.35283715491741896
Train: epoch: 4, loss = 0.35352137390185484
Train: epoch: 4, loss = 0.3533907769744595
Train: epoch: 4, loss = 0.3527257419893375
Train: epoch: 4, loss = 0.3531016049321209
Train: epoch: 4, loss = 0.3529623545904954
Train: epoch: 4, loss = 0.35279727093875407
Train: epoch: 4, loss = 0.35287536130231967
Train: epoch: 4, loss = 0.35255825181802114
Train:  Epoch 4, Loss=0.3524115531974369, AUC-ROC Macro=0.7602708862401876, AUC-ROC Micro=0.8152937898910482
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3514893377820651, AUC-ROC Macro=0.7592379061574753, AUC-ROC Micro=0.813543365312075
Eval task: 2
Eval:  Epoch 4, Loss=0.34902404248714447, AUC-ROC Macro=0.4827463998844744, AUC-ROC Micro=0.5555630379646486
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3400327429175377
Train: epoch: 5, loss = 0.34535297989845276
Train: epoch: 5, loss = 0.3450656260053317
Train: epoch: 5, loss = 0.3466659814491868
Train: epoch: 5, loss = 0.34668535432219505
Train: epoch: 5, loss = 0.3479041694353024
Train: epoch: 5, loss = 0.3476752919490848
Train: epoch: 5, loss = 0.34768351560458544
Train: epoch: 5, loss = 0.3483928666760524
Train: epoch: 5, loss = 0.347972585208714
Train: epoch: 5, loss = 0.34716439926488835
Train: epoch: 5, loss = 0.34714073115959765
Train: epoch: 5, loss = 0.34783015761811
Train: epoch: 5, loss = 0.34807059307183535
Train: epoch: 5, loss = 0.3481941891014576
Train: epoch: 5, loss = 0.3484031685302034
Train: epoch: 5, loss = 0.348619061182527
Train: epoch: 5, loss = 0.34845589426656565
Train:  Epoch 5, Loss=0.34843959928577783, AUC-ROC Macro=0.7685389693772027, AUC-ROC Micro=0.8208725216293645
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.34912027915318805, AUC-ROC Macro=0.7635236544367872, AUC-ROC Micro=0.8164226993343717
Eval task: 2
Eval:  Epoch 5, Loss=0.3426145724952221, AUC-ROC Macro=0.49130714766188066, AUC-ROC Micro=0.5522324482144648
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.35016907773911954
Train: epoch: 6, loss = 0.3507940252497792
Train: epoch: 6, loss = 0.3488782394180695
Train: epoch: 6, loss = 0.3478771228529513
Train: epoch: 6, loss = 0.3482546237558126
Train: epoch: 6, loss = 0.3463289798920353
Train: epoch: 6, loss = 0.345064571925572
Train: epoch: 6, loss = 0.3453033134993166
Train: epoch: 6, loss = 0.3449797547939751
Train: epoch: 6, loss = 0.3446606620848179
Train: epoch: 6, loss = 0.3449411401220343
Train: epoch: 6, loss = 0.3451952518957357
Train: epoch: 6, loss = 0.3450203107354733
Train: epoch: 6, loss = 0.3450308198002832
Train: epoch: 6, loss = 0.34493805139760175
Train: epoch: 6, loss = 0.3447511610155925
Train: epoch: 6, loss = 0.34501606360954395
Train: epoch: 6, loss = 0.345344941707121
Train:  Epoch 6, Loss=0.34536444085276025, AUC-ROC Macro=0.77447783487674, AUC-ROC Micro=0.8250805852775712
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3527498220403989, AUC-ROC Macro=0.7625890494875649, AUC-ROC Micro=0.8147265857792623
Eval task: 2
Eval:  Epoch 6, Loss=0.37544986978173256, AUC-ROC Macro=0.4891010392768933, AUC-ROC Micro=0.5730849844529013
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3553728759288788, AUC-ROC Macro=0.7623170337033711, AUC-ROC Micro=0.8140313432275823
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3750355541706085, AUC-ROC Macro=0.4906137192593161, AUC-ROC Micro=0.5703693424774446
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2622295420616865
Train: epoch: 1, loss = 0.24787905897945164
Train: epoch: 1, loss = 0.24109743493298688
Train: epoch: 1, loss = 0.23611098676919937
Train: epoch: 1, loss = 0.232935546875
Train: epoch: 1, loss = 0.23080142968644698
Train:  Epoch 1, Loss=0.22953286724096816, AUC-ROC Macro=0.6246629068280154, AUC-ROC Micro=0.7699730162216376
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.5044734875361124, AUC-ROC Macro=0.6423934803973655, AUC-ROC Micro=0.6308839878133907
Eval task: 2
Eval:  Epoch 1, Loss=0.2150330524891615, AUC-ROC Macro=0.712165760325642, AUC-ROC Micro=0.8105166819557112
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2187877683341503
Train: epoch: 2, loss = 0.21645366875454783
Train: epoch: 2, loss = 0.21611963077137866
Train: epoch: 2, loss = 0.21438238956965505
Train: epoch: 2, loss = 0.21324600914120675
Train: epoch: 2, loss = 0.21323120043302576
Train:  Epoch 2, Loss=0.21292422065983624, AUC-ROC Macro=0.7164499085421344, AUC-ROC Micro=0.8157924979135414
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.5361470865706602, AUC-ROC Macro=0.614496866898195, AUC-ROC Micro=0.6127463883191961
Eval task: 2
Eval:  Epoch 2, Loss=0.21046172827482224, AUC-ROC Macro=0.7285808583717275, AUC-ROC Micro=0.8221499917554896
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.20855846520513296
Train: epoch: 3, loss = 0.20647364910691976
Train: epoch: 3, loss = 0.2074748633429408
Train: epoch: 3, loss = 0.2077589045278728
Train: epoch: 3, loss = 0.2079818495810032
Train: epoch: 3, loss = 0.2079711251333356
Train:  Epoch 3, Loss=0.20804789466762508, AUC-ROC Macro=0.7431970214936571, AUC-ROC Micro=0.8280594563194383
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5489365110794703, AUC-ROC Macro=0.5947378024738766, AUC-ROC Micro=0.6041757899028685
Eval task: 2
Eval:  Epoch 3, Loss=0.2112622894346714, AUC-ROC Macro=0.7325993351429974, AUC-ROC Micro=0.8201441482864226
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.20508883204311132
Train: epoch: 4, loss = 0.2030276843160391
Train: epoch: 4, loss = 0.20339882186303537
Train: epoch: 4, loss = 0.20351001421920956
Train: epoch: 4, loss = 0.2039381436035037
Train: epoch: 4, loss = 0.20388794368132948
Train:  Epoch 4, Loss=0.20409024499562933, AUC-ROC Macro=0.7613632132201841, AUC-ROC Micro=0.8372430520246676
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5686148926615715, AUC-ROC Macro=0.5828174894827111, AUC-ROC Micro=0.5909155091815136
Eval task: 2
Eval:  Epoch 4, Loss=0.2091463841497898, AUC-ROC Macro=0.7400626561453272, AUC-ROC Micro=0.824464322610786
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.20098380345851183
Train: epoch: 5, loss = 0.20232673585414887
Train: epoch: 5, loss = 0.20322542255123457
Train: epoch: 5, loss = 0.20134039181284608
Train: epoch: 5, loss = 0.2011226302087307
Train: epoch: 5, loss = 0.200357589473327
Train:  Epoch 5, Loss=0.200649302054361, AUC-ROC Macro=0.7757200843597244, AUC-ROC Micro=0.8446473225483752
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5620252018173536, AUC-ROC Macro=0.592654958311833, AUC-ROC Micro=0.5968999788113033
Eval task: 2
Eval:  Epoch 5, Loss=0.20837248116731644, AUC-ROC Macro=0.7402235605106475, AUC-ROC Micro=0.8267108670723867
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.19543085608631372
Train: epoch: 6, loss = 0.1962065101787448
Train: epoch: 6, loss = 0.1965500121191144
Train: epoch: 6, loss = 0.19755871303379535
Train: epoch: 6, loss = 0.1972067121937871
Train: epoch: 6, loss = 0.19674666825681925
Train:  Epoch 6, Loss=0.1973173291594481, AUC-ROC Macro=0.7900419900127181, AUC-ROC Micro=0.8513340060620903
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5844874158501625, AUC-ROC Macro=0.5923915431443771, AUC-ROC Micro=0.5942280280277601
Eval task: 2
Eval:  Epoch 6, Loss=0.2072082031518221, AUC-ROC Macro=0.7465148509998251, AUC-ROC Micro=0.8306555116001857
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5871551384528478, AUC-ROC Macro=0.5918131629610408, AUC-ROC Micro=0.5967579459971046
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.21026378870010376, AUC-ROC Macro=0.7376945707998417, AUC-ROC Micro=0.8260062206017542
{'0': {'precision': 0.3076923076923077, 'recall': 0.40061162079510704, 'f1-score': 0.3480571238791099, 'support': 1308}, '1': {'precision': 0.3645833333333333, 'recall': 0.08706467661691543, 'f1-score': 0.14056224899598393, 'support': 402}, '2': {'precision': 0.09090909090909091, 'recall': 0.007598784194528876, 'f1-score': 0.014025245441795233, 'support': 658}, '3': {'precision': 0.6666666666666666, 'recall': 0.008040201005025126, 'f1-score': 0.01588877855014896, 'support': 1990}, '4': {'precision': 0.2, 'recall': 0.08684863523573201, 'f1-score': 0.12110726643598617, 'support': 806}, '5': {'precision': 0.1917808219178082, 'recall': 0.05398457583547558, 'f1-score': 0.08425275827482447, 'support': 778}, '6': {'precision': 0.38967136150234744, 'recall': 0.06374807987711213, 'f1-score': 0.10957095709570956, 'support': 1302}, '7': {'precision': 0.06635071090047394, 'recall': 0.0660377358490566, 'f1-score': 0.06619385342789598, 'support': 424}, '8': {'precision': 0.6533333333333333, 'recall': 0.029805352798053526, 'f1-score': 0.05700988947062245, 'support': 1644}, '9': {'precision': 0.3684210526315789, 'recall': 0.0034465780403741997, 'f1-score': 0.006829268292682927, 'support': 2031}, '10': {'precision': 0.13675213675213677, 'recall': 0.027923211169284468, 'f1-score': 0.04637681159420289, 'support': 573}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1176}, '12': {'precision': 0.44329896907216493, 'recall': 0.024293785310734464, 'f1-score': 0.046063202999464384, 'support': 1770}, '13': {'precision': 0.3215686274509804, 'recall': 0.031587057010785825, 'f1-score': 0.05752367590319186, 'support': 2596}, '14': {'precision': 0.8666666666666667, 'recall': 0.007990165949600492, 'f1-score': 0.015834348355663826, 'support': 1627}, '15': {'precision': 0.10126582278481013, 'recall': 0.01652892561983471, 'f1-score': 0.028419182948490232, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 0.4, 'recall': 0.003676470588235294, 'f1-score': 0.007285974499089253, 'support': 544}, '18': {'precision': 0.12, 'recall': 0.008547008547008548, 'f1-score': 0.01595744680851064, 'support': 351}, '19': {'precision': 0.2727272727272727, 'recall': 0.022900763358778626, 'f1-score': 0.04225352112676057, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.8648648648648649, 'recall': 0.029465930018416207, 'f1-score': 0.05699020480854853, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.5, 'recall': 0.007920792079207921, 'f1-score': 0.015594541910331383, 'support': 505}, 'micro avg': {'precision': 0.278125, 'recall': 0.04209198754581642, 'f1-score': 0.07311813233834252, 'support': 25373}, 'macro avg': {'precision': 0.29306212156823347, 'recall': 0.03952081399597068, 'f1-score': 0.05183185203276053, 'support': 25373}, 'weighted avg': {'precision': 0.3658822275041497, 'recall': 0.04209198754581642, 'f1-score': 0.05444572911021228, 'support': 25373}, 'samples avg': {'precision': 0.09539891803075395, 'recall': 0.028321669554148873, 'f1-score': 0.040505303563369795, 'support': 25373}}
{'0': {'precision': 0.6145833333333334, 'recall': 0.423444976076555, 'f1-score': 0.5014164305949009, 'support': 418}, '1': {'precision': 0.5230769230769231, 'recall': 0.1574074074074074, 'f1-score': 0.24199288256227758, 'support': 216}, '2': {'precision': 0.35, 'recall': 0.024305555555555556, 'f1-score': 0.04545454545454545, 'support': 288}, '3': {'precision': 0.5, 'recall': 0.003968253968253968, 'f1-score': 0.007874015748031496, 'support': 252}, '4': {'precision': 0.3953488372093023, 'recall': 0.059027777777777776, 'f1-score': 0.10271903323262839, 'support': 288}, '5': {'precision': 0.3333333333333333, 'recall': 0.07063197026022305, 'f1-score': 0.11656441717791412, 'support': 269}, '6': {'precision': 0.38461538461538464, 'recall': 0.0176678445229682, 'f1-score': 0.033783783783783786, 'support': 283}, '7': {'precision': 0.8211382113821138, 'recall': 0.396078431372549, 'f1-score': 0.5343915343915344, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.5517241379310345, 'recall': 0.13559322033898305, 'f1-score': 0.21768707482993196, 'support': 236}, '10': {'precision': 0.625, 'recall': 0.0273224043715847, 'f1-score': 0.05235602094240837, 'support': 183}, '11': {'precision': 0.75, 'recall': 0.10047846889952153, 'f1-score': 0.17721518987341775, 'support': 209}, '12': {'precision': 0.3333333333333333, 'recall': 0.00625, 'f1-score': 0.01226993865030675, 'support': 160}, '13': {'precision': 0.5, 'recall': 0.06306306306306306, 'f1-score': 0.11199999999999999, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.7407407407407407, 'recall': 0.6666666666666666, 'f1-score': 0.7017543859649122, 'support': 90}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.5982800982800983, 'recall': 0.12812417784793476, 'f1-score': 0.21105092091007585, 'support': 3801}, 'macro avg': {'precision': 0.29691576939821995, 'recall': 0.08607624161124436, 'f1-score': 0.11429917012826372, 'support': 3801}, 'weighted avg': {'precision': 0.44600785972144474, 'recall': 0.12812417784793476, 'f1-score': 0.17344215065793256, 'support': 3801}, 'samples avg': {'precision': 0.21182454427083333, 'recall': 0.14820556640625, 'f1-score': 0.16349602992238563, 'support': 3801}}