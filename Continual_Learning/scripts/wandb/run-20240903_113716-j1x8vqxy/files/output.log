
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4341759097576141
Train: epoch: 1, loss = 0.4154221674799919
Train: epoch: 1, loss = 0.41232444263994694
Train: epoch: 1, loss = 0.41019243946298956
Train: epoch: 1, loss = 0.40799436639249326
Train: epoch: 1, loss = 0.4062812609101335
Train: epoch: 1, loss = 0.4044601172315223
Train: epoch: 1, loss = 0.4023258656729013
Train: epoch: 1, loss = 0.4006437787827518
Train: epoch: 1, loss = 0.39883099430054425
Train: epoch: 1, loss = 0.39729121575301346
Train: epoch: 1, loss = 0.39557881992931165
Train: epoch: 1, loss = 0.3939577747308291
Train: epoch: 1, loss = 0.39255925802247865
Train: epoch: 1, loss = 0.3919146406153838
Train: epoch: 1, loss = 0.3905803577369079
Train: epoch: 1, loss = 0.3897448017448187
Train: epoch: 1, loss = 0.3888445167409049
Train:  Epoch 1, Loss=0.3889901231619028, AUC-ROC Macro=0.6676000574455455, AUC-ROC Micro=0.7551429751324776
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3753052738805612, AUC-ROC Macro=0.7201601196594015, AUC-ROC Micro=0.784813969527244
Eval task: 2
Eval:  Epoch 1, Loss=0.36013638973236084, AUC-ROC Macro=0.4770955210635124, AUC-ROC Micro=0.5520176766464838
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3721657415479422
Train: epoch: 2, loss = 0.36821994416415693
Train: epoch: 2, loss = 0.36726100504398346
Train: epoch: 2, loss = 0.36728945104405286
Train: epoch: 2, loss = 0.36735552416741846
Train: epoch: 2, loss = 0.367697268401583
Train: epoch: 2, loss = 0.36831000305712225
Train: epoch: 2, loss = 0.3677469901740551
Train: epoch: 2, loss = 0.3675720379004876
Train: epoch: 2, loss = 0.3682265678197145
Train: epoch: 2, loss = 0.3683477450704033
Train: epoch: 2, loss = 0.3688653108974298
Train: epoch: 2, loss = 0.3685129547978823
Train: epoch: 2, loss = 0.36859633654356005
Train: epoch: 2, loss = 0.36830758651097617
Train: epoch: 2, loss = 0.3681440434185788
Train: epoch: 2, loss = 0.36793984268956326
Train: epoch: 2, loss = 0.36750529007779226
Train:  Epoch 2, Loss=0.3674333503633483, AUC-ROC Macro=0.7268098763636688, AUC-ROC Micro=0.7926483718483186
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3599776029586792, AUC-ROC Macro=0.7420055129881724, AUC-ROC Micro=0.8004419128119523
Eval task: 2
Eval:  Epoch 2, Loss=0.3508883237838745, AUC-ROC Macro=0.4737941623504598, AUC-ROC Micro=0.5590269522600202
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36189134933054445
Train: epoch: 3, loss = 0.36067244548350574
Train: epoch: 3, loss = 0.36015551721056305
Train: epoch: 3, loss = 0.36056781582534314
Train: epoch: 3, loss = 0.360626317307353
Train: epoch: 3, loss = 0.35951086475203436
Train: epoch: 3, loss = 0.3598018306706633
Train: epoch: 3, loss = 0.36067390045151115
Train: epoch: 3, loss = 0.36051196200152236
Train: epoch: 3, loss = 0.36031084958463905
Train: epoch: 3, loss = 0.3603263145075603
Train: epoch: 3, loss = 0.36099458164225023
Train: epoch: 3, loss = 0.3603762533229131
Train: epoch: 3, loss = 0.36062955752015113
Train: epoch: 3, loss = 0.3603025804360708
Train: epoch: 3, loss = 0.36014791251625866
Train: epoch: 3, loss = 0.3599813552376102
Train: epoch: 3, loss = 0.35952105631017023
Train:  Epoch 3, Loss=0.3597074167117094, AUC-ROC Macro=0.7443952451859801, AUC-ROC Micro=0.8046334815887005
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.355086966107289, AUC-ROC Macro=0.7526830957570215, AUC-ROC Micro=0.8089320178309687
Eval task: 2
Eval:  Epoch 3, Loss=0.4080246865749359, AUC-ROC Macro=0.4738083907654484, AUC-ROC Micro=0.5501723084522328
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3591277220100164
Train: epoch: 4, loss = 0.35681282978504897
Train: epoch: 4, loss = 0.3575574203332265
Train: epoch: 4, loss = 0.35514073515310884
Train: epoch: 4, loss = 0.35436850853264334
Train: epoch: 4, loss = 0.35418393096576134
Train: epoch: 4, loss = 0.35324103045676436
Train: epoch: 4, loss = 0.3536193764396012
Train: epoch: 4, loss = 0.3537982529567348
Train: epoch: 4, loss = 0.3541658404916525
Train: epoch: 4, loss = 0.3545634253661741
Train: epoch: 4, loss = 0.3544814474508166
Train: epoch: 4, loss = 0.3545374583166379
Train: epoch: 4, loss = 0.3543747340887785
Train: epoch: 4, loss = 0.3541706482519706
Train: epoch: 4, loss = 0.354018029011786
Train: epoch: 4, loss = 0.3538639854070018
Train: epoch: 4, loss = 0.35398180559691456
Train:  Epoch 4, Loss=0.35403969396689, AUC-ROC Macro=0.7569518695845872, AUC-ROC Micro=0.8130417662262074
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3527183271944523, AUC-ROC Macro=0.7563234510828404, AUC-ROC Micro=0.8113444128152439
Eval task: 2
Eval:  Epoch 4, Loss=0.37781114876270294, AUC-ROC Macro=0.4674783171702456, AUC-ROC Micro=0.5432882874682878
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3482569634914398
Train: epoch: 5, loss = 0.34480363845825196
Train: epoch: 5, loss = 0.34622542237242065
Train: epoch: 5, loss = 0.34604862429201605
Train: epoch: 5, loss = 0.34633368796110153
Train: epoch: 5, loss = 0.34771854650229217
Train: epoch: 5, loss = 0.3479714731765645
Train: epoch: 5, loss = 0.34847146306186916
Train: epoch: 5, loss = 0.3484742177857293
Train: epoch: 5, loss = 0.34910416741669176
Train: epoch: 5, loss = 0.34900557214563543
Train: epoch: 5, loss = 0.3492244062262277
Train: epoch: 5, loss = 0.34971997275375405
Train: epoch: 5, loss = 0.34977097685847963
Train: epoch: 5, loss = 0.34948151275515554
Train: epoch: 5, loss = 0.34979703335557133
Train: epoch: 5, loss = 0.35011205625008135
Train: epoch: 5, loss = 0.34983135603782206
Train:  Epoch 5, Loss=0.3498551251786387, AUC-ROC Macro=0.7656742983148022, AUC-ROC Micro=0.8189213950159169
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3512791308263938, AUC-ROC Macro=0.7596961818303211, AUC-ROC Micro=0.8144177960037494
Eval task: 2
Eval:  Epoch 5, Loss=0.3747455835342407, AUC-ROC Macro=0.46942275067944367, AUC-ROC Micro=0.5309235525309053
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.35160563252866267
Train: epoch: 6, loss = 0.3525474855676293
Train: epoch: 6, loss = 0.3484917716681957
Train: epoch: 6, loss = 0.3459738160856068
Train: epoch: 6, loss = 0.346325009226799
Train: epoch: 6, loss = 0.347920919743677
Train: epoch: 6, loss = 0.3476829031748431
Train: epoch: 6, loss = 0.3475935005955398
Train: epoch: 6, loss = 0.3465272377928098
Train: epoch: 6, loss = 0.3460923063233495
Train: epoch: 6, loss = 0.34623276390812613
Train: epoch: 6, loss = 0.34624425795550146
Train: epoch: 6, loss = 0.34596561954571653
Train: epoch: 6, loss = 0.34585006964526005
Train: epoch: 6, loss = 0.34653484296798703
Train: epoch: 6, loss = 0.34672658120281996
Train: epoch: 6, loss = 0.34645928112023017
Train: epoch: 6, loss = 0.34644711297005415
Train:  Epoch 6, Loss=0.3465927685652024, AUC-ROC Macro=0.7723621102192152, AUC-ROC Micro=0.8233290763815421
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3514595963060856, AUC-ROC Macro=0.7615633889177087, AUC-ROC Micro=0.8143077803200482
Eval task: 2
Eval:  Epoch 6, Loss=0.3746219754219055, AUC-ROC Macro=0.4722529862528133, AUC-ROC Micro=0.544681841561901
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35341139510273933, AUC-ROC Macro=0.7627052184121323, AUC-ROC Micro=0.8142478930062962
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.37273197770118716, AUC-ROC Macro=0.46162260945769235, AUC-ROC Micro=0.5441734667992488
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.30241447769105434
Train: epoch: 1, loss = 0.29041665300726893
Train: epoch: 1, loss = 0.2820109471678734
Train: epoch: 1, loss = 0.2800573711283505
Train: epoch: 1, loss = 0.277756838992238
Train: epoch: 1, loss = 0.27521384733418625
Train: epoch: 1, loss = 0.27372141875326633
Train:  Epoch 1, Loss=0.27148324382398, AUC-ROC Macro=0.6266728190942827, AUC-ROC Micro=0.758725908369001
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.36295397703846294, AUC-ROC Macro=0.7455231232341417, AUC-ROC Micro=0.8013176217901126
Eval task: 2
Eval:  Epoch 1, Loss=0.2657658964395523, AUC-ROC Macro=0.6927836033320562, AUC-ROC Micro=0.7935984767261717
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.262634369879961
Train: epoch: 2, loss = 0.260417659021914
Train: epoch: 2, loss = 0.2576959084967772
Train: epoch: 2, loss = 0.2570795279927552
Train: epoch: 2, loss = 0.25647409634292123
Train: epoch: 2, loss = 0.2561449204881986
Train: epoch: 2, loss = 0.25675805255770684
Train:  Epoch 2, Loss=0.25637556180213444, AUC-ROC Macro=0.7091974076825164, AUC-ROC Micro=0.8043849033310198
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36431769529978436, AUC-ROC Macro=0.7443373263390519, AUC-ROC Micro=0.7982856311789313
Eval task: 2
Eval:  Epoch 2, Loss=0.26264775544404984, AUC-ROC Macro=0.7160031365144313, AUC-ROC Micro=0.8054912313011904
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2532754088938236
Train: epoch: 3, loss = 0.25288674868643285
Train: epoch: 3, loss = 0.2514648346851269
Train: epoch: 3, loss = 0.2510934734530747
Train: epoch: 3, loss = 0.2511686901897192
Train: epoch: 3, loss = 0.25149912118911744
Train: epoch: 3, loss = 0.2513947057617562
Train:  Epoch 3, Loss=0.25070409106300584, AUC-ROC Macro=0.7329222730589053, AUC-ROC Micro=0.8168922160272337
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.36257723718881607, AUC-ROC Macro=0.7471997672814745, AUC-ROC Micro=0.8006754853234443
Eval task: 2
Eval:  Epoch 3, Loss=0.26026295870542526, AUC-ROC Macro=0.7228634495300034, AUC-ROC Micro=0.8098575366694587
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.24988189354538917
Train: epoch: 4, loss = 0.24496483394876123
Train: epoch: 4, loss = 0.24360313632835945
Train: epoch: 4, loss = 0.24468406215310096
Train: epoch: 4, loss = 0.2460152832567692
Train: epoch: 4, loss = 0.2465433266883095
Train: epoch: 4, loss = 0.2475435769451516
Train:  Epoch 4, Loss=0.24682685405494412, AUC-ROC Macro=0.7484788506746243, AUC-ROC Micro=0.8250965099856764
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.36058542132377625, AUC-ROC Macro=0.7466330395790709, AUC-ROC Micro=0.8009477046187397
Eval task: 2
Eval:  Epoch 4, Loss=0.25599057972431183, AUC-ROC Macro=0.7317487980223026, AUC-ROC Micro=0.8160134366091806
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.244232105538249
Train: epoch: 5, loss = 0.24243737816810607
Train: epoch: 5, loss = 0.24214167510469756
Train: epoch: 5, loss = 0.24366919150575994
Train: epoch: 5, loss = 0.24324651823937893
Train: epoch: 5, loss = 0.24345296498388053
Train: epoch: 5, loss = 0.24451253956982066
Train:  Epoch 5, Loss=0.2435292883975539, AUC-ROC Macro=0.7613505718844809, AUC-ROC Micro=0.8319418243822451
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3624244344731172, AUC-ROC Macro=0.7462253492773864, AUC-ROC Micro=0.8012843591769273
Eval task: 2
Eval:  Epoch 5, Loss=0.25479176789522173, AUC-ROC Macro=0.7341407932499554, AUC-ROC Micro=0.8153540873245628
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2416462741047144
Train: epoch: 6, loss = 0.24131968419998884
Train: epoch: 6, loss = 0.23985185665388903
Train: epoch: 6, loss = 0.24022308642044662
Train: epoch: 6, loss = 0.2406077646315098
Train: epoch: 6, loss = 0.24085179338852564
Train: epoch: 6, loss = 0.24155690167631422
Train:  Epoch 6, Loss=0.2405044161075819, AUC-ROC Macro=0.7731113184990714, AUC-ROC Micro=0.8376210174863061
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.36341065913438797, AUC-ROC Macro=0.745226332440504, AUC-ROC Micro=0.7991752690558429
Eval task: 2
Eval:  Epoch 6, Loss=0.25359251648187636, AUC-ROC Macro=0.7380975631579677, AUC-ROC Micro=0.818662903558695
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3701465502381325, AUC-ROC Macro=0.7411201285890036, AUC-ROC Micro=0.7960489796232353
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.22904580533504487, AUC-ROC Macro=0.745539649834696, AUC-ROC Micro=0.8231797327569281
{'0': {'precision': 0.4896142433234421, 'recall': 0.37844036697247707, 'f1-score': 0.42690815006468297, 'support': 1308}, '1': {'precision': 0.651685393258427, 'recall': 0.43283582089552236, 'f1-score': 0.5201793721973095, 'support': 402}, '2': {'precision': 0.47619047619047616, 'recall': 0.04559270516717325, 'f1-score': 0.08321775312066575, 'support': 658}, '3': {'precision': 0.5155778894472361, 'recall': 0.2577889447236181, 'f1-score': 0.3437185929648241, 'support': 1990}, '4': {'precision': 0.4385026737967914, 'recall': 0.10173697270471464, 'f1-score': 0.1651560926485398, 'support': 806}, '5': {'precision': 0.38461538461538464, 'recall': 0.019280205655526992, 'f1-score': 0.03671970624235006, 'support': 778}, '6': {'precision': 0.5238095238095238, 'recall': 0.13517665130568357, 'f1-score': 0.2148962148962149, 'support': 1302}, '7': {'precision': 0.45454545454545453, 'recall': 0.01179245283018868, 'f1-score': 0.02298850574712644, 'support': 424}, '8': {'precision': 0.4968474148802018, 'recall': 0.4793187347931874, 'f1-score': 0.48792569659442725, 'support': 1644}, '9': {'precision': 0.6293348493462194, 'recall': 0.5450516986706057, 'f1-score': 0.5841688654353563, 'support': 2031}, '10': {'precision': 0.6055900621118012, 'recall': 0.3403141361256545, 'f1-score': 0.4357541899441341, 'support': 573}, '11': {'precision': 0.4766734279918864, 'recall': 0.19982993197278912, 'f1-score': 0.28160575194727383, 'support': 1176}, '12': {'precision': 0.573170731707317, 'recall': 0.2655367231638418, 'f1-score': 0.36293436293436293, 'support': 1770}, '13': {'precision': 0.572945779765232, 'recall': 0.3948382126348228, 'f1-score': 0.467502850627138, 'support': 2596}, '14': {'precision': 0.517632241813602, 'recall': 0.2526121696373694, 'f1-score': 0.33952912019826514, 'support': 1627}, '15': {'precision': 0.4, 'recall': 0.008264462809917356, 'f1-score': 0.01619433198380567, 'support': 484}, '16': {'precision': 0.3686440677966102, 'recall': 0.10943396226415095, 'f1-score': 0.16876818622696416, 'support': 795}, '17': {'precision': 0.35064935064935066, 'recall': 0.04963235294117647, 'f1-score': 0.08695652173913043, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.40816326530612246, 'recall': 0.07633587786259542, 'f1-score': 0.12861736334405144, 'support': 262}, '20': {'precision': 0.2, 'recall': 0.0017761989342806395, 'f1-score': 0.0035211267605633804, 'support': 563}, '21': {'precision': 0.5070921985815603, 'recall': 0.17084826762246116, 'f1-score': 0.2555853440571939, 'support': 837}, '22': {'precision': 0.6224105461393596, 'recall': 0.6086556169429097, 'f1-score': 0.6154562383612663, 'support': 1086}, '23': {'precision': 0.48686030428769017, 'recall': 0.4088269454123113, 'f1-score': 0.4444444444444445, 'support': 861}, '24': {'precision': 0.4887005649717514, 'recall': 0.3425742574257426, 'f1-score': 0.40279394644935973, 'support': 505}, 'micro avg': {'precision': 0.5417483044461191, 'recall': 0.2833326764671107, 'f1-score': 0.3720725616541159, 'support': 25373}, 'macro avg': {'precision': 0.46557023377341766, 'recall': 0.22545974677874883, 'f1-score': 0.275821709157178, 'support': 25373}, 'weighted avg': {'precision': 0.5036483844373866, 'recall': 0.2833326764671107, 'f1-score': 0.34007684115461123, 'support': 25373}, 'samples avg': {'precision': 0.3823723422844516, 'recall': 0.25449817604143204, 'f1-score': 0.2801453805877891, 'support': 25373}}
{'0': {'precision': 0.640625, 'recall': 0.5208711433756806, 'f1-score': 0.5745745745745745, 'support': 551}, '1': {'precision': 0.5828220858895705, 'recall': 0.29096477794793263, 'f1-score': 0.3881511746680286, 'support': 653}, '2': {'precision': 0.35294117647058826, 'recall': 0.028169014084507043, 'f1-score': 0.05217391304347826, 'support': 426}, '3': {'precision': 0.6, 'recall': 0.044009779951100246, 'f1-score': 0.08200455580865604, 'support': 409}, '4': {'precision': 0.3333333333333333, 'recall': 0.012244897959183673, 'f1-score': 0.023622047244094488, 'support': 245}, '5': {'precision': 0.6944444444444444, 'recall': 0.06983240223463687, 'f1-score': 0.12690355329949238, 'support': 358}, '6': {'precision': 0.4, 'recall': 0.01639344262295082, 'f1-score': 0.031496062992125984, 'support': 244}, '7': {'precision': 0.6036585365853658, 'recall': 0.336734693877551, 'f1-score': 0.43231441048034935, 'support': 294}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 263}, '9': {'precision': 0.5, 'recall': 0.007194244604316547, 'f1-score': 0.014184397163120569, 'support': 278}, '10': {'precision': 0.3333333333333333, 'recall': 0.004807692307692308, 'f1-score': 0.009478672985781991, 'support': 208}, '11': {'precision': 0.5, 'recall': 0.05220883534136546, 'f1-score': 0.09454545454545454, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.6, 'recall': 0.022727272727272728, 'f1-score': 0.043795620437956206, 'support': 132}, '14': {'precision': 0.7317073170731707, 'recall': 0.13274336283185842, 'f1-score': 0.22471910112359553, 'support': 226}, '15': {'precision': 0.765625, 'recall': 0.4666666666666667, 'f1-score': 0.5798816568047337, 'support': 105}, '16': {'precision': 0.7142857142857143, 'recall': 0.11029411764705882, 'f1-score': 0.1910828025477707, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.5, 'recall': 0.014084507042253521, 'f1-score': 0.027397260273972605, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.6143790849673203, 'recall': 0.1394917455017622, 'f1-score': 0.2273620559334845, 'support': 5391}, 'macro avg': {'precision': 0.3541110376566208, 'recall': 0.0851978740488811, 'f1-score': 0.11585301031972742, 'support': 5391}, 'weighted avg': {'precision': 0.46839291317584164, 'recall': 0.1394917455017622, 'f1-score': 0.18302130060374608, 'support': 5391}, 'samples avg': {'precision': 0.22654296875000002, 'recall': 0.14017051091269842, 'f1-score': 0.15699773967352093, 'support': 5391}}