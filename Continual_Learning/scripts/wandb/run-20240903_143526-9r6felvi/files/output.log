
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4306934298574924
Train: epoch: 1, loss = 0.42088163673877715
Train: epoch: 1, loss = 0.4179813070098559
Train: epoch: 1, loss = 0.41332190204411745
Train: epoch: 1, loss = 0.41103958314657213
Train: epoch: 1, loss = 0.40859098037083946
Train: epoch: 1, loss = 0.4074704468676022
Train: epoch: 1, loss = 0.404750699410215
Train: epoch: 1, loss = 0.40311854302055306
Train: epoch: 1, loss = 0.4024528397023678
Train: epoch: 1, loss = 0.40096658080816266
Train: epoch: 1, loss = 0.400092552776138
Train: epoch: 1, loss = 0.3985640402825979
Train: epoch: 1, loss = 0.39734705814293453
Train: epoch: 1, loss = 0.39623729106783867
Train: epoch: 1, loss = 0.3946094966959208
Train: epoch: 1, loss = 0.3939637562369599
Train: epoch: 1, loss = 0.3930173505180412
Train:  Epoch 1, Loss=0.39282503400908575, AUC-ROC Macro=0.6560087103616296, AUC-ROC Micro=0.7477274903215045
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37160565207401913, AUC-ROC Macro=0.7160111056292547, AUC-ROC Micro=0.7823469242643142
Eval task: 2
Eval:  Epoch 1, Loss=0.32306555286049843, AUC-ROC Macro=0.5131691683130484, AUC-ROC Micro=0.5987898556850724
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3754297980666161
Train: epoch: 2, loss = 0.37189999025315046
Train: epoch: 2, loss = 0.3735314743965864
Train: epoch: 2, loss = 0.37313831817358734
Train: epoch: 2, loss = 0.371501567736268
Train: epoch: 2, loss = 0.37130931604653594
Train: epoch: 2, loss = 0.3708520504938705
Train: epoch: 2, loss = 0.370298603605479
Train: epoch: 2, loss = 0.36980587012237975
Train: epoch: 2, loss = 0.3696608571857214
Train: epoch: 2, loss = 0.3693201887810772
Train: epoch: 2, loss = 0.36883422077943884
Train: epoch: 2, loss = 0.3684039627187527
Train: epoch: 2, loss = 0.36845680899385896
Train: epoch: 2, loss = 0.3684557324697574
Train: epoch: 2, loss = 0.36884520562831313
Train: epoch: 2, loss = 0.36836037878604494
Train: epoch: 2, loss = 0.3682641555906998
Train:  Epoch 2, Loss=0.36814712106468334, AUC-ROC Macro=0.7253821904334687, AUC-ROC Micro=0.7918420835931886
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36146146431565285, AUC-ROC Macro=0.7396319735836744, AUC-ROC Micro=0.7988662937852056
Eval task: 2
Eval:  Epoch 2, Loss=0.32385000586509705, AUC-ROC Macro=0.4898565919796243, AUC-ROC Micro=0.5746181020135327
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3578152918815613
Train: epoch: 3, loss = 0.36012970507144926
Train: epoch: 3, loss = 0.3595104027539492
Train: epoch: 3, loss = 0.3598289305530489
Train: epoch: 3, loss = 0.359965963229537
Train: epoch: 3, loss = 0.36054316818714144
Train: epoch: 3, loss = 0.3592283036453383
Train: epoch: 3, loss = 0.35885773816145955
Train: epoch: 3, loss = 0.3589558045566082
Train: epoch: 3, loss = 0.359232391320169
Train: epoch: 3, loss = 0.36014237374744634
Train: epoch: 3, loss = 0.3602650710009038
Train: epoch: 3, loss = 0.36049444852540125
Train: epoch: 3, loss = 0.3602791646335806
Train: epoch: 3, loss = 0.3603712559342384
Train: epoch: 3, loss = 0.36012686175759884
Train: epoch: 3, loss = 0.3596600927456337
Train: epoch: 3, loss = 0.3596702194958925
Train:  Epoch 3, Loss=0.3596772701679132, AUC-ROC Macro=0.744808805500482, AUC-ROC Micro=0.8047938577516422
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3561868506173293, AUC-ROC Macro=0.7506301717401378, AUC-ROC Micro=0.806369113965376
Eval task: 2
Eval:  Epoch 3, Loss=0.33063124492764473, AUC-ROC Macro=0.4796984899115445, AUC-ROC Micro=0.5624372456328582
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.35204995326697824
Train: epoch: 4, loss = 0.35131383445113895
Train: epoch: 4, loss = 0.3528873753299316
Train: epoch: 4, loss = 0.3537501648068428
Train: epoch: 4, loss = 0.3552628656923771
Train: epoch: 4, loss = 0.3557292843858401
Train: epoch: 4, loss = 0.35452412966106617
Train: epoch: 4, loss = 0.35468318505212665
Train: epoch: 4, loss = 0.35405275456607344
Train: epoch: 4, loss = 0.35421313374489544
Train: epoch: 4, loss = 0.35428038895807484
Train: epoch: 4, loss = 0.3542003737886747
Train: epoch: 4, loss = 0.3543718239435783
Train: epoch: 4, loss = 0.3541333171193089
Train: epoch: 4, loss = 0.3542886573970318
Train: epoch: 4, loss = 0.35413799036294225
Train: epoch: 4, loss = 0.35422066474662106
Train: epoch: 4, loss = 0.35398550587809746
Train:  Epoch 4, Loss=0.3541362777000818, AUC-ROC Macro=0.7567172755434042, AUC-ROC Micro=0.8130639714642489
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35302038739124936, AUC-ROC Macro=0.7572035099018701, AUC-ROC Micro=0.8111951286674265
Eval task: 2
Eval:  Epoch 4, Loss=0.3436517044901848, AUC-ROC Macro=0.4769840572773838, AUC-ROC Micro=0.5595994022155232
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3394391342252493
Train: epoch: 5, loss = 0.33677434660494326
Train: epoch: 5, loss = 0.3393049183736245
Train: epoch: 5, loss = 0.3409173234179616
Train: epoch: 5, loss = 0.3427500034421682
Train: epoch: 5, loss = 0.34524541260053715
Train: epoch: 5, loss = 0.3465787054172584
Train: epoch: 5, loss = 0.34732131828553975
Train: epoch: 5, loss = 0.34752627073890635
Train: epoch: 5, loss = 0.3482763227820396
Train: epoch: 5, loss = 0.3484903635084629
Train: epoch: 5, loss = 0.3490667706852158
Train: epoch: 5, loss = 0.34897069867413777
Train: epoch: 5, loss = 0.3492152769810387
Train: epoch: 5, loss = 0.34896730596820513
Train: epoch: 5, loss = 0.34891304716002197
Train: epoch: 5, loss = 0.3496225798612132
Train: epoch: 5, loss = 0.34986149518854087
Train:  Epoch 5, Loss=0.349729225823003, AUC-ROC Macro=0.7657017630950594, AUC-ROC Micro=0.8192405226761432
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3503995363910993, AUC-ROC Macro=0.761825812502879, AUC-ROC Micro=0.8149489509702607
Eval task: 2
Eval:  Epoch 5, Loss=0.3514821343123913, AUC-ROC Macro=0.47761790318989567, AUC-ROC Micro=0.5550937746554617
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3454734659194946
Train: epoch: 6, loss = 0.3455612827837467
Train: epoch: 6, loss = 0.34667674779891966
Train: epoch: 6, loss = 0.3474716665409505
Train: epoch: 6, loss = 0.34690128737688064
Train: epoch: 6, loss = 0.3476174741114179
Train: epoch: 6, loss = 0.347864836198943
Train: epoch: 6, loss = 0.3472694475576282
Train: epoch: 6, loss = 0.34618029134968914
Train: epoch: 6, loss = 0.3466967832669616
Train: epoch: 6, loss = 0.34732145793058655
Train: epoch: 6, loss = 0.34728424821048975
Train: epoch: 6, loss = 0.3470501048347125
Train: epoch: 6, loss = 0.3467678474049483
Train: epoch: 6, loss = 0.34645332205295565
Train: epoch: 6, loss = 0.3467158349882811
Train: epoch: 6, loss = 0.34694788605851284
Train: epoch: 6, loss = 0.346545332674351
Train:  Epoch 6, Loss=0.3464413361855042, AUC-ROC Macro=0.7722506757090474, AUC-ROC Micro=0.8237134343008636
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3492879383265972, AUC-ROC Macro=0.7632075122364627, AUC-ROC Micro=0.8166439565218565
Eval task: 2
Eval:  Epoch 6, Loss=0.35133369639515877, AUC-ROC Macro=0.4890592616080714, AUC-ROC Micro=0.5698361517613955
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35187381878495216, AUC-ROC Macro=0.7642152589556139, AUC-ROC Micro=0.8160990184725689
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3529955893754959, AUC-ROC Macro=0.49055366974212733, AUC-ROC Micro=0.5640336009273438
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.28499326318502427
Train: epoch: 1, loss = 0.27683566480875016
Train: epoch: 1, loss = 0.2730293896794319
Train: epoch: 1, loss = 0.269298439193517
Train: epoch: 1, loss = 0.26629369747638704
Train: epoch: 1, loss = 0.25978381872177125
Train:  Epoch 1, Loss=0.25657176194613607, AUC-ROC Macro=0.5987963599629054, AUC-ROC Micro=0.7504769905245489
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3694370860854785, AUC-ROC Macro=0.7423037242009153, AUC-ROC Micro=0.790881052321224
Eval task: 2
Eval:  Epoch 1, Loss=0.2501810993999243, AUC-ROC Macro=0.677265531612549, AUC-ROC Micro=0.7975834262524732
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2489270254969597
Train: epoch: 2, loss = 0.24983346048742533
Train: epoch: 2, loss = 0.25049028391639394
Train: epoch: 2, loss = 0.2497696109302342
Train: epoch: 2, loss = 0.25005295380949977
Train: epoch: 2, loss = 0.24481524810194968
Train:  Epoch 2, Loss=0.24119689813191622, AUC-ROC Macro=0.6871921511488378, AUC-ROC Micro=0.8035076905819707
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3686728651324908, AUC-ROC Macro=0.7450071583697628, AUC-ROC Micro=0.7972985709521734
Eval task: 2
Eval:  Epoch 2, Loss=0.24790572933852673, AUC-ROC Macro=0.7042145932940929, AUC-ROC Micro=0.8095512796376749
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.24591432467103005
Train: epoch: 3, loss = 0.24509700234979392
Train: epoch: 3, loss = 0.24598391036192577
Train: epoch: 3, loss = 0.24590631771832705
Train: epoch: 3, loss = 0.24548039254546167
Train: epoch: 3, loss = 0.2397440340804557
Train:  Epoch 3, Loss=0.2367802888389033, AUC-ROC Macro=0.7195639465300507, AUC-ROC Micro=0.8171094930224536
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.36940550183256465, AUC-ROC Macro=0.739185545169363, AUC-ROC Micro=0.7905068108626724
Eval task: 2
Eval:  Epoch 3, Loss=0.24558044038712978, AUC-ROC Macro=0.7221111737621014, AUC-ROC Micro=0.8165894824951875
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.23939810894429683
Train: epoch: 4, loss = 0.23970325177535415
Train: epoch: 4, loss = 0.2393286158144474
Train: epoch: 4, loss = 0.24032235337421298
Train: epoch: 4, loss = 0.24022937337309122
Train: epoch: 4, loss = 0.23546583322808146
Train:  Epoch 4, Loss=0.23275025796894716, AUC-ROC Macro=0.7410529545144378, AUC-ROC Micro=0.8270092296169251
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.36273745199044544, AUC-ROC Macro=0.745718796969622, AUC-ROC Micro=0.799906064896404
Eval task: 2
Eval:  Epoch 4, Loss=0.2442358434200287, AUC-ROC Macro=0.7204524748424967, AUC-ROC Micro=0.8160859400128231
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.23672540351748467
Train: epoch: 5, loss = 0.23650738686323167
Train: epoch: 5, loss = 0.2384916794920961
Train: epoch: 5, loss = 0.23836395273916422
Train: epoch: 5, loss = 0.23789817224442958
Train: epoch: 5, loss = 0.2320860901599129
Train:  Epoch 5, Loss=0.22957102246666097, AUC-ROC Macro=0.7537674559769789, AUC-ROC Micro=0.8345132132099985
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3679997983078162, AUC-ROC Macro=0.7368594581704947, AUC-ROC Micro=0.7881897148911654
Eval task: 2
Eval:  Epoch 5, Loss=0.2430391740053892, AUC-ROC Macro=0.734084660588069, AUC-ROC Micro=0.8264234769285921
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2326220151036978
Train: epoch: 6, loss = 0.23319600258022546
Train: epoch: 6, loss = 0.2346766088778774
Train: epoch: 6, loss = 0.23460977122187615
Train: epoch: 6, loss = 0.2344952222108841
Train: epoch: 6, loss = 0.22900848718980948
Train:  Epoch 6, Loss=0.22581388075225106, AUC-ROC Macro=0.7674326728186973, AUC-ROC Micro=0.840959055671475
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3587547838687897, AUC-ROC Macro=0.7392212342631715, AUC-ROC Micro=0.795558763127935
Eval task: 2
Eval:  Epoch 6, Loss=0.2383139207959175, AUC-ROC Macro=0.7316576071324029, AUC-ROC Micro=0.8230999186602432
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3694592999915282, AUC-ROC Macro=0.7407274196370239, AUC-ROC Micro=0.7958835389001164
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.21192979253828526, AUC-ROC Macro=0.7233176112849711, AUC-ROC Micro=0.8215631976801262
{'0': {'precision': 0.511, 'recall': 0.39067278287461776, 'f1-score': 0.44280762564991333, 'support': 1308}, '1': {'precision': 0.5868725868725869, 'recall': 0.3781094527363184, 'f1-score': 0.45990922844175497, 'support': 402}, '2': {'precision': 0.4567901234567901, 'recall': 0.05623100303951368, 'f1-score': 0.10013531799729364, 'support': 658}, '3': {'precision': 0.5710014947683109, 'recall': 0.19195979899497487, 'f1-score': 0.2873260624294848, 'support': 1990}, '4': {'precision': 0.46153846153846156, 'recall': 0.1488833746898263, 'f1-score': 0.225140712945591, 'support': 806}, '5': {'precision': 0.42857142857142855, 'recall': 0.007712082262210797, 'f1-score': 0.015151515151515152, 'support': 778}, '6': {'precision': 0.4808362369337979, 'recall': 0.2119815668202765, 'f1-score': 0.2942430703624733, 'support': 1302}, '7': {'precision': 0.2608695652173913, 'recall': 0.014150943396226415, 'f1-score': 0.026845637583892617, 'support': 424}, '8': {'precision': 0.5752351097178683, 'recall': 0.2232360097323601, 'f1-score': 0.3216476774758983, 'support': 1644}, '9': {'precision': 0.6664190193164933, 'recall': 0.44165435745937964, 'f1-score': 0.5312407462244597, 'support': 2031}, '10': {'precision': 0.6486486486486487, 'recall': 0.33507853403141363, 'f1-score': 0.4418872266973533, 'support': 573}, '11': {'precision': 0.5287356321839081, 'recall': 0.11734693877551021, 'f1-score': 0.1920668058455115, 'support': 1176}, '12': {'precision': 0.5483146067415731, 'recall': 0.27570621468926554, 'f1-score': 0.3669172932330827, 'support': 1770}, '13': {'precision': 0.5849056603773585, 'recall': 0.3701848998459168, 'f1-score': 0.4534088228355744, 'support': 2596}, '14': {'precision': 0.532741398446171, 'recall': 0.29502151198524895, 'f1-score': 0.37974683544303806, 'support': 1627}, '15': {'precision': 0.25, 'recall': 0.002066115702479339, 'f1-score': 0.004098360655737705, 'support': 484}, '16': {'precision': 0.4253393665158371, 'recall': 0.11823899371069183, 'f1-score': 0.18503937007874016, 'support': 795}, '17': {'precision': 0.37777777777777777, 'recall': 0.03125, 'f1-score': 0.057724957555178265, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.5, 'recall': 0.011450381679389313, 'f1-score': 0.02238805970149254, 'support': 262}, '20': {'precision': 0.23684210526315788, 'recall': 0.015985790408525755, 'f1-score': 0.029950083194675542, 'support': 563}, '21': {'precision': 0.5238095238095238, 'recall': 0.14456391875746716, 'f1-score': 0.2265917602996255, 'support': 837}, '22': {'precision': 0.699724517906336, 'recall': 0.4677716390423573, 'f1-score': 0.5607064017660043, 'support': 1086}, '23': {'precision': 0.615819209039548, 'recall': 0.25319396051103366, 'f1-score': 0.3588477366255144, 'support': 861}, '24': {'precision': 0.5875706214689266, 'recall': 0.20594059405940593, 'f1-score': 0.30498533724340177, 'support': 505}, 'micro avg': {'precision': 0.5712677113634231, 'recall': 0.23994009380049658, 'f1-score': 0.33794060505134604, 'support': 25373}, 'macro avg': {'precision': 0.4823745237828759, 'recall': 0.1883356346081764, 'f1-score': 0.2515522658174883, 'support': 25373}, 'weighted avg': {'precision': 0.5275640699974367, 'recall': 0.23994009380049658, 'f1-score': 0.3147213025150881, 'support': 25373}, 'samples avg': {'precision': 0.3491559732404459, 'recall': 0.21322750010278735, 'f1-score': 0.241035394285792, 'support': 25373}}
{'0': {'precision': 0.5841584158415841, 'recall': 0.423444976076555, 'f1-score': 0.4909847434119279, 'support': 418}, '1': {'precision': 0.5079365079365079, 'recall': 0.14814814814814814, 'f1-score': 0.2293906810035842, 'support': 216}, '2': {'precision': 0.16666666666666666, 'recall': 0.003472222222222222, 'f1-score': 0.006802721088435375, 'support': 288}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 252}, '4': {'precision': 0.4583333333333333, 'recall': 0.0763888888888889, 'f1-score': 0.13095238095238096, 'support': 288}, '5': {'precision': 0.6875, 'recall': 0.040892193308550186, 'f1-score': 0.07719298245614035, 'support': 269}, '6': {'precision': 0.3939393939393939, 'recall': 0.045936395759717315, 'f1-score': 0.08227848101265824, 'support': 283}, '7': {'precision': 0.7638888888888888, 'recall': 0.43137254901960786, 'f1-score': 0.5513784461152883, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.5217391304347826, 'recall': 0.15254237288135594, 'f1-score': 0.2360655737704918, 'support': 236}, '10': {'precision': 0.48148148148148145, 'recall': 0.07103825136612021, 'f1-score': 0.1238095238095238, 'support': 183}, '11': {'precision': 0.8, 'recall': 0.019138755980861243, 'f1-score': 0.037383177570093455, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.5714285714285714, 'recall': 0.036036036036036036, 'f1-score': 0.06779661016949153, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.7341772151898734, 'recall': 0.6444444444444445, 'f1-score': 0.6863905325443788, 'support': 90}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.5960346964064436, 'recall': 0.12654564588266246, 'f1-score': 0.2087673611111111, 'support': 3801}, 'macro avg': {'precision': 0.2668499842056433, 'recall': 0.08371420936530033, 'f1-score': 0.10881703415617579, 'support': 3801}, 'weighted avg': {'precision': 0.4033287517434788, 'recall': 0.12654564588266246, 'f1-score': 0.1669526386304482, 'support': 3801}, 'samples avg': {'precision': 0.20767647879464285, 'recall': 0.1448637462797619, 'f1-score': 0.15950124501149893, 'support': 3801}}