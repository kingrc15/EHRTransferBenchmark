
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43161564469337466
Train: epoch: 1, loss = 0.42337248884141443
Train: epoch: 1, loss = 0.4171339970330397
Train: epoch: 1, loss = 0.4134160011634231
Train: epoch: 1, loss = 0.4101964522898197
Train: epoch: 1, loss = 0.40871584656337895
Train: epoch: 1, loss = 0.40701556261096683
Train: epoch: 1, loss = 0.4056385898310691
Train: epoch: 1, loss = 0.40444819788965913
Train: epoch: 1, loss = 0.4034557288140059
Train: epoch: 1, loss = 0.4030808029527014
Train: epoch: 1, loss = 0.40185256794095037
Train: epoch: 1, loss = 0.4003036912759909
Train: epoch: 1, loss = 0.399294873321695
Train: epoch: 1, loss = 0.398026852418979
Train: epoch: 1, loss = 0.39760356208309533
Train: epoch: 1, loss = 0.3962925374770866
Train: epoch: 1, loss = 0.3956577227223251
Train:  Epoch 1, Loss=0.3952770940055195, AUC-ROC Macro=0.6477034199702003, AUC-ROC Micro=0.7429212261272945
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37298850218455, AUC-ROC Macro=0.7132278776938964, AUC-ROC Micro=0.779930004130357
Eval task: 2
Eval:  Epoch 1, Loss=0.34940882623195646, AUC-ROC Macro=0.4799078408666127, AUC-ROC Micro=0.5604355944054897
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3771252565085888
Train: epoch: 2, loss = 0.37697412323206664
Train: epoch: 2, loss = 0.3718617909401655
Train: epoch: 2, loss = 0.37138907494023443
Train: epoch: 2, loss = 0.3719417105615139
Train: epoch: 2, loss = 0.371101527561744
Train: epoch: 2, loss = 0.37128176992493017
Train: epoch: 2, loss = 0.37095598149113357
Train: epoch: 2, loss = 0.37082371804449293
Train: epoch: 2, loss = 0.37007017944008114
Train: epoch: 2, loss = 0.3698674290424043
Train: epoch: 2, loss = 0.3698619760759175
Train: epoch: 2, loss = 0.36999311498724496
Train: epoch: 2, loss = 0.3701864436055933
Train: epoch: 2, loss = 0.36988178283969564
Train: epoch: 2, loss = 0.36983673790004107
Train: epoch: 2, loss = 0.3692147303898545
Train: epoch: 2, loss = 0.36909843967606626
Train:  Epoch 2, Loss=0.3690685053156991, AUC-ROC Macro=0.7234489165800955, AUC-ROC Micro=0.7903669075129883
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36094579597314197, AUC-ROC Macro=0.7395594829411586, AUC-ROC Micro=0.7995571692122592
Eval task: 2
Eval:  Epoch 2, Loss=0.35613841712474825, AUC-ROC Macro=0.46800211416691573, AUC-ROC Micro=0.5517735758296755
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3687073858827353
Train: epoch: 3, loss = 0.3671602141857147
Train: epoch: 3, loss = 0.3671481248736381
Train: epoch: 3, loss = 0.3655514811910689
Train: epoch: 3, loss = 0.36543497307598594
Train: epoch: 3, loss = 0.36372685046245656
Train: epoch: 3, loss = 0.3629096661720957
Train: epoch: 3, loss = 0.3621161913871765
Train: epoch: 3, loss = 0.3624626847936048
Train: epoch: 3, loss = 0.3630036037936807
Train: epoch: 3, loss = 0.3624736348675056
Train: epoch: 3, loss = 0.3620196942426264
Train: epoch: 3, loss = 0.3616560396609398
Train: epoch: 3, loss = 0.36113732632781775
Train: epoch: 3, loss = 0.3609608646382888
Train: epoch: 3, loss = 0.36088752855546774
Train: epoch: 3, loss = 0.36048312003998195
Train: epoch: 3, loss = 0.36017867935614456
Train:  Epoch 3, Loss=0.36015305745499765, AUC-ROC Macro=0.7433909311884506, AUC-ROC Micro=0.8040689133134714
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3576911787192027, AUC-ROC Macro=0.7498967660943778, AUC-ROC Micro=0.8057190937230769
Eval task: 2
Eval:  Epoch 3, Loss=0.3745307415723801, AUC-ROC Macro=0.46645474328363484, AUC-ROC Micro=0.5493586521970784
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.35281878016889096
Train: epoch: 4, loss = 0.35702313359826804
Train: epoch: 4, loss = 0.3550754050910473
Train: epoch: 4, loss = 0.35599838018417357
Train: epoch: 4, loss = 0.3568952156454325
Train: epoch: 4, loss = 0.35632535799096027
Train: epoch: 4, loss = 0.3546725159244878
Train: epoch: 4, loss = 0.3542576869577169
Train: epoch: 4, loss = 0.35468688334027926
Train: epoch: 4, loss = 0.35441086114197967
Train: epoch: 4, loss = 0.3538998729600148
Train: epoch: 4, loss = 0.35430254782860476
Train: epoch: 4, loss = 0.35453061363444877
Train: epoch: 4, loss = 0.35475528577076537
Train: epoch: 4, loss = 0.3544733284811179
Train: epoch: 4, loss = 0.35457158474251627
Train: epoch: 4, loss = 0.3548074799206327
Train: epoch: 4, loss = 0.35453181670357786
Train:  Epoch 4, Loss=0.3546163543309921, AUC-ROC Macro=0.7558284680270277, AUC-ROC Micro=0.8122515784181698
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3532997394601504, AUC-ROC Macro=0.7561985850111772, AUC-ROC Micro=0.8107538705368442
Eval task: 2
Eval:  Epoch 4, Loss=0.38090781569480897, AUC-ROC Macro=0.4640227552826296, AUC-ROC Micro=0.5513058541026522
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.35047022700309755
Train: epoch: 5, loss = 0.35033497869968416
Train: epoch: 5, loss = 0.3482972450802724
Train: epoch: 5, loss = 0.34898393413051965
Train: epoch: 5, loss = 0.3496521780788898
Train: epoch: 5, loss = 0.34923861881097157
Train: epoch: 5, loss = 0.3490739468697991
Train: epoch: 5, loss = 0.3496264639031142
Train: epoch: 5, loss = 0.3502062167144484
Train: epoch: 5, loss = 0.350601278655231
Train: epoch: 5, loss = 0.35079927625981244
Train: epoch: 5, loss = 0.35062309212361775
Train: epoch: 5, loss = 0.3508822439840207
Train: epoch: 5, loss = 0.3510327033751777
Train: epoch: 5, loss = 0.3510196132908265
Train: epoch: 5, loss = 0.35092994092032315
Train: epoch: 5, loss = 0.350449813100345
Train: epoch: 5, loss = 0.3502920775281058
Train:  Epoch 5, Loss=0.35033386423037605, AUC-ROC Macro=0.7648886852138794, AUC-ROC Micro=0.8184547025089384
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35011081273357075, AUC-ROC Macro=0.7616242468794218, AUC-ROC Micro=0.8154373947141897
Eval task: 2
Eval:  Epoch 5, Loss=0.39269554018974306, AUC-ROC Macro=0.46649632395158647, AUC-ROC Micro=0.5384446193395473
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.33976082742214203
Train: epoch: 6, loss = 0.3426684045046568
Train: epoch: 6, loss = 0.3433565273632606
Train: epoch: 6, loss = 0.3442531802877784
Train: epoch: 6, loss = 0.3455036790519953
Train: epoch: 6, loss = 0.3452271706983447
Train: epoch: 6, loss = 0.3464507927639144
Train: epoch: 6, loss = 0.34648676646873355
Train: epoch: 6, loss = 0.34638599707848494
Train: epoch: 6, loss = 0.34646296682953837
Train: epoch: 6, loss = 0.34650128102438016
Train: epoch: 6, loss = 0.346740118569384
Train: epoch: 6, loss = 0.34669044417830613
Train: epoch: 6, loss = 0.3469904386890786
Train: epoch: 6, loss = 0.34637342336773874
Train: epoch: 6, loss = 0.3465994537854567
Train: epoch: 6, loss = 0.3468807300618466
Train: epoch: 6, loss = 0.3468581829302841
Train:  Epoch 6, Loss=0.34682312017832045, AUC-ROC Macro=0.7717902584041444, AUC-ROC Micro=0.8231989269326547
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3493632326523463, AUC-ROC Macro=0.7642661256833045, AUC-ROC Micro=0.816497527757148
Eval task: 2
Eval:  Epoch 6, Loss=0.39845307171344757, AUC-ROC Macro=0.4584031238024116, AUC-ROC Micro=0.5334841003723468
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35220345109701157, AUC-ROC Macro=0.7636703435933876, AUC-ROC Micro=0.8151770537836285
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.397805717587471, AUC-ROC Macro=0.45244636359914236, AUC-ROC Micro=0.5338927825483489
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3218150544166565
Train: epoch: 1, loss = 0.3134964416921139
Train: epoch: 1, loss = 0.30904034815728665
Train: epoch: 1, loss = 0.30531671937555077
Train: epoch: 1, loss = 0.303823716044426
Train: epoch: 1, loss = 0.3017142295713226
Train: epoch: 1, loss = 0.30036769816918035
Train:  Epoch 1, Loss=0.2987290183835749, AUC-ROC Macro=0.6023080360738361, AUC-ROC Micro=0.7441836542405794
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.34032456080118817, AUC-ROC Macro=0.7577091704130968, AUC-ROC Micro=0.8112449065557351
Eval task: 2
Eval:  Epoch 1, Loss=0.2788035422563553, AUC-ROC Macro=0.6663159951736994, AUC-ROC Micro=0.7843241949985307
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.286264718696475
Train: epoch: 2, loss = 0.2865242878347635
Train: epoch: 2, loss = 0.2860312223682801
Train: epoch: 2, loss = 0.28613047817721965
Train: epoch: 2, loss = 0.28489903795719146
Train: epoch: 2, loss = 0.28407704072693984
Train: epoch: 2, loss = 0.28371945414159977
Train:  Epoch 2, Loss=0.28275854769751296, AUC-ROC Macro=0.6925545710702449, AUC-ROC Micro=0.795384976805682
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3300553821027279, AUC-ROC Macro=0.7524750501646422, AUC-ROC Micro=0.8065707304013088
Eval task: 2
Eval:  Epoch 2, Loss=0.26440734714269637, AUC-ROC Macro=0.6994393752385152, AUC-ROC Micro=0.7997306484071767
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.27697942160069944
Train: epoch: 3, loss = 0.2751496007293463
Train: epoch: 3, loss = 0.2746618493894736
Train: epoch: 3, loss = 0.27425368219614027
Train: epoch: 3, loss = 0.27346800115704534
Train: epoch: 3, loss = 0.2737174420679609
Train: epoch: 3, loss = 0.27347342874322617
Train:  Epoch 3, Loss=0.273115937555562, AUC-ROC Macro=0.7160850187973581, AUC-ROC Micro=0.8085534237582228
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.34900688131650287, AUC-ROC Macro=0.744091940826519, AUC-ROC Micro=0.7965580852809405
Eval task: 2
Eval:  Epoch 3, Loss=0.28855970948934556, AUC-ROC Macro=0.7039706111310184, AUC-ROC Micro=0.8038831803684161
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.2684387063235045
Train: epoch: 4, loss = 0.2661507716029882
Train: epoch: 4, loss = 0.2661462996651729
Train: epoch: 4, loss = 0.26613896127790215
Train: epoch: 4, loss = 0.2653070692718029
Train: epoch: 4, loss = 0.2653890970100959
Train: epoch: 4, loss = 0.26570143924227785
Train:  Epoch 4, Loss=0.2654234157554525, AUC-ROC Macro=0.7321143570702178, AUC-ROC Micro=0.8168199208069511
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3232678783436616, AUC-ROC Macro=0.7415782240807792, AUC-ROC Micro=0.7963776803289153
Eval task: 2
Eval:  Epoch 4, Loss=0.27239902019500734, AUC-ROC Macro=0.7138809399222452, AUC-ROC Micro=0.8036728743920865
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.25810972169041635
Train: epoch: 5, loss = 0.26000089596956966
Train: epoch: 5, loss = 0.25969602530201275
Train: epoch: 5, loss = 0.26016510764136913
Train: epoch: 5, loss = 0.2593668707758188
Train: epoch: 5, loss = 0.2591446889688571
Train: epoch: 5, loss = 0.25841700614563057
Train:  Epoch 5, Loss=0.258121068954013, AUC-ROC Macro=0.7470541603081162, AUC-ROC Micro=0.8247817512091877
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3328276053071022, AUC-ROC Macro=0.7392661255937764, AUC-ROC Micro=0.794022155510973
Eval task: 2
Eval:  Epoch 5, Loss=0.26319742798805235, AUC-ROC Macro=0.7156466946821319, AUC-ROC Micro=0.8078573713360586
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2528495777398348
Train: epoch: 6, loss = 0.2527458529919386
Train: epoch: 6, loss = 0.2525733222067356
Train: epoch: 6, loss = 0.2522912626154721
Train: epoch: 6, loss = 0.2523795178681612
Train: epoch: 6, loss = 0.25277580607682465
Train: epoch: 6, loss = 0.25285767162484785
Train:  Epoch 6, Loss=0.25213796303488645, AUC-ROC Macro=0.756967005552213, AUC-ROC Micro=0.8294724437429406
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.33682746812701225, AUC-ROC Macro=0.7338644541691014, AUC-ROC Micro=0.7890761925210142
Eval task: 2
Eval:  Epoch 6, Loss=0.25649415105581286, AUC-ROC Macro=0.7173743433069757, AUC-ROC Micro=0.8095639146378454
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.39701318740844727, AUC-ROC Macro=0.7316905867254877, AUC-ROC Micro=0.7873798135941923
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2337471753358841, AUC-ROC Macro=0.7232974653256851, AUC-ROC Micro=0.8119729820301086
{'0': {'precision': 0.5555555555555556, 'recall': 0.290519877675841, 'f1-score': 0.38152610441767065, 'support': 1308}, '1': {'precision': 0.5281501340482574, 'recall': 0.4900497512437811, 'f1-score': 0.5083870967741936, 'support': 402}, '2': {'precision': 0.3978494623655914, 'recall': 0.11246200607902736, 'f1-score': 0.17535545023696683, 'support': 658}, '3': {'precision': 0.48214285714285715, 'recall': 0.3663316582914573, 'f1-score': 0.41633352370074245, 'support': 1990}, '4': {'precision': 0.3977272727272727, 'recall': 0.17369727047146402, 'f1-score': 0.24179620034542315, 'support': 806}, '5': {'precision': 0.3458646616541353, 'recall': 0.05912596401028278, 'f1-score': 0.10098792535675083, 'support': 778}, '6': {'precision': 0.48549323017408125, 'recall': 0.19278033794162827, 'f1-score': 0.2759758108851017, 'support': 1302}, '7': {'precision': 0.24770642201834864, 'recall': 0.06367924528301887, 'f1-score': 0.10131332082551595, 'support': 424}, '8': {'precision': 0.49719495091164095, 'recall': 0.43126520681265207, 'f1-score': 0.46188925081433224, 'support': 1644}, '9': {'precision': 0.5916030534351145, 'recall': 0.534219596258001, 'f1-score': 0.5614489003880982, 'support': 2031}, '10': {'precision': 0.5141242937853108, 'recall': 0.31762652705061084, 'f1-score': 0.3926645091693635, 'support': 573}, '11': {'precision': 0.43425076452599387, 'recall': 0.24149659863945577, 'f1-score': 0.31038251366120223, 'support': 1176}, '12': {'precision': 0.5141630901287554, 'recall': 0.3384180790960452, 'f1-score': 0.4081771720613288, 'support': 1770}, '13': {'precision': 0.5129324823647968, 'recall': 0.5882126348228043, 'f1-score': 0.5479992822537232, 'support': 2596}, '14': {'precision': 0.5058214747736093, 'recall': 0.24031960663798402, 'f1-score': 0.32583333333333336, 'support': 1627}, '15': {'precision': 0.14942528735632185, 'recall': 0.026859504132231406, 'f1-score': 0.04553415061295972, 'support': 484}, '16': {'precision': 0.34674922600619196, 'recall': 0.14088050314465408, 'f1-score': 0.2003577817531306, 'support': 795}, '17': {'precision': 0.3161290322580645, 'recall': 0.0900735294117647, 'f1-score': 0.1402002861230329, 'support': 544}, '18': {'precision': 0.16666666666666666, 'recall': 0.002849002849002849, 'f1-score': 0.0056022408963585435, 'support': 351}, '19': {'precision': 0.38666666666666666, 'recall': 0.11068702290076336, 'f1-score': 0.17210682492581603, 'support': 262}, '20': {'precision': 0.28125, 'recall': 0.03197158081705151, 'f1-score': 0.05741626794258373, 'support': 563}, '21': {'precision': 0.4732510288065844, 'recall': 0.2747909199522103, 'f1-score': 0.34769463340891915, 'support': 837}, '22': {'precision': 0.6, 'recall': 0.5441988950276243, 'f1-score': 0.570738773539353, 'support': 1086}, '23': {'precision': 0.5038314176245211, 'recall': 0.305458768873403, 'f1-score': 0.3803326102675344, 'support': 861}, '24': {'precision': 0.5042372881355932, 'recall': 0.23564356435643563, 'f1-score': 0.32118758434547906, 'support': 505}, 'micro avg': {'precision': 0.5032524393294971, 'recall': 0.3171087376344934, 'f1-score': 0.3890621600058026, 'support': 25373}, 'macro avg': {'precision': 0.42955145276527723, 'recall': 0.2481447060711678, 'f1-score': 0.2980496619215565, 'support': 25373}, 'weighted avg': {'precision': 0.4709771835938895, 'recall': 0.3171087376344934, 'f1-score': 0.36359040479681176, 'support': 25373}, 'samples avg': {'precision': 0.40682795485041573, 'recall': 0.2913628947794274, 'f1-score': 0.31161655940778216, 'support': 25373}}
{'0': {'precision': 0.634032634032634, 'recall': 0.49364791288566245, 'f1-score': 0.5551020408163265, 'support': 551}, '1': {'precision': 0.5571428571428572, 'recall': 0.23889739663093415, 'f1-score': 0.33440514469453375, 'support': 653}, '2': {'precision': 1.0, 'recall': 0.004694835680751174, 'f1-score': 0.009345794392523364, 'support': 426}, '3': {'precision': 0.4387755102040816, 'recall': 0.10513447432762836, 'f1-score': 0.16962524654832345, 'support': 409}, '4': {'precision': 0.21875, 'recall': 0.02857142857142857, 'f1-score': 0.05054151624548736, 'support': 245}, '5': {'precision': 0.5853658536585366, 'recall': 0.0670391061452514, 'f1-score': 0.12030075187969923, 'support': 358}, '6': {'precision': 0.3333333333333333, 'recall': 0.028688524590163935, 'f1-score': 0.05283018867924529, 'support': 244}, '7': {'precision': 0.6447368421052632, 'recall': 0.3333333333333333, 'f1-score': 0.43946188340807174, 'support': 294}, '8': {'precision': 0.25, 'recall': 0.0038022813688212928, 'f1-score': 0.007490636704119851, 'support': 263}, '9': {'precision': 0.8181818181818182, 'recall': 0.03237410071942446, 'f1-score': 0.06228373702422146, 'support': 278}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 208}, '11': {'precision': 0.5, 'recall': 0.024096385542168676, 'f1-score': 0.04597701149425288, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.6666666666666666, 'recall': 0.07575757575757576, 'f1-score': 0.13605442176870747, 'support': 132}, '14': {'precision': 0.6875, 'recall': 0.14601769911504425, 'f1-score': 0.24087591240875914, 'support': 226}, '15': {'precision': 0.7936507936507936, 'recall': 0.47619047619047616, 'f1-score': 0.5952380952380952, 'support': 105}, '16': {'precision': 0.625, 'recall': 0.11029411764705882, 'f1-score': 0.1875, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.5940032414910859, 'recall': 0.13596735299573362, 'f1-score': 0.2212830188679245, 'support': 5391}, 'macro avg': {'precision': 0.35012545235903936, 'recall': 0.08674158594022892, 'f1-score': 0.12028129525209469, 'support': 5391}, 'weighted avg': {'precision': 0.49751048414944393, 'recall': 0.13596735299573362, 'f1-score': 0.1829454369733679, 'support': 5391}, 'samples avg': {'precision': 0.21508463541666661, 'recall': 0.13547030009920635, 'f1-score': 0.1524348936653624, 'support': 5391}}