
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4323237419128418
Train: epoch: 1, loss = 0.4173035421594977
Train: epoch: 1, loss = 0.41389411099255086
Train: epoch: 1, loss = 0.41249596955254675
Train: epoch: 1, loss = 0.4106593467444181
Train: epoch: 1, loss = 0.40878727082163097
Train: epoch: 1, loss = 0.4069693086828504
Train: epoch: 1, loss = 0.40479757860302923
Train: epoch: 1, loss = 0.40341615487304
Train: epoch: 1, loss = 0.4018911574482918
Train: epoch: 1, loss = 0.4003287028859962
Train: epoch: 1, loss = 0.3993884597346187
Train: epoch: 1, loss = 0.3976984483691362
Train: epoch: 1, loss = 0.39585853781018937
Train: epoch: 1, loss = 0.3946441284120083
Train: epoch: 1, loss = 0.39387144666630775
Train: epoch: 1, loss = 0.39260524389498375
Train: epoch: 1, loss = 0.3914992861739463
Train:  Epoch 1, Loss=0.39132555693642707, AUC-ROC Macro=0.6607670165279523, AUC-ROC Micro=0.7505722684086742
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37076078231136006, AUC-ROC Macro=0.7201051526517251, AUC-ROC Micro=0.78558923468058
Eval task: 2
Eval:  Epoch 1, Loss=0.3169837184250355, AUC-ROC Macro=0.49625562751381863, AUC-ROC Micro=0.5636543268933891
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37330101765692236
Train: epoch: 2, loss = 0.370767325386405
Train: epoch: 2, loss = 0.3698524061838786
Train: epoch: 2, loss = 0.3689203792437911
Train: epoch: 2, loss = 0.3688913421779871
Train: epoch: 2, loss = 0.3695121507843335
Train: epoch: 2, loss = 0.36946938687137193
Train: epoch: 2, loss = 0.3701257741451263
Train: epoch: 2, loss = 0.37006100312703183
Train: epoch: 2, loss = 0.36983281475305557
Train: epoch: 2, loss = 0.36958777063272213
Train: epoch: 2, loss = 0.36939860094338656
Train: epoch: 2, loss = 0.3691081882726688
Train: epoch: 2, loss = 0.36939617831259963
Train: epoch: 2, loss = 0.3688282705595096
Train: epoch: 2, loss = 0.36859709696844223
Train: epoch: 2, loss = 0.36793825591311735
Train: epoch: 2, loss = 0.3674382565087742
Train:  Epoch 2, Loss=0.3673479924140832, AUC-ROC Macro=0.7271718949204474, AUC-ROC Micro=0.7930408049124875
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3602498819430669, AUC-ROC Macro=0.7419232001943747, AUC-ROC Micro=0.8005899598081861
Eval task: 2
Eval:  Epoch 2, Loss=0.32099831104278564, AUC-ROC Macro=0.49200003988075475, AUC-ROC Micro=0.5747395586955855
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36000080294907094
Train: epoch: 3, loss = 0.36114449515938757
Train: epoch: 3, loss = 0.36002419508993627
Train: epoch: 3, loss = 0.36045765563845633
Train: epoch: 3, loss = 0.3591629768460989
Train: epoch: 3, loss = 0.3605108576143781
Train: epoch: 3, loss = 0.36055478030017446
Train: epoch: 3, loss = 0.3603185678739101
Train: epoch: 3, loss = 0.36021939548353354
Train: epoch: 3, loss = 0.36007121147215365
Train: epoch: 3, loss = 0.36016542839733034
Train: epoch: 3, loss = 0.35982955928891897
Train: epoch: 3, loss = 0.35905882563155433
Train: epoch: 3, loss = 0.35918695239616294
Train: epoch: 3, loss = 0.35940155992408596
Train: epoch: 3, loss = 0.3595286743622273
Train: epoch: 3, loss = 0.3592516365603489
Train: epoch: 3, loss = 0.3595300514457954
Train:  Epoch 3, Loss=0.3595477068505735, AUC-ROC Macro=0.7454349925279078, AUC-ROC Micro=0.8050422150866297
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35652589177091915, AUC-ROC Macro=0.7505125945538156, AUC-ROC Micro=0.8060134827126595
Eval task: 2
Eval:  Epoch 3, Loss=0.329506304115057, AUC-ROC Macro=0.48665205759712526, AUC-ROC Micro=0.5633707349804346
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.34470227628946304
Train: epoch: 4, loss = 0.34992457706481217
Train: epoch: 4, loss = 0.3485884431997935
Train: epoch: 4, loss = 0.34866817692294716
Train: epoch: 4, loss = 0.3500318454802036
Train: epoch: 4, loss = 0.35168164271861313
Train: epoch: 4, loss = 0.35254666342266966
Train: epoch: 4, loss = 0.3536624804604799
Train: epoch: 4, loss = 0.35440651470588314
Train: epoch: 4, loss = 0.3545296859368682
Train: epoch: 4, loss = 0.3541212822361426
Train: epoch: 4, loss = 0.35395872258891664
Train: epoch: 4, loss = 0.3540381182902134
Train: epoch: 4, loss = 0.3540119182478104
Train: epoch: 4, loss = 0.3542647255659103
Train: epoch: 4, loss = 0.3544170861924067
Train: epoch: 4, loss = 0.354408901289982
Train: epoch: 4, loss = 0.3543766814346115
Train:  Epoch 4, Loss=0.3541996241481895, AUC-ROC Macro=0.7568916676059778, AUC-ROC Micro=0.8128947464922802
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35458342730998993, AUC-ROC Macro=0.7576728207355017, AUC-ROC Micro=0.81205442062855
Eval task: 2
Eval:  Epoch 4, Loss=0.33605143055319786, AUC-ROC Macro=0.48574425817958944, AUC-ROC Micro=0.5619959124659161
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.34810835249722005
Train: epoch: 5, loss = 0.3488851718604565
Train: epoch: 5, loss = 0.35085178626080354
Train: epoch: 5, loss = 0.34909120166674257
Train: epoch: 5, loss = 0.3488467992693186
Train: epoch: 5, loss = 0.349343856908381
Train: epoch: 5, loss = 0.34936463665749345
Train: epoch: 5, loss = 0.3499620355386287
Train: epoch: 5, loss = 0.35077090755105017
Train: epoch: 5, loss = 0.3504861309751868
Train: epoch: 5, loss = 0.3506117282807827
Train: epoch: 5, loss = 0.3506036528820793
Train: epoch: 5, loss = 0.35029832965479446
Train: epoch: 5, loss = 0.3503815457650593
Train: epoch: 5, loss = 0.3509651641647021
Train: epoch: 5, loss = 0.3509252273617312
Train: epoch: 5, loss = 0.350532294713399
Train: epoch: 5, loss = 0.35031555857923297
Train:  Epoch 5, Loss=0.35015114144789866, AUC-ROC Macro=0.7651351498886957, AUC-ROC Micro=0.8185220883251216
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.353384830057621, AUC-ROC Macro=0.7589361391085353, AUC-ROC Micro=0.8125226766043425
Eval task: 2
Eval:  Epoch 5, Loss=0.3659643158316612, AUC-ROC Macro=0.4889253092749027, AUC-ROC Micro=0.5640674865851829
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3464364751428366
Train: epoch: 6, loss = 0.34894429326057436
Train: epoch: 6, loss = 0.34765411376953126
Train: epoch: 6, loss = 0.34838650554418565
Train: epoch: 6, loss = 0.3478422449529171
Train: epoch: 6, loss = 0.34825913549711307
Train: epoch: 6, loss = 0.3483263986131975
Train: epoch: 6, loss = 0.34844146282412114
Train: epoch: 6, loss = 0.3476097023155954
Train: epoch: 6, loss = 0.3479767125621438
Train: epoch: 6, loss = 0.34737401486797764
Train: epoch: 6, loss = 0.3465919917883972
Train: epoch: 6, loss = 0.34581403468090754
Train: epoch: 6, loss = 0.34563778732504163
Train: epoch: 6, loss = 0.3458172313819329
Train: epoch: 6, loss = 0.34582284042611716
Train: epoch: 6, loss = 0.3464250620892819
Train: epoch: 6, loss = 0.3467672067011396
Train:  Epoch 6, Loss=0.3467980828061063, AUC-ROC Macro=0.7716462309177626, AUC-ROC Micro=0.8232287440976345
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3506708890199661, AUC-ROC Macro=0.76247331130007, AUC-ROC Micro=0.8147400069336184
Eval task: 2
Eval:  Epoch 6, Loss=0.34809141978621483, AUC-ROC Macro=0.4849462930670109, AUC-ROC Micro=0.543675442483684
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3526635393500328, AUC-ROC Macro=0.7641763579820439, AUC-ROC Micro=0.8150296642157993
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3508855774998665, AUC-ROC Macro=0.4819545286604752, AUC-ROC Micro=0.5387353857201753
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2930045775324106
Train: epoch: 1, loss = 0.2816862005367875
Train: epoch: 1, loss = 0.27592874648670357
Train: epoch: 1, loss = 0.2722417995892465
Train: epoch: 1, loss = 0.26859737864136696
Train: epoch: 1, loss = 0.26061996904512247
Train:  Epoch 1, Loss=0.2558720382564355, AUC-ROC Macro=0.6058230474396429, AUC-ROC Micro=0.7546224694240664
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3754665106534958, AUC-ROC Macro=0.7350381282597129, AUC-ROC Micro=0.7853636308533657
Eval task: 2
Eval:  Epoch 1, Loss=0.2648173402994871, AUC-ROC Macro=0.6755322335257026, AUC-ROC Micro=0.7977852387313105
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2520018105581403
Train: epoch: 2, loss = 0.25130305567756295
Train: epoch: 2, loss = 0.25088612145433825
Train: epoch: 2, loss = 0.2502266546618193
Train: epoch: 2, loss = 0.2503465528562665
Train: epoch: 2, loss = 0.24417321500678857
Train:  Epoch 2, Loss=0.24079821885144792, AUC-ROC Macro=0.6961297141929379, AUC-ROC Micro=0.8059475210573652
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.37309126431743306, AUC-ROC Macro=0.7340395864121975, AUC-ROC Micro=0.7885635164391037
Eval task: 2
Eval:  Epoch 2, Loss=0.2611411474645138, AUC-ROC Macro=0.7110244717179184, AUC-ROC Micro=0.8144483487286519
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.24640797436237336
Train: epoch: 3, loss = 0.24379880998283623
Train: epoch: 3, loss = 0.24339465881387393
Train: epoch: 3, loss = 0.24362166615203024
Train: epoch: 3, loss = 0.24340201231837272
Train: epoch: 3, loss = 0.2385904261780282
Train:  Epoch 3, Loss=0.2358235248887637, AUC-ROC Macro=0.7293611916471001, AUC-ROC Micro=0.8206869847991365
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3635409226020177, AUC-ROC Macro=0.7441262611405649, AUC-ROC Micro=0.7988271283911837
Eval task: 2
Eval:  Epoch 3, Loss=0.2547838892787695, AUC-ROC Macro=0.7233465895611921, AUC-ROC Micro=0.8200402814966767
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.23861595220863818
Train: epoch: 4, loss = 0.2397800775617361
Train: epoch: 4, loss = 0.23874979741871358
Train: epoch: 4, loss = 0.2403380261734128
Train: epoch: 4, loss = 0.24044948639720679
Train: epoch: 4, loss = 0.2346728420940538
Train:  Epoch 4, Loss=0.2314454238741988, AUC-ROC Macro=0.7477710328263711, AUC-ROC Micro=0.8301121472258282
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.36530595521132153, AUC-ROC Macro=0.7379461309951596, AUC-ROC Micro=0.7955081518309874
Eval task: 2
Eval:  Epoch 4, Loss=0.25156118907034397, AUC-ROC Macro=0.7246996905278426, AUC-ROC Micro=0.8224953650535879
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.23967320639640094
Train: epoch: 5, loss = 0.23861667186021804
Train: epoch: 5, loss = 0.2381911434729894
Train: epoch: 5, loss = 0.23669893473386763
Train: epoch: 5, loss = 0.23588324651122095
Train: epoch: 5, loss = 0.23103912444164357
Train:  Epoch 5, Loss=0.22816748002080126, AUC-ROC Macro=0.761043315623175, AUC-ROC Micro=0.8373816808326073
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3634530541797479, AUC-ROC Macro=0.742131063482278, AUC-ROC Micro=0.7983269950394372
Eval task: 2
Eval:  Epoch 5, Loss=0.2477086093276739, AUC-ROC Macro=0.7321247256991973, AUC-ROC Micro=0.8257891863629595
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.23620167963206767
Train: epoch: 6, loss = 0.2333616852387786
Train: epoch: 6, loss = 0.23272793936232725
Train: epoch: 6, loss = 0.23265600920654833
Train: epoch: 6, loss = 0.23256484252214432
Train: epoch: 6, loss = 0.22758957378566266
Train:  Epoch 6, Loss=0.22475809364864519, AUC-ROC Macro=0.7722215761842047, AUC-ROC Micro=0.8435370826020475
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.36892548327644664, AUC-ROC Macro=0.7338530672623641, AUC-ROC Micro=0.790591844777044
Eval task: 2
Eval:  Epoch 6, Loss=0.249108100309968, AUC-ROC Macro=0.726679447220611, AUC-ROC Micro=0.8218855504217408
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3786686174571514, AUC-ROC Macro=0.733530445574088, AUC-ROC Micro=0.7891514066467453
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.21252510137856007, AUC-ROC Macro=0.7250041937615529, AUC-ROC Micro=0.8189134865139989
{'0': {'precision': 0.535230352303523, 'recall': 0.30198776758409784, 'f1-score': 0.386119257086999, 'support': 1308}, '1': {'precision': 0.6105263157894737, 'recall': 0.43283582089552236, 'f1-score': 0.5065502183406113, 'support': 402}, '2': {'precision': 0.42857142857142855, 'recall': 0.15045592705167174, 'f1-score': 0.22272215973003376, 'support': 658}, '3': {'precision': 0.5287049399198932, 'recall': 0.19899497487437187, 'f1-score': 0.2891566265060241, 'support': 1990}, '4': {'precision': 0.5037037037037037, 'recall': 0.1687344913151365, 'f1-score': 0.2527881040892193, 'support': 806}, '5': {'precision': 0.5, 'recall': 0.021850899742930592, 'f1-score': 0.04187192118226601, 'support': 778}, '6': {'precision': 0.6261682242990654, 'recall': 0.10291858678955453, 'f1-score': 0.17678100263852242, 'support': 1302}, '7': {'precision': 0.125, 'recall': 0.007075471698113208, 'f1-score': 0.013392857142857144, 'support': 424}, '8': {'precision': 0.5153488372093024, 'recall': 0.33698296836982966, 'f1-score': 0.4075027583670467, 'support': 1644}, '9': {'precision': 0.6497948016415869, 'recall': 0.46774987690792713, 'f1-score': 0.5439450329229888, 'support': 2031}, '10': {'precision': 0.5419161676646707, 'recall': 0.3158813263525305, 'f1-score': 0.39911797133406834, 'support': 573}, '11': {'precision': 0.4483695652173913, 'recall': 0.28061224489795916, 'f1-score': 0.34518828451882844, 'support': 1176}, '12': {'precision': 0.5742251223491027, 'recall': 0.19887005649717515, 'f1-score': 0.2954259336970206, 'support': 1770}, '13': {'precision': 0.5988225399495374, 'recall': 0.27426810477657937, 'f1-score': 0.37622192866578597, 'support': 2596}, '14': {'precision': 0.5300699300699301, 'recall': 0.2329440688383528, 'f1-score': 0.32365499573014517, 'support': 1627}, '15': {'precision': 0.16666666666666666, 'recall': 0.004132231404958678, 'f1-score': 0.008064516129032258, 'support': 484}, '16': {'precision': 0.37623762376237624, 'recall': 0.14339622641509434, 'f1-score': 0.20765027322404372, 'support': 795}, '17': {'precision': 0.4444444444444444, 'recall': 0.007352941176470588, 'f1-score': 0.014466546112115732, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.34545454545454546, 'recall': 0.07251908396946564, 'f1-score': 0.1198738170347003, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.5682819383259912, 'recall': 0.15412186379928317, 'f1-score': 0.24248120300751883, 'support': 837}, '22': {'precision': 0.6568396226415094, 'recall': 0.5128913443830571, 'f1-score': 0.576008273009307, 'support': 1086}, '23': {'precision': 0.6293706293706294, 'recall': 0.20905923344947736, 'f1-score': 0.3138622493461203, 'support': 861}, '24': {'precision': 0.55625, 'recall': 0.17623762376237623, 'f1-score': 0.26766917293233083, 'support': 505}, 'micro avg': {'precision': 0.5586983256077949, 'recall': 0.2327671146494305, 'f1-score': 0.32862230135766746, 'support': 25373}, 'macro avg': {'precision': 0.4583998959741909, 'recall': 0.1908749253980774, 'f1-score': 0.25322060410990344, 'support': 25373}, 'weighted avg': {'precision': 0.5164876602643816, 'recall': 0.2327671146494305, 'f1-score': 0.3066440186901915, 'support': 25373}, 'samples avg': {'precision': 0.35333106653907437, 'recall': 0.20344127621744235, 'f1-score': 0.23641870807464863, 'support': 25373}}
{'0': {'precision': 0.6428571428571429, 'recall': 0.3444976076555024, 'f1-score': 0.4485981308411215, 'support': 418}, '1': {'precision': 0.7096774193548387, 'recall': 0.10185185185185185, 'f1-score': 0.1781376518218623, 'support': 216}, '2': {'precision': 0.6, 'recall': 0.020833333333333332, 'f1-score': 0.040268456375838924, 'support': 288}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 252}, '4': {'precision': 0.46153846153846156, 'recall': 0.020833333333333332, 'f1-score': 0.0398671096345515, 'support': 288}, '5': {'precision': 0.5882352941176471, 'recall': 0.03717472118959108, 'f1-score': 0.06993006993006994, 'support': 269}, '6': {'precision': 0.38461538461538464, 'recall': 0.0176678445229682, 'f1-score': 0.033783783783783786, 'support': 283}, '7': {'precision': 0.6931216931216931, 'recall': 0.5137254901960784, 'f1-score': 0.5900900900900902, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.5, 'recall': 0.0423728813559322, 'f1-score': 0.078125, 'support': 236}, '10': {'precision': 0.6666666666666666, 'recall': 0.03278688524590164, 'f1-score': 0.0625, 'support': 183}, '11': {'precision': 0.75, 'recall': 0.10047846889952153, 'f1-score': 0.17721518987341775, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.6666666666666666, 'recall': 0.018018018018018018, 'f1-score': 0.03508771929824561, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.7294117647058823, 'recall': 0.6888888888888889, 'f1-score': 0.7085714285714285, 'support': 90}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.661993769470405, 'recall': 0.11181268087345435, 'f1-score': 0.19131217645734866, 'support': 3801}, 'macro avg': {'precision': 0.29571161974577537, 'recall': 0.07756517297963683, 'f1-score': 0.09848698520881641, 'support': 3801}, 'weighted avg': {'precision': 0.4493428633915732, 'recall': 0.11181268087345435, 'f1-score': 0.1479860318832292, 'support': 3801}, 'samples avg': {'precision': 0.19632975260416666, 'recall': 0.13888462611607144, 'f1-score': 0.15353616381448412, 'support': 3801}}