
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_northeast
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4355859386920929
Train: epoch: 1, loss = 0.42194688484072684
Train: epoch: 1, loss = 0.41657560676336286
Train: epoch: 1, loss = 0.41293178409338
Train: epoch: 1, loss = 0.40974976009130476
Train: epoch: 1, loss = 0.4076294035464525
Train: epoch: 1, loss = 0.4049930272783552
Train: epoch: 1, loss = 0.4032165601104498
Train: epoch: 1, loss = 0.40050797696742746
Train: epoch: 1, loss = 0.39873860689997676
Train: epoch: 1, loss = 0.3973819396306168
Train: epoch: 1, loss = 0.39595253227278593
Train: epoch: 1, loss = 0.39454051529558803
Train: epoch: 1, loss = 0.393531767167151
Train: epoch: 1, loss = 0.3929011595348517
Train: epoch: 1, loss = 0.39197649055626244
Train: epoch: 1, loss = 0.39156256968922476
Train: epoch: 1, loss = 0.39088298328220844
Train:  Epoch 1, Loss=0.3906207375302274, AUC-ROC Macro=0.6639322941487312, AUC-ROC Micro=0.7524490156658676
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3722071411708991, AUC-ROC Macro=0.7118664373349229, AUC-ROC Micro=0.780356938467128
Eval task: 2
Eval:  Epoch 1, Loss=0.4033426195383072, AUC-ROC Macro=0.48024882512422307, AUC-ROC Micro=0.5754930157793627
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37170350253582
Train: epoch: 2, loss = 0.37312463607639074
Train: epoch: 2, loss = 0.3716046172132095
Train: epoch: 2, loss = 0.371812558490783
Train: epoch: 2, loss = 0.3709674286842346
Train: epoch: 2, loss = 0.372064951993525
Train: epoch: 2, loss = 0.37168089563293116
Train: epoch: 2, loss = 0.3722588768135756
Train: epoch: 2, loss = 0.3725262130382988
Train: epoch: 2, loss = 0.372248658105731
Train: epoch: 2, loss = 0.3719218841398304
Train: epoch: 2, loss = 0.37156870745122433
Train: epoch: 2, loss = 0.3715398708272439
Train: epoch: 2, loss = 0.37116728030677354
Train: epoch: 2, loss = 0.3709407740732034
Train: epoch: 2, loss = 0.3706666602334008
Train: epoch: 2, loss = 0.37026445317794293
Train: epoch: 2, loss = 0.3697707068671783
Train:  Epoch 2, Loss=0.3695909123074295, AUC-ROC Macro=0.7216221609222732, AUC-ROC Micro=0.7894858456777752
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3622156009078026, AUC-ROC Macro=0.7377811074444649, AUC-ROC Micro=0.7973074588850934
Eval task: 2
Eval:  Epoch 2, Loss=0.40279029309749603, AUC-ROC Macro=0.49290753642405327, AUC-ROC Micro=0.5928216340606141
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3649490211904049
Train: epoch: 3, loss = 0.36480208788067103
Train: epoch: 3, loss = 0.36360509537160396
Train: epoch: 3, loss = 0.36291083980351685
Train: epoch: 3, loss = 0.36267768312990667
Train: epoch: 3, loss = 0.3619373201206326
Train: epoch: 3, loss = 0.362232423009617
Train: epoch: 3, loss = 0.362061166446656
Train: epoch: 3, loss = 0.36235815825561685
Train: epoch: 3, loss = 0.36223814960569145
Train: epoch: 3, loss = 0.3622063927420161
Train: epoch: 3, loss = 0.3623679291891555
Train: epoch: 3, loss = 0.3623037660580415
Train: epoch: 3, loss = 0.36205636585397377
Train: epoch: 3, loss = 0.3622149720241626
Train: epoch: 3, loss = 0.36191614603623745
Train: epoch: 3, loss = 0.36132944233715536
Train: epoch: 3, loss = 0.3616612761012382
Train:  Epoch 3, Loss=0.3616315521297292, AUC-ROC Macro=0.7405095642753886, AUC-ROC Micro=0.8018951859087755
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3577299776176612, AUC-ROC Macro=0.7484470817259928, AUC-ROC Micro=0.8042757896880668
Eval task: 2
Eval:  Epoch 3, Loss=0.3999628722667694, AUC-ROC Macro=0.5041389619027153, AUC-ROC Micro=0.5841201249412834
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3559909788519144
Train: epoch: 4, loss = 0.3582232168316841
Train: epoch: 4, loss = 0.3587259772668282
Train: epoch: 4, loss = 0.3578507664054632
Train: epoch: 4, loss = 0.3583109312653542
Train: epoch: 4, loss = 0.3583269922931989
Train: epoch: 4, loss = 0.35723622133689265
Train: epoch: 4, loss = 0.3566069677751511
Train: epoch: 4, loss = 0.35627719319529005
Train: epoch: 4, loss = 0.35654524544626476
Train: epoch: 4, loss = 0.3565580713748932
Train: epoch: 4, loss = 0.3560880078437428
Train: epoch: 4, loss = 0.35613612414552615
Train: epoch: 4, loss = 0.35587777782231567
Train: epoch: 4, loss = 0.355817220667998
Train: epoch: 4, loss = 0.35563773453235625
Train: epoch: 4, loss = 0.35539940305492457
Train: epoch: 4, loss = 0.3555139473080635
Train:  Epoch 4, Loss=0.3555860520040887, AUC-ROC Macro=0.7541514088918809, AUC-ROC Micro=0.8108543163338011
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35450462996959686, AUC-ROC Macro=0.7547384390419927, AUC-ROC Micro=0.8093184793047353
Eval task: 2
Eval:  Epoch 4, Loss=0.43014010787010193, AUC-ROC Macro=0.49270055597728046, AUC-ROC Micro=0.5774345592384338
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.34380098171532153
Train: epoch: 5, loss = 0.3458807070925832
Train: epoch: 5, loss = 0.34562416061758994
Train: epoch: 5, loss = 0.34715336168184874
Train: epoch: 5, loss = 0.34986591796576977
Train: epoch: 5, loss = 0.3505400239303708
Train: epoch: 5, loss = 0.3492412545851299
Train: epoch: 5, loss = 0.34904382172971965
Train: epoch: 5, loss = 0.34967825930151675
Train: epoch: 5, loss = 0.3498950607776642
Train: epoch: 5, loss = 0.3494279529222033
Train: epoch: 5, loss = 0.34937377252926427
Train: epoch: 5, loss = 0.35008872220149406
Train: epoch: 5, loss = 0.35069750018417833
Train: epoch: 5, loss = 0.35046205108364425
Train: epoch: 5, loss = 0.3502477825945243
Train: epoch: 5, loss = 0.3504949993946973
Train: epoch: 5, loss = 0.3506333141608371
Train:  Epoch 5, Loss=0.3505014098607577, AUC-ROC Macro=0.7646408861667028, AUC-ROC Micro=0.818097373819498
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3523320369422436, AUC-ROC Macro=0.7584479165882615, AUC-ROC Micro=0.8120776930486653
Eval task: 2
Eval:  Epoch 5, Loss=0.44152967631816864, AUC-ROC Macro=0.49841306634587534, AUC-ROC Micro=0.5741178826929721
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3503265645354986
Train: epoch: 6, loss = 0.34598026346415284
Train: epoch: 6, loss = 0.3449751318246126
Train: epoch: 6, loss = 0.345631092954427
Train: epoch: 6, loss = 0.3461067185103893
Train: epoch: 6, loss = 0.34709000085790953
Train: epoch: 6, loss = 0.3474972456267902
Train: epoch: 6, loss = 0.3477151208464056
Train: epoch: 6, loss = 0.3479692405462265
Train: epoch: 6, loss = 0.3475852067992091
Train: epoch: 6, loss = 0.34776770611378277
Train: epoch: 6, loss = 0.3475910700236758
Train: epoch: 6, loss = 0.34754249028288403
Train: epoch: 6, loss = 0.3474863065885646
Train: epoch: 6, loss = 0.3475013036976258
Train: epoch: 6, loss = 0.34695693833287805
Train: epoch: 6, loss = 0.3468849629996454
Train: epoch: 6, loss = 0.34657356277936036
Train:  Epoch 6, Loss=0.34681359783197063, AUC-ROC Macro=0.7716310919364693, AUC-ROC Micro=0.8230585584027433
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3507464937865734, AUC-ROC Macro=0.7611744427558413, AUC-ROC Micro=0.8143892635938524
Eval task: 2
Eval:  Epoch 6, Loss=0.437232568860054, AUC-ROC Macro=0.4986823558567103, AUC-ROC Micro=0.5789172225712107
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35213010261456174, AUC-ROC Macro=0.7630514904056054, AUC-ROC Micro=0.8151041612886503
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.45565032958984375, AUC-ROC Macro=0.47903694035582123, AUC-ROC Micro=0.5791829015510219
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.34643437415361406
Train:  Epoch 1, Loss=0.33831110106186224, AUC-ROC Macro=0.5544362917080535, AUC-ROC Micro=0.7191179624983077
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.35401133075356483, AUC-ROC Macro=0.7574822734650735, AUC-ROC Micro=0.8117966016535065
Eval task: 2
Eval:  Epoch 1, Loss=0.3215721547603607, AUC-ROC Macro=0.628597833382202, AUC-ROC Micro=0.7670915362451693
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.32283363297581674
Train:  Epoch 2, Loss=0.31759947417836476, AUC-ROC Macro=0.6560572688973122, AUC-ROC Micro=0.7946141411021492
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.35242245222131413, AUC-ROC Macro=0.7574133354698239, AUC-ROC Micro=0.8115823318112392
Eval task: 2
Eval:  Epoch 2, Loss=0.31021909415721893, AUC-ROC Macro=0.6697583327183533, AUC-ROC Micro=0.7954987543433387
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.3096228110790253
Train:  Epoch 3, Loss=0.30828729421523826, AUC-ROC Macro=0.6996490271158098, AUC-ROC Micro=0.8195105641463485
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.351555726180474, AUC-ROC Macro=0.7567505057417974, AUC-ROC Micro=0.8103874811878101
Eval task: 2
Eval:  Epoch 3, Loss=0.3022928535938263, AUC-ROC Macro=0.6933966421491842, AUC-ROC Micro=0.808563905373142
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.3033015214651823
Train:  Epoch 4, Loss=0.301412679743401, AUC-ROC Macro=0.7299192599561646, AUC-ROC Micro=0.8336153912972631
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.348925660053889, AUC-ROC Macro=0.755388521419696, AUC-ROC Micro=0.8093126019809702
Eval task: 2
Eval:  Epoch 4, Loss=0.29555121064186096, AUC-ROC Macro=0.7015968166009717, AUC-ROC Micro=0.8180034753341532
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.29822118692100047
Train:  Epoch 5, Loss=0.2956790410325118, AUC-ROC Macro=0.7527607231262826, AUC-ROC Micro=0.8437088942026818
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.34744952246546745, AUC-ROC Macro=0.7539364734396886, AUC-ROC Micro=0.8081884765350278
Eval task: 2
Eval:  Epoch 5, Loss=0.2928249090909958, AUC-ROC Macro=0.7061794578423222, AUC-ROC Micro=0.8210394940175862
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2927676298469305
Train:  Epoch 6, Loss=0.2911803813409606, AUC-ROC Macro=0.7646318025935834, AUC-ROC Micro=0.8522476176002164
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3463061588505904, AUC-ROC Macro=0.7511337074290882, AUC-ROC Micro=0.8057385975652568
Eval task: 2
Eval:  Epoch 6, Loss=0.2922961413860321, AUC-ROC Macro=0.7183321490038392, AUC-ROC Micro=0.8259858853513539
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3641593928138415, AUC-ROC Macro=0.7484806971599788, AUC-ROC Micro=0.8035578188533109
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.29164446890354156, AUC-ROC Macro=0.6960918021658711, AUC-ROC Micro=0.8161267098798461
{'0': {'precision': 0.5317559153175592, 'recall': 0.3264525993883792, 'f1-score': 0.40454760776883, 'support': 1308}, '1': {'precision': 0.5954692556634305, 'recall': 0.4577114427860697, 'f1-score': 0.5175808720112517, 'support': 402}, '2': {'precision': 0.5303030303030303, 'recall': 0.05319148936170213, 'f1-score': 0.09668508287292818, 'support': 658}, '3': {'precision': 0.5405982905982906, 'recall': 0.2542713567839196, 'f1-score': 0.3458646616541354, 'support': 1990}, '4': {'precision': 0.48325358851674644, 'recall': 0.12531017369727046, 'f1-score': 0.19901477832512315, 'support': 806}, '5': {'precision': 0.4, 'recall': 0.002570694087403599, 'f1-score': 0.005108556832694763, 'support': 778}, '6': {'precision': 0.5373493975903615, 'recall': 0.17127496159754224, 'f1-score': 0.2597553873034362, 'support': 1302}, '7': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 424}, '8': {'precision': 0.5480283114256825, 'recall': 0.32968369829683697, 'f1-score': 0.41169768325104444, 'support': 1644}, '9': {'precision': 0.703405017921147, 'recall': 0.3865091088133924, 'f1-score': 0.4988878296790594, 'support': 2031}, '10': {'precision': 0.625, 'recall': 0.33158813263525305, 'f1-score': 0.43329532497149376, 'support': 573}, '11': {'precision': 0.509915014164306, 'recall': 0.15306122448979592, 'f1-score': 0.23544800523217793, 'support': 1176}, '12': {'precision': 0.5791139240506329, 'recall': 0.20677966101694914, 'f1-score': 0.3047460449625312, 'support': 1770}, '13': {'precision': 0.5926161680458307, 'recall': 0.3586286594761171, 'f1-score': 0.44684425245980325, 'support': 2596}, '14': {'precision': 0.5350978135788262, 'recall': 0.2858020897357099, 'f1-score': 0.3725961538461539, 'support': 1627}, '15': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 484}, '16': {'precision': 0.4007352941176471, 'recall': 0.1371069182389937, 'f1-score': 0.20431115276476103, 'support': 795}, '17': {'precision': 0.47058823529411764, 'recall': 0.04411764705882353, 'f1-score': 0.08067226890756304, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.5238095238095238, 'recall': 0.08396946564885496, 'f1-score': 0.14473684210526316, 'support': 262}, '20': {'precision': 0.5, 'recall': 0.0053285968028419185, 'f1-score': 0.01054481546572935, 'support': 563}, '21': {'precision': 0.5853658536585366, 'recall': 0.17204301075268819, 'f1-score': 0.2659279778393352, 'support': 837}, '22': {'precision': 0.6523560209424084, 'recall': 0.5736648250460405, 'f1-score': 0.610485056344929, 'support': 1086}, '23': {'precision': 0.6074074074074074, 'recall': 0.2857142857142857, 'f1-score': 0.38862559241706157, 'support': 861}, '24': {'precision': 0.5808080808080808, 'recall': 0.22772277227722773, 'f1-score': 0.3271692745376956, 'support': 505}, 'micro avg': {'precision': 0.5786145978614597, 'recall': 0.2452607102037599, 'f1-score': 0.3444973427812223, 'support': 25373}, 'macro avg': {'precision': 0.4813190457285426, 'recall': 0.1989001125482439, 'f1-score': 0.26258180886212, 'support': 25373}, 'weighted avg': {'precision': 0.5316447247743895, 'recall': 0.2452607102037599, 'f1-score': 0.3211332111833867, 'support': 25373}, 'samples avg': {'precision': 0.36366851916168325, 'recall': 0.2156472904605947, 'f1-score': 0.247755906188155, 'support': 25373}}
{'0': {'precision': 0.6363636363636364, 'recall': 0.3230769230769231, 'f1-score': 0.4285714285714286, 'support': 130}, '1': {'precision': 0.6309523809523809, 'recall': 0.3897058823529412, 'f1-score': 0.4818181818181818, 'support': 136}, '2': {'precision': 0.5178571428571429, 'recall': 0.2116788321167883, 'f1-score': 0.3005181347150259, 'support': 137}, '3': {'precision': 0.6521739130434783, 'recall': 0.7746478873239436, 'f1-score': 0.7081545064377681, 'support': 213}, '4': {'precision': 0.4166666666666667, 'recall': 0.13333333333333333, 'f1-score': 0.20202020202020202, 'support': 75}, '5': {'precision': 0.2727272727272727, 'recall': 0.031914893617021274, 'f1-score': 0.057142857142857134, 'support': 94}, '6': {'precision': 0.5454545454545454, 'recall': 0.08108108108108109, 'f1-score': 0.1411764705882353, 'support': 74}, '7': {'precision': 0.5454545454545454, 'recall': 0.15, 'f1-score': 0.2352941176470588, 'support': 40}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 65}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 63}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 56}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 52}, '13': {'precision': 0.5555555555555556, 'recall': 0.09090909090909091, 'f1-score': 0.15625, 'support': 55}, '14': {'precision': 0.6153846153846154, 'recall': 0.12698412698412698, 'f1-score': 0.21052631578947367, 'support': 63}, '15': {'precision': 1.0, 'recall': 0.10526315789473684, 'f1-score': 0.1904761904761905, 'support': 19}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '17': {'precision': 0.42857142857142855, 'recall': 0.036585365853658534, 'f1-score': 0.06741573033707865, 'support': 82}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, 'micro avg': {'precision': 0.6025408348457351, 'recall': 0.21600520494469747, 'f1-score': 0.31800766283524906, 'support': 1537}, 'macro avg': {'precision': 0.27268646812125075, 'recall': 0.0982072229817458, 'f1-score': 0.12717456542174002, 'support': 1537}, 'weighted avg': {'precision': 0.4039896511856287, 'recall': 0.21600520494469747, 'f1-score': 0.2502506606522719, 'support': 1537}, 'samples avg': {'precision': 0.366796875, 'recall': 0.19391586061507937, 'f1-score': 0.23383880659271283, 'support': 1537}}