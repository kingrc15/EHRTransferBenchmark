Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.42689664900302887
Train: epoch: 1, loss = 0.41836667522788046
Train: epoch: 1, loss = 0.41288156402607756
Train: epoch: 1, loss = 0.4101647363044322
Train: epoch: 1, loss = 0.40716235096752645
Train: epoch: 1, loss = 0.4064716096843282
Train: epoch: 1, loss = 0.4059253374061414
Train: epoch: 1, loss = 0.40520785851404073
Train: epoch: 1, loss = 0.40443177632159655
Train: epoch: 1, loss = 0.4033375487551093
Train: epoch: 1, loss = 0.4025451482764699
Train: epoch: 1, loss = 0.40198094931120676
Train: epoch: 1, loss = 0.40140166002970473
Train: epoch: 1, loss = 0.4011149845059429
Train: epoch: 1, loss = 0.40020893839995064
Train: epoch: 1, loss = 0.3993061551405117
Train: epoch: 1, loss = 0.39856575372464514
Train: epoch: 1, loss = 0.3973042514009608
Train:  Epoch 1, Loss=0.3971782162291372, AUC-ROC Macro=0.6411908436956018, AUC-ROC Micro=0.7392434690513923
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37473810588320094, AUC-ROC Macro=0.7084966378903126, AUC-ROC Micro=0.7763720704223724
Eval task: 2
Eval:  Epoch 1, Loss=0.34009359776973724, AUC-ROC Macro=0.47562551035748785, AUC-ROC Micro=0.5470923063938398
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3770372162759304
Train: epoch: 2, loss = 0.3782731280848384
Train: epoch: 2, loss = 0.3759743470946948
Train: epoch: 2, loss = 0.37805516593158245
Train: epoch: 2, loss = 0.37780840441584584
Train: epoch: 2, loss = 0.3779122429092725
Train: epoch: 2, loss = 0.37782854276044026
Train: epoch: 2, loss = 0.3782316199596971
Train: epoch: 2, loss = 0.3778079462548097
Train: epoch: 2, loss = 0.37780952247232197
Train: epoch: 2, loss = 0.3768688540567051
Train: epoch: 2, loss = 0.3765874718377988
Train: epoch: 2, loss = 0.3761487831805761
Train: epoch: 2, loss = 0.3755780225619674
Train: epoch: 2, loss = 0.3749208127657572
Train: epoch: 2, loss = 0.37469905267935244
Train: epoch: 2, loss = 0.3741098321623662
Train: epoch: 2, loss = 0.3742025216461884
Train:  Epoch 2, Loss=0.37420210187047975, AUC-ROC Macro=0.7113452864346893, AUC-ROC Micro=0.7820393338674717
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3693568992118041, AUC-ROC Macro=0.724594113698703, AUC-ROC Micro=0.7864547196952454
Eval task: 2
Eval:  Epoch 2, Loss=0.35789741277694703, AUC-ROC Macro=0.4715159738008079, AUC-ROC Micro=0.5399799298806707
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36836042881011966
Train: epoch: 3, loss = 0.3679666832834482
Train: epoch: 3, loss = 0.3670179407298565
Train: epoch: 3, loss = 0.36685433631762865
Train: epoch: 3, loss = 0.36741556234657763
Train: epoch: 3, loss = 0.36752881574134033
Train: epoch: 3, loss = 0.3660090211991753
Train: epoch: 3, loss = 0.3661886657960713
Train: epoch: 3, loss = 0.3660795794592963
Train: epoch: 3, loss = 0.36601876449584964
Train: epoch: 3, loss = 0.3657770779932087
Train: epoch: 3, loss = 0.36596675555532177
Train: epoch: 3, loss = 0.36580634818627283
Train: epoch: 3, loss = 0.36559900035283394
Train: epoch: 3, loss = 0.36517019668221473
Train: epoch: 3, loss = 0.36493231595959513
Train: epoch: 3, loss = 0.3646249357523287
Train: epoch: 3, loss = 0.3645338270192345
Train:  Epoch 3, Loss=0.36445392548936045, AUC-ROC Macro=0.7337756849649462, AUC-ROC Micro=0.7975975216170609
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35926640530427295, AUC-ROC Macro=0.7438690929651363, AUC-ROC Micro=0.8016700373800679
Eval task: 2
Eval:  Epoch 3, Loss=0.3589813023805618, AUC-ROC Macro=0.4683079373861137, AUC-ROC Micro=0.5290837968460723
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3544202569127083
Train: epoch: 4, loss = 0.3557906940206885
Train: epoch: 4, loss = 0.35629143719871836
Train: epoch: 4, loss = 0.35558560211211443
Train: epoch: 4, loss = 0.3551700982749462
Train: epoch: 4, loss = 0.3557673937330643
Train: epoch: 4, loss = 0.35686741650104525
Train: epoch: 4, loss = 0.3565687042661011
Train: epoch: 4, loss = 0.35705990470945836
Train: epoch: 4, loss = 0.35690120039880274
Train: epoch: 4, loss = 0.3568657186017795
Train: epoch: 4, loss = 0.3567200093343854
Train: epoch: 4, loss = 0.35699953513649796
Train: epoch: 4, loss = 0.35769740047199383
Train: epoch: 4, loss = 0.3579972331672907
Train: epoch: 4, loss = 0.3578196405339986
Train: epoch: 4, loss = 0.3577203373216531
Train: epoch: 4, loss = 0.3573251367939843
Train:  Epoch 4, Loss=0.35731058231378215, AUC-ROC Macro=0.7498021012763274, AUC-ROC Micro=0.8082917640155797
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3542276086906592, AUC-ROC Macro=0.7543857325441172, AUC-ROC Micro=0.8090577780924769
Eval task: 2
Eval:  Epoch 4, Loss=0.3664019912481308, AUC-ROC Macro=0.4670788568278872, AUC-ROC Micro=0.5353123883181945
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3543944659084082
Train: epoch: 5, loss = 0.3551413983479142
Train: epoch: 5, loss = 0.3523331482708454
Train: epoch: 5, loss = 0.35271087097004056
Train: epoch: 5, loss = 0.35244205194711686
Train: epoch: 5, loss = 0.3519176567842563
Train: epoch: 5, loss = 0.3519069186278752
Train: epoch: 5, loss = 0.35178449370898307
Train: epoch: 5, loss = 0.35254526156518196
Train: epoch: 5, loss = 0.35233844704926015
Train: epoch: 5, loss = 0.35171455119143835
Train: epoch: 5, loss = 0.35272251840059954
Train: epoch: 5, loss = 0.3527051617549016
Train: epoch: 5, loss = 0.35264479771256446
Train: epoch: 5, loss = 0.35250990125040216
Train: epoch: 5, loss = 0.35260411829687655
Train: epoch: 5, loss = 0.3525559654656579
Train: epoch: 5, loss = 0.35238100906627046
Train:  Epoch 5, Loss=0.3522523005925692, AUC-ROC Macro=0.7604999233277614, AUC-ROC Micro=0.8156214312636132
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.352790975322326, AUC-ROC Macro=0.7577951100899826, AUC-ROC Micro=0.8117477203508374
Eval task: 2
Eval:  Epoch 5, Loss=0.3781539618968964, AUC-ROC Macro=0.4604067535423528, AUC-ROC Micro=0.5377330978317446
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3506627840548754
Train: epoch: 6, loss = 0.3494723946973681
Train: epoch: 6, loss = 0.3487738480915626
Train: epoch: 6, loss = 0.34759228594601155
Train: epoch: 6, loss = 0.34836689004302024
Train: epoch: 6, loss = 0.3475930227339268
Train: epoch: 6, loss = 0.3477038483428104
Train: epoch: 6, loss = 0.34700044273398817
Train: epoch: 6, loss = 0.346570878095097
Train: epoch: 6, loss = 0.3475039135888219
Train: epoch: 6, loss = 0.34788811816410586
Train: epoch: 6, loss = 0.34818941589444874
Train: epoch: 6, loss = 0.34801898611279636
Train: epoch: 6, loss = 0.3482698639535478
Train: epoch: 6, loss = 0.3483091098268827
Train: epoch: 6, loss = 0.3485580422356725
Train: epoch: 6, loss = 0.34856730657027046
Train: epoch: 6, loss = 0.34860715897132954
Train:  Epoch 6, Loss=0.34857308840955425, AUC-ROC Macro=0.7679762657873432, AUC-ROC Micro=0.8207712834900289
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3523886849482854, AUC-ROC Macro=0.7585463182351332, AUC-ROC Micro=0.8130831318839982
Eval task: 2
Eval:  Epoch 6, Loss=0.3936314046382904, AUC-ROC Macro=0.4689930922787091, AUC-ROC Micro=0.5344909067023937
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35382365932067233, AUC-ROC Macro=0.7611567558972284, AUC-ROC Micro=0.8139606975411955
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.39156239926815034, AUC-ROC Macro=0.46429784419575726, AUC-ROC Micro=0.5325031368812185
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.291209277510643
Train: epoch: 1, loss = 0.2773929483816028
Train: epoch: 1, loss = 0.2684382158269485
Train: epoch: 1, loss = 0.2635575313307345
Train: epoch: 1, loss = 0.25939622439444066
Train: epoch: 1, loss = 0.2572570702681939
Train: epoch: 1, loss = 0.2545600983394044
Train:  Epoch 1, Loss=0.25338285063791494, AUC-ROC Macro=0.6308948980842919, AUC-ROC Micro=0.7638384737149295
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.5040907151997089, AUC-ROC Macro=0.60831877191314, AUC-ROC Micro=0.6064426149881459
Eval task: 2
Eval:  Epoch 1, Loss=0.23848912566900254, AUC-ROC Macro=0.7115863649720356, AUC-ROC Micro=0.8020624482692832
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.23470360770821572
Train: epoch: 2, loss = 0.23448404259979724
Train: epoch: 2, loss = 0.23436175694068273
Train: epoch: 2, loss = 0.23533537911251187
Train: epoch: 2, loss = 0.2351180899143219
Train: epoch: 2, loss = 0.23563069007049003
Train: epoch: 2, loss = 0.23565690728170532
Train:  Epoch 2, Loss=0.2353643503799819, AUC-ROC Macro=0.7194535081218474, AUC-ROC Micro=0.8103949912112614
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.5100968418021997, AUC-ROC Macro=0.5911801165317669, AUC-ROC Micro=0.6133290756940095
Eval task: 2
Eval:  Epoch 2, Loss=0.2362851932644844, AUC-ROC Macro=0.7283116429214667, AUC-ROC Micro=0.8070080888065743
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.23203723177313804
Train: epoch: 3, loss = 0.23073076317086816
Train: epoch: 3, loss = 0.22999085360517105
Train: epoch: 3, loss = 0.2289390534069389
Train: epoch: 3, loss = 0.22940397914499044
Train: epoch: 3, loss = 0.22912028434996803
Train: epoch: 3, loss = 0.22935276661068202
Train:  Epoch 3, Loss=0.2295608255242983, AUC-ROC Macro=0.7474105958641633, AUC-ROC Micro=0.8237960094624405
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5337439080079397, AUC-ROC Macro=0.5913633599801178, AUC-ROC Micro=0.5966537134660612
Eval task: 2
Eval:  Epoch 3, Loss=0.23121364414691925, AUC-ROC Macro=0.7377189567801326, AUC-ROC Micro=0.8184410904407585
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.22233367212116717
Train: epoch: 4, loss = 0.22421251740306616
Train: epoch: 4, loss = 0.22412189967930318
Train: epoch: 4, loss = 0.22366972715593875
Train: epoch: 4, loss = 0.2240879125073552
Train: epoch: 4, loss = 0.22472893775130312
Train: epoch: 4, loss = 0.22462184160415616
Train:  Epoch 4, Loss=0.22529472272112988, AUC-ROC Macro=0.7639038319531365, AUC-ROC Micro=0.8327703110445264
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5516240398089091, AUC-ROC Macro=0.5792425355056176, AUC-ROC Micro=0.5879656073809406
Eval task: 2
Eval:  Epoch 4, Loss=0.23043259531259536, AUC-ROC Macro=0.7460754452265911, AUC-ROC Micro=0.8200828416477199
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2195852492749691
Train: epoch: 5, loss = 0.22088558088988067
Train: epoch: 5, loss = 0.21947205861409505
Train: epoch: 5, loss = 0.21954866284504532
Train: epoch: 5, loss = 0.22030809374898672
Train: epoch: 5, loss = 0.22096365154410402
Train: epoch: 5, loss = 0.22143038248377186
Train:  Epoch 5, Loss=0.22213953780106568, AUC-ROC Macro=0.7771706785469008, AUC-ROC Micro=0.8397274794384536
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5450035408139229, AUC-ROC Macro=0.5762840109647273, AUC-ROC Micro=0.5874629353072179
Eval task: 2
Eval:  Epoch 5, Loss=0.2309141457080841, AUC-ROC Macro=0.7447223535142301, AUC-ROC Micro=0.8208688876978789
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2133715295046568
Train: epoch: 6, loss = 0.21820695651695132
Train: epoch: 6, loss = 0.21833541846523682
Train: epoch: 6, loss = 0.21793420622125267
Train: epoch: 6, loss = 0.21821888169646264
Train: epoch: 6, loss = 0.2187397824289898
Train: epoch: 6, loss = 0.2188000329530665
Train:  Epoch 6, Loss=0.21903529012834225, AUC-ROC Macro=0.7855486656579642, AUC-ROC Micro=0.8454563899006806
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5526993374029795, AUC-ROC Macro=0.5811930238874982, AUC-ROC Micro=0.5979692243992697
Eval task: 2
Eval:  Epoch 6, Loss=0.22879031598567962, AUC-ROC Macro=0.7489169646434946, AUC-ROC Micro=0.8240585787742334
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5587899933258692, AUC-ROC Macro=0.5796545915105648, AUC-ROC Micro=0.5966308877418198
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2264919400215149, AUC-ROC Macro=0.7483526387138738, AUC-ROC Micro=0.8277904836132702
{'0': {'precision': 0.3117283950617284, 'recall': 0.463302752293578, 'f1-score': 0.3726937269372694, 'support': 1308}, '1': {'precision': 0.09737098344693282, 'recall': 0.24875621890547264, 'f1-score': 0.13995801259622115, 'support': 402}, '2': {'precision': 0.5, 'recall': 0.001519756838905775, 'f1-score': 0.00303030303030303, 'support': 658}, '3': {'precision': 0.4431137724550898, 'recall': 0.0371859296482412, 'f1-score': 0.06861381548446917, 'support': 1990}, '4': {'precision': 0.39622641509433965, 'recall': 0.026054590570719603, 'f1-score': 0.04889406286379511, 'support': 806}, '5': {'precision': 0.09090909090909091, 'recall': 0.006426735218508998, 'f1-score': 0.01200480192076831, 'support': 778}, '6': {'precision': 0.375, 'recall': 0.02534562211981567, 'f1-score': 0.04748201438848921, 'support': 1302}, '7': {'precision': 0.06818181818181818, 'recall': 0.007075471698113208, 'f1-score': 0.01282051282051282, 'support': 424}, '8': {'precision': 0.6666666666666666, 'recall': 0.006082725060827251, 'f1-score': 0.012055455093429776, 'support': 1644}, '9': {'precision': 1.0, 'recall': 0.0004923682914820286, 'f1-score': 0.000984251968503937, 'support': 2031}, '10': {'precision': 0.11428571428571428, 'recall': 0.006980802792321117, 'f1-score': 0.013157894736842106, 'support': 573}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1176}, '12': {'precision': 0.6666666666666666, 'recall': 0.0011299435028248588, 'f1-score': 0.0022560631697687537, 'support': 1770}, '13': {'precision': 0.28804347826086957, 'recall': 0.020416024653312787, 'f1-score': 0.038129496402877695, 'support': 2596}, '14': {'precision': 0.1271186440677966, 'recall': 0.027658266748617086, 'f1-score': 0.045431600201918214, 'support': 1627}, '15': {'precision': 0.1, 'recall': 0.030991735537190084, 'f1-score': 0.0473186119873817, 'support': 484}, '16': {'precision': 0.08333333333333333, 'recall': 0.0012578616352201257, 'f1-score': 0.0024783147459727386, 'support': 795}, '17': {'precision': 1.0, 'recall': 0.001838235294117647, 'f1-score': 0.0036697247706422016, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 1.0, 'recall': 0.003816793893129771, 'f1-score': 0.0076045627376425855, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 1.0, 'recall': 0.001841620626151013, 'f1-score': 0.003676470588235294, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.2361748369958947, 'recall': 0.038544909943640876, 'f1-score': 0.06627363285220572, 'support': 25373}, 'macro avg': {'precision': 0.3331457991372018, 'recall': 0.036726938213141956, 'f1-score': 0.03529038785780173, 'support': 25373}, 'weighted avg': {'precision': 0.39012508395631873, 'recall': 0.038544909943640876, 'f1-score': 0.040885740576239636, 'support': 25373}, 'samples avg': {'precision': 0.11061391679067462, 'recall': 0.02882319742527693, 'f1-score': 0.04241368712842053, 'support': 25373}}
{'0': {'precision': 0.6724137931034483, 'recall': 0.4954627949183303, 'f1-score': 0.5705329153605015, 'support': 551}, '1': {'precision': 0.5668604651162791, 'recall': 0.2986217457886677, 'f1-score': 0.3911735205616851, 'support': 653}, '2': {'precision': 0.6153846153846154, 'recall': 0.018779342723004695, 'f1-score': 0.03644646924829157, 'support': 426}, '3': {'precision': 0.5714285714285714, 'recall': 0.029339853300733496, 'f1-score': 0.055813953488372085, 'support': 409}, '4': {'precision': 0.75, 'recall': 0.012244897959183673, 'f1-score': 0.024096385542168672, 'support': 245}, '5': {'precision': 0.4583333333333333, 'recall': 0.061452513966480445, 'f1-score': 0.1083743842364532, 'support': 358}, '6': {'precision': 0.625, 'recall': 0.020491803278688523, 'f1-score': 0.03968253968253968, 'support': 244}, '7': {'precision': 0.696969696969697, 'recall': 0.23469387755102042, 'f1-score': 0.35114503816793896, 'support': 294}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 263}, '9': {'precision': 0.8484848484848485, 'recall': 0.10071942446043165, 'f1-score': 0.18006430868167203, 'support': 278}, '10': {'precision': 0.5, 'recall': 0.004807692307692308, 'f1-score': 0.009523809523809525, 'support': 208}, '11': {'precision': 0.5573770491803278, 'recall': 0.13654618473895583, 'f1-score': 0.2193548387096774, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.46153846153846156, 'recall': 0.045454545454545456, 'f1-score': 0.08275862068965517, 'support': 132}, '14': {'precision': 0.7105263157894737, 'recall': 0.11946902654867257, 'f1-score': 0.20454545454545456, 'support': 226}, '15': {'precision': 0.7692307692307693, 'recall': 0.47619047619047616, 'f1-score': 0.588235294117647, 'support': 105}, '16': {'precision': 0.45, 'recall': 0.0661764705882353, 'f1-score': 0.11538461538461538, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.6293469041560644, 'recall': 0.13763680207753665, 'f1-score': 0.22587519025875188, 'support': 5391}, 'macro avg': {'precision': 0.370141916782393, 'recall': 0.08481802599100474, 'f1-score': 0.11908528591761927, 'support': 5391}, 'weighted avg': {'precision': 0.5163990665956046, 'recall': 0.13763680207753665, 'f1-score': 0.1868004975610208, 'support': 5391}, 'samples avg': {'precision': 0.23949869791666667, 'recall': 0.14333255828373015, 'f1-score': 0.16403307629870129, 'support': 5391}}