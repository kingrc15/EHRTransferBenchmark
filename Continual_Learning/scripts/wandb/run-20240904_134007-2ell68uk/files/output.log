
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43492855176329615
Train: epoch: 1, loss = 0.4211937392503023
Train: epoch: 1, loss = 0.4178066270550092
Train: epoch: 1, loss = 0.41391458120197056
Train: epoch: 1, loss = 0.4124069106131792
Train: epoch: 1, loss = 0.40868204067150754
Train: epoch: 1, loss = 0.40790285006165505
Train: epoch: 1, loss = 0.40651428198441864
Train: epoch: 1, loss = 0.4045413003034062
Train: epoch: 1, loss = 0.4034346131682396
Train: epoch: 1, loss = 0.4012919915535233
Train: epoch: 1, loss = 0.39924580841014784
Train: epoch: 1, loss = 0.3980150682020646
Train: epoch: 1, loss = 0.39627623296741926
Train: epoch: 1, loss = 0.39514156789084276
Train: epoch: 1, loss = 0.3941066632932052
Train: epoch: 1, loss = 0.39272897975848003
Train: epoch: 1, loss = 0.39190046622521346
Train:  Epoch 1, Loss=0.3915532185481145, AUC-ROC Macro=0.6596370763167301, AUC-ROC Micro=0.7501692028746303
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37149085104465485, AUC-ROC Macro=0.7175828915617197, AUC-ROC Micro=0.7828201550796426
Eval task: 2
Eval:  Epoch 1, Loss=0.30056586116552353, AUC-ROC Macro=0.4953175444135677, AUC-ROC Micro=0.5673953157655294
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37347850114107134
Train: epoch: 2, loss = 0.3753805411979556
Train: epoch: 2, loss = 0.3746181166668733
Train: epoch: 2, loss = 0.37360146367922425
Train: epoch: 2, loss = 0.37288416181504724
Train: epoch: 2, loss = 0.3732317553088069
Train: epoch: 2, loss = 0.3729960629663297
Train: epoch: 2, loss = 0.3727458053361625
Train: epoch: 2, loss = 0.37246867364479436
Train: epoch: 2, loss = 0.37239773879945276
Train: epoch: 2, loss = 0.3718170492351055
Train: epoch: 2, loss = 0.3711882567964494
Train: epoch: 2, loss = 0.37079283541211716
Train: epoch: 2, loss = 0.36994107795080966
Train: epoch: 2, loss = 0.3692693167477846
Train: epoch: 2, loss = 0.36898710118606687
Train: epoch: 2, loss = 0.36849365569651127
Train: epoch: 2, loss = 0.36835772244052756
Train:  Epoch 2, Loss=0.36825119483572805, AUC-ROC Macro=0.7250374513065124, AUC-ROC Micro=0.79159004397346
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36120643466711044, AUC-ROC Macro=0.7395552522713039, AUC-ROC Micro=0.7992085537111265
Eval task: 2
Eval:  Epoch 2, Loss=0.3144078515470028, AUC-ROC Macro=0.4913681739199003, AUC-ROC Micro=0.5596221076926655
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36177109107375144
Train: epoch: 3, loss = 0.36265266604721547
Train: epoch: 3, loss = 0.36234380207955835
Train: epoch: 3, loss = 0.36246804932132365
Train: epoch: 3, loss = 0.3630758985430002
Train: epoch: 3, loss = 0.364335867613554
Train: epoch: 3, loss = 0.36484408331768853
Train: epoch: 3, loss = 0.3641019694879651
Train: epoch: 3, loss = 0.3635751240866052
Train: epoch: 3, loss = 0.3629053117185831
Train: epoch: 3, loss = 0.36146376560357485
Train: epoch: 3, loss = 0.3611438452452421
Train: epoch: 3, loss = 0.3598290103731247
Train: epoch: 3, loss = 0.35931184245539566
Train: epoch: 3, loss = 0.35936173822979134
Train: epoch: 3, loss = 0.3594478553766385
Train: epoch: 3, loss = 0.3597528251041384
Train: epoch: 3, loss = 0.3598415857180953
Train:  Epoch 3, Loss=0.3599509491981604, AUC-ROC Macro=0.7437457793077259, AUC-ROC Micro=0.8042528989891291
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35641371458768845, AUC-ROC Macro=0.7496032278358526, AUC-ROC Micro=0.8060069666337166
Eval task: 2
Eval:  Epoch 3, Loss=0.33140360563993454, AUC-ROC Macro=0.49032735983601794, AUC-ROC Micro=0.5363034064609495
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3544614314287901
Train: epoch: 4, loss = 0.35228203698992727
Train: epoch: 4, loss = 0.353492638617754
Train: epoch: 4, loss = 0.3520250041037798
Train: epoch: 4, loss = 0.35295204481482506
Train: epoch: 4, loss = 0.35350779311110575
Train: epoch: 4, loss = 0.3542183772580964
Train: epoch: 4, loss = 0.354805803457275
Train: epoch: 4, loss = 0.3546616836306122
Train: epoch: 4, loss = 0.35432410561293365
Train: epoch: 4, loss = 0.3545824107527733
Train: epoch: 4, loss = 0.3550200443404416
Train: epoch: 4, loss = 0.3545574760952821
Train: epoch: 4, loss = 0.35483837144715447
Train: epoch: 4, loss = 0.3544279606143634
Train: epoch: 4, loss = 0.35429932455532254
Train: epoch: 4, loss = 0.3544393294479917
Train: epoch: 4, loss = 0.3545907637476921
Train:  Epoch 4, Loss=0.3546356014512543, AUC-ROC Macro=0.7554938923489304, AUC-ROC Micro=0.8121505796249044
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3538898465534051, AUC-ROC Macro=0.7564187292462025, AUC-ROC Micro=0.8098170757634042
Eval task: 2
Eval:  Epoch 4, Loss=0.3952324315905571, AUC-ROC Macro=0.4756166751623288, AUC-ROC Micro=0.5189078112821206
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3411815287172794
Train: epoch: 5, loss = 0.3479875235259533
Train: epoch: 5, loss = 0.3504764260848363
Train: epoch: 5, loss = 0.34989734645932913
Train: epoch: 5, loss = 0.34942789521813394
Train: epoch: 5, loss = 0.3497408359746138
Train: epoch: 5, loss = 0.3498990612583501
Train: epoch: 5, loss = 0.35006264643743634
Train: epoch: 5, loss = 0.3506930224266317
Train: epoch: 5, loss = 0.35079665841162205
Train: epoch: 5, loss = 0.3500922022421252
Train: epoch: 5, loss = 0.3501813452380399
Train: epoch: 5, loss = 0.35033250358242257
Train: epoch: 5, loss = 0.35008216449724777
Train: epoch: 5, loss = 0.35010451400279996
Train: epoch: 5, loss = 0.3504092056909576
Train: epoch: 5, loss = 0.3504132521064842
Train: epoch: 5, loss = 0.35030761447631653
Train:  Epoch 5, Loss=0.350391283646608, AUC-ROC Macro=0.7644214747656936, AUC-ROC Micro=0.8181959206411806
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.351444773375988, AUC-ROC Macro=0.7607538720528387, AUC-ROC Micro=0.813889055267926
Eval task: 2
Eval:  Epoch 5, Loss=0.4931210093200207, AUC-ROC Macro=0.4812680293480697, AUC-ROC Micro=0.5280838810920148
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3477652131021023
Train: epoch: 6, loss = 0.3483767933398485
Train: epoch: 6, loss = 0.3475326607127984
Train: epoch: 6, loss = 0.3467238575220108
Train: epoch: 6, loss = 0.34716795191168787
Train: epoch: 6, loss = 0.34602527572462954
Train: epoch: 6, loss = 0.34551900292081494
Train: epoch: 6, loss = 0.3464427170809358
Train: epoch: 6, loss = 0.346845372153653
Train: epoch: 6, loss = 0.3472345264852047
Train: epoch: 6, loss = 0.3472607848386873
Train: epoch: 6, loss = 0.34716884811098375
Train: epoch: 6, loss = 0.34704236237475505
Train: epoch: 6, loss = 0.34709674491946185
Train: epoch: 6, loss = 0.34718457312881945
Train: epoch: 6, loss = 0.3468875945452601
Train: epoch: 6, loss = 0.34663997296024773
Train: epoch: 6, loss = 0.346927622920937
Train:  Epoch 6, Loss=0.3469725779875731, AUC-ROC Macro=0.7712309963299524, AUC-ROC Micro=0.8228958433418497
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35190218066175777, AUC-ROC Macro=0.7602036730673195, AUC-ROC Micro=0.8137388936272726
Eval task: 2
Eval:  Epoch 6, Loss=0.40550876408815384, AUC-ROC Macro=0.4810855400494622, AUC-ROC Micro=0.5538312936283659
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35309433067838353, AUC-ROC Macro=0.7629042765895595, AUC-ROC Micro=0.8151635128430134
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.41328442096710205, AUC-ROC Macro=0.4860420794666212, AUC-ROC Micro=0.5507997955791282
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3054345179349184
Train: epoch: 1, loss = 0.299853574372828
Train: epoch: 1, loss = 0.2952421484639247
Train: epoch: 1, loss = 0.29238355057314036
Train: epoch: 1, loss = 0.2910945108681917
Train: epoch: 1, loss = 0.2897991873199741
Train:  Epoch 1, Loss=0.2887601776740938, AUC-ROC Macro=0.5797941000594036, AUC-ROC Micro=0.7433951700411197
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.33563343187173206, AUC-ROC Macro=0.7561283910736915, AUC-ROC Micro=0.8106585774226656
Eval task: 2
Eval:  Epoch 1, Loss=0.27208591625094414, AUC-ROC Macro=0.6602400498218322, AUC-ROC Micro=0.7800585989263963
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2791711633652449
Train: epoch: 2, loss = 0.27578801967203614
Train: epoch: 2, loss = 0.27609293423593045
Train: epoch: 2, loss = 0.2754933645017445
Train: epoch: 2, loss = 0.2751483301669359
Train: epoch: 2, loss = 0.2742176278556387
Train:  Epoch 2, Loss=0.2739646553034736, AUC-ROC Macro=0.6658267895799201, AUC-ROC Micro=0.7905265910973936
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3398494981229305, AUC-ROC Macro=0.753425687318727, AUC-ROC Micro=0.8092407493967142
Eval task: 2
Eval:  Epoch 2, Loss=0.2725807726383209, AUC-ROC Macro=0.6900240476103527, AUC-ROC Micro=0.7997743341839786
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2709111958742142
Train: epoch: 3, loss = 0.2688544150441885
Train: epoch: 3, loss = 0.26767109910647074
Train: epoch: 3, loss = 0.26739041281864045
Train: epoch: 3, loss = 0.26752622497081757
Train: epoch: 3, loss = 0.2664542655770977
Train:  Epoch 3, Loss=0.2661375903044517, AUC-ROC Macro=0.7010097737527949, AUC-ROC Micro=0.8058287533649053
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3264940244456132, AUC-ROC Macro=0.7476494771669644, AUC-ROC Micro=0.8043275828761256
Eval task: 2
Eval:  Epoch 3, Loss=0.27367060258984566, AUC-ROC Macro=0.7127621606655645, AUC-ROC Micro=0.8109151493746017
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.2642032355070114
Train: epoch: 4, loss = 0.26128644712269306
Train: epoch: 4, loss = 0.2605773099015156
Train: epoch: 4, loss = 0.26021437145769594
Train: epoch: 4, loss = 0.25968393525481226
Train: epoch: 4, loss = 0.25939148392528294
Train:  Epoch 4, Loss=0.2587979258265884, AUC-ROC Macro=0.7188020910249004, AUC-ROC Micro=0.8165591998289758
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3276834699014823, AUC-ROC Macro=0.743761768201382, AUC-ROC Micro=0.8003134474261471
Eval task: 2
Eval:  Epoch 4, Loss=0.25789063423871994, AUC-ROC Macro=0.7180189233762663, AUC-ROC Micro=0.8121403389349892
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.261469095274806
Train: epoch: 5, loss = 0.2555506018549204
Train: epoch: 5, loss = 0.2543966621160507
Train: epoch: 5, loss = 0.25425200641155243
Train: epoch: 5, loss = 0.2532786722928286
Train: epoch: 5, loss = 0.2525626775374015
Train:  Epoch 5, Loss=0.2521590382061347, AUC-ROC Macro=0.732555833682451, AUC-ROC Micro=0.8239292242490149
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3377262142797311, AUC-ROC Macro=0.7400598060012449, AUC-ROC Micro=0.7965562505090813
Eval task: 2
Eval:  Epoch 5, Loss=0.23809400387108326, AUC-ROC Macro=0.7200608064076817, AUC-ROC Micro=0.8174647929033653
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2458510671555996
Train: epoch: 6, loss = 0.24674852810800074
Train: epoch: 6, loss = 0.2463939916342497
Train: epoch: 6, loss = 0.2454949999973178
Train: epoch: 6, loss = 0.24544132974743843
Train: epoch: 6, loss = 0.24622393772006035
Train:  Epoch 6, Loss=0.24583851529888548, AUC-ROC Macro=0.74703039926387, AUC-ROC Micro=0.8298577424101097
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3238848273952802, AUC-ROC Macro=0.7372857438456318, AUC-ROC Micro=0.7944883764733074
Eval task: 2
Eval:  Epoch 6, Loss=0.26073164865374565, AUC-ROC Macro=0.7277330515189311, AUC-ROC Micro=0.8185916955492102
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3880553108950456, AUC-ROC Macro=0.7362477426928226, AUC-ROC Micro=0.7935612044987916
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2152878250926733, AUC-ROC Macro=0.7070066109351514, AUC-ROC Micro=0.8123481231078205
{'0': {'precision': 0.5476550680786687, 'recall': 0.27675840978593275, 'f1-score': 0.36769933976637886, 'support': 1308}, '1': {'precision': 0.5918367346938775, 'recall': 0.43283582089552236, 'f1-score': 0.5, 'support': 402}, '2': {'precision': 0.3671875, 'recall': 0.07142857142857142, 'f1-score': 0.11959287531806616, 'support': 658}, '3': {'precision': 0.4860426929392447, 'recall': 0.2974874371859296, 'f1-score': 0.36907730673316713, 'support': 1990}, '4': {'precision': 0.45507246376811594, 'recall': 0.19478908188585609, 'f1-score': 0.2728062554300608, 'support': 806}, '5': {'precision': 0.30864197530864196, 'recall': 0.06426735218508997, 'f1-score': 0.10638297872340424, 'support': 778}, '6': {'precision': 0.4804928131416838, 'recall': 0.17972350230414746, 'f1-score': 0.2615986584684181, 'support': 1302}, '7': {'precision': 0.34615384615384615, 'recall': 0.04245283018867924, 'f1-score': 0.07563025210084033, 'support': 424}, '8': {'precision': 0.4974838245866283, 'recall': 0.4209245742092457, 'f1-score': 0.45601317957166393, 'support': 1644}, '9': {'precision': 0.6172629187961386, 'recall': 0.535204332840965, 'f1-score': 0.5733122362869199, 'support': 2031}, '10': {'precision': 0.6535087719298246, 'recall': 0.2600349040139616, 'f1-score': 0.3720349563046192, 'support': 573}, '11': {'precision': 0.47068676716917923, 'recall': 0.2389455782312925, 'f1-score': 0.3169768753525099, 'support': 1176}, '12': {'precision': 0.5074503311258278, 'recall': 0.3463276836158192, 'f1-score': 0.41168569509738084, 'support': 1770}, '13': {'precision': 0.5494173500215797, 'recall': 0.4903697996918336, 'f1-score': 0.5182169753714635, 'support': 2596}, '14': {'precision': 0.4881422924901186, 'recall': 0.30362630608481866, 'f1-score': 0.37438423645320196, 'support': 1627}, '15': {'precision': 0.25, 'recall': 0.012396694214876033, 'f1-score': 0.023622047244094488, 'support': 484}, '16': {'precision': 0.35795454545454547, 'recall': 0.15849056603773584, 'f1-score': 0.2197035745422842, 'support': 795}, '17': {'precision': 0.3465346534653465, 'recall': 0.06433823529411764, 'f1-score': 0.10852713178294573, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.3870967741935484, 'recall': 0.0916030534351145, 'f1-score': 0.14814814814814814, 'support': 262}, '20': {'precision': 0.25, 'recall': 0.019538188277087035, 'f1-score': 0.03624382207578254, 'support': 563}, '21': {'precision': 0.44398340248962653, 'recall': 0.25567502986857826, 'f1-score': 0.3244882486732373, 'support': 837}, '22': {'precision': 0.6164102564102564, 'recall': 0.5534069981583793, 'f1-score': 0.5832120329936924, 'support': 1086}, '23': {'precision': 0.5050505050505051, 'recall': 0.29036004645760743, 'f1-score': 0.36873156342182895, 'support': 861}, '24': {'precision': 0.4389312977099237, 'recall': 0.22772277227722773, 'f1-score': 0.29986962190352023, 'support': 505}, 'micro avg': {'precision': 0.5185109429331152, 'recall': 0.29972805738383324, 'f1-score': 0.37987012987012986, 'support': 25373}, 'macro avg': {'precision': 0.4385198713990851, 'recall': 0.2331483107427356, 'f1-score': 0.2883183204705451, 'support': 25373}, 'weighted avg': {'precision': 0.4806040030638756, 'recall': 0.29972805738383324, 'f1-score': 0.3559601998186758, 'support': 25373}, 'samples avg': {'precision': 0.39175250024859404, 'recall': 0.27134610795212244, 'f1-score': 0.29308811654219824, 'support': 25373}}
{'0': {'precision': 0.6417112299465241, 'recall': 0.28708133971291866, 'f1-score': 0.396694214876033, 'support': 418}, '1': {'precision': 0.6333333333333333, 'recall': 0.08796296296296297, 'f1-score': 0.15447154471544716, 'support': 216}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 288}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 252}, '4': {'precision': 0.34375, 'recall': 0.03819444444444445, 'f1-score': 0.06875000000000002, 'support': 288}, '5': {'precision': 0.4583333333333333, 'recall': 0.040892193308550186, 'f1-score': 0.0750853242320819, 'support': 269}, '6': {'precision': 0.23076923076923078, 'recall': 0.02120141342756184, 'f1-score': 0.03883495145631068, 'support': 283}, '7': {'precision': 0.7952755905511811, 'recall': 0.396078431372549, 'f1-score': 0.5287958115183246, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.5, 'recall': 0.05508474576271186, 'f1-score': 0.09923664122137404, 'support': 236}, '10': {'precision': 0.5333333333333333, 'recall': 0.04371584699453552, 'f1-score': 0.0808080808080808, 'support': 183}, '11': {'precision': 1.0, 'recall': 0.019138755980861243, 'f1-score': 0.037558685446009384, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.21052631578947367, 'recall': 0.036036036036036036, 'f1-score': 0.061538461538461535, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.7108433734939759, 'recall': 0.6555555555555556, 'f1-score': 0.6820809248554914, 'support': 90}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.615916955017301, 'recall': 0.09365956327282295, 'f1-score': 0.16259419958894725, 'support': 3801}, 'macro avg': {'precision': 0.2423150296220154, 'recall': 0.0672376690223475, 'f1-score': 0.08895418562670457, 'support': 3801}, 'weighted avg': {'precision': 0.37026420766894147, 'recall': 0.09365956327282295, 'f1-score': 0.13135773605276493, 'support': 3801}, 'samples avg': {'precision': 0.16044108072916669, 'recall': 0.11308244977678572, 'f1-score': 0.12421487475198412, 'support': 3801}}