
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_northeast
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.42840562626719475
Train: epoch: 1, loss = 0.4202664531394839
Train: epoch: 1, loss = 0.4160778005172809
Train: epoch: 1, loss = 0.41239048024639485
Train: epoch: 1, loss = 0.409433205768466
Train: epoch: 1, loss = 0.4072818753744165
Train: epoch: 1, loss = 0.40554696609931334
Train: epoch: 1, loss = 0.4043975363392383
Train: epoch: 1, loss = 0.403391441512439
Train: epoch: 1, loss = 0.4024652104601264
Train: epoch: 1, loss = 0.4016348364407366
Train: epoch: 1, loss = 0.400397787373513
Train: epoch: 1, loss = 0.39935754873431645
Train: epoch: 1, loss = 0.39773788931114334
Train: epoch: 1, loss = 0.3965158417522907
Train: epoch: 1, loss = 0.39558946770615877
Train: epoch: 1, loss = 0.3948266179333715
Train: epoch: 1, loss = 0.3941230247914791
Train:  Epoch 1, Loss=0.3939275638975649, AUC-ROC Macro=0.6527334387653418, AUC-ROC Micro=0.7455896816424492
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3735264092683792, AUC-ROC Macro=0.7138791662772515, AUC-ROC Micro=0.7786505551568403
Eval task: 2
Eval:  Epoch 1, Loss=0.3943147212266922, AUC-ROC Macro=0.4785584346426775, AUC-ROC Micro=0.5835984208639186
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.36968038640916345
Train: epoch: 2, loss = 0.37007493756711485
Train: epoch: 2, loss = 0.3707902411371469
Train: epoch: 2, loss = 0.36964675536379216
Train: epoch: 2, loss = 0.36972230556607244
Train: epoch: 2, loss = 0.3702370928848783
Train: epoch: 2, loss = 0.37024217105337554
Train: epoch: 2, loss = 0.3690001331362873
Train: epoch: 2, loss = 0.36929117732577854
Train: epoch: 2, loss = 0.3691292946860194
Train: epoch: 2, loss = 0.3695741591331634
Train: epoch: 2, loss = 0.36965304613113403
Train: epoch: 2, loss = 0.36956334625872284
Train: epoch: 2, loss = 0.36968027612992693
Train: epoch: 2, loss = 0.36942326330641906
Train: epoch: 2, loss = 0.36909132030792535
Train: epoch: 2, loss = 0.3690697027611382
Train: epoch: 2, loss = 0.36901999744276204
Train:  Epoch 2, Loss=0.3689980817044902, AUC-ROC Macro=0.7232685294592254, AUC-ROC Micro=0.7906766448270277
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3639313193658988, AUC-ROC Macro=0.7371892322078035, AUC-ROC Micro=0.7953188746238729
Eval task: 2
Eval:  Epoch 2, Loss=0.4049943834543228, AUC-ROC Macro=0.48440170145254835, AUC-ROC Micro=0.6048552544005255
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36310894072055816
Train: epoch: 3, loss = 0.3639981998130679
Train: epoch: 3, loss = 0.3610086360325416
Train: epoch: 3, loss = 0.3621943999826908
Train: epoch: 3, loss = 0.36144725112617015
Train: epoch: 3, loss = 0.36134225117663543
Train: epoch: 3, loss = 0.3612315712975604
Train: epoch: 3, loss = 0.36068016038276257
Train: epoch: 3, loss = 0.35986999129255615
Train: epoch: 3, loss = 0.3600640848278999
Train: epoch: 3, loss = 0.3602019238471985
Train: epoch: 3, loss = 0.36040097078308464
Train: epoch: 3, loss = 0.36056418172441995
Train: epoch: 3, loss = 0.3608300280570984
Train: epoch: 3, loss = 0.3605095053662856
Train: epoch: 3, loss = 0.3607315555587411
Train: epoch: 3, loss = 0.3607798828491393
Train: epoch: 3, loss = 0.36055859888593356
Train:  Epoch 3, Loss=0.36044303150462287, AUC-ROC Macro=0.7432879096345789, AUC-ROC Micro=0.8038241658018342
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35587873434027034, AUC-ROC Macro=0.7497942433495963, AUC-ROC Micro=0.8069647925183993
Eval task: 2
Eval:  Epoch 3, Loss=0.43611741065979004, AUC-ROC Macro=0.4788121917982531, AUC-ROC Micro=0.5688661139003056
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.35543549232184884
Train: epoch: 4, loss = 0.35583214595913887
Train: epoch: 4, loss = 0.35470372209946316
Train: epoch: 4, loss = 0.35571404460817574
Train: epoch: 4, loss = 0.3561683796495199
Train: epoch: 4, loss = 0.3558463455115755
Train: epoch: 4, loss = 0.3567869380755084
Train: epoch: 4, loss = 0.355429419297725
Train: epoch: 4, loss = 0.3554626727435324
Train: epoch: 4, loss = 0.35522809144854545
Train: epoch: 4, loss = 0.3553691972250288
Train: epoch: 4, loss = 0.3551579502659539
Train: epoch: 4, loss = 0.3549227150529623
Train: epoch: 4, loss = 0.35478853721171616
Train: epoch: 4, loss = 0.3549414535264174
Train: epoch: 4, loss = 0.3550426390301436
Train: epoch: 4, loss = 0.3551026257565793
Train: epoch: 4, loss = 0.3550000729163488
Train:  Epoch 4, Loss=0.3551127516265608, AUC-ROC Macro=0.7548260224341158, AUC-ROC Micro=0.8115642388551257
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35379678880174953, AUC-ROC Macro=0.7549486741793294, AUC-ROC Micro=0.8098304163554426
Eval task: 2
Eval:  Epoch 4, Loss=0.6491827964782715, AUC-ROC Macro=0.47399668955985136, AUC-ROC Micro=0.5457507585750925
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.351289469525218
Train: epoch: 5, loss = 0.349152847006917
Train: epoch: 5, loss = 0.348457571392258
Train: epoch: 5, loss = 0.3497047718986869
Train: epoch: 5, loss = 0.35027069084346296
Train: epoch: 5, loss = 0.34974767486254377
Train: epoch: 5, loss = 0.35075256917093484
Train: epoch: 5, loss = 0.3502943237032741
Train: epoch: 5, loss = 0.3496234193113115
Train: epoch: 5, loss = 0.35060170367360116
Train: epoch: 5, loss = 0.3507769591564482
Train: epoch: 5, loss = 0.35065341555203
Train: epoch: 5, loss = 0.3505930583236309
Train: epoch: 5, loss = 0.3505896354094148
Train: epoch: 5, loss = 0.35052130738894144
Train: epoch: 5, loss = 0.3508920795703307
Train: epoch: 5, loss = 0.3507990381428424
Train: epoch: 5, loss = 0.3510863366350532
Train:  Epoch 5, Loss=0.35105855340835374, AUC-ROC Macro=0.7629999854647906, AUC-ROC Micro=0.8172905747995968
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3510683650771777, AUC-ROC Macro=0.7607401198112221, AUC-ROC Micro=0.8138898983005796
Eval task: 2
Eval:  Epoch 5, Loss=0.4574402719736099, AUC-ROC Macro=0.47747365848541135, AUC-ROC Micro=0.5720019756384153
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3436116798222065
Train: epoch: 6, loss = 0.3473969797790051
Train: epoch: 6, loss = 0.34759399510920047
Train: epoch: 6, loss = 0.34706112001091244
Train: epoch: 6, loss = 0.34670679415762423
Train: epoch: 6, loss = 0.34674642167985437
Train: epoch: 6, loss = 0.3467616593837738
Train: epoch: 6, loss = 0.3467312043532729
Train: epoch: 6, loss = 0.34647903165055643
Train: epoch: 6, loss = 0.3469460590928793
Train: epoch: 6, loss = 0.34693148013543
Train: epoch: 6, loss = 0.3474176820057134
Train: epoch: 6, loss = 0.3475684951245785
Train: epoch: 6, loss = 0.34745857916772366
Train: epoch: 6, loss = 0.3473362621665001
Train: epoch: 6, loss = 0.3471769290463999
Train: epoch: 6, loss = 0.34743975556510337
Train: epoch: 6, loss = 0.34730012006229827
Train:  Epoch 6, Loss=0.34746074086784295, AUC-ROC Macro=0.7706022535245833, AUC-ROC Micro=0.8223878408665949
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3512501083314419, AUC-ROC Macro=0.7608934393138367, AUC-ROC Micro=0.8139817590564377
Eval task: 2
Eval:  Epoch 6, Loss=0.4684329926967621, AUC-ROC Macro=0.49840309070311734, AUC-ROC Micro=0.5685765328667238
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3538213074207306, AUC-ROC Macro=0.7604744358445168, AUC-ROC Micro=0.8131670804867519
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.46647022664546967, AUC-ROC Macro=0.4783271690153685, AUC-ROC Micro=0.5755014187032684
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3379959619790316
Train:  Epoch 1, Loss=0.32165423347361416, AUC-ROC Macro=0.5695971721821472, AUC-ROC Micro=0.7432291642777374
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4240874871611595, AUC-ROC Macro=0.6902964487452351, AUC-ROC Micro=0.6917835005069569
Eval task: 2
Eval:  Epoch 1, Loss=0.29684560000896454, AUC-ROC Macro=0.6317037246771773, AUC-ROC Micro=0.784872673878398
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2930475630611181
Train:  Epoch 2, Loss=0.28903832289713693, AUC-ROC Macro=0.6791351298761886, AUC-ROC Micro=0.8089659327387557
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.4423426662882169, AUC-ROC Macro=0.6794514373238001, AUC-ROC Micro=0.675564266599083
Eval task: 2
Eval:  Epoch 2, Loss=0.2856346517801285, AUC-ROC Macro=0.6839405600892695, AUC-ROC Micro=0.8113039822486766
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.27696065708994866
Train:  Epoch 3, Loss=0.2768458874072656, AUC-ROC Macro=0.7250184963212903, AUC-ROC Micro=0.8311125109874982
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.4576146925489108, AUC-ROC Macro=0.6580622602902784, AUC-ROC Micro=0.6571549395657055
Eval task: 2
Eval:  Epoch 3, Loss=0.2802511751651764, AUC-ROC Macro=0.7021033089894657, AUC-ROC Micro=0.8203339002561855
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.26922585353255274
Train:  Epoch 4, Loss=0.2684509747946113, AUC-ROC Macro=0.7513728510978521, AUC-ROC Micro=0.8444275074322986
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.46449050803979236, AUC-ROC Macro=0.6558788230430648, AUC-ROC Micro=0.6527366235888529
Eval task: 2
Eval:  Epoch 4, Loss=0.2775324881076813, AUC-ROC Macro=0.7147402501235084, AUC-ROC Micro=0.8269851901277648
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.26448901899158955
Train:  Epoch 5, Loss=0.26194345963549914, AUC-ROC Macro=0.7722852002347177, AUC-ROC Micro=0.8540855618801658
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.4748809101680915, AUC-ROC Macro=0.6398785199000262, AUC-ROC Micro=0.6432305687580506
Eval task: 2
Eval:  Epoch 5, Loss=0.27680516242980957, AUC-ROC Macro=0.7155516608537085, AUC-ROC Micro=0.8282768493559429
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.253677916675806
Train:  Epoch 6, Loss=0.25640600664096896, AUC-ROC Macro=0.7888591843221932, AUC-ROC Micro=0.8619540900966096
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.4789575586716334, AUC-ROC Macro=0.6418406686098025, AUC-ROC Micro=0.6440021553645576
Eval task: 2
Eval:  Epoch 6, Loss=0.2744445502758026, AUC-ROC Macro=0.7134436834731522, AUC-ROC Micro=0.8323563364858054
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.4793522084752719, AUC-ROC Macro=0.646470274774212, AUC-ROC Micro=0.649143177038696
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.28780682384967804, AUC-ROC Macro=0.7152143161952877, AUC-ROC Micro=0.8232516797909981
{'0': {'precision': 0.347008547008547, 'recall': 0.6207951070336392, 'f1-score': 0.4451754385964912, 'support': 1308}, '1': {'precision': 0.49873417721518987, 'recall': 0.4900497512437811, 'f1-score': 0.49435382685069, 'support': 402}, '2': {'precision': 0.16355140186915887, 'recall': 0.10638297872340426, 'f1-score': 0.12891344383057088, 'support': 658}, '3': {'precision': 0.3589981447124304, 'recall': 0.38894472361809046, 'f1-score': 0.3733719247467438, 'support': 1990}, '4': {'precision': 0.26229508196721313, 'recall': 0.09925558312655088, 'f1-score': 0.14401440144014402, 'support': 806}, '5': {'precision': 0.15384615384615385, 'recall': 0.017994858611825194, 'f1-score': 0.03222094361334868, 'support': 778}, '6': {'precision': 0.3390151515151515, 'recall': 0.2749615975422427, 'f1-score': 0.30364715860899066, 'support': 1302}, '7': {'precision': 0.5, 'recall': 0.0023584905660377358, 'f1-score': 0.004694835680751173, 'support': 424}, '8': {'precision': 0.6354166666666666, 'recall': 0.03710462287104623, 'f1-score': 0.07011494252873564, 'support': 1644}, '9': {'precision': 0.8974358974358975, 'recall': 0.017232890201871, 'f1-score': 0.033816425120772944, 'support': 2031}, '10': {'precision': 0.34210526315789475, 'recall': 0.02268760907504363, 'f1-score': 0.0425531914893617, 'support': 573}, '11': {'precision': 0.5, 'recall': 0.0008503401360544217, 'f1-score': 0.0016977928692699488, 'support': 1176}, '12': {'precision': 1.0, 'recall': 0.001694915254237288, 'f1-score': 0.0033840947546531297, 'support': 1770}, '13': {'precision': 0.3565217391304348, 'recall': 0.015793528505392913, 'f1-score': 0.030247141276281815, 'support': 2596}, '14': {'precision': 0.208955223880597, 'recall': 0.008604794099569761, 'f1-score': 0.01652892561983471, 'support': 1627}, '15': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 0.20652173913043478, 'recall': 0.034926470588235295, 'f1-score': 0.05974842767295597, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.3333333333333333, 'recall': 0.026717557251908396, 'f1-score': 0.04946996466431096, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.7919463087248322, 'recall': 0.10865561694290976, 'f1-score': 0.19109311740890686, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.6666666666666666, 'recall': 0.007920792079207921, 'f1-score': 0.01565557729941292, 'support': 505}, 'micro avg': {'precision': 0.35398946942081816, 'recall': 0.10333819414338076, 'f1-score': 0.15997559487492374, 'support': 25373}, 'macro avg': {'precision': 0.3424940598504241, 'recall': 0.09131728909884192, 'f1-score': 0.09762806296288909, 'support': 25373}, 'weighted avg': {'precision': 0.41556564241698585, 'recall': 0.10333819414338076, 'f1-score': 0.10759345622749594, 'support': 25373}, 'samples avg': {'precision': 0.19716596653852514, 'recall': 0.08372038912523172, 'f1-score': 0.10601727355590522, 'support': 25373}}
{'0': {'precision': 0.6086956521739131, 'recall': 0.4307692307692308, 'f1-score': 0.5045045045045046, 'support': 130}, '1': {'precision': 0.6956521739130435, 'recall': 0.35294117647058826, 'f1-score': 0.46829268292682924, 'support': 136}, '2': {'precision': 0.417910447761194, 'recall': 0.20437956204379562, 'f1-score': 0.2745098039215686, 'support': 137}, '3': {'precision': 0.6488888888888888, 'recall': 0.6854460093896714, 'f1-score': 0.6666666666666667, 'support': 213}, '4': {'precision': 0.5, 'recall': 0.12, 'f1-score': 0.1935483870967742, 'support': 75}, '5': {'precision': 0.5, 'recall': 0.09574468085106383, 'f1-score': 0.16071428571428573, 'support': 94}, '6': {'precision': 0.625, 'recall': 0.06756756756756757, 'f1-score': 0.12195121951219512, 'support': 74}, '7': {'precision': 0.5, 'recall': 0.075, 'f1-score': 0.13043478260869565, 'support': 40}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '9': {'precision': 1.0, 'recall': 0.015384615384615385, 'f1-score': 0.030303030303030307, 'support': 65}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 63}, '11': {'precision': 0.3333333333333333, 'recall': 0.03571428571428571, 'f1-score': 0.06451612903225806, 'support': 56}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 52}, '13': {'precision': 0.625, 'recall': 0.09090909090909091, 'f1-score': 0.15873015873015875, 'support': 55}, '14': {'precision': 0.7368421052631579, 'recall': 0.2222222222222222, 'f1-score': 0.34146341463414637, 'support': 63}, '15': {'precision': 0.8333333333333334, 'recall': 0.2631578947368421, 'f1-score': 0.39999999999999997, 'support': 19}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '17': {'precision': 0.375, 'recall': 0.036585365853658534, 'f1-score': 0.06666666666666667, 'support': 82}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, 'micro avg': {'precision': 0.6061705989110708, 'recall': 0.2173064411190631, 'f1-score': 0.3199233716475096, 'support': 1537}, 'macro avg': {'precision': 0.33598623738667455, 'recall': 0.1078328680765053, 'f1-score': 0.1432920692927112, 'support': 1537}, 'weighted avg': {'precision': 0.4756032841528812, 'recall': 0.2173064411190631, 'f1-score': 0.2613128872822515, 'support': 1537}, 'samples avg': {'precision': 0.3727864583333333, 'recall': 0.1967316158234127, 'f1-score': 0.23683485568251195, 'support': 1537}}