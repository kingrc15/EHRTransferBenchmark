
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_west_baseline
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43382311359047887
Train: epoch: 1, loss = 0.4219724426418543
Train: epoch: 1, loss = 0.41620808792610964
Train: epoch: 1, loss = 0.4137401652522385
Train: epoch: 1, loss = 0.4101430445462465
Train: epoch: 1, loss = 0.40783312674611805
Train: epoch: 1, loss = 0.40745271445385045
Train: epoch: 1, loss = 0.406617150856182
Train: epoch: 1, loss = 0.40492570942474737
Train: epoch: 1, loss = 0.4035969297811389
Train: epoch: 1, loss = 0.40168255227533256
Train: epoch: 1, loss = 0.4004205372246603
Train: epoch: 1, loss = 0.3988360970410017
Train: epoch: 1, loss = 0.3974920869831528
Train: epoch: 1, loss = 0.39606194651126864
Train: epoch: 1, loss = 0.39510669935494663
Train: epoch: 1, loss = 0.39407761198632857
Train: epoch: 1, loss = 0.39309346170475085
Train:  Epoch 1, Loss=0.3927581905462803, AUC-ROC Macro=0.656061617587119, AUC-ROC Micro=0.7480074595614635
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3711477890610695, AUC-ROC Macro=0.7188818509112384, AUC-ROC Micro=0.783268079392754
Eval task: 2
Eval:  Epoch 1, Loss=0.317848265171051, AUC-ROC Macro=0.5157334416455929, AUC-ROC Micro=0.5598172406232697
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3699957972764969
Train: epoch: 2, loss = 0.3695406598597765
Train: epoch: 2, loss = 0.37077713911732035
Train: epoch: 2, loss = 0.3708986206911504
Train: epoch: 2, loss = 0.3710269066542387
Train: epoch: 2, loss = 0.37067972019314765
Train: epoch: 2, loss = 0.3701924496144056
Train: epoch: 2, loss = 0.3694292746111751
Train: epoch: 2, loss = 0.36982911004788344
Train: epoch: 2, loss = 0.3706105978116393
Train: epoch: 2, loss = 0.37035926978696476
Train: epoch: 2, loss = 0.37015153978019955
Train: epoch: 2, loss = 0.37042949720644036
Train: epoch: 2, loss = 0.36966532216540404
Train: epoch: 2, loss = 0.3697346013734738
Train: epoch: 2, loss = 0.36984267191495745
Train: epoch: 2, loss = 0.3692342094025191
Train: epoch: 2, loss = 0.3687956080213189
Train:  Epoch 2, Loss=0.36884771885627354, AUC-ROC Macro=0.7240109123805673, AUC-ROC Micro=0.7906943234493614
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3633042151729266, AUC-ROC Macro=0.7394057793666522, AUC-ROC Micro=0.7960930238571668
Eval task: 2
Eval:  Epoch 2, Loss=0.3422377407550812, AUC-ROC Macro=0.49500620512898746, AUC-ROC Micro=0.5168928251575773
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3648892220854759
Train: epoch: 3, loss = 0.3649005239829421
Train: epoch: 3, loss = 0.36173452148834867
Train: epoch: 3, loss = 0.36042338417842984
Train: epoch: 3, loss = 0.36171218743920325
Train: epoch: 3, loss = 0.3607573469479879
Train: epoch: 3, loss = 0.3611271344763892
Train: epoch: 3, loss = 0.361630238071084
Train: epoch: 3, loss = 0.3626085915002558
Train: epoch: 3, loss = 0.36279443534463646
Train: epoch: 3, loss = 0.36238487287001175
Train: epoch: 3, loss = 0.36278553924833734
Train: epoch: 3, loss = 0.36231327913128414
Train: epoch: 3, loss = 0.36179366472576346
Train: epoch: 3, loss = 0.3618619622339805
Train: epoch: 3, loss = 0.36167404577601703
Train: epoch: 3, loss = 0.36104504038305846
Train: epoch: 3, loss = 0.36068194075591037
Train:  Epoch 3, Loss=0.360655714532249, AUC-ROC Macro=0.7430894639650546, AUC-ROC Micro=0.8035874792813704
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3562734127044678, AUC-ROC Macro=0.7513125758531913, AUC-ROC Micro=0.8066204817459636
Eval task: 2
Eval:  Epoch 3, Loss=0.35834161937236786, AUC-ROC Macro=0.4987393287852086, AUC-ROC Micro=0.5464407789225234
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.35268128409981725
Train: epoch: 4, loss = 0.3520869898796082
Train: epoch: 4, loss = 0.35300228228171665
Train: epoch: 4, loss = 0.35338118629530074
Train: epoch: 4, loss = 0.35457051648199556
Train: epoch: 4, loss = 0.3529511457433303
Train: epoch: 4, loss = 0.353467335456184
Train: epoch: 4, loss = 0.3532619682326913
Train: epoch: 4, loss = 0.35394572039445243
Train: epoch: 4, loss = 0.3543211014419794
Train: epoch: 4, loss = 0.35447440866719593
Train: epoch: 4, loss = 0.3542285180091858
Train: epoch: 4, loss = 0.3538688702766712
Train: epoch: 4, loss = 0.35428619490670304
Train: epoch: 4, loss = 0.3544625490307808
Train: epoch: 4, loss = 0.3547640597494319
Train: epoch: 4, loss = 0.3548246459049337
Train: epoch: 4, loss = 0.35462542093876337
Train:  Epoch 4, Loss=0.35454182567351905, AUC-ROC Macro=0.7562642052476302, AUC-ROC Micro=0.8124573894987366
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35391761859258014, AUC-ROC Macro=0.7570090952887996, AUC-ROC Micro=0.8109582856983794
Eval task: 2
Eval:  Epoch 4, Loss=0.34115514904260635, AUC-ROC Macro=0.4943216867477546, AUC-ROC Micro=0.528729300480602
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.35254589557647703
Train: epoch: 5, loss = 0.35162694491446017
Train: epoch: 5, loss = 0.3528340530395508
Train: epoch: 5, loss = 0.3537363753095269
Train: epoch: 5, loss = 0.353604992210865
Train: epoch: 5, loss = 0.35217870311190685
Train: epoch: 5, loss = 0.35172811767884665
Train: epoch: 5, loss = 0.35178659929893913
Train: epoch: 5, loss = 0.35154845599499013
Train: epoch: 5, loss = 0.3511104171872139
Train: epoch: 5, loss = 0.3513198649273677
Train: epoch: 5, loss = 0.3512330177053809
Train: epoch: 5, loss = 0.35102971560106827
Train: epoch: 5, loss = 0.3510747987457684
Train: epoch: 5, loss = 0.35070337643225985
Train: epoch: 5, loss = 0.3509845466865227
Train: epoch: 5, loss = 0.35096126509939923
Train: epoch: 5, loss = 0.3504112795367837
Train:  Epoch 5, Loss=0.35045770104114826, AUC-ROC Macro=0.7646657716632174, AUC-ROC Micro=0.8182538079540851
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3519245559970538, AUC-ROC Macro=0.7608355014856614, AUC-ROC Micro=0.8137101355187052
Eval task: 2
Eval:  Epoch 5, Loss=0.3667720928788185, AUC-ROC Macro=0.4812129274355614, AUC-ROC Micro=0.5268297623958222
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.35340437449514867
Train: epoch: 6, loss = 0.3510957970842719
Train: epoch: 6, loss = 0.3478913129121065
Train: epoch: 6, loss = 0.34748888133093714
Train: epoch: 6, loss = 0.34699733467400073
Train: epoch: 6, loss = 0.34794373566905656
Train: epoch: 6, loss = 0.3486611346687589
Train: epoch: 6, loss = 0.3492503411602229
Train: epoch: 6, loss = 0.34873334805170697
Train: epoch: 6, loss = 0.347862107552588
Train: epoch: 6, loss = 0.34782342299141666
Train: epoch: 6, loss = 0.3471266119492551
Train: epoch: 6, loss = 0.3471935824648692
Train: epoch: 6, loss = 0.3470463487984879
Train: epoch: 6, loss = 0.3467920756936073
Train: epoch: 6, loss = 0.3471460487134755
Train: epoch: 6, loss = 0.34731182380634196
Train: epoch: 6, loss = 0.34694986171192593
Train:  Epoch 6, Loss=0.3470682730654366, AUC-ROC Macro=0.7715189521772362, AUC-ROC Micro=0.8229218840358238
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35001349573334056, AUC-ROC Macro=0.7648201724783144, AUC-ROC Micro=0.8160317386336727
Eval task: 2
Eval:  Epoch 6, Loss=0.39448925107717514, AUC-ROC Macro=0.49100862189394534, AUC-ROC Micro=0.5295278760340801
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3525163804491361, AUC-ROC Macro=0.7650684278036778, AUC-ROC Micro=0.8148454751615295
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.38949450105428696, AUC-ROC Macro=0.4821575734070114, AUC-ROC Micro=0.5317332791392902
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2665653518587351
Train: epoch: 1, loss = 0.25065375842154025
Train: epoch: 1, loss = 0.2464577374358972
Train:  Epoch 1, Loss=0.24392841491946532, AUC-ROC Macro=0.5836735462217184, AUC-ROC Micro=0.7552154289628312
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4548201027015845, AUC-ROC Macro=0.6896082607504674, AUC-ROC Micro=0.676100284176699
Eval task: 2
Eval:  Epoch 1, Loss=0.2273903787136078, AUC-ROC Macro=0.6871107384042978, AUC-ROC Micro=0.798002568378158
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.22295850627124308
Train: epoch: 2, loss = 0.2244774917140603
Train: epoch: 2, loss = 0.22380791969597338
Train:  Epoch 2, Loss=0.2235800202702044, AUC-ROC Macro=0.6973520975762879, AUC-ROC Micro=0.8117366889576902
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.4741290546953678, AUC-ROC Macro=0.666605995709774, AUC-ROC Micro=0.6594878721640645
Eval task: 2
Eval:  Epoch 2, Loss=0.22555109858512878, AUC-ROC Macro=0.7039597721070785, AUC-ROC Micro=0.8074690751449689
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.21758865185081958
Train: epoch: 3, loss = 0.21975192289799453
Train: epoch: 3, loss = 0.21833247096588215
Train:  Epoch 3, Loss=0.2173441086550861, AUC-ROC Macro=0.7308166051684745, AUC-ROC Micro=0.8264163321513447
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.4977899764974912, AUC-ROC Macro=0.6496908986747032, AUC-ROC Micro=0.6441624186505815
Eval task: 2
Eval:  Epoch 3, Loss=0.2219526655972004, AUC-ROC Macro=0.7121693030373893, AUC-ROC Micro=0.8143742644049226
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.21118631772696972
Train: epoch: 4, loss = 0.2126685944199562
Train: epoch: 4, loss = 0.21268984764814378
Train:  Epoch 4, Loss=0.21298954710567725, AUC-ROC Macro=0.7497925745229941, AUC-ROC Micro=0.8355858122422698
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5003609023988247, AUC-ROC Macro=0.6384228694793118, AUC-ROC Micro=0.6478402062690386
Eval task: 2
Eval:  Epoch 4, Loss=0.21949411556124687, AUC-ROC Macro=0.7202594536541568, AUC-ROC Micro=0.820390246958213
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.20912712551653384
Train: epoch: 5, loss = 0.20959751276299357
Train: epoch: 5, loss = 0.20938108966996272
Train:  Epoch 5, Loss=0.20884344626058765, AUC-ROC Macro=0.7685574847657957, AUC-ROC Micro=0.8447705700030486
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.517780768374602, AUC-ROC Macro=0.6257454830531107, AUC-ROC Micro=0.6423873566629927
Eval task: 2
Eval:  Epoch 5, Loss=0.22064832225441933, AUC-ROC Macro=0.7185506134627013, AUC-ROC Micro=0.8191818138865486
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2065141612291336
Train: epoch: 6, loss = 0.206098887398839
Train: epoch: 6, loss = 0.20615633810559908
Train:  Epoch 6, Loss=0.20555458139353605, AUC-ROC Macro=0.7802844336632342, AUC-ROC Micro=0.8515656606739008
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5341217306753, AUC-ROC Macro=0.6132847740664243, AUC-ROC Micro=0.638511733759848
Eval task: 2
Eval:  Epoch 6, Loss=0.22053521871566772, AUC-ROC Macro=0.7194889660855028, AUC-ROC Micro=0.8215726140175688
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5367469365398089, AUC-ROC Macro=0.6149671904478852, AUC-ROC Micro=0.6416366078523598
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.21979086846113205, AUC-ROC Macro=0.7405306959123387, AUC-ROC Micro=0.8227961759547898
{'0': {'precision': 0.33676268861454045, 'recall': 0.37856592135697764, 'f1-score': 0.3564428312159709, 'support': 1297.0}, '1': {'precision': 0.5060240963855421, 'recall': 0.20638820638820637, 'f1-score': 0.2931937172774869, 'support': 407.0}, '2': {'precision': 0.5, 'recall': 0.0015060240963855422, 'f1-score': 0.003003003003003003, 'support': 664.0}, '3': {'precision': 0.3333333333333333, 'recall': 0.0005022601707684581, 'f1-score': 0.001003009027081244, 'support': 1991.0}, '4': {'precision': 0.21345707656612528, 'recall': 0.11442786069651742, 'f1-score': 0.14898785425101216, 'support': 804.0}, '5': {'precision': 0.16363636363636364, 'recall': 0.011627906976744186, 'f1-score': 0.021712907117008445, 'support': 774.0}, '6': {'precision': 0.4767932489451477, 'recall': 0.0861280487804878, 'f1-score': 0.1459005810200129, 'support': 1312.0}, '7': {'precision': 0.04316546762589928, 'recall': 0.013824884792626729, 'f1-score': 0.020942408376963352, 'support': 434.0}, '8': {'precision': 0.5277777777777778, 'recall': 0.01153612629022465, 'f1-score': 0.0225787284610814, 'support': 1647.0}, '9': {'precision': 0.7272727272727273, 'recall': 0.003950617283950617, 'f1-score': 0.007858546168958742, 'support': 2025.0}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 570.0}, '11': {'precision': 0.3372093023255814, 'recall': 0.04919423240033927, 'f1-score': 0.08586232420429311, 'support': 1179.0}, '12': {'precision': 0.7142857142857143, 'recall': 0.005649717514124294, 'f1-score': 0.011210762331838566, 'support': 1770.0}, '13': {'precision': 0.41379310344827586, 'recall': 0.059770114942528735, 'f1-score': 0.10445262805490457, 'support': 2610.0}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1619.0}, '15': {'precision': 0.09230769230769231, 'recall': 0.02459016393442623, 'f1-score': 0.038834951456310676, 'support': 488.0}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 791.0}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 543.0}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 350.0}, '19': {'precision': 0.47368421052631576, 'recall': 0.033962264150943396, 'f1-score': 0.06338028169014083, 'support': 265.0}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 554.0}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 829.0}, '22': {'precision': 0.8620689655172413, 'recall': 0.023084025854108958, 'f1-score': 0.044964028776978415, 'support': 1083.0}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 856.0}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 499.0}, 'micro avg': {'precision': 0.3335365853658537, 'recall': 0.043137100272071294, 'f1-score': 0.07639398065709997, 'support': 25361.0}, 'macro avg': {'precision': 0.26886287074273113, 'recall': 0.04098833502517442, 'f1-score': 0.05481314249732181, 'support': 25361.0}, 'weighted avg': {'precision': 0.3457665780274308, 'recall': 0.043137100272071294, 'f1-score': 0.057330935575304415, 'support': 25361.0}, 'samples avg': {'precision': 0.11143391927083333, 'recall': 0.0315453577157966, 'f1-score': 0.04599345595836169, 'support': 25361.0}}
Traceback (most recent call last):
  File "../tests/test.py", line 614, in <module>
    main()
  File "../tests/test.py", line 418, in main
    TestLSTM().test_standard_lstm(
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 446, in test_standard_lstm
    sources = get_conf_matrix_stats(task, model, test_loaders, device, region)
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 490, in get_conf_matrix_stats
    specificity = multilabel_specificity(y_true, y_pred)
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 518, in multilabel_specificity
    true_label = y_true[:, label]
TypeError: list indices must be integers or slices, not tuple
Traceback (most recent call last):
  File "../tests/test.py", line 614, in <module>
    main()
  File "../tests/test.py", line 418, in main
    TestLSTM().test_standard_lstm(
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 446, in test_standard_lstm
    sources = get_conf_matrix_stats(task, model, test_loaders, device, region)
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 490, in get_conf_matrix_stats
    specificity = multilabel_specificity(y_true, y_pred)
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 518, in multilabel_specificity
    true_label = y_true[:, label]
TypeError: list indices must be integers or slices, not tuple