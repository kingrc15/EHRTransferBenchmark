
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_northeast
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43238038539886475
Train: epoch: 1, loss = 0.4219874818623066
Train: epoch: 1, loss = 0.41517133072018625
Train: epoch: 1, loss = 0.41188655063509944
Train: epoch: 1, loss = 0.4087250606119633
Train: epoch: 1, loss = 0.4063571341087421
Train: epoch: 1, loss = 0.40420176484755105
Train: epoch: 1, loss = 0.4023609883710742
Train: epoch: 1, loss = 0.40074790643321145
Train: epoch: 1, loss = 0.3994840813577175
Train: epoch: 1, loss = 0.3988305661353198
Train: epoch: 1, loss = 0.39725249901413917
Train: epoch: 1, loss = 0.3954833905857343
Train: epoch: 1, loss = 0.39476293364805837
Train: epoch: 1, loss = 0.39391414577762285
Train: epoch: 1, loss = 0.3926667785132304
Train: epoch: 1, loss = 0.3914663148145465
Train: epoch: 1, loss = 0.3908299978491333
Train:  Epoch 1, Loss=0.39067092703142736, AUC-ROC Macro=0.6635493077909835, AUC-ROC Micro=0.7520187663763327
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37018463263909024, AUC-ROC Macro=0.7194662826502275, AUC-ROC Micro=0.7840765418091098
Eval task: 2
Eval:  Epoch 1, Loss=0.38949303328990936, AUC-ROC Macro=0.4893723618302609, AUC-ROC Micro=0.5935107681880012
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.36472005598247054
Train: epoch: 2, loss = 0.36849946558475494
Train: epoch: 2, loss = 0.3689592699954907
Train: epoch: 2, loss = 0.3700812730938196
Train: epoch: 2, loss = 0.36982604490220544
Train: epoch: 2, loss = 0.37028413590043785
Train: epoch: 2, loss = 0.37074350927557265
Train: epoch: 2, loss = 0.3705277463886887
Train: epoch: 2, loss = 0.3703684357388152
Train: epoch: 2, loss = 0.3698163465857506
Train: epoch: 2, loss = 0.36936000420288606
Train: epoch: 2, loss = 0.3695740511268377
Train: epoch: 2, loss = 0.3696245571225882
Train: epoch: 2, loss = 0.36969985092857055
Train: epoch: 2, loss = 0.36926472999652227
Train: epoch: 2, loss = 0.369121383340098
Train: epoch: 2, loss = 0.36888094733743104
Train: epoch: 2, loss = 0.36871216172973315
Train:  Epoch 2, Loss=0.36855089374688954, AUC-ROC Macro=0.7237397500881981, AUC-ROC Micro=0.7911673512083734
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3608124318222205, AUC-ROC Macro=0.7400621708038385, AUC-ROC Micro=0.799046059982053
Eval task: 2
Eval:  Epoch 2, Loss=0.41329817473888397, AUC-ROC Macro=0.48486962307169973, AUC-ROC Micro=0.5855543438933642
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3631570965051651
Train: epoch: 3, loss = 0.36483426820486786
Train: epoch: 3, loss = 0.36399815688530607
Train: epoch: 3, loss = 0.3638070633634925
Train: epoch: 3, loss = 0.36323975306749345
Train: epoch: 3, loss = 0.3622358360886574
Train: epoch: 3, loss = 0.3630731862996306
Train: epoch: 3, loss = 0.36265527894720434
Train: epoch: 3, loss = 0.3622130498703983
Train: epoch: 3, loss = 0.36214977233111856
Train: epoch: 3, loss = 0.36187857518819244
Train: epoch: 3, loss = 0.3615533780244489
Train: epoch: 3, loss = 0.3617149442205062
Train: epoch: 3, loss = 0.36130475342805896
Train: epoch: 3, loss = 0.36088685276607674
Train: epoch: 3, loss = 0.3605657611042261
Train: epoch: 3, loss = 0.36071009493925993
Train: epoch: 3, loss = 0.3606228290291296
Train:  Epoch 3, Loss=0.36044888250848167, AUC-ROC Macro=0.7429951455111994, AUC-ROC Micro=0.8036698586393317
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35862208406130475, AUC-ROC Macro=0.7462760628776545, AUC-ROC Micro=0.8031913246520057
Eval task: 2
Eval:  Epoch 3, Loss=0.4189921170473099, AUC-ROC Macro=0.4762972666860108, AUC-ROC Micro=0.579134423419322
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3572621813416481
Train: epoch: 4, loss = 0.35425761628895996
Train: epoch: 4, loss = 0.35403721461693444
Train: epoch: 4, loss = 0.3560833763703704
Train: epoch: 4, loss = 0.35618295969069
Train: epoch: 4, loss = 0.3547560847426454
Train: epoch: 4, loss = 0.3548790468914168
Train: epoch: 4, loss = 0.3553971050586551
Train: epoch: 4, loss = 0.356113347593281
Train: epoch: 4, loss = 0.35599360109865663
Train: epoch: 4, loss = 0.35603209870782765
Train: epoch: 4, loss = 0.3553476813621819
Train: epoch: 4, loss = 0.35539817987726285
Train: epoch: 4, loss = 0.35533953555460485
Train: epoch: 4, loss = 0.35469895900785925
Train: epoch: 4, loss = 0.35473499369807543
Train: epoch: 4, loss = 0.35481004179400555
Train: epoch: 4, loss = 0.3549420839589503
Train:  Epoch 4, Loss=0.3549039359011202, AUC-ROC Macro=0.7553428239691925, AUC-ROC Micro=0.811832001147531
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3534303580721219, AUC-ROC Macro=0.7577162345847046, AUC-ROC Micro=0.8107477529231604
Eval task: 2
Eval:  Epoch 4, Loss=0.43814100325107574, AUC-ROC Macro=0.4773250657992299, AUC-ROC Micro=0.5652364631417848
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3553263408690691
Train: epoch: 5, loss = 0.3522678666561842
Train: epoch: 5, loss = 0.3500528035312891
Train: epoch: 5, loss = 0.35128747280687095
Train: epoch: 5, loss = 0.3507595562636852
Train: epoch: 5, loss = 0.3507074202845494
Train: epoch: 5, loss = 0.3510857661494187
Train: epoch: 5, loss = 0.3510722505394369
Train: epoch: 5, loss = 0.3508784810536438
Train: epoch: 5, loss = 0.3509306213632226
Train: epoch: 5, loss = 0.3507397589561614
Train: epoch: 5, loss = 0.35066893228019275
Train: epoch: 5, loss = 0.3504636905915462
Train: epoch: 5, loss = 0.35007617376212563
Train: epoch: 5, loss = 0.3502708027710517
Train: epoch: 5, loss = 0.35073635161388667
Train: epoch: 5, loss = 0.3512201973576756
Train: epoch: 5, loss = 0.3509054310702615
Train:  Epoch 5, Loss=0.35075822996278094, AUC-ROC Macro=0.7641303011715127, AUC-ROC Micro=0.8177250450735262
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3516063690185547, AUC-ROC Macro=0.7621112087628353, AUC-ROC Micro=0.8144105606073111
Eval task: 2
Eval:  Epoch 5, Loss=0.46133264899253845, AUC-ROC Macro=0.4970298062753025, AUC-ROC Micro=0.5869752685256648
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3475809466093779
Train: epoch: 6, loss = 0.3483066137880087
Train: epoch: 6, loss = 0.34759599971274535
Train: epoch: 6, loss = 0.3490828844346106
Train: epoch: 6, loss = 0.3476019639223814
Train: epoch: 6, loss = 0.3487828925748666
Train: epoch: 6, loss = 0.3480922647246293
Train: epoch: 6, loss = 0.3477689155843109
Train: epoch: 6, loss = 0.34801194296114973
Train: epoch: 6, loss = 0.3484056202098727
Train: epoch: 6, loss = 0.3477111781253056
Train: epoch: 6, loss = 0.3476627542078495
Train: epoch: 6, loss = 0.3472731309899917
Train: epoch: 6, loss = 0.34738521164017067
Train: epoch: 6, loss = 0.347546310638388
Train: epoch: 6, loss = 0.3473609821172431
Train: epoch: 6, loss = 0.3468780802584746
Train: epoch: 6, loss = 0.3470788489116563
Train:  Epoch 6, Loss=0.34723229672766137, AUC-ROC Macro=0.7711005259071027, AUC-ROC Micro=0.822488641020839
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3520653260250886, AUC-ROC Macro=0.7628531075667372, AUC-ROC Micro=0.8128236395721831
Eval task: 2
Eval:  Epoch 6, Loss=0.45564986765384674, AUC-ROC Macro=0.4885843047379494, AUC-ROC Micro=0.570482956410729
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3558162624637286, AUC-ROC Macro=0.7610115911679344, AUC-ROC Micro=0.8105616970733087
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.46826350688934326, AUC-ROC Macro=0.47547689465802323, AUC-ROC Micro=0.576889419360183
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3368964494764805
Train:  Epoch 1, Loss=0.3235245147509555, AUC-ROC Macro=0.5743491893586894, AUC-ROC Micro=0.7392282174224494
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.42697876195112866, AUC-ROC Macro=0.688774795042697, AUC-ROC Micro=0.6793905718591442
Eval task: 2
Eval:  Epoch 1, Loss=0.2948589622974396, AUC-ROC Macro=0.6470722352574176, AUC-ROC Micro=0.7895587557987802
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.28614249750971793
Train:  Epoch 2, Loss=0.28555638878249057, AUC-ROC Macro=0.6907329435052441, AUC-ROC Micro=0.8155360927343185
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.4459586205581824, AUC-ROC Macro=0.6636328042610314, AUC-ROC Micro=0.6592153436584862
Eval task: 2
Eval:  Epoch 2, Loss=0.28535032272338867, AUC-ROC Macro=0.6882548581542395, AUC-ROC Micro=0.8148478379185472
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.27091705732047555
Train:  Epoch 3, Loss=0.2729788714788615, AUC-ROC Macro=0.7367142769509067, AUC-ROC Micro=0.8372109900846415
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.4639798365533352, AUC-ROC Macro=0.6433845516228935, AUC-ROC Micro=0.6438682219860694
Eval task: 2
Eval:  Epoch 3, Loss=0.2789158523082733, AUC-ROC Macro=0.710160524767006, AUC-ROC Micro=0.8218627470309201
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.2611245308816433
Train:  Epoch 4, Loss=0.264530924095602, AUC-ROC Macro=0.7657967876808809, AUC-ROC Micro=0.8501814709820583
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.4683324322104454, AUC-ROC Macro=0.64071224843513, AUC-ROC Micro=0.6346660373517161
Eval task: 2
Eval:  Epoch 4, Loss=0.27605271339416504, AUC-ROC Macro=0.7120439666014581, AUC-ROC Micro=0.8269055146466324
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2582862742245197
Train:  Epoch 5, Loss=0.2572221958404472, AUC-ROC Macro=0.7870597145590901, AUC-ROC Micro=0.8607874985595496
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.47942794983585674, AUC-ROC Macro=0.6346778025868839, AUC-ROC Micro=0.6317464384693166
Eval task: 2
Eval:  Epoch 5, Loss=0.2735542058944702, AUC-ROC Macro=0.7160445948166063, AUC-ROC Micro=0.8304865100035084
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.25246760725975037
Train:  Epoch 6, Loss=0.25211508501440577, AUC-ROC Macro=0.8005067119772185, AUC-ROC Micro=0.867955051232276
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.4934646748006344, AUC-ROC Macro=0.6266305117265215, AUC-ROC Micro=0.6215007484507852
Eval task: 2
Eval:  Epoch 6, Loss=0.2731221467256546, AUC-ROC Macro=0.7234175390946714, AUC-ROC Micro=0.8334214496524214
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.4966002367436886, AUC-ROC Macro=0.6279988530453195, AUC-ROC Micro=0.6232071892443241
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2861288785934448, AUC-ROC Macro=0.723086402547461, AUC-ROC Micro=0.8262654458253144
{'0': {'precision': 0.3420404139970429, 'recall': 0.5305810397553516, 'f1-score': 0.41594246329038054, 'support': 1308}, '1': {'precision': 0.2573932092004381, 'recall': 0.5845771144278606, 'f1-score': 0.3574144486692015, 'support': 402}, '2': {'precision': 0.09482758620689655, 'recall': 0.03343465045592705, 'f1-score': 0.04943820224719101, 'support': 658}, '3': {'precision': 0.35051546391752575, 'recall': 0.2904522613065327, 'f1-score': 0.3176696894751305, 'support': 1990}, '4': {'precision': 0.2713864306784661, 'recall': 0.1141439205955335, 'f1-score': 0.16069868995633185, 'support': 806}, '5': {'precision': 0.13636363636363635, 'recall': 0.030848329048843187, 'f1-score': 0.050314465408805034, 'support': 778}, '6': {'precision': 0.31299212598425197, 'recall': 0.24423963133640553, 'f1-score': 0.274374460742019, 'support': 1302}, '7': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 424}, '8': {'precision': 0.5454545454545454, 'recall': 0.0036496350364963502, 'f1-score': 0.007250755287009063, 'support': 1644}, '9': {'precision': 0.4, 'recall': 0.0009847365829640572, 'f1-score': 0.001964636542239686, 'support': 2031}, '10': {'precision': 0.3111111111111111, 'recall': 0.12216404886561955, 'f1-score': 0.17543859649122806, 'support': 573}, '11': {'precision': 1.0, 'recall': 0.0008503401360544217, 'f1-score': 0.001699235344095157, 'support': 1176}, '12': {'precision': 0.5, 'recall': 0.0011299435028248588, 'f1-score': 0.0022547914317925595, 'support': 1770}, '13': {'precision': 0.33088235294117646, 'recall': 0.017334360554699536, 'f1-score': 0.03294289897510981, 'support': 2596}, '14': {'precision': 0.147239263803681, 'recall': 0.014751075599262446, 'f1-score': 0.026815642458100558, 'support': 1627}, '15': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 0.30303030303030304, 'recall': 0.03676470588235294, 'f1-score': 0.06557377049180328, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.25, 'recall': 0.05343511450381679, 'f1-score': 0.08805031446540881, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.7777777777777778, 'recall': 0.01289134438305709, 'f1-score': 0.025362318840579712, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 1.0, 'recall': 0.0039603960396039604, 'f1-score': 0.007889546351084813, 'support': 505}, 'micro avg': {'precision': 0.30533596837944665, 'recall': 0.0852480983722855, 'f1-score': 0.13328403734171365, 'support': 25373}, 'macro avg': {'precision': 0.2932405688186741, 'recall': 0.08384770592052826, 'f1-score': 0.08244379705870043, 'support': 25373}, 'weighted avg': {'precision': 0.3417043841141743, 'recall': 0.0852480983722855, 'f1-score': 0.08750142120300536, 'support': 25373}, 'samples avg': {'precision': 0.15560302734375, 'recall': 0.06828212791132138, 'f1-score': 0.08575858491391881, 'support': 25373}}
{'0': {'precision': 0.5616438356164384, 'recall': 0.3153846153846154, 'f1-score': 0.4039408866995074, 'support': 130}, '1': {'precision': 0.5833333333333334, 'recall': 0.4632352941176471, 'f1-score': 0.5163934426229508, 'support': 136}, '2': {'precision': 0.4264705882352941, 'recall': 0.2116788321167883, 'f1-score': 0.28292682926829266, 'support': 137}, '3': {'precision': 0.715, 'recall': 0.6713615023474179, 'f1-score': 0.6924939467312349, 'support': 213}, '4': {'precision': 0.55, 'recall': 0.14666666666666667, 'f1-score': 0.23157894736842105, 'support': 75}, '5': {'precision': 0.5, 'recall': 0.11702127659574468, 'f1-score': 0.1896551724137931, 'support': 94}, '6': {'precision': 0.5882352941176471, 'recall': 0.13513513513513514, 'f1-score': 0.21978021978021975, 'support': 74}, '7': {'precision': 0.5833333333333334, 'recall': 0.175, 'f1-score': 0.2692307692307692, 'support': 40}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 65}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 63}, '11': {'precision': 0.4, 'recall': 0.03571428571428571, 'f1-score': 0.06557377049180328, 'support': 56}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 52}, '13': {'precision': 0.8333333333333334, 'recall': 0.09090909090909091, 'f1-score': 0.16393442622950818, 'support': 55}, '14': {'precision': 0.5294117647058824, 'recall': 0.2857142857142857, 'f1-score': 0.37113402061855666, 'support': 63}, '15': {'precision': 0.8333333333333334, 'recall': 0.2631578947368421, 'f1-score': 0.39999999999999997, 'support': 19}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '17': {'precision': 0.5483870967741935, 'recall': 0.2073170731707317, 'f1-score': 0.3008849557522124, 'support': 82}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, 'micro avg': {'precision': 0.5973597359735974, 'recall': 0.23552374756018218, 'f1-score': 0.33784414372375177, 'support': 1537}, 'macro avg': {'precision': 0.3060992765113116, 'recall': 0.12473183810437004, 'f1-score': 0.1643010954882908, 'support': 1537}, 'weighted avg': {'precision': 0.4427902390555406, 'recall': 0.23552374756018218, 'f1-score': 0.2859957828786441, 'support': 1537}, 'samples avg': {'precision': 0.36813151041666664, 'recall': 0.22145879836309523, 'f1-score': 0.25137108984765233, 'support': 1537}}