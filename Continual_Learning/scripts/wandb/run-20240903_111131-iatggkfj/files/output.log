
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_northeast_baseline
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4324891962110996
Train: epoch: 1, loss = 0.4222160270065069
Train: epoch: 1, loss = 0.4157016622026761
Train: epoch: 1, loss = 0.4135158305615187
Train: epoch: 1, loss = 0.41140091812610624
Train: epoch: 1, loss = 0.40976488870879013
Train: epoch: 1, loss = 0.4081768837464707
Train: epoch: 1, loss = 0.4052403211221099
Train: epoch: 1, loss = 0.4026689413189888
Train: epoch: 1, loss = 0.4004111404344439
Train: epoch: 1, loss = 0.39953277971934187
Train: epoch: 1, loss = 0.39812337095538775
Train: epoch: 1, loss = 0.3970276034336824
Train: epoch: 1, loss = 0.3953220976356949
Train: epoch: 1, loss = 0.39395271154244743
Train: epoch: 1, loss = 0.392831057626754
Train: epoch: 1, loss = 0.39154402222265217
Train: epoch: 1, loss = 0.39048849516444734
Train:  Epoch 1, Loss=0.3902223700132125, AUC-ROC Macro=0.6635386886965611, AUC-ROC Micro=0.7525990587192894
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.369525495916605, AUC-ROC Macro=0.720940050955787, AUC-ROC Micro=0.7846732423704172
Eval task: 2
Eval:  Epoch 1, Loss=0.38475723564624786, AUC-ROC Macro=0.48548625598149586, AUC-ROC Micro=0.591709794826743
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3693473036587238
Train: epoch: 2, loss = 0.37258908819407227
Train: epoch: 2, loss = 0.3708610105017821
Train: epoch: 2, loss = 0.3712096975371242
Train: epoch: 2, loss = 0.3709189016968012
Train: epoch: 2, loss = 0.37108964727570615
Train: epoch: 2, loss = 0.370763501226902
Train: epoch: 2, loss = 0.37134582673199473
Train: epoch: 2, loss = 0.3703071077250772
Train: epoch: 2, loss = 0.369990360096097
Train: epoch: 2, loss = 0.36994658974761313
Train: epoch: 2, loss = 0.36883264942094685
Train: epoch: 2, loss = 0.3682909343047784
Train: epoch: 2, loss = 0.36780190231012444
Train: epoch: 2, loss = 0.3673760944455862
Train: epoch: 2, loss = 0.36743380756583066
Train: epoch: 2, loss = 0.3675068807996371
Train: epoch: 2, loss = 0.36689885801739164
Train:  Epoch 2, Loss=0.36681593199469087, AUC-ROC Macro=0.7283801045810777, AUC-ROC Micro=0.7938108088370115
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3610527589917183, AUC-ROC Macro=0.740913138135282, AUC-ROC Micro=0.7998171650773664
Eval task: 2
Eval:  Epoch 2, Loss=0.41139261424541473, AUC-ROC Macro=0.49286419819227917, AUC-ROC Micro=0.5876762801178895
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.354181237667799
Train: epoch: 3, loss = 0.35621240492910144
Train: epoch: 3, loss = 0.35942876445750394
Train: epoch: 3, loss = 0.35971595989540217
Train: epoch: 3, loss = 0.359266581684351
Train: epoch: 3, loss = 0.3591691984857122
Train: epoch: 3, loss = 0.3587153178027698
Train: epoch: 3, loss = 0.3588882714509964
Train: epoch: 3, loss = 0.3582793608059486
Train: epoch: 3, loss = 0.35872340116649865
Train: epoch: 3, loss = 0.35872901812873104
Train: epoch: 3, loss = 0.3586714445799589
Train: epoch: 3, loss = 0.35876314924313474
Train: epoch: 3, loss = 0.35865920857659406
Train: epoch: 3, loss = 0.3589959855576356
Train: epoch: 3, loss = 0.3592286632023752
Train: epoch: 3, loss = 0.3590663396830068
Train: epoch: 3, loss = 0.3591920631751418
Train:  Epoch 3, Loss=0.3590900694814503, AUC-ROC Macro=0.7463775034001795, AUC-ROC Micro=0.8056935041323381
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35785920917987823, AUC-ROC Macro=0.7496831107403986, AUC-ROC Micro=0.8049838456890752
Eval task: 2
Eval:  Epoch 3, Loss=0.4324442446231842, AUC-ROC Macro=0.4856588764563349, AUC-ROC Micro=0.5757437388124983
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3557638896256685
Train: epoch: 4, loss = 0.35278058346360924
Train: epoch: 4, loss = 0.3546813940505187
Train: epoch: 4, loss = 0.354989258646965
Train: epoch: 4, loss = 0.35430973072350025
Train: epoch: 4, loss = 0.3545128203804294
Train: epoch: 4, loss = 0.35484218967812403
Train: epoch: 4, loss = 0.3549790919478983
Train: epoch: 4, loss = 0.3554128488732709
Train: epoch: 4, loss = 0.35484157805889843
Train: epoch: 4, loss = 0.35452121839604595
Train: epoch: 4, loss = 0.35400242334852616
Train: epoch: 4, loss = 0.3541858731668729
Train: epoch: 4, loss = 0.35402369788182636
Train: epoch: 4, loss = 0.35355580070614817
Train: epoch: 4, loss = 0.35376097466330975
Train: epoch: 4, loss = 0.35392621214775477
Train: epoch: 4, loss = 0.3541949440373315
Train:  Epoch 4, Loss=0.35419870766003925, AUC-ROC Macro=0.7565591246342415, AUC-ROC Micro=0.8128688325244757
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3545551747083664, AUC-ROC Macro=0.7534733074309721, AUC-ROC Micro=0.809136184786057
Eval task: 2
Eval:  Epoch 4, Loss=0.42497433722019196, AUC-ROC Macro=0.4826397246513016, AUC-ROC Micro=0.5814111585827858
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3507027018070221
Train: epoch: 5, loss = 0.3504760729894042
Train: epoch: 5, loss = 0.35075606351097427
Train: epoch: 5, loss = 0.3504831524938345
Train: epoch: 5, loss = 0.35091031420230867
Train: epoch: 5, loss = 0.35165026254951953
Train: epoch: 5, loss = 0.3511982743654932
Train: epoch: 5, loss = 0.3514269829541445
Train: epoch: 5, loss = 0.35181032394369444
Train: epoch: 5, loss = 0.35095935318619015
Train: epoch: 5, loss = 0.35008382927287707
Train: epoch: 5, loss = 0.3502483816072345
Train: epoch: 5, loss = 0.35010999382115326
Train: epoch: 5, loss = 0.35003887441541465
Train: epoch: 5, loss = 0.3500007021725178
Train: epoch: 5, loss = 0.34990543708670885
Train: epoch: 5, loss = 0.3501087719640311
Train: epoch: 5, loss = 0.35013456614481075
Train:  Epoch 5, Loss=0.35017396288244135, AUC-ROC Macro=0.7651314117387504, AUC-ROC Micro=0.8186110051498028
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3522117460767428, AUC-ROC Macro=0.7594306291774992, AUC-ROC Micro=0.8128282558395536
Eval task: 2
Eval:  Epoch 5, Loss=0.43617360293865204, AUC-ROC Macro=0.478728765656871, AUC-ROC Micro=0.5826330603144296
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3463093987107277
Train: epoch: 6, loss = 0.3426189346238971
Train: epoch: 6, loss = 0.3444350477059682
Train: epoch: 6, loss = 0.34571568232029676
Train: epoch: 6, loss = 0.3468134271502495
Train: epoch: 6, loss = 0.3455765321229895
Train: epoch: 6, loss = 0.3454629921274526
Train: epoch: 6, loss = 0.34534523030743003
Train: epoch: 6, loss = 0.34475380587081117
Train: epoch: 6, loss = 0.344844426356256
Train: epoch: 6, loss = 0.34553220651366495
Train: epoch: 6, loss = 0.3459986680870255
Train: epoch: 6, loss = 0.34564398994239476
Train: epoch: 6, loss = 0.34581567095326526
Train: epoch: 6, loss = 0.3461750854204098
Train: epoch: 6, loss = 0.34655942413955926
Train: epoch: 6, loss = 0.34669709556681266
Train: epoch: 6, loss = 0.3467344555258751
Train:  Epoch 6, Loss=0.3469298799425109, AUC-ROC Macro=0.7714571530651243, AUC-ROC Micro=0.8230047216477498
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.34935811534523964, AUC-ROC Macro=0.7626102530302206, AUC-ROC Micro=0.8163803192089452
Eval task: 2
Eval:  Epoch 6, Loss=0.4640302211046219, AUC-ROC Macro=0.48227612184217306, AUC-ROC Micro=0.577883340505031
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3516099229454994, AUC-ROC Macro=0.7632123499105167, AUC-ROC Micro=0.816086789041155
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.4614786058664322, AUC-ROC Macro=0.4774330714427202, AUC-ROC Micro=0.588287828866705
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.35700031712651253
Train:  Epoch 1, Loss=0.33493399798786955, AUC-ROC Macro=0.5503608006500927, AUC-ROC Micro=0.7239611726914339
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4248929098248482, AUC-ROC Macro=0.6942270382525377, AUC-ROC Micro=0.6946980469367978
Eval task: 2
Eval:  Epoch 1, Loss=0.2999276965856552, AUC-ROC Macro=0.6392898057825529, AUC-ROC Micro=0.7800993498685732
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.29489173941314223
Train:  Epoch 2, Loss=0.2908631933533497, AUC-ROC Macro=0.6793717048969925, AUC-ROC Micro=0.807385238599825
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.4471871716280778, AUC-ROC Macro=0.6648207041687261, AUC-ROC Micro=0.6515613818956365
Eval task: 2
Eval:  Epoch 2, Loss=0.28618407249450684, AUC-ROC Macro=0.6803131254416496, AUC-ROC Micro=0.8101088500316924
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2767780238389969
Train:  Epoch 3, Loss=0.2766194557628206, AUC-ROC Macro=0.7297313941827912, AUC-ROC Micro=0.832511639099468
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.4567599942286809, AUC-ROC Macro=0.6473147384367246, AUC-ROC Micro=0.6453098671203301
Eval task: 2
Eval:  Epoch 3, Loss=0.2774614989757538, AUC-ROC Macro=0.7119978854521366, AUC-ROC Micro=0.8250824443774403
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.2623521160334349
Train:  Epoch 4, Loss=0.26556651707806184, AUC-ROC Macro=0.7631837612184968, AUC-ROC Micro=0.8492602655233032
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.47059130171934765, AUC-ROC Macro=0.6336412307937621, AUC-ROC Micro=0.6342345362646832
Eval task: 2
Eval:  Epoch 4, Loss=0.2750295549631119, AUC-ROC Macro=0.7150500110306288, AUC-ROC Micro=0.8291078799985361
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2569612841308117
Train:  Epoch 5, Loss=0.257828849296357, AUC-ROC Macro=0.7877111953597962, AUC-ROC Micro=0.8599478151470272
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.47147657225529355, AUC-ROC Macro=0.62854620131912, AUC-ROC Micro=0.6390634585057943
Eval task: 2
Eval:  Epoch 5, Loss=0.2705239802598953, AUC-ROC Macro=0.7217861882812683, AUC-ROC Micro=0.8366173317775663
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.25220618657767774
Train:  Epoch 6, Loss=0.25215482688931073, AUC-ROC Macro=0.8029047183029945, AUC-ROC Micro=0.8675787736644667
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.47656859333316487, AUC-ROC Macro=0.6310375760370217, AUC-ROC Micro=0.6421126435060484
Eval task: 2
Eval:  Epoch 6, Loss=0.2725405842065811, AUC-ROC Macro=0.712921703977335, AUC-ROC Micro=0.8337857923936112
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.47763703887661296, AUC-ROC Macro=0.635912197307358, AUC-ROC Micro=0.6459120976968462
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2871951162815094, AUC-ROC Macro=0.7225069563519843, AUC-ROC Micro=0.8246087467725431
{'0': {'precision': 0.3118568232662192, 'recall': 0.5328746177370031, 'f1-score': 0.393451876940446, 'support': 1308}, '1': {'precision': 0.5616438356164384, 'recall': 0.20398009950248755, 'f1-score': 0.29927007299270075, 'support': 402}, '2': {'precision': 0.16095890410958905, 'recall': 0.07142857142857142, 'f1-score': 0.09894736842105263, 'support': 658}, '3': {'precision': 0.356353591160221, 'recall': 0.5185929648241207, 'f1-score': 0.4224314367580843, 'support': 1990}, '4': {'precision': 0.23351158645276293, 'recall': 0.16253101736972705, 'f1-score': 0.1916605705925384, 'support': 806}, '5': {'precision': 0.18960244648318042, 'recall': 0.15938303341902313, 'f1-score': 0.17318435754189943, 'support': 778}, '6': {'precision': 0.380352644836272, 'recall': 0.23195084485407066, 'f1-score': 0.2881679389312977, 'support': 1302}, '7': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 424}, '8': {'precision': 0.5510204081632653, 'recall': 0.032846715328467155, 'f1-score': 0.061997703788748575, 'support': 1644}, '9': {'precision': 0.3, 'recall': 0.0014771048744460858, 'f1-score': 0.0029397354238118573, 'support': 2031}, '10': {'precision': 0.2, 'recall': 0.04537521815008726, 'f1-score': 0.0739687055476529, 'support': 573}, '11': {'precision': 0.4444444444444444, 'recall': 0.003401360544217687, 'f1-score': 0.006751054852320674, 'support': 1176}, '12': {'precision': 0.6176470588235294, 'recall': 0.011864406779661017, 'f1-score': 0.02328159645232816, 'support': 1770}, '13': {'precision': 0.40764331210191085, 'recall': 0.07395993836671803, 'f1-score': 0.1252037821975872, 'support': 2596}, '14': {'precision': 0.4523809523809524, 'recall': 0.011677934849416103, 'f1-score': 0.022768124625524265, 'support': 1627}, '15': {'precision': 0.1, 'recall': 0.002066115702479339, 'f1-score': 0.004048582995951418, 'support': 484}, '16': {'precision': 1.0, 'recall': 0.0012578616352201257, 'f1-score': 0.002512562814070352, 'support': 795}, '17': {'precision': 0.18181818181818182, 'recall': 0.011029411764705883, 'f1-score': 0.02079722703639515, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.4090909090909091, 'recall': 0.06870229007633588, 'f1-score': 0.11764705882352942, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.7941176470588235, 'recall': 0.024861878453038673, 'f1-score': 0.04821428571428571, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 1.0, 'recall': 0.007920792079207921, 'f1-score': 0.015717092337917484, 'support': 505}, 'micro avg': {'precision': 0.3273900293255132, 'recall': 0.10999881764079927, 'f1-score': 0.16467048203433832, 'support': 25373}, 'macro avg': {'precision': 0.346097709832268, 'recall': 0.08708728710956018, 'f1-score': 0.09571844539152569, 'support': 25373}, 'weighted avg': {'precision': 0.38373595440139213, 'recall': 0.10999881764079927, 'f1-score': 0.1132301835210097, 'support': 25373}, 'samples avg': {'precision': 0.19208654978918652, 'recall': 0.08581250122639139, 'f1-score': 0.1067609133537553, 'support': 25373}}
{'0': {'precision': 0.6944444444444444, 'recall': 0.38461538461538464, 'f1-score': 0.49504950495049505, 'support': 130}, '1': {'precision': 0.6823529411764706, 'recall': 0.4264705882352941, 'f1-score': 0.5248868778280543, 'support': 136}, '2': {'precision': 0.4342105263157895, 'recall': 0.24087591240875914, 'f1-score': 0.3098591549295775, 'support': 137}, '3': {'precision': 0.6545454545454545, 'recall': 0.676056338028169, 'f1-score': 0.6651270207852195, 'support': 213}, '4': {'precision': 0.35294117647058826, 'recall': 0.08, 'f1-score': 0.13043478260869565, 'support': 75}, '5': {'precision': 0.47058823529411764, 'recall': 0.0851063829787234, 'f1-score': 0.14414414414414414, 'support': 94}, '6': {'precision': 0.5, 'recall': 0.06756756756756757, 'f1-score': 0.11904761904761905, 'support': 74}, '7': {'precision': 0.75, 'recall': 0.15, 'f1-score': 0.24999999999999997, 'support': 40}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 65}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 63}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 56}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 52}, '13': {'precision': 0.38461538461538464, 'recall': 0.09090909090909091, 'f1-score': 0.14705882352941177, 'support': 55}, '14': {'precision': 0.5862068965517241, 'recall': 0.2698412698412698, 'f1-score': 0.3695652173913043, 'support': 63}, '15': {'precision': 0.8, 'recall': 0.21052631578947367, 'f1-score': 0.3333333333333333, 'support': 19}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '17': {'precision': 0.5, 'recall': 0.07317073170731707, 'f1-score': 0.1276595744680851, 'support': 82}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, 'micro avg': {'precision': 0.6031746031746031, 'recall': 0.2225113858165257, 'f1-score': 0.32509505703422054, 'support': 1537}, 'macro avg': {'precision': 0.2723962023765589, 'recall': 0.11020558328324198, 'f1-score': 0.14464664212063758, 'support': 1537}, 'weighted avg': {'precision': 0.412474667983584, 'recall': 0.2225113858165257, 'f1-score': 0.26686906647039377, 'support': 1537}, 'samples avg': {'precision': 0.3676432291666667, 'recall': 0.20177951388888887, 'f1-score': 0.24062662597818846, 'support': 1537}}