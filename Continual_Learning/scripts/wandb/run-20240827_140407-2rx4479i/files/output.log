
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_west_baseline
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43171295523643494
Train: epoch: 1, loss = 0.4245506515353918
Train: epoch: 1, loss = 0.4190687130143245
Train: epoch: 1, loss = 0.4144887627102435
Train: epoch: 1, loss = 0.4116723151355982
Train: epoch: 1, loss = 0.408959634291629
Train: epoch: 1, loss = 0.40653953236128604
Train: epoch: 1, loss = 0.40626587106846274
Train: epoch: 1, loss = 0.404860055901938
Train: epoch: 1, loss = 0.4028682446479797
Train: epoch: 1, loss = 0.4013068038496104
Train: epoch: 1, loss = 0.40015406360228856
Train: epoch: 1, loss = 0.398381274290956
Train: epoch: 1, loss = 0.3967402216206704
Train: epoch: 1, loss = 0.39559552851319313
Train: epoch: 1, loss = 0.3942389178788289
Train: epoch: 1, loss = 0.392825729737387
Train: epoch: 1, loss = 0.3917868748265836
Train:  Epoch 1, Loss=0.39157830107313957, AUC-ROC Macro=0.659815534939756, AUC-ROC Micro=0.7502668109962356
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37190163383881253, AUC-ROC Macro=0.7144690196273359, AUC-ROC Micro=0.7812574142265445
Eval task: 2
Eval:  Epoch 1, Loss=0.34483832865953445, AUC-ROC Macro=0.4993614637291651, AUC-ROC Micro=0.5535062608862763
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.371600835621357
Train: epoch: 2, loss = 0.37250104412436486
Train: epoch: 2, loss = 0.372284658725063
Train: epoch: 2, loss = 0.3708153883367777
Train: epoch: 2, loss = 0.3709210816025734
Train: epoch: 2, loss = 0.37114866111427547
Train: epoch: 2, loss = 0.3704252879640886
Train: epoch: 2, loss = 0.36965137427672745
Train: epoch: 2, loss = 0.3694004604468743
Train: epoch: 2, loss = 0.36968752778321506
Train: epoch: 2, loss = 0.369540164640004
Train: epoch: 2, loss = 0.3697435750377675
Train: epoch: 2, loss = 0.369891951032556
Train: epoch: 2, loss = 0.36967022595661025
Train: epoch: 2, loss = 0.36948253042499224
Train: epoch: 2, loss = 0.3693242324423045
Train: epoch: 2, loss = 0.3688247059899218
Train: epoch: 2, loss = 0.36900258955856163
Train:  Epoch 2, Loss=0.3689723015707782, AUC-ROC Macro=0.7229998540394967, AUC-ROC Micro=0.7904162736439362
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3633490912616253, AUC-ROC Macro=0.7360710672796377, AUC-ROC Micro=0.7953871011277034
Eval task: 2
Eval:  Epoch 2, Loss=0.35657159239053726, AUC-ROC Macro=0.49095661188795825, AUC-ROC Micro=0.5438980208411306
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3672817342728376
Train: epoch: 3, loss = 0.3646360835433006
Train: epoch: 3, loss = 0.3628803667674462
Train: epoch: 3, loss = 0.36115282490849493
Train: epoch: 3, loss = 0.3604183968156576
Train: epoch: 3, loss = 0.3594867731506626
Train: epoch: 3, loss = 0.3602731078756707
Train: epoch: 3, loss = 0.3606154841091484
Train: epoch: 3, loss = 0.3605644612179862
Train: epoch: 3, loss = 0.3598807018697262
Train: epoch: 3, loss = 0.36057538617740975
Train: epoch: 3, loss = 0.3602664917272826
Train: epoch: 3, loss = 0.36028989198689276
Train: epoch: 3, loss = 0.3602666387228029
Train: epoch: 3, loss = 0.36029426686962446
Train: epoch: 3, loss = 0.3604425749508664
Train: epoch: 3, loss = 0.36077441671315363
Train: epoch: 3, loss = 0.36068642047958244
Train:  Epoch 3, Loss=0.3607860035203461, AUC-ROC Macro=0.7422541213482843, AUC-ROC Micro=0.8031218926977528
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35773158570130664, AUC-ROC Macro=0.7483557471801485, AUC-ROC Micro=0.8044766349610049
Eval task: 2
Eval:  Epoch 3, Loss=0.356801301240921, AUC-ROC Macro=0.487642619994353, AUC-ROC Micro=0.5303914308117254
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3597554399818182
Train: epoch: 4, loss = 0.35741559632122516
Train: epoch: 4, loss = 0.358900447289149
Train: epoch: 4, loss = 0.35791245810687544
Train: epoch: 4, loss = 0.35756345705688
Train: epoch: 4, loss = 0.3567034054423372
Train: epoch: 4, loss = 0.355189037291067
Train: epoch: 4, loss = 0.3551734719797969
Train: epoch: 4, loss = 0.35520376529958514
Train: epoch: 4, loss = 0.3553132373467088
Train: epoch: 4, loss = 0.3555618054352023
Train: epoch: 4, loss = 0.35592863923559587
Train: epoch: 4, loss = 0.35611000712101276
Train: epoch: 4, loss = 0.355837606739785
Train: epoch: 4, loss = 0.3557757450838884
Train: epoch: 4, loss = 0.35592760453000666
Train: epoch: 4, loss = 0.35585482468499857
Train: epoch: 4, loss = 0.3557216035409106
Train:  Epoch 4, Loss=0.3558409697663071, AUC-ROC Macro=0.7531560091639576, AUC-ROC Micro=0.8105111475347626
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35467826823393506, AUC-ROC Macro=0.7538478132589874, AUC-ROC Micro=0.8085910701860374
Eval task: 2
Eval:  Epoch 4, Loss=0.3671789988875389, AUC-ROC Macro=0.48435615957438877, AUC-ROC Micro=0.5212133171309974
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.356106840968132
Train: epoch: 5, loss = 0.3578004055842757
Train: epoch: 5, loss = 0.3556753630936146
Train: epoch: 5, loss = 0.35436406241729856
Train: epoch: 5, loss = 0.3537384158074856
Train: epoch: 5, loss = 0.3520860328897834
Train: epoch: 5, loss = 0.35134382196835107
Train: epoch: 5, loss = 0.3518158497381955
Train: epoch: 5, loss = 0.35176413977311716
Train: epoch: 5, loss = 0.35190154932439327
Train: epoch: 5, loss = 0.35218433616513556
Train: epoch: 5, loss = 0.35167851073046524
Train: epoch: 5, loss = 0.35187663092063026
Train: epoch: 5, loss = 0.3513828448738371
Train: epoch: 5, loss = 0.3515264250735442
Train: epoch: 5, loss = 0.35113964131567627
Train: epoch: 5, loss = 0.35130128463401517
Train: epoch: 5, loss = 0.3514726632957657
Train:  Epoch 5, Loss=0.3516040886691493, AUC-ROC Macro=0.7621964414628641, AUC-ROC Micro=0.8166039414439176
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3519328609108925, AUC-ROC Macro=0.757939834128122, AUC-ROC Micro=0.8125862571926274
Eval task: 2
Eval:  Epoch 5, Loss=0.371647484600544, AUC-ROC Macro=0.4770088336107808, AUC-ROC Micro=0.5109638956531342
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34413787052035333
Train: epoch: 6, loss = 0.3457464692369103
Train: epoch: 6, loss = 0.34703620448708533
Train: epoch: 6, loss = 0.346138054151088
Train: epoch: 6, loss = 0.34738108173012733
Train: epoch: 6, loss = 0.3466470584645867
Train: epoch: 6, loss = 0.3484782529303006
Train: epoch: 6, loss = 0.3483410170394927
Train: epoch: 6, loss = 0.34793531752294965
Train: epoch: 6, loss = 0.3482178285047412
Train: epoch: 6, loss = 0.34834048321301286
Train: epoch: 6, loss = 0.34827687925348677
Train: epoch: 6, loss = 0.3481566899957565
Train: epoch: 6, loss = 0.3485095964212503
Train: epoch: 6, loss = 0.3483348780870438
Train: epoch: 6, loss = 0.34820845355745406
Train: epoch: 6, loss = 0.3481977198009982
Train: epoch: 6, loss = 0.34827083915885954
Train:  Epoch 6, Loss=0.34831543146646937, AUC-ROC Macro=0.7686813797765969, AUC-ROC Micro=0.8211538085221608
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3519444378713767, AUC-ROC Macro=0.7602981614279847, AUC-ROC Micro=0.8133728884627015
Eval task: 2
Eval:  Epoch 6, Loss=0.4255201742053032, AUC-ROC Macro=0.48612665421128726, AUC-ROC Micro=0.530372149394881
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3547879072527091, AUC-ROC Macro=0.7599761226710053, AUC-ROC Micro=0.8125647770323354
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.4469873905181885, AUC-ROC Macro=0.4970362978445493, AUC-ROC Micro=0.5393269425322481
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2710358192026615
Train: epoch: 1, loss = 0.25497324004769323
Train: epoch: 1, loss = 0.24637425934274992
Train:  Epoch 1, Loss=0.2446526084627424, AUC-ROC Macro=0.5723852786263081, AUC-ROC Micro=0.7539019674803429
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.47967170054713887, AUC-ROC Macro=0.6624915931399594, AUC-ROC Micro=0.6443655918485258
Eval task: 2
Eval:  Epoch 1, Loss=0.22961215302348137, AUC-ROC Macro=0.6546431329050268, AUC-ROC Micro=0.7921340207115969
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.22635133095085622
Train: epoch: 2, loss = 0.22549378350377083
Train: epoch: 2, loss = 0.22396427241464456
Train:  Epoch 2, Loss=0.22445031144436758, AUC-ROC Macro=0.6905100210859534, AUC-ROC Micro=0.809681379752166
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.5020704555014769, AUC-ROC Macro=0.6325641730658487, AUC-ROC Micro=0.6299250354532951
Eval task: 2
Eval:  Epoch 2, Loss=0.2248903326690197, AUC-ROC Macro=0.6804410764343958, AUC-ROC Micro=0.8062181613746291
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.21675191022455692
Train: epoch: 3, loss = 0.2170297688804567
Train: epoch: 3, loss = 0.21773173445214827
Train:  Epoch 3, Loss=0.21828628119498192, AUC-ROC Macro=0.7249328088361218, AUC-ROC Micro=0.8242303124060473
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5158998481929302, AUC-ROC Macro=0.6150978542470358, AUC-ROC Micro=0.6218804181641521
Eval task: 2
Eval:  Epoch 3, Loss=0.22139601781964302, AUC-ROC Macro=0.6963552168614391, AUC-ROC Micro=0.814421353107403
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.21356102220714093
Train: epoch: 4, loss = 0.21490528006106616
Train: epoch: 4, loss = 0.2135228330641985
Train:  Epoch 4, Loss=0.21391006708687496, AUC-ROC Macro=0.7480749059056018, AUC-ROC Micro=0.8340972900528014
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5237321518361568, AUC-ROC Macro=0.6015833786675477, AUC-ROC Micro=0.6145432514944398
Eval task: 2
Eval:  Epoch 4, Loss=0.22133823111653328, AUC-ROC Macro=0.7049408439317858, AUC-ROC Micro=0.8154549474724728
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.21158843092620372
Train: epoch: 5, loss = 0.21125149494037032
Train: epoch: 5, loss = 0.21052454286565384
Train:  Epoch 5, Loss=0.21037304496580736, AUC-ROC Macro=0.7610023375364163, AUC-ROC Micro=0.8417725765399213
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5509209682544073, AUC-ROC Macro=0.5841311136968468, AUC-ROC Micro=0.601807670974941
Eval task: 2
Eval:  Epoch 5, Loss=0.2210230492055416, AUC-ROC Macro=0.707896707323911, AUC-ROC Micro=0.8174701952933594
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.20540705010294913
Train: epoch: 6, loss = 0.2068823976069689
Train: epoch: 6, loss = 0.2074156394104163
Train:  Epoch 6, Loss=0.20685155385727227, AUC-ROC Macro=0.7735794563479418, AUC-ROC Micro=0.8488581135563985
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5656150306264559, AUC-ROC Macro=0.5719685353539683, AUC-ROC Micro=0.5996004750437313
Eval task: 2
Eval:  Epoch 6, Loss=0.21979426220059395, AUC-ROC Macro=0.7113342429617334, AUC-ROC Micro=0.8200869574911648
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.570734292268753, AUC-ROC Macro=0.5718819345672703, AUC-ROC Micro=0.5995797677709152
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2186410166323185, AUC-ROC Macro=0.7410030114130493, AUC-ROC Micro=0.8226417263312433
{'0': {'precision': 0.29284037558685444, 'recall': 0.38149847094801226, 'f1-score': 0.33134130146082336, 'support': 1308}, '1': {'precision': 0.23788546255506607, 'recall': 0.13432835820895522, 'f1-score': 0.17170111287758347, 'support': 402}, '2': {'precision': 0.5, 'recall': 0.00303951367781155, 'f1-score': 0.006042296072507553, 'support': 658}, '3': {'precision': 0.4, 'recall': 0.0010050251256281408, 'f1-score': 0.0020050125313283208, 'support': 1990}, '4': {'precision': 0.23119469026548672, 'recall': 0.25930521091811415, 'f1-score': 0.24444444444444444, 'support': 806}, '5': {'precision': 0.15714285714285714, 'recall': 0.028277634961439587, 'f1-score': 0.04793028322440087, 'support': 778}, '6': {'precision': 0.5833333333333334, 'recall': 0.016129032258064516, 'f1-score': 0.03139013452914798, 'support': 1302}, '7': {'precision': 0.0660377358490566, 'recall': 0.01650943396226415, 'f1-score': 0.026415094339622643, 'support': 424}, '8': {'precision': 1.0, 'recall': 0.0030413625304136255, 'f1-score': 0.006064281382656156, 'support': 1644}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2031}, '10': {'precision': 1.0, 'recall': 0.0017452006980802793, 'f1-score': 0.003484320557491289, 'support': 573}, '11': {'precision': 0.4583333333333333, 'recall': 0.00935374149659864, 'f1-score': 0.018333333333333337, 'support': 1176}, '12': {'precision': 0.25, 'recall': 0.0011299435028248588, 'f1-score': 0.0022497187851518562, 'support': 1770}, '13': {'precision': 0.3377049180327869, 'recall': 0.039676425269645606, 'f1-score': 0.07100999655291278, 'support': 2596}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1627}, '15': {'precision': 0.0915032679738562, 'recall': 0.028925619834710745, 'f1-score': 0.04395604395604396, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.26269315673289184, 'recall': 0.037520198636345724, 'f1-score': 0.06566196503086527, 'support': 25373}, 'macro avg': {'precision': 0.22423903896290526, 'recall': 0.03695859893570253, 'f1-score': 0.04025469496189792, 'support': 25373}, 'weighted avg': {'precision': 0.2687594994418606, 'recall': 0.037520198636345724, 'f1-score': 0.040984151894403124, 'support': 25373}, 'samples avg': {'precision': 0.09612630208333332, 'recall': 0.025174512147455617, 'f1-score': 0.03745834092441974, 'support': 25373}}
{'0': {'precision': 0.6036036036036037, 'recall': 0.34183673469387754, 'f1-score': 0.4364820846905538, 'support': 196}, '1': {'precision': 0.44554455445544555, 'recall': 0.18672199170124482, 'f1-score': 0.26315789473684215, 'support': 241}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 145}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 118}, '4': {'precision': 0.5142857142857142, 'recall': 0.25961538461538464, 'f1-score': 0.34504792332268375, 'support': 208}, '5': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 100}, '6': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 110}, '7': {'precision': 0.7878787878787878, 'recall': 0.19548872180451127, 'f1-score': 0.3132530120481927, 'support': 133}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 89}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '10': {'precision': 0.3333333333333333, 'recall': 0.013333333333333334, 'f1-score': 0.025641025641025644, 'support': 75}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 86}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 87}, '13': {'precision': 0.3, 'recall': 0.0821917808219178, 'f1-score': 0.12903225806451613, 'support': 73}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 45}, '15': {'precision': 0.7441860465116279, 'recall': 0.6274509803921569, 'f1-score': 0.6808510638297872, 'support': 51}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1}, 'micro avg': {'precision': 0.5448113207547169, 'recall': 0.11584754262788365, 'f1-score': 0.1910669975186104, 'support': 1994}, 'macro avg': {'precision': 0.1491532816027405, 'recall': 0.06826555709449705, 'f1-score': 0.08773861049334405, 'support': 1994}, 'weighted avg': {'precision': 0.2619334702414589, 'recall': 0.11584754262788365, 'f1-score': 0.15469909523649003, 'support': 1994}, 'samples avg': {'precision': 0.200439453125, 'recall': 0.1323428199404762, 'f1-score': 0.1483057415674603, 'support': 1994}}