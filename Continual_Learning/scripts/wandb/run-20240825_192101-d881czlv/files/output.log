
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_west_baseline
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4352127803862095
Train: epoch: 1, loss = 0.4191785207390785
Train: epoch: 1, loss = 0.4159839352965355
Train: epoch: 1, loss = 0.4117016240954399
Train: epoch: 1, loss = 0.4101795595288277
Train: epoch: 1, loss = 0.40789314729472004
Train: epoch: 1, loss = 0.4059469238881554
Train: epoch: 1, loss = 0.4045251179393381
Train: epoch: 1, loss = 0.4036527046478457
Train: epoch: 1, loss = 0.4025747418478131
Train: epoch: 1, loss = 0.40138387916440316
Train: epoch: 1, loss = 0.40001057472700874
Train: epoch: 1, loss = 0.3995011905236886
Train: epoch: 1, loss = 0.3983583033989583
Train: epoch: 1, loss = 0.3967930716027816
Train: epoch: 1, loss = 0.3952871532225981
Train: epoch: 1, loss = 0.39454501188414937
Train: epoch: 1, loss = 0.39344414697339136
Train:  Epoch 1, Loss=0.39301867271081, AUC-ROC Macro=0.6546967456605673, AUC-ROC Micro=0.7471868183097098
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3700961197415988, AUC-ROC Macro=0.7192399281942343, AUC-ROC Micro=0.7842555523655672
Eval task: 2
Eval:  Epoch 1, Loss=0.3414759039878845, AUC-ROC Macro=0.5017743076414004, AUC-ROC Micro=0.5326148138828325
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37345364175736906
Train: epoch: 2, loss = 0.37127713721245525
Train: epoch: 2, loss = 0.37283597730100154
Train: epoch: 2, loss = 0.3725071977078915
Train: epoch: 2, loss = 0.3710046909451485
Train: epoch: 2, loss = 0.37028244699041046
Train: epoch: 2, loss = 0.370824969964368
Train: epoch: 2, loss = 0.37096510813571515
Train: epoch: 2, loss = 0.3702723308900992
Train: epoch: 2, loss = 0.36983324348926544
Train: epoch: 2, loss = 0.3694659207151695
Train: epoch: 2, loss = 0.36953491274888317
Train: epoch: 2, loss = 0.36899349209780874
Train: epoch: 2, loss = 0.3688899557611772
Train: epoch: 2, loss = 0.3690882139255603
Train: epoch: 2, loss = 0.3686625206982717
Train: epoch: 2, loss = 0.3686545621691381
Train: epoch: 2, loss = 0.3683142909200655
Train:  Epoch 2, Loss=0.36825545240059876, AUC-ROC Macro=0.7247807280028592, AUC-ROC Micro=0.7915537893452524
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3642771989107132, AUC-ROC Macro=0.7369143315532664, AUC-ROC Micro=0.7961080947539358
Eval task: 2
Eval:  Epoch 2, Loss=0.3451825827360153, AUC-ROC Macro=0.5036682669072878, AUC-ROC Micro=0.54810118921536
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3604287414252758
Train: epoch: 3, loss = 0.3628223964571953
Train: epoch: 3, loss = 0.3629278477529685
Train: epoch: 3, loss = 0.360486823245883
Train: epoch: 3, loss = 0.3584752783924341
Train: epoch: 3, loss = 0.3590959838529428
Train: epoch: 3, loss = 0.35940749836819513
Train: epoch: 3, loss = 0.3600561573728919
Train: epoch: 3, loss = 0.35938295507596596
Train: epoch: 3, loss = 0.3590995424687862
Train: epoch: 3, loss = 0.35907642793926325
Train: epoch: 3, loss = 0.3592160436200599
Train: epoch: 3, loss = 0.35922708680423404
Train: epoch: 3, loss = 0.3595252554704036
Train: epoch: 3, loss = 0.3589140760799249
Train: epoch: 3, loss = 0.3591356362169609
Train: epoch: 3, loss = 0.35929543141933046
Train: epoch: 3, loss = 0.35947017944521376
Train:  Epoch 3, Loss=0.3595000989518614, AUC-ROC Macro=0.74538662860548, AUC-ROC Micro=0.8050693932212838
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3570895033578078, AUC-ROC Macro=0.7507085800702482, AUC-ROC Micro=0.8049724738289733
Eval task: 2
Eval:  Epoch 3, Loss=0.3516254648566246, AUC-ROC Macro=0.49251176147050324, AUC-ROC Micro=0.5290916976830978
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3493920555710793
Train: epoch: 4, loss = 0.34896473690867424
Train: epoch: 4, loss = 0.35025729085008306
Train: epoch: 4, loss = 0.35292273173108696
Train: epoch: 4, loss = 0.35319975228607653
Train: epoch: 4, loss = 0.3531045386319359
Train: epoch: 4, loss = 0.3528775573841163
Train: epoch: 4, loss = 0.35235316819511353
Train: epoch: 4, loss = 0.35260814981328115
Train: epoch: 4, loss = 0.3530897954776883
Train: epoch: 4, loss = 0.3531200391257351
Train: epoch: 4, loss = 0.3530399187840521
Train: epoch: 4, loss = 0.3534769179385442
Train: epoch: 4, loss = 0.3538241545855999
Train: epoch: 4, loss = 0.35356346705555913
Train: epoch: 4, loss = 0.353625395600684
Train: epoch: 4, loss = 0.35365754228742685
Train: epoch: 4, loss = 0.3537253187141485
Train:  Epoch 4, Loss=0.35370801032302723, AUC-ROC Macro=0.7573487889188156, AUC-ROC Micro=0.8135638544035891
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35319813216725987, AUC-ROC Macro=0.7562752127880433, AUC-ROC Micro=0.8110276037517625
Eval task: 2
Eval:  Epoch 4, Loss=0.36750686913728714, AUC-ROC Macro=0.4862720448633882, AUC-ROC Micro=0.5336709598609954
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.34924223497509954
Train: epoch: 5, loss = 0.34814290918409824
Train: epoch: 5, loss = 0.3483552995324135
Train: epoch: 5, loss = 0.34880644382908943
Train: epoch: 5, loss = 0.3501414731889963
Train: epoch: 5, loss = 0.35017997498313586
Train: epoch: 5, loss = 0.35040438135819774
Train: epoch: 5, loss = 0.35039758795872333
Train: epoch: 5, loss = 0.3500870913763841
Train: epoch: 5, loss = 0.3503442401215434
Train: epoch: 5, loss = 0.3498167942396619
Train: epoch: 5, loss = 0.3505376964186629
Train: epoch: 5, loss = 0.35007093974030934
Train: epoch: 5, loss = 0.3498406120655792
Train: epoch: 5, loss = 0.34963416612148285
Train: epoch: 5, loss = 0.3499379929667339
Train: epoch: 5, loss = 0.35017310264355994
Train: epoch: 5, loss = 0.34971838286767404
Train:  Epoch 5, Loss=0.34966076266867485, AUC-ROC Macro=0.7659593605996545, AUC-ROC Micro=0.8191817361376893
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35209748273094493, AUC-ROC Macro=0.7601449442133908, AUC-ROC Micro=0.8127245974385506
Eval task: 2
Eval:  Epoch 5, Loss=0.3678397759795189, AUC-ROC Macro=0.4784696759603068, AUC-ROC Micro=0.5167607219701446
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34622373029589654
Train: epoch: 6, loss = 0.3464666550979018
Train: epoch: 6, loss = 0.34572197558979195
Train: epoch: 6, loss = 0.3450839865021408
Train: epoch: 6, loss = 0.3449718613028526
Train: epoch: 6, loss = 0.34524512040118377
Train: epoch: 6, loss = 0.34567330784031325
Train: epoch: 6, loss = 0.3455198897793889
Train: epoch: 6, loss = 0.3455875515689453
Train: epoch: 6, loss = 0.3454355526268482
Train: epoch: 6, loss = 0.3455526372925802
Train: epoch: 6, loss = 0.34583921181038024
Train: epoch: 6, loss = 0.34640111084740893
Train: epoch: 6, loss = 0.34684603725160873
Train: epoch: 6, loss = 0.3471872786283493
Train: epoch: 6, loss = 0.3465979940583929
Train: epoch: 6, loss = 0.34666257558500063
Train: epoch: 6, loss = 0.3466008380593525
Train:  Epoch 6, Loss=0.346554474251902, AUC-ROC Macro=0.772191043678589, AUC-ROC Micro=0.8235291195827689
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.34967876722415286, AUC-ROC Macro=0.7636581597167518, AUC-ROC Micro=0.816826170167765
Eval task: 2
Eval:  Epoch 6, Loss=0.38608018308877945, AUC-ROC Macro=0.4766700769296425, AUC-ROC Micro=0.5232386515961585
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3516413780550162, AUC-ROC Macro=0.7653611495923904, AUC-ROC Micro=0.8170592480328257
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3861502334475517, AUC-ROC Macro=0.47346442713704406, AUC-ROC Micro=0.5312878608714392
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2681317029893398
Train: epoch: 1, loss = 0.2546120110154152
Train: epoch: 1, loss = 0.24742728588481744
Train:  Epoch 1, Loss=0.2453689705522848, AUC-ROC Macro=0.5734271561740908, AUC-ROC Micro=0.7510062619473341
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4697938027481238, AUC-ROC Macro=0.66385948371685, AUC-ROC Micro=0.6613692743930464
Eval task: 2
Eval:  Epoch 1, Loss=0.23163463175296783, AUC-ROC Macro=0.6441195211623143, AUC-ROC Micro=0.788680725325281
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.22586350165307523
Train: epoch: 2, loss = 0.22489263150841
Train: epoch: 2, loss = 0.22499157242476941
Train:  Epoch 2, Loss=0.22491198261018447, AUC-ROC Macro=0.6853379474525579, AUC-ROC Micro=0.8081978908056213
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.48205610861380893, AUC-ROC Macro=0.6319869202079723, AUC-ROC Micro=0.6506080187597655
Eval task: 2
Eval:  Epoch 2, Loss=0.22539665549993515, AUC-ROC Macro=0.6895246809536356, AUC-ROC Micro=0.8037706743027873
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.21736595205962658
Train: epoch: 3, loss = 0.21799900323152543
Train: epoch: 3, loss = 0.2179169351607561
Train:  Epoch 3, Loss=0.2180938460075172, AUC-ROC Macro=0.7283628825864987, AUC-ROC Micro=0.8246458019045811
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5102461328109106, AUC-ROC Macro=0.6219102956087332, AUC-ROC Micro=0.632340539304812
Eval task: 2
Eval:  Epoch 3, Loss=0.22175244987010956, AUC-ROC Macro=0.7056172136035889, AUC-ROC Micro=0.814422860795284
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.20947313457727432
Train: epoch: 4, loss = 0.21202247716486455
Train: epoch: 4, loss = 0.21338988907635212
Train:  Epoch 4, Loss=0.21356641165335902, AUC-ROC Macro=0.747672529184736, AUC-ROC Micro=0.8344941744564658
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5159094495077928, AUC-ROC Macro=0.6094360584030644, AUC-ROC Micro=0.635578563153828
Eval task: 2
Eval:  Epoch 4, Loss=0.21923920884728432, AUC-ROC Macro=0.7078476811339455, AUC-ROC Micro=0.8202989044311689
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.21114493280649185
Train: epoch: 5, loss = 0.2098151803202927
Train: epoch: 5, loss = 0.2106235306834181
Train:  Epoch 5, Loss=0.20980764787450934, AUC-ROC Macro=0.7635756055395844, AUC-ROC Micro=0.8424438325458246
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5202388850351175, AUC-ROC Macro=0.6017251004163015, AUC-ROC Micro=0.6267139403738989
Eval task: 2
Eval:  Epoch 5, Loss=0.21861056238412857, AUC-ROC Macro=0.7110385703004944, AUC-ROC Micro=0.8216334524088234
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.20669240884482862
Train: epoch: 6, loss = 0.20526007564738394
Train: epoch: 6, loss = 0.20680528004964194
Train:  Epoch 6, Loss=0.20658025162343657, AUC-ROC Macro=0.7743782417529992, AUC-ROC Micro=0.8488594074736526
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.519055916617314, AUC-ROC Macro=0.5926958003486462, AUC-ROC Micro=0.6184378245484596
Eval task: 2
Eval:  Epoch 6, Loss=0.21849333122372627, AUC-ROC Macro=0.7162967519098019, AUC-ROC Micro=0.8218854592528769
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5208052645126978, AUC-ROC Macro=0.5968025534921374, AUC-ROC Micro=0.6203019976009804
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.21971933543682098, AUC-ROC Macro=0.7292719539070999, AUC-ROC Micro=0.8180296417508052
[0, 29250, 34745]
Traceback (most recent call last):
  File "../tests/test.py", line 614, in <module>
    main()
  File "../tests/test.py", line 418, in main
    TestLSTM().test_standard_lstm(
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 447, in test_standard_lstm
    sources = get_conf_matrix_stats(task, model, test_loaders, device, region)
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 491, in get_conf_matrix_stats
    specificity = multilabel_specificity(y_true, y_pred)
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 518, in multilabel_specificity
    num_labels = y_true.shape[1]
AttributeError: 'list' object has no attribute 'shape'
Traceback (most recent call last):
  File "../tests/test.py", line 614, in <module>
    main()
  File "../tests/test.py", line 418, in main
    TestLSTM().test_standard_lstm(
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 447, in test_standard_lstm
    sources = get_conf_matrix_stats(task, model, test_loaders, device, region)
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 491, in get_conf_matrix_stats
    specificity = multilabel_specificity(y_true, y_pred)
  File "/home/grads/k/kingrc15/Continual_Learning/Continual_Learning/tests/test_standard_lstm.py", line 518, in multilabel_specificity
    num_labels = y_true.shape[1]
AttributeError: 'list' object has no attribute 'shape'
{'0': {'precision': 0.35104091888011485, 'recall': 0.37702390131071706, 'f1-score': 0.36356877323420067, 'support': 1297.0}, '1': {'precision': 0.3797216699801193, 'recall': 0.4692874692874693, 'f1-score': 0.4197802197802198, 'support': 407.0}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 664.0}, '3': {'precision': 0.3333333333333333, 'recall': 0.0010045203415369162, 'f1-score': 0.0020030045067601404, 'support': 1991.0}, '4': {'precision': 0.2777777777777778, 'recall': 0.08084577114427861, 'f1-score': 0.1252408477842004, 'support': 804.0}, '5': {'precision': 0.12244897959183673, 'recall': 0.015503875968992248, 'f1-score': 0.027522935779816512, 'support': 774.0}, '6': {'precision': 0.6170212765957447, 'recall': 0.022103658536585365, 'f1-score': 0.042678440029433405, 'support': 1312.0}, '7': {'precision': 0.1076923076923077, 'recall': 0.03225806451612903, 'f1-score': 0.04964539007092198, 'support': 434.0}, '8': {'precision': 0.5833333333333334, 'recall': 0.004250151791135397, 'f1-score': 0.008438818565400843, 'support': 1647.0}, '9': {'precision': 0.3888888888888889, 'recall': 0.0034567901234567903, 'f1-score': 0.006852667645619187, 'support': 2025.0}, '10': {'precision': 1.0, 'recall': 0.0017543859649122807, 'f1-score': 0.0035026269702276708, 'support': 570.0}, '11': {'precision': 0.410958904109589, 'recall': 0.02544529262086514, 'f1-score': 0.04792332268370607, 'support': 1179.0}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1770.0}, '13': {'precision': 0.30714285714285716, 'recall': 0.016475095785440614, 'f1-score': 0.03127272727272728, 'support': 2610.0}, '14': {'precision': 0.6666666666666666, 'recall': 0.0012353304508956147, 'f1-score': 0.002466091245376079, 'support': 1619.0}, '15': {'precision': 0.03571428571428571, 'recall': 0.004098360655737705, 'f1-score': 0.007352941176470589, 'support': 488.0}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 791.0}, '17': {'precision': 0.6666666666666666, 'recall': 0.003683241252302026, 'f1-score': 0.007326007326007326, 'support': 543.0}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 350.0}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 265.0}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 554.0}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 829.0}, '22': {'precision': 0.6923076923076923, 'recall': 0.01662049861495845, 'f1-score': 0.03246167718665465, 'support': 1083.0}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 856.0}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 499.0}, 'micro avg': {'precision': 0.3322428207924391, 'recall': 0.03603958834430819, 'f1-score': 0.06502561183836085, 'support': 25361.0}, 'macro avg': {'precision': 0.27762862234724855, 'recall': 0.0430018563346165, 'f1-score': 0.0471214596503097, 'support': 25361.0}, 'weighted avg': {'precision': 0.3257299482956026, 'recall': 0.03603958834430819, 'f1-score': 0.041817514742313835, 'support': 25361.0}, 'samples avg': {'precision': 0.10980360243055554, 'recall': 0.02984468570262458, 'f1-score': 0.04330709747581755, 'support': 25361.0}}