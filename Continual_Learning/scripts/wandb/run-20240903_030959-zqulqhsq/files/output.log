
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south_baseline
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4323734936118126
Train: epoch: 1, loss = 0.42087891593575477
Train: epoch: 1, loss = 0.41767976666490236
Train: epoch: 1, loss = 0.4136044380068779
Train: epoch: 1, loss = 0.41264012068510053
Train: epoch: 1, loss = 0.41033154147366685
Train: epoch: 1, loss = 0.40712710361395565
Train: epoch: 1, loss = 0.40578304036520424
Train: epoch: 1, loss = 0.40463684223592283
Train: epoch: 1, loss = 0.4024412234351039
Train: epoch: 1, loss = 0.39999908709390597
Train: epoch: 1, loss = 0.3985689888087412
Train: epoch: 1, loss = 0.39772794437523074
Train: epoch: 1, loss = 0.3965882200800947
Train: epoch: 1, loss = 0.39515337559580804
Train: epoch: 1, loss = 0.3938084950251505
Train: epoch: 1, loss = 0.39269147689289907
Train: epoch: 1, loss = 0.3914826157896055
Train:  Epoch 1, Loss=0.39102514390863924, AUC-ROC Macro=0.6620339797213238, AUC-ROC Micro=0.7514352833551557
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3700570650398731, AUC-ROC Macro=0.7178716877956249, AUC-ROC Micro=0.7841911695690784
Eval task: 2
Eval:  Epoch 1, Loss=0.33790638148784635, AUC-ROC Macro=0.48383828796756645, AUC-ROC Micro=0.5484482798430925
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.36949198715388776
Train: epoch: 2, loss = 0.37049266017973426
Train: epoch: 2, loss = 0.369712986672918
Train: epoch: 2, loss = 0.3696912543848157
Train: epoch: 2, loss = 0.3699037956893444
Train: epoch: 2, loss = 0.3688842498138547
Train: epoch: 2, loss = 0.36961725762912206
Train: epoch: 2, loss = 0.37063478681258855
Train: epoch: 2, loss = 0.3703638606849644
Train: epoch: 2, loss = 0.369882742933929
Train: epoch: 2, loss = 0.3701754921132868
Train: epoch: 2, loss = 0.36930360631396375
Train: epoch: 2, loss = 0.36905663541876355
Train: epoch: 2, loss = 0.3687732907278197
Train: epoch: 2, loss = 0.36856177272399265
Train: epoch: 2, loss = 0.36879539262037725
Train: epoch: 2, loss = 0.3690758990058128
Train: epoch: 2, loss = 0.3689352522790432
Train:  Epoch 2, Loss=0.36873563171044377, AUC-ROC Macro=0.7236381719517654, AUC-ROC Micro=0.7908042469803562
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36134226123491925, AUC-ROC Macro=0.7383269764701883, AUC-ROC Micro=0.7983604855244573
Eval task: 2
Eval:  Epoch 2, Loss=0.35435105562210084, AUC-ROC Macro=0.47070268148031924, AUC-ROC Micro=0.5208121967820509
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3601803802698851
Train: epoch: 3, loss = 0.3606804086640477
Train: epoch: 3, loss = 0.36154455699026583
Train: epoch: 3, loss = 0.3617189553007483
Train: epoch: 3, loss = 0.36049755695462227
Train: epoch: 3, loss = 0.3620833725978931
Train: epoch: 3, loss = 0.36287102755691325
Train: epoch: 3, loss = 0.36298182437196375
Train: epoch: 3, loss = 0.3630424267219173
Train: epoch: 3, loss = 0.363001766204834
Train: epoch: 3, loss = 0.3623492343317379
Train: epoch: 3, loss = 0.3620738465463122
Train: epoch: 3, loss = 0.3617807253335531
Train: epoch: 3, loss = 0.3615678612621767
Train: epoch: 3, loss = 0.3615092694113652
Train: epoch: 3, loss = 0.36117949353996665
Train: epoch: 3, loss = 0.3611893929102842
Train: epoch: 3, loss = 0.36079759801427524
Train:  Epoch 3, Loss=0.3606304333352635, AUC-ROC Macro=0.7427458742398448, AUC-ROC Micro=0.8034751985880899
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3604191566507022, AUC-ROC Macro=0.7453564114857245, AUC-ROC Micro=0.8006340301900234
Eval task: 2
Eval:  Epoch 3, Loss=0.376833638548851, AUC-ROC Macro=0.4706649314412179, AUC-ROC Micro=0.5379200538145246
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3532000079005957
Train: epoch: 4, loss = 0.35184780046343805
Train: epoch: 4, loss = 0.3539014700303475
Train: epoch: 4, loss = 0.35338962914422156
Train: epoch: 4, loss = 0.3551424862295389
Train: epoch: 4, loss = 0.35515446609507006
Train: epoch: 4, loss = 0.35561253675392696
Train: epoch: 4, loss = 0.35522124770097435
Train: epoch: 4, loss = 0.3559188892775112
Train: epoch: 4, loss = 0.3555461975634098
Train: epoch: 4, loss = 0.3557601330090653
Train: epoch: 4, loss = 0.3556297320872545
Train: epoch: 4, loss = 0.35602337974768417
Train: epoch: 4, loss = 0.3556220256643636
Train: epoch: 4, loss = 0.35545831549167634
Train: epoch: 4, loss = 0.35535724862013013
Train: epoch: 4, loss = 0.35502551578861824
Train: epoch: 4, loss = 0.3551804828974936
Train:  Epoch 4, Loss=0.35497012311169224, AUC-ROC Macro=0.7552218846572454, AUC-ROC Micro=0.8118706403717716
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35277102515101433, AUC-ROC Macro=0.7570713510937276, AUC-ROC Micro=0.8113650608286058
Eval task: 2
Eval:  Epoch 4, Loss=0.3762581467628479, AUC-ROC Macro=0.463995448157145, AUC-ROC Micro=0.5340978513671646
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.35315343834459784
Train: epoch: 5, loss = 0.35321499563753606
Train: epoch: 5, loss = 0.3541344073911508
Train: epoch: 5, loss = 0.35412093102931974
Train: epoch: 5, loss = 0.3543226553797722
Train: epoch: 5, loss = 0.35285186540335417
Train: epoch: 5, loss = 0.3528644022877727
Train: epoch: 5, loss = 0.35273617759346965
Train: epoch: 5, loss = 0.3521474307113224
Train: epoch: 5, loss = 0.35262927182018755
Train: epoch: 5, loss = 0.35266367490996015
Train: epoch: 5, loss = 0.35203985920796793
Train: epoch: 5, loss = 0.35161744054693445
Train: epoch: 5, loss = 0.35164088049105235
Train: epoch: 5, loss = 0.3507000025262435
Train: epoch: 5, loss = 0.3507931708637625
Train: epoch: 5, loss = 0.3508569487096632
Train: epoch: 5, loss = 0.3506650700378749
Train:  Epoch 5, Loss=0.35060593160808595, AUC-ROC Macro=0.7647979982910523, AUC-ROC Micro=0.8179978406289778
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35280537108580273, AUC-ROC Macro=0.7584959951429059, AUC-ROC Micro=0.8120932144114187
Eval task: 2
Eval:  Epoch 5, Loss=0.3832828223705292, AUC-ROC Macro=0.4654851603269822, AUC-ROC Micro=0.541742237348626
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3493963667750359
Train: epoch: 6, loss = 0.34736740034073593
Train: epoch: 6, loss = 0.34681947112083433
Train: epoch: 6, loss = 0.3491266355663538
Train: epoch: 6, loss = 0.34777225121855737
Train: epoch: 6, loss = 0.3479753681644797
Train: epoch: 6, loss = 0.3472954006280218
Train: epoch: 6, loss = 0.34713608282618225
Train: epoch: 6, loss = 0.3469200995316108
Train: epoch: 6, loss = 0.34686457104235885
Train: epoch: 6, loss = 0.3476934269680218
Train: epoch: 6, loss = 0.34742770993461214
Train: epoch: 6, loss = 0.34766168657403723
Train: epoch: 6, loss = 0.34764465750328133
Train: epoch: 6, loss = 0.3476177718589703
Train: epoch: 6, loss = 0.3475545840803534
Train: epoch: 6, loss = 0.3474793993068092
Train: epoch: 6, loss = 0.3472633454658919
Train:  Epoch 6, Loss=0.3473890751590077, AUC-ROC Macro=0.7713120409272729, AUC-ROC Micro=0.8225824048421586
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.34967438504099846, AUC-ROC Macro=0.7625069412283562, AUC-ROC Micro=0.815998739749539
Eval task: 2
Eval:  Epoch 6, Loss=0.38636122941970824, AUC-ROC Macro=0.4752724471030875, AUC-ROC Micro=0.5665155922872047
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35256244490544003, AUC-ROC Macro=0.7620935737455157, AUC-ROC Micro=0.814959891588209
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.38060055375099183, AUC-ROC Macro=0.4676022833973613, AUC-ROC Micro=0.5667451237884747
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.28627963952720165
Train: epoch: 1, loss = 0.2741557949781418
Train: epoch: 1, loss = 0.2690495858589808
Train: epoch: 1, loss = 0.26354323275387287
Train: epoch: 1, loss = 0.26054869942367076
Train: epoch: 1, loss = 0.2575397304818034
Train: epoch: 1, loss = 0.25506623168076786
Train:  Epoch 1, Loss=0.2540257565216464, AUC-ROC Macro=0.6331005108592059, AUC-ROC Micro=0.7621725314395904
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4870538314183553, AUC-ROC Macro=0.6230213744224321, AUC-ROC Micro=0.6182926908346498
Eval task: 2
Eval:  Epoch 1, Loss=0.23872101157903672, AUC-ROC Macro=0.7058432987493152, AUC-ROC Micro=0.8004196741702655
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.23486566588282584
Train: epoch: 2, loss = 0.2356658336520195
Train: epoch: 2, loss = 0.23640615843236445
Train: epoch: 2, loss = 0.23700014615431428
Train: epoch: 2, loss = 0.2368002608716488
Train: epoch: 2, loss = 0.2356602093949914
Train: epoch: 2, loss = 0.23651461313877786
Train:  Epoch 2, Loss=0.23609944341899367, AUC-ROC Macro=0.7179339453828226, AUC-ROC Micro=0.808624548556711
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.5040171680351099, AUC-ROC Macro=0.6029949090923385, AUC-ROC Micro=0.6110029915135571
Eval task: 2
Eval:  Epoch 2, Loss=0.23429389595985411, AUC-ROC Macro=0.7292748332876604, AUC-ROC Micro=0.8123940567922594
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.235462167263031
Train: epoch: 3, loss = 0.2330009825900197
Train: epoch: 3, loss = 0.23186891940732798
Train: epoch: 3, loss = 0.2310729182884097
Train: epoch: 3, loss = 0.23024274615943432
Train: epoch: 3, loss = 0.23039280250668526
Train: epoch: 3, loss = 0.22967011549643107
Train:  Epoch 3, Loss=0.22974847399019283, AUC-ROC Macro=0.7475088628440681, AUC-ROC Micro=0.8231670499299227
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5266132193307081, AUC-ROC Macro=0.5786956167521344, AUC-ROC Micro=0.6022551167261537
Eval task: 2
Eval:  Epoch 3, Loss=0.23208995908498764, AUC-ROC Macro=0.7351375546249951, AUC-ROC Micro=0.8169681306080274
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.22272361014038325
Train: epoch: 4, loss = 0.2214201670512557
Train: epoch: 4, loss = 0.22385188502569994
Train: epoch: 4, loss = 0.22516464859247207
Train: epoch: 4, loss = 0.22551008987426757
Train: epoch: 4, loss = 0.22633566078419487
Train: epoch: 4, loss = 0.22566002209803887
Train:  Epoch 4, Loss=0.22573622269814997, AUC-ROC Macro=0.7637597944489194, AUC-ROC Micro=0.8320263427100629
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5289377036194006, AUC-ROC Macro=0.571575040117583, AUC-ROC Micro=0.6029204521910176
Eval task: 2
Eval:  Epoch 4, Loss=0.23010601699352265, AUC-ROC Macro=0.7402494427933972, AUC-ROC Micro=0.8205979883700799
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.21521302092820405
Train: epoch: 5, loss = 0.21812222810462117
Train: epoch: 5, loss = 0.22127533864229917
Train: epoch: 5, loss = 0.22193441725336016
Train: epoch: 5, loss = 0.2216268016770482
Train: epoch: 5, loss = 0.22138473801935712
Train: epoch: 5, loss = 0.22174769602715969
Train:  Epoch 5, Loss=0.22182172717577778, AUC-ROC Macro=0.7779932482657205, AUC-ROC Micro=0.8400471100405019
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5458571463823318, AUC-ROC Macro=0.5647022209812712, AUC-ROC Micro=0.5934420010526815
Eval task: 2
Eval:  Epoch 5, Loss=0.22877960354089738, AUC-ROC Macro=0.742862951644863, AUC-ROC Micro=0.8233097256466384
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2170018868893385
Train: epoch: 6, loss = 0.21700904635712503
Train: epoch: 6, loss = 0.21776922321567932
Train: epoch: 6, loss = 0.21802301091141998
Train: epoch: 6, loss = 0.21751047383248806
Train: epoch: 6, loss = 0.21693534351264437
Train: epoch: 6, loss = 0.21828635334436383
Train:  Epoch 6, Loss=0.2182409602268154, AUC-ROC Macro=0.7893386880156864, AUC-ROC Micro=0.8470743283345692
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5558217217524847, AUC-ROC Macro=0.5676474213139917, AUC-ROC Micro=0.5969371199024642
Eval task: 2
Eval:  Epoch 6, Loss=0.2289259746670723, AUC-ROC Macro=0.7489756137997816, AUC-ROC Micro=0.8249888793981108
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5595371127128601, AUC-ROC Macro=0.5693322030947967, AUC-ROC Micro=0.5971808915779767
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.22728486508131027, AUC-ROC Macro=0.7530197122646501, AUC-ROC Micro=0.8275311700614658
{'0': {'precision': 0.2904812082894275, 'recall': 0.632262996941896, 'f1-score': 0.3980746089049338, 'support': 1308}, '1': {'precision': 0.18359375, 'recall': 0.11691542288557213, 'f1-score': 0.14285714285714288, 'support': 402}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 658}, '3': {'precision': 0.4332425068119891, 'recall': 0.15979899497487438, 'f1-score': 0.23348017621145375, 'support': 1990}, '4': {'precision': 0.3074626865671642, 'recall': 0.12779156327543426, 'f1-score': 0.18054338299737074, 'support': 806}, '5': {'precision': 0.14285714285714285, 'recall': 0.04113110539845758, 'f1-score': 0.06387225548902195, 'support': 778}, '6': {'precision': 0.3804347826086957, 'recall': 0.053763440860215055, 'f1-score': 0.09421265141318977, 'support': 1302}, '7': {'precision': 0.07547169811320754, 'recall': 0.009433962264150943, 'f1-score': 0.016771488469601678, 'support': 424}, '8': {'precision': 0.6, 'recall': 0.0036496350364963502, 'f1-score': 0.007255139056831922, 'support': 1644}, '9': {'precision': 0.6666666666666666, 'recall': 0.0019694731659281144, 'f1-score': 0.0039273441335297005, 'support': 2031}, '10': {'precision': 0.19318181818181818, 'recall': 0.029668411867364748, 'f1-score': 0.05143721633888049, 'support': 573}, '11': {'precision': 0.5, 'recall': 0.0017006802721088435, 'f1-score': 0.0033898305084745766, 'support': 1176}, '12': {'precision': 0.4, 'recall': 0.006779661016949152, 'f1-score': 0.013333333333333334, 'support': 1770}, '13': {'precision': 0.33923578751164957, 'recall': 0.14021571648690292, 'f1-score': 0.19841918778958842, 'support': 2596}, '14': {'precision': 0.13872832369942195, 'recall': 0.02950215119852489, 'f1-score': 0.0486568677141409, 'support': 1627}, '15': {'precision': 0.0783132530120482, 'recall': 0.026859504132231406, 'f1-score': 0.04, 'support': 484}, '16': {'precision': 0.125, 'recall': 0.012578616352201259, 'f1-score': 0.022857142857142857, 'support': 795}, '17': {'precision': 1.0, 'recall': 0.001838235294117647, 'f1-score': 0.0036697247706422016, 'support': 544}, '18': {'precision': 0.5, 'recall': 0.005698005698005698, 'f1-score': 0.011267605633802818, 'support': 351}, '19': {'precision': 0.4, 'recall': 0.015267175572519083, 'f1-score': 0.02941176470588235, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 1.0, 'recall': 0.0009208103130755065, 'f1-score': 0.0018399264029438822, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.29188603282750075, 'recall': 0.07429156977889884, 'f1-score': 0.11843800069115014, 'support': 25373}, 'macro avg': {'precision': 0.31018678497276925, 'recall': 0.056709822520281034, 'f1-score': 0.06261107158351631, 'support': 25373}, 'weighted avg': {'precision': 0.35877623652253016, 'recall': 0.07429156977889884, 'f1-score': 0.08245512125340154, 'support': 25373}, 'samples avg': {'precision': 0.14304664248511903, 'recall': 0.053629525330036586, 'f1-score': 0.07151348525926958, 'support': 25373}}
{'0': {'precision': 0.6359832635983264, 'recall': 0.5517241379310345, 'f1-score': 0.5908649173955295, 'support': 551}, '1': {'precision': 0.605072463768116, 'recall': 0.2557427258805513, 'f1-score': 0.3595263724434876, 'support': 653}, '2': {'precision': 0.42105263157894735, 'recall': 0.018779342723004695, 'f1-score': 0.035955056179775284, 'support': 426}, '3': {'precision': 0.5365853658536586, 'recall': 0.10757946210268948, 'f1-score': 0.17922606924643583, 'support': 409}, '4': {'precision': 0.41935483870967744, 'recall': 0.053061224489795916, 'f1-score': 0.09420289855072463, 'support': 245}, '5': {'precision': 0.5483870967741935, 'recall': 0.09497206703910614, 'f1-score': 0.1619047619047619, 'support': 358}, '6': {'precision': 0.2631578947368421, 'recall': 0.020491803278688523, 'f1-score': 0.03802281368821292, 'support': 244}, '7': {'precision': 0.6073619631901841, 'recall': 0.336734693877551, 'f1-score': 0.4332603938730853, 'support': 294}, '8': {'precision': 0.5, 'recall': 0.0038022813688212928, 'f1-score': 0.007547169811320754, 'support': 263}, '9': {'precision': 0.7619047619047619, 'recall': 0.11510791366906475, 'f1-score': 0.20000000000000004, 'support': 278}, '10': {'precision': 0.2, 'recall': 0.009615384615384616, 'f1-score': 0.01834862385321101, 'support': 208}, '11': {'precision': 0.6666666666666666, 'recall': 0.01606425702811245, 'f1-score': 0.03137254901960784, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.4411764705882353, 'recall': 0.11363636363636363, 'f1-score': 0.18072289156626506, 'support': 132}, '14': {'precision': 0.7551020408163265, 'recall': 0.16371681415929204, 'f1-score': 0.2690909090909091, 'support': 226}, '15': {'precision': 0.7948717948717948, 'recall': 0.5904761904761905, 'f1-score': 0.6775956284153005, 'support': 105}, '16': {'precision': 0.5862068965517241, 'recall': 0.125, 'f1-score': 0.20606060606060606, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.6115942028985507, 'recall': 0.15655722500463737, 'f1-score': 0.24929847880667558, 'support': 5391}, 'macro avg': {'precision': 0.34971536598437813, 'recall': 0.10306018649102605, 'f1-score': 0.13934806644396933, 'support': 5391}, 'weighted avg': {'precision': 0.4877006024739389, 'recall': 0.15655722500463737, 'f1-score': 0.20769992188225242, 'support': 5391}, 'samples avg': {'precision': 0.24238932291666665, 'recall': 0.1543258618551587, 'f1-score': 0.17164772510475634, 'support': 5391}}