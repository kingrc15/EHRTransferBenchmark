
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_northeast
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4288556323200464
Train: epoch: 1, loss = 0.41773846056312325
Train: epoch: 1, loss = 0.41391856980820496
Train: epoch: 1, loss = 0.4111912955157459
Train: epoch: 1, loss = 0.40884095001220705
Train: epoch: 1, loss = 0.40578301131725314
Train: epoch: 1, loss = 0.40266619558845246
Train: epoch: 1, loss = 0.40173829382285475
Train: epoch: 1, loss = 0.3998271717793412
Train: epoch: 1, loss = 0.3993972486257553
Train: epoch: 1, loss = 0.3986492656171322
Train: epoch: 1, loss = 0.3974613532672326
Train: epoch: 1, loss = 0.39607698457172286
Train: epoch: 1, loss = 0.3951268000315343
Train: epoch: 1, loss = 0.3936628382553657
Train: epoch: 1, loss = 0.392880982439965
Train: epoch: 1, loss = 0.3920064565670841
Train: epoch: 1, loss = 0.3912108893899454
Train:  Epoch 1, Loss=0.3907729417177347, AUC-ROC Macro=0.6615991234388696, AUC-ROC Micro=0.7516846436302911
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3724959244330724, AUC-ROC Macro=0.715990736171094, AUC-ROC Micro=0.7793726991632971
Eval task: 2
Eval:  Epoch 1, Loss=0.3914039433002472, AUC-ROC Macro=0.49446402217697843, AUC-ROC Micro=0.5993546014715636
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3824398043006659
Train: epoch: 2, loss = 0.378958161175251
Train: epoch: 2, loss = 0.37542820888261
Train: epoch: 2, loss = 0.375082226973027
Train: epoch: 2, loss = 0.3737448740154505
Train: epoch: 2, loss = 0.37266359517971676
Train: epoch: 2, loss = 0.3723192823997566
Train: epoch: 2, loss = 0.37104882299900055
Train: epoch: 2, loss = 0.3707024416906966
Train: epoch: 2, loss = 0.3711196908056736
Train: epoch: 2, loss = 0.3716680205816572
Train: epoch: 2, loss = 0.37090863342707353
Train: epoch: 2, loss = 0.3706991819406931
Train: epoch: 2, loss = 0.3697418067178556
Train: epoch: 2, loss = 0.3693214101294676
Train: epoch: 2, loss = 0.3694495596922934
Train: epoch: 2, loss = 0.36926244900945354
Train: epoch: 2, loss = 0.3691179603462418
Train:  Epoch 2, Loss=0.36923286290250273, AUC-ROC Macro=0.7231923766350765, AUC-ROC Micro=0.7901024975960594
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3629557006061077, AUC-ROC Macro=0.7367804106613066, AUC-ROC Micro=0.7962389403759246
Eval task: 2
Eval:  Epoch 2, Loss=0.4198557585477829, AUC-ROC Macro=0.4728155892584445, AUC-ROC Micro=0.5667954859122114
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3728123963624239
Train: epoch: 3, loss = 0.3677366067841649
Train: epoch: 3, loss = 0.3669618272036314
Train: epoch: 3, loss = 0.364739078078419
Train: epoch: 3, loss = 0.36573270699381827
Train: epoch: 3, loss = 0.36551104408999285
Train: epoch: 3, loss = 0.36510505077029975
Train: epoch: 3, loss = 0.36427242181263864
Train: epoch: 3, loss = 0.36397432001928487
Train: epoch: 3, loss = 0.36380464272946117
Train: epoch: 3, loss = 0.3634187351776795
Train: epoch: 3, loss = 0.3639254501275718
Train: epoch: 3, loss = 0.3631798239625417
Train: epoch: 3, loss = 0.36249498508870603
Train: epoch: 3, loss = 0.36204785201946893
Train: epoch: 3, loss = 0.3616309493081644
Train: epoch: 3, loss = 0.36121777026092305
Train: epoch: 3, loss = 0.3611664817771978
Train:  Epoch 3, Loss=0.3610905622376336, AUC-ROC Macro=0.7419536360271262, AUC-ROC Micro=0.8026314778820834
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3585783702631791, AUC-ROC Macro=0.7466646430942567, AUC-ROC Micro=0.802982290739483
Eval task: 2
Eval:  Epoch 3, Loss=0.4104185551404953, AUC-ROC Macro=0.4849593214363129, AUC-ROC Micro=0.5821222087430078
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3655814626812935
Train: epoch: 4, loss = 0.36032722432166336
Train: epoch: 4, loss = 0.3587833557029565
Train: epoch: 4, loss = 0.35829198131337764
Train: epoch: 4, loss = 0.3584566557854414
Train: epoch: 4, loss = 0.35706079377482336
Train: epoch: 4, loss = 0.35810288121657713
Train: epoch: 4, loss = 0.3585622250754386
Train: epoch: 4, loss = 0.35836813578175175
Train: epoch: 4, loss = 0.3582051276117563
Train: epoch: 4, loss = 0.3578418443961577
Train: epoch: 4, loss = 0.35743997185180587
Train: epoch: 4, loss = 0.35658316566393927
Train: epoch: 4, loss = 0.3570018420581307
Train: epoch: 4, loss = 0.3569776423573494
Train: epoch: 4, loss = 0.35654597751330586
Train: epoch: 4, loss = 0.3560129094299148
Train: epoch: 4, loss = 0.3553398397316535
Train:  Epoch 4, Loss=0.35514273679562103, AUC-ROC Macro=0.754933273905705, AUC-ROC Micro=0.8114982304419533
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3538516623278459, AUC-ROC Macro=0.7569101927569112, AUC-ROC Micro=0.8101810575564707
Eval task: 2
Eval:  Epoch 4, Loss=0.4358290433883667, AUC-ROC Macro=0.48291645317898463, AUC-ROC Micro=0.5625693392228677
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.35239126116037367
Train: epoch: 5, loss = 0.3498199312388897
Train: epoch: 5, loss = 0.3517790179948012
Train: epoch: 5, loss = 0.35125959299504755
Train: epoch: 5, loss = 0.3497143718600273
Train: epoch: 5, loss = 0.3496432632083694
Train: epoch: 5, loss = 0.3503609010470765
Train: epoch: 5, loss = 0.35090280962176623
Train: epoch: 5, loss = 0.35123362839221955
Train: epoch: 5, loss = 0.3510292290225625
Train: epoch: 5, loss = 0.35111395247280597
Train: epoch: 5, loss = 0.350674439954261
Train: epoch: 5, loss = 0.3504380653683956
Train: epoch: 5, loss = 0.3506808326553021
Train: epoch: 5, loss = 0.3511106602599223
Train: epoch: 5, loss = 0.35105851338710636
Train: epoch: 5, loss = 0.35087213109521304
Train: epoch: 5, loss = 0.3506244669813249
Train:  Epoch 5, Loss=0.35049997847508163, AUC-ROC Macro=0.76444030922615, AUC-ROC Micro=0.8180862302665632
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35117484504977864, AUC-ROC Macro=0.759339862153435, AUC-ROC Micro=0.8139567179907585
Eval task: 2
Eval:  Epoch 5, Loss=0.4442700296640396, AUC-ROC Macro=0.48398022264597157, AUC-ROC Micro=0.56365232887844
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34569812260568145
Train: epoch: 6, loss = 0.3449610229209065
Train: epoch: 6, loss = 0.34403993936876454
Train: epoch: 6, loss = 0.3446088908240199
Train: epoch: 6, loss = 0.3448126708120108
Train: epoch: 6, loss = 0.34500510547310115
Train: epoch: 6, loss = 0.34566193524215905
Train: epoch: 6, loss = 0.3458068230841309
Train: epoch: 6, loss = 0.3459508869217502
Train: epoch: 6, loss = 0.34605553061515093
Train: epoch: 6, loss = 0.34601340910927814
Train: epoch: 6, loss = 0.345891808476299
Train: epoch: 6, loss = 0.34605193562805653
Train: epoch: 6, loss = 0.3457867931468146
Train: epoch: 6, loss = 0.34626547692219417
Train: epoch: 6, loss = 0.34630511623807253
Train: epoch: 6, loss = 0.34666874434141554
Train: epoch: 6, loss = 0.3468879706909259
Train:  Epoch 6, Loss=0.3469627585370316, AUC-ROC Macro=0.771521819091365, AUC-ROC Micro=0.8229923899582496
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3521062172949314, AUC-ROC Macro=0.7612526446016555, AUC-ROC Micro=0.8136036920519917
Eval task: 2
Eval:  Epoch 6, Loss=0.44246111810207367, AUC-ROC Macro=0.482699565175561, AUC-ROC Micro=0.5641331853292689
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3559285067021847, AUC-ROC Macro=0.7590190344760714, AUC-ROC Micro=0.8110174176287259
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.451984167098999, AUC-ROC Macro=0.4812719440859855, AUC-ROC Micro=0.572357881423915
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.34513319849967955
Train:  Epoch 1, Loss=0.33836475106130254, AUC-ROC Macro=0.555822473690805, AUC-ROC Micro=0.71875412493695
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.34348554785052937, AUC-ROC Macro=0.754506950468058, AUC-ROC Micro=0.8090268258637547
Eval task: 2
Eval:  Epoch 1, Loss=0.3790922164916992, AUC-ROC Macro=0.5950609815694146, AUC-ROC Micro=0.7604486872115458
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.3191879686713219
Train:  Epoch 2, Loss=0.31920851195540223, AUC-ROC Macro=0.6391577668045296, AUC-ROC Micro=0.7876499457463837
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3434111028909683, AUC-ROC Macro=0.7560579037175843, AUC-ROC Micro=0.8103246009794429
Eval task: 2
Eval:  Epoch 2, Loss=0.2969481199979782, AUC-ROC Macro=0.6482199657882048, AUC-ROC Micro=0.7864314554820258
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.3109752289950848
Train:  Epoch 3, Loss=0.31321925585738786, AUC-ROC Macro=0.6802539652591542, AUC-ROC Micro=0.8081126829667572
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3318130522966385, AUC-ROC Macro=0.7554185144536291, AUC-ROC Micro=0.8109102969454726
Eval task: 2
Eval:  Epoch 3, Loss=0.30591459572315216, AUC-ROC Macro=0.6736169996765098, AUC-ROC Micro=0.801666112887405
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.3059556788951159
Train:  Epoch 4, Loss=0.3038581450115188, AUC-ROC Macro=0.714514974119628, AUC-ROC Micro=0.8262607912020008
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.34276626134912175, AUC-ROC Macro=0.7544663371626085, AUC-ROC Micro=0.8088568702634422
Eval task: 2
Eval:  Epoch 4, Loss=0.323978453874588, AUC-ROC Macro=0.6877392294670145, AUC-ROC Micro=0.808102101099413
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2988904182612896
Train:  Epoch 5, Loss=0.29993665143535725, AUC-ROC Macro=0.7340342217487859, AUC-ROC Micro=0.8368280480250072
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.350181149939696, AUC-ROC Macro=0.7517023878375302, AUC-ROC Micro=0.806491076000774
Eval task: 2
Eval:  Epoch 5, Loss=0.2636203169822693, AUC-ROC Macro=0.6931510889171567, AUC-ROC Micro=0.8146337119471199
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.29730190128087997
Train:  Epoch 6, Loss=0.2989721118240011, AUC-ROC Macro=0.7513450891886854, AUC-ROC Micro=0.8459788605950879
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3313160041968028, AUC-ROC Macro=0.7534221349407771, AUC-ROC Micro=0.8082575825496325
Eval task: 2
Eval:  Epoch 6, Loss=0.3244144022464752, AUC-ROC Macro=0.7066877391778875, AUC-ROC Micro=0.8239937873020978
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3593161789079507, AUC-ROC Macro=0.7522225708495951, AUC-ROC Micro=0.8072409952722626
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2956311106681824, AUC-ROC Macro=0.6783303138380693, AUC-ROC Micro=0.8085448689350863
{'0': {'precision': 0.5892857142857143, 'recall': 0.25229357798165136, 'f1-score': 0.35331905781584577, 'support': 1308}, '1': {'precision': 0.6386861313868614, 'recall': 0.43532338308457713, 'f1-score': 0.5177514792899408, 'support': 402}, '2': {'precision': 0.4409937888198758, 'recall': 0.10790273556231003, 'f1-score': 0.17338217338217338, 'support': 658}, '3': {'precision': 0.5346197502837684, 'recall': 0.23668341708542714, 'f1-score': 0.3281086729362591, 'support': 1990}, '4': {'precision': 0.4797297297297297, 'recall': 0.0880893300248139, 'f1-score': 0.14884696016771487, 'support': 806}, '5': {'precision': 0.39622641509433965, 'recall': 0.02699228791773779, 'f1-score': 0.05054151624548736, 'support': 778}, '6': {'precision': 0.5445859872611465, 'recall': 0.1313364055299539, 'f1-score': 0.2116336633663366, 'support': 1302}, '7': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 424}, '8': {'precision': 0.5399820305480683, 'recall': 0.3655717761557178, 'f1-score': 0.435981138919115, 'support': 1644}, '9': {'precision': 0.6412307692307693, 'recall': 0.5130477597242737, 'f1-score': 0.5700218818380743, 'support': 2031}, '10': {'precision': 0.7041666666666667, 'recall': 0.2949389179755672, 'f1-score': 0.41574415744157445, 'support': 573}, '11': {'precision': 0.47581699346405226, 'recall': 0.30952380952380953, 'f1-score': 0.37506439979392064, 'support': 1176}, '12': {'precision': 0.5709382151029748, 'recall': 0.28192090395480224, 'f1-score': 0.3774583963691377, 'support': 1770}, '13': {'precision': 0.5886561062851303, 'recall': 0.4437596302003082, 'f1-score': 0.5060399736437514, 'support': 2596}, '14': {'precision': 0.5420023014959724, 'recall': 0.2894898586355255, 'f1-score': 0.3774038461538461, 'support': 1627}, '15': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 484}, '16': {'precision': 0.4512820512820513, 'recall': 0.11069182389937107, 'f1-score': 0.17777777777777778, 'support': 795}, '17': {'precision': 0.4583333333333333, 'recall': 0.04044117647058824, 'f1-score': 0.07432432432432433, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.7222222222222222, 'recall': 0.04961832061068702, 'f1-score': 0.09285714285714286, 'support': 262}, '20': {'precision': 0.2857142857142857, 'recall': 0.007104795737122558, 'f1-score': 0.013864818024263433, 'support': 563}, '21': {'precision': 0.5527156549520766, 'recall': 0.2066905615292712, 'f1-score': 0.3008695652173913, 'support': 837}, '22': {'precision': 0.6812121212121212, 'recall': 0.5174953959484346, 'f1-score': 0.5881737310308738, 'support': 1086}, '23': {'precision': 0.6069651741293532, 'recall': 0.28339140534262486, 'f1-score': 0.386381631037213, 'support': 861}, '24': {'precision': 0.5474137931034483, 'recall': 0.2514851485148515, 'f1-score': 0.344640434192673, 'support': 505}, 'micro avg': {'precision': 0.5755994951619688, 'recall': 0.26961730973869863, 'f1-score': 0.36722314670674755, 'support': 25373}, 'macro avg': {'precision': 0.4797111694241585, 'recall': 0.20975169685637707, 'f1-score': 0.2728074696729935, 'support': 25373}, 'weighted avg': {'precision': 0.5249238313250948, 'recall': 0.26961730973869863, 'f1-score': 0.3402405164424765, 'support': 25373}, 'samples avg': {'precision': 0.3913806995594105, 'recall': 0.24386664671878366, 'f1-score': 0.27561243275013647, 'support': 25373}}
{'0': {'precision': 0.782608695652174, 'recall': 0.27692307692307694, 'f1-score': 0.4090909090909091, 'support': 130}, '1': {'precision': 0.6031746031746031, 'recall': 0.27941176470588236, 'f1-score': 0.38190954773869346, 'support': 136}, '2': {'precision': 0.46153846153846156, 'recall': 0.17518248175182483, 'f1-score': 0.253968253968254, 'support': 137}, '3': {'precision': 0.6619047619047619, 'recall': 0.6525821596244131, 'f1-score': 0.6572104018912529, 'support': 213}, '4': {'precision': 0.5714285714285714, 'recall': 0.05333333333333334, 'f1-score': 0.0975609756097561, 'support': 75}, '5': {'precision': 0.5, 'recall': 0.031914893617021274, 'f1-score': 0.06, 'support': 94}, '6': {'precision': 0.5, 'recall': 0.02702702702702703, 'f1-score': 0.05128205128205129, 'support': 74}, '7': {'precision': 1.0, 'recall': 0.05, 'f1-score': 0.09523809523809523, 'support': 40}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 65}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 63}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 56}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 52}, '13': {'precision': 0.4166666666666667, 'recall': 0.09090909090909091, 'f1-score': 0.1492537313432836, 'support': 55}, '14': {'precision': 0.6666666666666666, 'recall': 0.12698412698412698, 'f1-score': 0.21333333333333335, 'support': 63}, '15': {'precision': 1.0, 'recall': 0.10526315789473684, 'f1-score': 0.1904761904761905, 'support': 19}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '17': {'precision': 1.0, 'recall': 0.024390243902439025, 'f1-score': 0.047619047619047616, 'support': 82}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, 'micro avg': {'precision': 0.6339712918660287, 'recall': 0.1724137931034483, 'f1-score': 0.2710997442455243, 'support': 1537}, 'macro avg': {'precision': 0.3265595370812763, 'recall': 0.0757568542669189, 'f1-score': 0.10427770150363468, 'support': 1537}, 'weighted avg': {'precision': 0.4689402534201833, 'recall': 0.1724137931034483, 'f1-score': 0.21446663408821448, 'support': 1537}, 'samples avg': {'precision': 0.31640625, 'recall': 0.1534698970734127, 'f1-score': 0.1911544293380231, 'support': 1537}}