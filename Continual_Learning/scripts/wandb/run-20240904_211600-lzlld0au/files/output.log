
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43635919570922854
Train: epoch: 1, loss = 0.4230150207877159
Train: epoch: 1, loss = 0.41724315216143926
Train: epoch: 1, loss = 0.41363438677042724
Train: epoch: 1, loss = 0.41032326781749723
Train: epoch: 1, loss = 0.4085871583471696
Train: epoch: 1, loss = 0.4075379741085427
Train: epoch: 1, loss = 0.40496319570578637
Train: epoch: 1, loss = 0.4041294680784146
Train: epoch: 1, loss = 0.4030253341719508
Train: epoch: 1, loss = 0.4021754286031831
Train: epoch: 1, loss = 0.4015071701444686
Train: epoch: 1, loss = 0.40013656361171834
Train: epoch: 1, loss = 0.3988690179054226
Train: epoch: 1, loss = 0.3978154387921095
Train: epoch: 1, loss = 0.39663219231646507
Train: epoch: 1, loss = 0.39536987863481043
Train: epoch: 1, loss = 0.39415344086786114
Train:  Epoch 1, Loss=0.39391954437687865, AUC-ROC Macro=0.6526803194005175, AUC-ROC Micro=0.7454892045305684
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3741365037858486, AUC-ROC Macro=0.7159954119272368, AUC-ROC Micro=0.7779920109866983
Eval task: 2
Eval:  Epoch 1, Loss=0.33252948224544526, AUC-ROC Macro=0.4937666275682981, AUC-ROC Micro=0.5711529451371294
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.36452240981161593
Train: epoch: 2, loss = 0.36872792027890683
Train: epoch: 2, loss = 0.3706852207581202
Train: epoch: 2, loss = 0.3718995178677142
Train: epoch: 2, loss = 0.37164390118420126
Train: epoch: 2, loss = 0.3703967142725984
Train: epoch: 2, loss = 0.37024091998381276
Train: epoch: 2, loss = 0.37039279303513467
Train: epoch: 2, loss = 0.3706598313815064
Train: epoch: 2, loss = 0.3703894916176796
Train: epoch: 2, loss = 0.36963344128294423
Train: epoch: 2, loss = 0.36983384592458607
Train: epoch: 2, loss = 0.3695750093632019
Train: epoch: 2, loss = 0.3691956508319293
Train: epoch: 2, loss = 0.36922421419620516
Train: epoch: 2, loss = 0.3691309417318553
Train: epoch: 2, loss = 0.3690506291959216
Train: epoch: 2, loss = 0.3689985974836681
Train:  Epoch 2, Loss=0.36885914586548113, AUC-ROC Macro=0.7236688480687341, AUC-ROC Micro=0.7906358719534188
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3635961376130581, AUC-ROC Macro=0.7380825640882381, AUC-ROC Micro=0.7949414007381475
Eval task: 2
Eval:  Epoch 2, Loss=0.36046788692474363, AUC-ROC Macro=0.47026347806988233, AUC-ROC Micro=0.5241296201248418
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3535931972414255
Train: epoch: 3, loss = 0.35857430670410395
Train: epoch: 3, loss = 0.3599365667502085
Train: epoch: 3, loss = 0.3600576954521239
Train: epoch: 3, loss = 0.3597947906702757
Train: epoch: 3, loss = 0.35933379710962376
Train: epoch: 3, loss = 0.3597205970862082
Train: epoch: 3, loss = 0.35983499239198863
Train: epoch: 3, loss = 0.3599070028463999
Train: epoch: 3, loss = 0.36069904316961765
Train: epoch: 3, loss = 0.36094707436182283
Train: epoch: 3, loss = 0.36116837766642373
Train: epoch: 3, loss = 0.36087207117332865
Train: epoch: 3, loss = 0.3605261411092111
Train: epoch: 3, loss = 0.3605878982295593
Train: epoch: 3, loss = 0.36084302834700793
Train: epoch: 3, loss = 0.3607054753513897
Train: epoch: 3, loss = 0.3604712194245723
Train:  Epoch 3, Loss=0.3604206390401237, AUC-ROC Macro=0.7431836274738992, AUC-ROC Micro=0.8037667081782076
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3560715677837531, AUC-ROC Macro=0.751412119105623, AUC-ROC Micro=0.8065579011238645
Eval task: 2
Eval:  Epoch 3, Loss=0.3701513886451721, AUC-ROC Macro=0.4733797437035666, AUC-ROC Micro=0.5195709180598054
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.354647550880909
Train: epoch: 4, loss = 0.35663970444351434
Train: epoch: 4, loss = 0.356806510562698
Train: epoch: 4, loss = 0.3573177736066282
Train: epoch: 4, loss = 0.3573094219267368
Train: epoch: 4, loss = 0.3568065434445937
Train: epoch: 4, loss = 0.35573450628135883
Train: epoch: 4, loss = 0.35602363136596976
Train: epoch: 4, loss = 0.3558746275305748
Train: epoch: 4, loss = 0.35641629704087974
Train: epoch: 4, loss = 0.35601872505789456
Train: epoch: 4, loss = 0.35586110591888426
Train: epoch: 4, loss = 0.35545141847087786
Train: epoch: 4, loss = 0.3552225604972669
Train: epoch: 4, loss = 0.35500874016682304
Train: epoch: 4, loss = 0.35507331175729634
Train: epoch: 4, loss = 0.3549207557562519
Train: epoch: 4, loss = 0.35488200193478003
Train:  Epoch 4, Loss=0.35466919019690946, AUC-ROC Macro=0.755655037645591, AUC-ROC Micro=0.812149857286415
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3547251299023628, AUC-ROC Macro=0.7550865201233806, AUC-ROC Micro=0.8090431812560511
Eval task: 2
Eval:  Epoch 4, Loss=0.3905400991439819, AUC-ROC Macro=0.4764769527531002, AUC-ROC Micro=0.5460208214485176
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3461086772382259
Train: epoch: 5, loss = 0.3479382187873125
Train: epoch: 5, loss = 0.351064747646451
Train: epoch: 5, loss = 0.35172399345785377
Train: epoch: 5, loss = 0.3509920032769442
Train: epoch: 5, loss = 0.3508936008438468
Train: epoch: 5, loss = 0.3504661635841642
Train: epoch: 5, loss = 0.3508811888564378
Train: epoch: 5, loss = 0.3515215573459864
Train: epoch: 5, loss = 0.3514527389779687
Train: epoch: 5, loss = 0.35087937956506554
Train: epoch: 5, loss = 0.3508129941672087
Train: epoch: 5, loss = 0.3503030091466812
Train: epoch: 5, loss = 0.3503769557763423
Train: epoch: 5, loss = 0.3504654618601004
Train: epoch: 5, loss = 0.3502845376683399
Train: epoch: 5, loss = 0.3506869220470681
Train: epoch: 5, loss = 0.35064399546219244
Train:  Epoch 5, Loss=0.35064230213409814, AUC-ROC Macro=0.7637518701781175, AUC-ROC Micro=0.8179573790616957
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35161476706465083, AUC-ROC Macro=0.7607548544612383, AUC-ROC Micro=0.8138179831602272
Eval task: 2
Eval:  Epoch 5, Loss=0.3894030064344406, AUC-ROC Macro=0.46103355273205915, AUC-ROC Micro=0.5342759370317737
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3467454323172569
Train: epoch: 6, loss = 0.34621557779610157
Train: epoch: 6, loss = 0.3466207149873177
Train: epoch: 6, loss = 0.34761147033423184
Train: epoch: 6, loss = 0.3467641664892435
Train: epoch: 6, loss = 0.34729675234605867
Train: epoch: 6, loss = 0.3469221332882132
Train: epoch: 6, loss = 0.34634171390905977
Train: epoch: 6, loss = 0.3465355702489614
Train: epoch: 6, loss = 0.3459765394628048
Train: epoch: 6, loss = 0.3453609344905073
Train: epoch: 6, loss = 0.34556870080530644
Train: epoch: 6, loss = 0.3459322403772519
Train: epoch: 6, loss = 0.34615342093897716
Train: epoch: 6, loss = 0.3462838547329108
Train: epoch: 6, loss = 0.34681906543206426
Train: epoch: 6, loss = 0.3472003064786687
Train: epoch: 6, loss = 0.34725651462872825
Train:  Epoch 6, Loss=0.3471924807903094, AUC-ROC Macro=0.7708195083057191, AUC-ROC Micro=0.8226727705221999
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3505885737637679, AUC-ROC Macro=0.7614078030553447, AUC-ROC Micro=0.8149377000312481
Eval task: 2
Eval:  Epoch 6, Loss=0.4173848479986191, AUC-ROC Macro=0.46896720892851174, AUC-ROC Micro=0.5327154340305155
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35394227753082913, AUC-ROC Macro=0.7605042594491931, AUC-ROC Micro=0.8131002396216445
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.4204764813184738, AUC-ROC Macro=0.452844436344246, AUC-ROC Micro=0.5299380127211158
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2961316192150116
Train: epoch: 1, loss = 0.27884376265108585
Train: epoch: 1, loss = 0.27129435338079927
Train: epoch: 1, loss = 0.2675448195077479
Train: epoch: 1, loss = 0.2634702696949244
Train: epoch: 1, loss = 0.2599899373576045
Train: epoch: 1, loss = 0.25772210776805876
Train:  Epoch 1, Loss=0.2557395375143494, AUC-ROC Macro=0.6191540880106304, AUC-ROC Micro=0.7566901742609108
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4818761460483074, AUC-ROC Macro=0.6284367085252718, AUC-ROC Micro=0.6255155914210797
Eval task: 2
Eval:  Epoch 1, Loss=0.2409518465399742, AUC-ROC Macro=0.6969831725530589, AUC-ROC Micro=0.7968519921689654
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2375409708172083
Train: epoch: 2, loss = 0.2382607068121433
Train: epoch: 2, loss = 0.23848322259883087
Train: epoch: 2, loss = 0.23826410090550781
Train: epoch: 2, loss = 0.23684694100171327
Train: epoch: 2, loss = 0.23706480670099458
Train: epoch: 2, loss = 0.23642218079417943
Train:  Epoch 2, Loss=0.2364564256085593, AUC-ROC Macro=0.7147748839599593, AUC-ROC Micro=0.8080913177942048
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.4862853412826856, AUC-ROC Macro=0.6042776620687136, AUC-ROC Micro=0.6271112436108218
Eval task: 2
Eval:  Epoch 2, Loss=0.2351190835237503, AUC-ROC Macro=0.7221249874833282, AUC-ROC Micro=0.8096080313890741
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.23095311738550664
Train: epoch: 3, loss = 0.23144095104187726
Train: epoch: 3, loss = 0.2305844111988942
Train: epoch: 3, loss = 0.22995080036111176
Train: epoch: 3, loss = 0.22985408804565668
Train: epoch: 3, loss = 0.23002089308574797
Train: epoch: 3, loss = 0.23012305898857968
Train:  Epoch 3, Loss=0.2305341810438065, AUC-ROC Macro=0.74307165112226, AUC-ROC Micro=0.8213185689025488
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.50760418176651, AUC-ROC Macro=0.5842700089247364, AUC-ROC Micro=0.6094108483638022
Eval task: 2
Eval:  Epoch 3, Loss=0.23282714933156967, AUC-ROC Macro=0.7313262896743314, AUC-ROC Micro=0.814777232944595
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.22874802127480506
Train: epoch: 4, loss = 0.2259333611279726
Train: epoch: 4, loss = 0.22725975307325522
Train: epoch: 4, loss = 0.22653035840950905
Train: epoch: 4, loss = 0.22568627033382654
Train: epoch: 4, loss = 0.22598877895623445
Train: epoch: 4, loss = 0.22600131532975606
Train:  Epoch 4, Loss=0.22620878939104846, AUC-ROC Macro=0.7605063340266475, AUC-ROC Micro=0.8307793886594532
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5192005832990011, AUC-ROC Macro=0.5833759578237163, AUC-ROC Micro=0.6024700225295301
Eval task: 2
Eval:  Epoch 4, Loss=0.23163212984800338, AUC-ROC Macro=0.733427008723256, AUC-ROC Micro=0.8180210427336404
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.21750730652362107
Train: epoch: 5, loss = 0.2220249719172716
Train: epoch: 5, loss = 0.2213575269530217
Train: epoch: 5, loss = 0.2228359674476087
Train: epoch: 5, loss = 0.22155137749016285
Train: epoch: 5, loss = 0.22215237451096376
Train: epoch: 5, loss = 0.22183218043297528
Train:  Epoch 5, Loss=0.2226683814069687, AUC-ROC Macro=0.7753756888057223, AUC-ROC Micro=0.838139797342419
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5308885661264261, AUC-ROC Macro=0.5704338870985902, AUC-ROC Micro=0.5991157761281527
Eval task: 2
Eval:  Epoch 5, Loss=0.23194489628076553, AUC-ROC Macro=0.7381280999312163, AUC-ROC Micro=0.8182169667530923
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2173489126563072
Train: epoch: 6, loss = 0.2216993226110935
Train: epoch: 6, loss = 0.21975493634740512
Train: epoch: 6, loss = 0.21964106415398418
Train: epoch: 6, loss = 0.22071431467682123
Train: epoch: 6, loss = 0.22050522470846773
Train: epoch: 6, loss = 0.22015367493565594
Train:  Epoch 6, Loss=0.2193512233707564, AUC-ROC Macro=0.7865980407713384, AUC-ROC Micro=0.8450200225735818
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5271180731554826, AUC-ROC Macro=0.5693760638793677, AUC-ROC Micro=0.60738036269428
Eval task: 2
Eval:  Epoch 6, Loss=0.23004092872142792, AUC-ROC Macro=0.7410709263796882, AUC-ROC Micro=0.8223931859943224
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.532915481676658, AUC-ROC Macro=0.5728957674858988, AUC-ROC Micro=0.6057937830431912
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.22701931595802308, AUC-ROC Macro=0.7469891299964037, AUC-ROC Micro=0.827199157691298
{'0': {'precision': 0.3323317307692308, 'recall': 0.422782874617737, 'f1-score': 0.3721399730820996, 'support': 1308}, '1': {'precision': 0.20867768595041322, 'recall': 0.5024875621890548, 'f1-score': 0.2948905109489051, 'support': 402}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 658}, '3': {'precision': 0.410958904109589, 'recall': 0.01507537688442211, 'f1-score': 0.0290838584585555, 'support': 1990}, '4': {'precision': 0.30120481927710846, 'recall': 0.062034739454094295, 'f1-score': 0.10288065843621401, 'support': 806}, '5': {'precision': 0.15151515151515152, 'recall': 0.006426735218508998, 'f1-score': 0.012330456226880395, 'support': 778}, '6': {'precision': 0.4358974358974359, 'recall': 0.03917050691244239, 'f1-score': 0.07188160676532769, 'support': 1302}, '7': {'precision': 0.06896551724137931, 'recall': 0.0047169811320754715, 'f1-score': 0.008830022075055188, 'support': 424}, '8': {'precision': 0.5436893203883495, 'recall': 0.0340632603406326, 'f1-score': 0.06410990269032628, 'support': 1644}, '9': {'precision': 0.76, 'recall': 0.009354997538158542, 'f1-score': 0.01848249027237354, 'support': 2031}, '10': {'precision': 0.2863849765258216, 'recall': 0.10645724258289703, 'f1-score': 0.15521628498727735, 'support': 573}, '11': {'precision': 0.29508196721311475, 'recall': 0.015306122448979591, 'f1-score': 0.02910266774454325, 'support': 1176}, '12': {'precision': 0.4077669902912621, 'recall': 0.0711864406779661, 'f1-score': 0.12121212121212122, 'support': 1770}, '13': {'precision': 0.32160804020100503, 'recall': 0.04930662557781202, 'f1-score': 0.08550434201736808, 'support': 2596}, '14': {'precision': 0.22574257425742575, 'recall': 0.14013521819299324, 'f1-score': 0.17292377701934017, 'support': 1627}, '15': {'precision': 0.0707070707070707, 'recall': 0.014462809917355372, 'f1-score': 0.024013722126929676, 'support': 484}, '16': {'precision': 0.16666666666666666, 'recall': 0.021383647798742137, 'f1-score': 0.0379041248606466, 'support': 795}, '17': {'precision': 0.5, 'recall': 0.003676470588235294, 'f1-score': 0.0072992700729927005, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.2857142857142857, 'recall': 0.015267175572519083, 'f1-score': 0.028985507246376805, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.6666666666666666, 'recall': 0.03867403314917127, 'f1-score': 0.07310704960835508, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.29365370506236244, 'recall': 0.06309856934536712, 'f1-score': 0.10387672343876724, 'support': 25373}, 'macro avg': {'precision': 0.2575831921356791, 'recall': 0.06287875283175189, 'f1-score': 0.06839593383406753, 'support': 25373}, 'weighted avg': {'precision': 0.33121117219584406, 'recall': 0.06309856934536712, 'f1-score': 0.07763001284707058, 'support': 25373}, 'samples avg': {'precision': 0.14543095341435186, 'recall': 0.05073602219454701, 'f1-score': 0.06868764970034956, 'support': 25373}}
{'0': {'precision': 0.6578947368421053, 'recall': 0.49909255898366606, 'f1-score': 0.567595459236326, 'support': 551}, '1': {'precision': 0.5641025641025641, 'recall': 0.33690658499234305, 'f1-score': 0.42186001917545546, 'support': 653}, '2': {'precision': 0.5714285714285714, 'recall': 0.009389671361502348, 'f1-score': 0.018475750577367205, 'support': 426}, '3': {'precision': 0.6530612244897959, 'recall': 0.07823960880195599, 'f1-score': 0.13973799126637554, 'support': 409}, '4': {'precision': 0.4583333333333333, 'recall': 0.044897959183673466, 'f1-score': 0.08178438661710037, 'support': 245}, '5': {'precision': 0.7307692307692307, 'recall': 0.05307262569832402, 'f1-score': 0.09895833333333331, 'support': 358}, '6': {'precision': 0.4, 'recall': 0.02459016393442623, 'f1-score': 0.04633204633204633, 'support': 244}, '7': {'precision': 0.648, 'recall': 0.2755102040816326, 'f1-score': 0.38663484486873506, 'support': 294}, '8': {'precision': 1.0, 'recall': 0.0038022813688212928, 'f1-score': 0.007575757575757576, 'support': 263}, '9': {'precision': 0.7735849056603774, 'recall': 0.1474820143884892, 'f1-score': 0.2477341389728097, 'support': 278}, '10': {'precision': 0.2727272727272727, 'recall': 0.014423076923076924, 'f1-score': 0.0273972602739726, 'support': 208}, '11': {'precision': 0.5, 'recall': 0.10441767068273092, 'f1-score': 0.17275747508305647, 'support': 249}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217}, '13': {'precision': 0.4, 'recall': 0.045454545454545456, 'f1-score': 0.0816326530612245, 'support': 132}, '14': {'precision': 0.6231884057971014, 'recall': 0.1902654867256637, 'f1-score': 0.29152542372881357, 'support': 226}, '15': {'precision': 0.7647058823529411, 'recall': 0.49523809523809526, 'f1-score': 0.6011560693641619, 'support': 105}, '16': {'precision': 0.5, 'recall': 0.1323529411764706, 'f1-score': 0.20930232558139536, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.6157237325495959, 'recall': 0.15544425895010203, 'f1-score': 0.24822274881516587, 'support': 5391}, 'macro avg': {'precision': 0.3807118451001317, 'recall': 0.09820541955981668, 'f1-score': 0.13601839740191723, 'support': 5391}, 'weighted avg': {'precision': 0.5387919146251131, 'recall': 0.15544425895010203, 'f1-score': 0.20803332152184706, 'support': 5391}, 'samples avg': {'precision': 0.24762369791666666, 'recall': 0.16006959945436508, 'f1-score': 0.1773815724206349, 'support': 5391}}