
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_west
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43355863347649576
Train: epoch: 1, loss = 0.4215161497145891
Train: epoch: 1, loss = 0.4155672068397204
Train: epoch: 1, loss = 0.411568132378161
Train: epoch: 1, loss = 0.4094108273684979
Train: epoch: 1, loss = 0.4076764232168595
Train: epoch: 1, loss = 0.40640138528176717
Train: epoch: 1, loss = 0.4049849952198565
Train: epoch: 1, loss = 0.40453945378462475
Train: epoch: 1, loss = 0.403465846568346
Train: epoch: 1, loss = 0.40242284430698916
Train: epoch: 1, loss = 0.4014178641885519
Train: epoch: 1, loss = 0.4000591198985393
Train: epoch: 1, loss = 0.39919865165970153
Train: epoch: 1, loss = 0.3981122204462687
Train: epoch: 1, loss = 0.3967647369671613
Train: epoch: 1, loss = 0.3959740461452919
Train: epoch: 1, loss = 0.3953865247261193
Train:  Epoch 1, Loss=0.395083353490911, AUC-ROC Macro=0.6481890206302046, AUC-ROC Micro=0.7435234858723991
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37341877818107605, AUC-ROC Macro=0.712664674682775, AUC-ROC Micro=0.7788533062951666
Eval task: 2
Eval:  Epoch 1, Loss=0.3487226068973541, AUC-ROC Macro=0.49318060087062365, AUC-ROC Micro=0.5366641662406386
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.3754703717678785
Train: epoch: 2, loss = 0.37420741476118563
Train: epoch: 2, loss = 0.3725800507267316
Train: epoch: 2, loss = 0.3737848060950637
Train: epoch: 2, loss = 0.373476701721549
Train: epoch: 2, loss = 0.37305143469323715
Train: epoch: 2, loss = 0.3725748669568981
Train: epoch: 2, loss = 0.372399665415287
Train: epoch: 2, loss = 0.372215671017766
Train: epoch: 2, loss = 0.37189241529256106
Train: epoch: 2, loss = 0.3723511385714466
Train: epoch: 2, loss = 0.3719037319719791
Train: epoch: 2, loss = 0.37187940423305216
Train: epoch: 2, loss = 0.3717320633573192
Train: epoch: 2, loss = 0.3711297614822785
Train: epoch: 2, loss = 0.3707796362927184
Train: epoch: 2, loss = 0.3704635397081866
Train: epoch: 2, loss = 0.3703241617149777
Train:  Epoch 2, Loss=0.37051605960650325, AUC-ROC Macro=0.7196494053294054, AUC-ROC Micro=0.7881248461246464
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3627309799194336, AUC-ROC Macro=0.7377347375283216, AUC-ROC Micro=0.7965297528021902
Eval task: 2
Eval:  Epoch 2, Loss=0.35190607607364655, AUC-ROC Macro=0.47959564790555964, AUC-ROC Micro=0.5410963863800573
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3702447134256363
Train: epoch: 3, loss = 0.36716835215687754
Train: epoch: 3, loss = 0.3671993861347437
Train: epoch: 3, loss = 0.3661196411401033
Train: epoch: 3, loss = 0.36371271815896034
Train: epoch: 3, loss = 0.3646016488969326
Train: epoch: 3, loss = 0.3644444263407162
Train: epoch: 3, loss = 0.3632558052521199
Train: epoch: 3, loss = 0.36278923021422493
Train: epoch: 3, loss = 0.36277327660471204
Train: epoch: 3, loss = 0.36309100488370116
Train: epoch: 3, loss = 0.3627846561558545
Train: epoch: 3, loss = 0.3628258584210506
Train: epoch: 3, loss = 0.3625287281136428
Train: epoch: 3, loss = 0.3627901678433021
Train: epoch: 3, loss = 0.36238068194594236
Train: epoch: 3, loss = 0.3620581260411178
Train: epoch: 3, loss = 0.3618232957480682
Train:  Epoch 3, Loss=0.36179874475185686, AUC-ROC Macro=0.7403228299222592, AUC-ROC Micro=0.801720314982223
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35894467557470006, AUC-ROC Macro=0.7477348244986163, AUC-ROC Micro=0.8029578201295217
Eval task: 2
Eval:  Epoch 3, Loss=0.3687751144170761, AUC-ROC Macro=0.4830437327416176, AUC-ROC Micro=0.5412624019272922
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3622267536818981
Train: epoch: 4, loss = 0.3620227910578251
Train: epoch: 4, loss = 0.35948473058640956
Train: epoch: 4, loss = 0.35975749529898166
Train: epoch: 4, loss = 0.35769121995568276
Train: epoch: 4, loss = 0.35861950685580574
Train: epoch: 4, loss = 0.35856470511427946
Train: epoch: 4, loss = 0.3569053175672889
Train: epoch: 4, loss = 0.35676901684867013
Train: epoch: 4, loss = 0.35664332868903875
Train: epoch: 4, loss = 0.35683427442881194
Train: epoch: 4, loss = 0.35722255705545347
Train: epoch: 4, loss = 0.3570226586438142
Train: epoch: 4, loss = 0.3567974070778915
Train: epoch: 4, loss = 0.3563627924869458
Train: epoch: 4, loss = 0.3559151234617457
Train: epoch: 4, loss = 0.35628115059260057
Train: epoch: 4, loss = 0.3560757565746705
Train:  Epoch 4, Loss=0.35611464778684143, AUC-ROC Macro=0.7530265375385968, AUC-ROC Micro=0.8100475996422303
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3541290337840716, AUC-ROC Macro=0.754305873784537, AUC-ROC Micro=0.8092770486970298
Eval task: 2
Eval:  Epoch 4, Loss=0.3612528294324875, AUC-ROC Macro=0.47949448610394235, AUC-ROC Micro=0.519860273433
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3546341712027788
Train: epoch: 5, loss = 0.35368308797478676
Train: epoch: 5, loss = 0.35187252084414167
Train: epoch: 5, loss = 0.35143174659460785
Train: epoch: 5, loss = 0.3513778818547726
Train: epoch: 5, loss = 0.35138070708761615
Train: epoch: 5, loss = 0.35176739442561356
Train: epoch: 5, loss = 0.3520378914102912
Train: epoch: 5, loss = 0.35224919006228445
Train: epoch: 5, loss = 0.35188720701634885
Train: epoch: 5, loss = 0.35149877890267156
Train: epoch: 5, loss = 0.35123115984722975
Train: epoch: 5, loss = 0.3511437537922309
Train: epoch: 5, loss = 0.3510775387446795
Train: epoch: 5, loss = 0.35104576151569683
Train: epoch: 5, loss = 0.35102857372723517
Train: epoch: 5, loss = 0.35153722460655606
Train: epoch: 5, loss = 0.3512568437970347
Train:  Epoch 5, Loss=0.35112211914347785, AUC-ROC Macro=0.7633595231240493, AUC-ROC Micro=0.817265757314856
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3508981081346671, AUC-ROC Macro=0.761637986765602, AUC-ROC Micro=0.8147700369644035
Eval task: 2
Eval:  Epoch 5, Loss=0.37887875735759735, AUC-ROC Macro=0.4889100266067247, AUC-ROC Micro=0.5403838658285196
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34334938853979113
Train: epoch: 6, loss = 0.34311336785554886
Train: epoch: 6, loss = 0.34375389801959194
Train: epoch: 6, loss = 0.3468773644044995
Train: epoch: 6, loss = 0.34578048630058766
Train: epoch: 6, loss = 0.3463959136605263
Train: epoch: 6, loss = 0.34655297121831347
Train: epoch: 6, loss = 0.34674969358369706
Train: epoch: 6, loss = 0.34700527225103645
Train: epoch: 6, loss = 0.3470969022959471
Train: epoch: 6, loss = 0.3467995859343897
Train: epoch: 6, loss = 0.3470393984702726
Train: epoch: 6, loss = 0.3468123346624466
Train: epoch: 6, loss = 0.3471226103497403
Train: epoch: 6, loss = 0.346949652304252
Train: epoch: 6, loss = 0.3470813321787864
Train: epoch: 6, loss = 0.3471249404900214
Train: epoch: 6, loss = 0.3474799303958813
Train:  Epoch 6, Loss=0.3475117995107276, AUC-ROC Macro=0.7708338334483943, AUC-ROC Micro=0.8222811760191746
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3497950422267119, AUC-ROC Macro=0.7636636413428576, AUC-ROC Micro=0.8161907711323809
Eval task: 2
Eval:  Epoch 6, Loss=0.3959420919418335, AUC-ROC Macro=0.4862086906314292, AUC-ROC Micro=0.5308646218384342
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35233263298869133, AUC-ROC Macro=0.7635531754258702, AUC-ROC Micro=0.8151322274933435
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.39492540061473846, AUC-ROC Macro=0.4688615278380959, AUC-ROC Micro=0.5274352138003437
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3125623567402363
Train: epoch: 1, loss = 0.3052230902761221
Train: epoch: 1, loss = 0.29263763631383577
Train:  Epoch 1, Loss=0.28480606951477094, AUC-ROC Macro=0.5459610153688427, AUC-ROC Micro=0.7315415699556883
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3607679220537345, AUC-ROC Macro=0.7502082661956513, AUC-ROC Micro=0.8021466206123036
Eval task: 2
Eval:  Epoch 1, Loss=0.2811269201338291, AUC-ROC Macro=0.6360609917727658, AUC-ROC Micro=0.7802595665184993
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.28645980909466745
Train: epoch: 2, loss = 0.28769837379455565
Train: epoch: 2, loss = 0.2768585555503766
Train:  Epoch 2, Loss=0.27055497161359326, AUC-ROC Macro=0.6397652502401617, AUC-ROC Micro=0.7954204970974382
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.35725586861371994, AUC-ROC Macro=0.7489668963217804, AUC-ROC Micro=0.8005184712290072
Eval task: 2
Eval:  Epoch 2, Loss=0.2785523124039173, AUC-ROC Macro=0.67020266836658, AUC-ROC Micro=0.7969572628882097
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.27939461745321753
Train: epoch: 3, loss = 0.2809018774330616
Train: epoch: 3, loss = 0.27010655018190544
Train:  Epoch 3, Loss=0.26455290916835966, AUC-ROC Macro=0.6886050793361457, AUC-ROC Micro=0.8137105919486467
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3495105442901452, AUC-ROC Macro=0.7524062591366323, AUC-ROC Micro=0.8061935339045267
Eval task: 2
Eval:  Epoch 3, Loss=0.27330178022384644, AUC-ROC Macro=0.6885729508841242, AUC-ROC Micro=0.8056464609946813
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.27708518780767916
Train: epoch: 4, loss = 0.2762521501630545
Train: epoch: 4, loss = 0.26621244286497436
Train:  Epoch 4, Loss=0.2602331229971147, AUC-ROC Macro=0.7242601806067493, AUC-ROC Micro=0.8249626655444106
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.34719544276595116, AUC-ROC Macro=0.7523111089031269, AUC-ROC Micro=0.8058178441869696
Eval task: 2
Eval:  Epoch 4, Loss=0.2725232280790806, AUC-ROC Macro=0.691406460412317, AUC-ROC Micro=0.809272758256582
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.272233559563756
Train: epoch: 5, loss = 0.2723907681182027
Train: epoch: 5, loss = 0.2626122134799759
Train:  Epoch 5, Loss=0.25593634896163403, AUC-ROC Macro=0.7403491815416824, AUC-ROC Micro=0.8324164157499692
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3431307089825471, AUC-ROC Macro=0.7488708017924403, AUC-ROC Micro=0.8041174909428761
Eval task: 2
Eval:  Epoch 5, Loss=0.27034175023436546, AUC-ROC Macro=0.6872025710627969, AUC-ROC Micro=0.8152802998812431
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2663254169374704
Train: epoch: 6, loss = 0.26851328283548354
Train: epoch: 6, loss = 0.2586078376074632
Train:  Epoch 6, Loss=0.25318156296931366, AUC-ROC Macro=0.7532052737542826, AUC-ROC Micro=0.8394104657868082
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.34446848432223004, AUC-ROC Macro=0.7471296896146769, AUC-ROC Micro=0.8010607287384311
Eval task: 2
Eval:  Epoch 6, Loss=0.27134693413972855, AUC-ROC Macro=0.7027706337890351, AUC-ROC Micro=0.8156649089361829
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.367016972353061, AUC-ROC Macro=0.7448857381680649, AUC-ROC Micro=0.8003208981164847
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2227087765932083, AUC-ROC Macro=0.712181351942787, AUC-ROC Micro=0.8103758874692365
{'0': {'precision': 0.5145833333333333, 'recall': 0.37767584097859325, 'f1-score': 0.4356261022927689, 'support': 1308}, '1': {'precision': 0.7569444444444444, 'recall': 0.27114427860696516, 'f1-score': 0.3992673992673993, 'support': 402}, '2': {'precision': 0.48, 'recall': 0.0729483282674772, 'f1-score': 0.12664907651715038, 'support': 658}, '3': {'precision': 0.5207631874298541, 'recall': 0.23316582914572864, 'f1-score': 0.3221103783408539, 'support': 1990}, '4': {'precision': 0.4793650793650794, 'recall': 0.18734491315136476, 'f1-score': 0.2694023193577163, 'support': 806}, '5': {'precision': 0.3125, 'recall': 0.012853470437017995, 'f1-score': 0.024691358024691357, 'support': 778}, '6': {'precision': 0.5826771653543307, 'recall': 0.11367127496159754, 'f1-score': 0.19023136246786632, 'support': 1302}, '7': {'precision': 0.23076923076923078, 'recall': 0.007075471698113208, 'f1-score': 0.013729977116704805, 'support': 424}, '8': {'precision': 0.5049668874172185, 'recall': 0.3710462287104623, 'f1-score': 0.4277699859747546, 'support': 1644}, '9': {'precision': 0.6392638036809816, 'recall': 0.5130477597242737, 'f1-score': 0.5692433761267413, 'support': 2031}, '10': {'precision': 0.6174496644295302, 'recall': 0.32111692844677137, 'f1-score': 0.42250287026406425, 'support': 573}, '11': {'precision': 0.4458128078817734, 'recall': 0.3078231292517007, 'f1-score': 0.3641851106639839, 'support': 1176}, '12': {'precision': 0.5792759051186017, 'recall': 0.2621468926553672, 'f1-score': 0.3609490470633995, 'support': 1770}, '13': {'precision': 0.606993006993007, 'recall': 0.33436055469953774, 'f1-score': 0.431197218082464, 'support': 2596}, '14': {'precision': 0.5446224256292906, 'recall': 0.29256299938537184, 'f1-score': 0.38064774090363857, 'support': 1627}, '15': {'precision': 0.16666666666666666, 'recall': 0.004132231404958678, 'f1-score': 0.008064516129032258, 'support': 484}, '16': {'precision': 0.4329501915708812, 'recall': 0.1421383647798742, 'f1-score': 0.21401515151515152, 'support': 795}, '17': {'precision': 0.4166666666666667, 'recall': 0.04595588235294118, 'f1-score': 0.08278145695364239, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.6666666666666666, 'recall': 0.030534351145038167, 'f1-score': 0.0583941605839416, 'support': 262}, '20': {'precision': 0.15789473684210525, 'recall': 0.0053285968028419185, 'f1-score': 0.010309278350515464, 'support': 563}, '21': {'precision': 0.5061425061425061, 'recall': 0.24611708482676226, 'f1-score': 0.33118971061093244, 'support': 837}, '22': {'precision': 0.6659217877094972, 'recall': 0.5488029465930019, 'f1-score': 0.6017163048965168, 'support': 1086}, '23': {'precision': 0.5711340206185567, 'recall': 0.32171893147502906, 'f1-score': 0.41158989598811296, 'support': 861}, '24': {'precision': 0.4772727272727273, 'recall': 0.3326732673267327, 'f1-score': 0.3920653442240373, 'support': 505}, 'micro avg': {'precision': 0.5569506726457399, 'recall': 0.26922319000512357, 'f1-score': 0.36298421807747494, 'support': 25373}, 'macro avg': {'precision': 0.475092116480118, 'recall': 0.21421542227310092, 'f1-score': 0.2739331656686432, 'support': 25373}, 'weighted avg': {'precision': 0.5164529159621475, 'recall': 0.26922319000512357, 'f1-score': 0.33795996130082184, 'support': 25373}, 'samples avg': {'precision': 0.3749455283757041, 'recall': 0.2335833772687518, 'f1-score': 0.2638103219654125, 'support': 25373}}
{'0': {'precision': 0.5918367346938775, 'recall': 0.29591836734693877, 'f1-score': 0.3945578231292517, 'support': 196}, '1': {'precision': 0.46703296703296704, 'recall': 0.35269709543568467, 'f1-score': 0.4018912529550828, 'support': 241}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 145}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 118}, '4': {'precision': 0.603448275862069, 'recall': 0.16826923076923078, 'f1-score': 0.2631578947368421, 'support': 208}, '5': {'precision': 0.2222222222222222, 'recall': 0.02, 'f1-score': 0.03669724770642202, 'support': 100}, '6': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 110}, '7': {'precision': 0.9333333333333333, 'recall': 0.21052631578947367, 'f1-score': 0.34355828220858897, 'support': 133}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 89}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '11': {'precision': 0.25, 'recall': 0.011627906976744186, 'f1-score': 0.02222222222222222, 'support': 86}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 87}, '13': {'precision': 0.3, 'recall': 0.0410958904109589, 'f1-score': 0.07228915662650602, 'support': 73}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 45}, '15': {'precision': 0.7272727272727273, 'recall': 0.6274509803921569, 'f1-score': 0.6736842105263158, 'support': 51}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1}, 'micro avg': {'precision': 0.5609195402298851, 'recall': 0.12236710130391174, 'f1-score': 0.20090572251955538, 'support': 1994}, 'macro avg': {'precision': 0.16380585041668788, 'recall': 0.06910343148484752, 'f1-score': 0.08832232360444926, 'support': 1994}, 'weighted avg': {'precision': 0.29133332551691077, 'recall': 0.12236710130391174, 'f1-score': 0.16039872516892886, 'support': 1994}, 'samples avg': {'precision': 0.22078450520833334, 'recall': 0.1464541480654762, 'f1-score': 0.1647677951388889, 'support': 1994}}