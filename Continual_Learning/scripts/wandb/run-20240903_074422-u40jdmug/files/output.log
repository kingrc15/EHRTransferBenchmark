Experiment dir: ./exp/Test_phen_west_baseline
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4332319216430187
Train: epoch: 1, loss = 0.4259147348999977
Train: epoch: 1, loss = 0.41856463049848874
Train: epoch: 1, loss = 0.41484648214653136
Train: epoch: 1, loss = 0.41194127924740315
Train: epoch: 1, loss = 0.40992665200183787
Train: epoch: 1, loss = 0.40790984203772884
Train: epoch: 1, loss = 0.40624130601994696
Train: epoch: 1, loss = 0.4049401315136088
Train: epoch: 1, loss = 0.40312392842024564
Train: epoch: 1, loss = 0.40247056583789265
Train: epoch: 1, loss = 0.40145140992477535
Train: epoch: 1, loss = 0.40005460063425397
Train: epoch: 1, loss = 0.398817009697003
Train: epoch: 1, loss = 0.39763189673423766
Train: epoch: 1, loss = 0.3961977971019223
Train: epoch: 1, loss = 0.395260324727963
Train: epoch: 1, loss = 0.39417911011725665
Train:  Epoch 1, Loss=0.39376414191417203, AUC-ROC Macro=0.6527265894255504, AUC-ROC Micro=0.7458438018522
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3730732649564743, AUC-ROC Macro=0.7137880544897527, AUC-ROC Micro=0.7784970156422084
Eval task: 2
Eval:  Epoch 1, Loss=0.3317403942346573, AUC-ROC Macro=0.5017291740869667, AUC-ROC Micro=0.5209704201193516
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37555082932114603
Train: epoch: 2, loss = 0.3740225673466921
Train: epoch: 2, loss = 0.37491339894632497
Train: epoch: 2, loss = 0.37280184479430317
Train: epoch: 2, loss = 0.37302596227824686
Train: epoch: 2, loss = 0.37342971794307234
Train: epoch: 2, loss = 0.37259969672986437
Train: epoch: 2, loss = 0.3730397748481482
Train: epoch: 2, loss = 0.372444227197104
Train: epoch: 2, loss = 0.3719317630454898
Train: epoch: 2, loss = 0.3717022391544147
Train: epoch: 2, loss = 0.3707727035693824
Train: epoch: 2, loss = 0.3705443329478686
Train: epoch: 2, loss = 0.37015330513140987
Train: epoch: 2, loss = 0.370222276593248
Train: epoch: 2, loss = 0.37007390283979474
Train: epoch: 2, loss = 0.37005538283463785
Train: epoch: 2, loss = 0.3693994276184175
Train:  Epoch 2, Loss=0.3692390500704447, AUC-ROC Macro=0.7228661066603845, AUC-ROC Micro=0.7902600652435128
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36211983611186344, AUC-ROC Macro=0.7398319332848794, AUC-ROC Micro=0.7988639416449363
Eval task: 2
Eval:  Epoch 2, Loss=0.3266134709119797, AUC-ROC Macro=0.4819066455663109, AUC-ROC Micro=0.5072621609095818
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3706532659381628
Train: epoch: 3, loss = 0.36553286127746104
Train: epoch: 3, loss = 0.36290711743136245
Train: epoch: 3, loss = 0.3619312261790037
Train: epoch: 3, loss = 0.362256928011775
Train: epoch: 3, loss = 0.36229586927841106
Train: epoch: 3, loss = 0.3615004686798368
Train: epoch: 3, loss = 0.3616077397111803
Train: epoch: 3, loss = 0.3612653833048211
Train: epoch: 3, loss = 0.3606648026034236
Train: epoch: 3, loss = 0.36086753801188687
Train: epoch: 3, loss = 0.3609503682392339
Train: epoch: 3, loss = 0.36081575073874916
Train: epoch: 3, loss = 0.36038868536374397
Train: epoch: 3, loss = 0.3604061035066843
Train: epoch: 3, loss = 0.3602458739373833
Train: epoch: 3, loss = 0.36037062066004555
Train: epoch: 3, loss = 0.3605593112938934
Train:  Epoch 3, Loss=0.36066183739238317, AUC-ROC Macro=0.7426726291456075, AUC-ROC Micro=0.8032628911203172
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35665518417954445, AUC-ROC Macro=0.7491627211978528, AUC-ROC Micro=0.8060357118585222
Eval task: 2
Eval:  Epoch 3, Loss=0.36417968571186066, AUC-ROC Macro=0.48413415358926926, AUC-ROC Micro=0.516447749324593
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.355625491514802
Train: epoch: 4, loss = 0.3557386514171958
Train: epoch: 4, loss = 0.3525821133454641
Train: epoch: 4, loss = 0.35065550230443476
Train: epoch: 4, loss = 0.35204092432558537
Train: epoch: 4, loss = 0.3523905476431052
Train: epoch: 4, loss = 0.35307585845036166
Train: epoch: 4, loss = 0.3537684058677405
Train: epoch: 4, loss = 0.3541318151603142
Train: epoch: 4, loss = 0.35422371136397124
Train: epoch: 4, loss = 0.3548961351066828
Train: epoch: 4, loss = 0.35531799770270783
Train: epoch: 4, loss = 0.35563381101649544
Train: epoch: 4, loss = 0.35526492100208995
Train: epoch: 4, loss = 0.35487794856727123
Train: epoch: 4, loss = 0.3546700308704749
Train: epoch: 4, loss = 0.3546837570342947
Train: epoch: 4, loss = 0.3544866311508748
Train:  Epoch 4, Loss=0.3544672955997989, AUC-ROC Macro=0.7558670609316553, AUC-ROC Micro=0.8123473798605839
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35432031253973645, AUC-ROC Macro=0.7551664788924648, AUC-ROC Micro=0.8096736863246692
Eval task: 2
Eval:  Epoch 4, Loss=0.36827895045280457, AUC-ROC Macro=0.49845534061749547, AUC-ROC Micro=0.5382343276110207
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3503600959479809
Train: epoch: 5, loss = 0.3485702492669225
Train: epoch: 5, loss = 0.35134729710717993
Train: epoch: 5, loss = 0.3522464371100068
Train: epoch: 5, loss = 0.3516070958375931
Train: epoch: 5, loss = 0.35205941994984946
Train: epoch: 5, loss = 0.35138764749680246
Train: epoch: 5, loss = 0.3510226344037801
Train: epoch: 5, loss = 0.35077170762750837
Train: epoch: 5, loss = 0.35094334042817354
Train: epoch: 5, loss = 0.3505009505017237
Train: epoch: 5, loss = 0.35027551554143427
Train: epoch: 5, loss = 0.3502501178876712
Train: epoch: 5, loss = 0.3500665385009987
Train: epoch: 5, loss = 0.35011329855024814
Train: epoch: 5, loss = 0.34996677150949834
Train: epoch: 5, loss = 0.3501287646197221
Train: epoch: 5, loss = 0.35031372897326946
Train:  Epoch 5, Loss=0.3503072065573472, AUC-ROC Macro=0.7647398240355656, AUC-ROC Micro=0.8182641376369262
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3515604722003142, AUC-ROC Macro=0.7606171198174542, AUC-ROC Micro=0.8132707480171986
Eval task: 2
Eval:  Epoch 5, Loss=0.3893089219927788, AUC-ROC Macro=0.49834874509126004, AUC-ROC Micro=0.5486600848658397
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3436509893834591
Train: epoch: 6, loss = 0.34773647267371416
Train: epoch: 6, loss = 0.3484309236705303
Train: epoch: 6, loss = 0.3484230654686689
Train: epoch: 6, loss = 0.347087838858366
Train: epoch: 6, loss = 0.34765699623773494
Train: epoch: 6, loss = 0.34718067123421603
Train: epoch: 6, loss = 0.3472929438296706
Train: epoch: 6, loss = 0.3468757626745436
Train: epoch: 6, loss = 0.3460419926866889
Train: epoch: 6, loss = 0.3460373422232541
Train: epoch: 6, loss = 0.34640074961508316
Train: epoch: 6, loss = 0.3466172744333744
Train: epoch: 6, loss = 0.3465369498995798
Train: epoch: 6, loss = 0.34657690158983073
Train: epoch: 6, loss = 0.3467351140873507
Train: epoch: 6, loss = 0.3468234789064702
Train: epoch: 6, loss = 0.34700785601304635
Train:  Epoch 6, Loss=0.34685329773690965, AUC-ROC Macro=0.7713713233762479, AUC-ROC Micro=0.8229601344403654
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3505964055657387, AUC-ROC Macro=0.7624276455155368, AUC-ROC Micro=0.8152196828895869
Eval task: 2
Eval:  Epoch 6, Loss=0.3897985443472862, AUC-ROC Macro=0.5090029158336773, AUC-ROC Micro=0.5332998987619441
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3532491351167361, AUC-ROC Macro=0.762527693571935, AUC-ROC Micro=0.8143498623087922
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3878730982542038, AUC-ROC Macro=0.49666339265213233, AUC-ROC Micro=0.5322641439526578
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.2659142445772886
Train: epoch: 1, loss = 0.2525252406671643
Train: epoch: 1, loss = 0.24716707214713096
Train:  Epoch 1, Loss=0.24491843802751032, AUC-ROC Macro=0.563041700890839, AUC-ROC Micro=0.7523860643322067
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.46521292875210446, AUC-ROC Macro=0.6884947025177443, AUC-ROC Micro=0.6887212175329734
Eval task: 2
Eval:  Epoch 1, Loss=0.230665173381567, AUC-ROC Macro=0.6474037834073278, AUC-ROC Micro=0.7918081902489755
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2317390188574791
Train: epoch: 2, loss = 0.22749593317508698
Train: epoch: 2, loss = 0.22479689446588358
Train:  Epoch 2, Loss=0.22468670531497206, AUC-ROC Macro=0.6780072980811859, AUC-ROC Micro=0.8098210334789366
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.48283793528874713, AUC-ROC Macro=0.660290227123603, AUC-ROC Micro=0.6689247320357379
Eval task: 2
Eval:  Epoch 2, Loss=0.22409938648343086, AUC-ROC Macro=0.6855046499177044, AUC-ROC Micro=0.8075568714202367
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2207427616417408
Train: epoch: 3, loss = 0.2208090453594923
Train: epoch: 3, loss = 0.2178387453407049
Train:  Epoch 3, Loss=0.21815064327081188, AUC-ROC Macro=0.7269624716881803, AUC-ROC Micro=0.8253444663291961
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5049805579086145, AUC-ROC Macro=0.638439340671143, AUC-ROC Micro=0.6563047804842019
Eval task: 2
Eval:  Epoch 3, Loss=0.22148795425891876, AUC-ROC Macro=0.7119111038918252, AUC-ROC Micro=0.815352477784166
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.21420253049582244
Train: epoch: 4, loss = 0.21419566752389074
Train: epoch: 4, loss = 0.2136377042159438
Train:  Epoch 4, Loss=0.21380000439581814, AUC-ROC Macro=0.7430738684725356, AUC-ROC Micro=0.8340851988464064
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5049593212703863, AUC-ROC Macro=0.6244832312183319, AUC-ROC Micro=0.649558066527461
Eval task: 2
Eval:  Epoch 4, Loss=0.22140636667609215, AUC-ROC Macro=0.711962519917605, AUC-ROC Micro=0.8159236685231401
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.21166060686111451
Train: epoch: 5, loss = 0.2093104686588049
Train: epoch: 5, loss = 0.20960329907635847
Train:  Epoch 5, Loss=0.21003782047913008, AUC-ROC Macro=0.7623382768255895, AUC-ROC Micro=0.8422078852333854
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.5259149149060249, AUC-ROC Macro=0.6131947119898883, AUC-ROC Micro=0.6367344147855561
Eval task: 2
Eval:  Epoch 5, Loss=0.22188768908381462, AUC-ROC Macro=0.7123368060472629, AUC-ROC Micro=0.8156269300661099
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.207383481413126
Train: epoch: 6, loss = 0.2063536872714758
Train: epoch: 6, loss = 0.20641584817320108
Train:  Epoch 6, Loss=0.20625976453975073, AUC-ROC Macro=0.7798590123655516, AUC-ROC Micro=0.8501078007352432
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5305762278536955, AUC-ROC Macro=0.6060530711313267, AUC-ROC Micro=0.6316782892680569
Eval task: 2
Eval:  Epoch 6, Loss=0.2199459783732891, AUC-ROC Macro=0.7222351639478957, AUC-ROC Micro=0.821415867565546
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5315653085708618, AUC-ROC Macro=0.6119726491512084, AUC-ROC Micro=0.6348316795859549
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.22072513028979301, AUC-ROC Macro=0.7380554560784236, AUC-ROC Micro=0.8172039204965571
{'0': {'precision': 0.32670237184391737, 'recall': 0.3264525993883792, 'f1-score': 0.3265774378585086, 'support': 1308}, '1': {'precision': 0.3333333333333333, 'recall': 0.1691542288557214, 'f1-score': 0.2244224422442244, 'support': 402}, '2': {'precision': 0.5, 'recall': 0.00303951367781155, 'f1-score': 0.006042296072507553, 'support': 658}, '3': {'precision': 0.4375, 'recall': 0.0035175879396984926, 'f1-score': 0.006979062811565305, 'support': 1990}, '4': {'precision': 0.1901323706377858, 'recall': 0.19602977667493796, 'f1-score': 0.19303604153940132, 'support': 806}, '5': {'precision': 0.17647058823529413, 'recall': 0.011568123393316195, 'f1-score': 0.02171290711700844, 'support': 778}, '6': {'precision': 0.36, 'recall': 0.1175115207373272, 'f1-score': 0.17718587145338738, 'support': 1302}, '7': {'precision': 0.05, 'recall': 0.02830188679245283, 'f1-score': 0.03614457831325301, 'support': 424}, '8': {'precision': 0.9230769230769231, 'recall': 0.0072992700729927005, 'f1-score': 0.01448400724200362, 'support': 1644}, '9': {'precision': 0.8, 'recall': 0.0019694731659281144, 'f1-score': 0.003929273084479372, 'support': 2031}, '10': {'precision': 0.55, 'recall': 0.019197207678883072, 'f1-score': 0.03709949409780775, 'support': 573}, '11': {'precision': 0.5373134328358209, 'recall': 0.030612244897959183, 'f1-score': 0.057924376508447305, 'support': 1176}, '12': {'precision': 0.16666666666666666, 'recall': 0.0005649717514124294, 'f1-score': 0.0011261261261261261, 'support': 1770}, '13': {'precision': 0.3776041666666667, 'recall': 0.05585516178736518, 'f1-score': 0.09731543624161075, 'support': 2596}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1627}, '15': {'precision': 0.13114754098360656, 'recall': 0.01652892561983471, 'f1-score': 0.029357798165137616, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 1.0, 'recall': 0.001838235294117647, 'f1-score': 0.0036697247706422016, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.2895604395604396, 'recall': 0.041540219918811336, 'f1-score': 0.07265708475510978, 'support': 25373}, 'macro avg': {'precision': 0.2743978957712006, 'recall': 0.03957762910912552, 'f1-score': 0.04948027494584442, 'support': 25373}, 'weighted avg': {'precision': 0.33553452078229135, 'recall': 0.041540219918811336, 'f1-score': 0.05303846735162504, 'support': 25373}, 'samples avg': {'precision': 0.09781494140624998, 'recall': 0.029739051611897428, 'f1-score': 0.042647310770443814, 'support': 25373}}
{'0': {'precision': 0.5798319327731093, 'recall': 0.3520408163265306, 'f1-score': 0.4380952380952381, 'support': 196}, '1': {'precision': 0.4863013698630137, 'recall': 0.2946058091286307, 'f1-score': 0.3669250645994832, 'support': 241}, '2': {'precision': 0.5, 'recall': 0.020689655172413793, 'f1-score': 0.03973509933774834, 'support': 145}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 118}, '4': {'precision': 0.6470588235294118, 'recall': 0.10576923076923077, 'f1-score': 0.18181818181818185, 'support': 208}, '5': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 100}, '6': {'precision': 0.7142857142857143, 'recall': 0.045454545454545456, 'f1-score': 0.08547008547008549, 'support': 110}, '7': {'precision': 0.9375, 'recall': 0.22556390977443608, 'f1-score': 0.36363636363636365, 'support': 133}, '8': {'precision': 1.0, 'recall': 0.011235955056179775, 'f1-score': 0.02222222222222222, 'support': 89}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '11': {'precision': 1.0, 'recall': 0.023255813953488372, 'f1-score': 0.04545454545454545, 'support': 86}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 87}, '13': {'precision': 0.38461538461538464, 'recall': 0.0684931506849315, 'f1-score': 0.11627906976744186, 'support': 73}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 45}, '15': {'precision': 0.673469387755102, 'recall': 0.6470588235294118, 'f1-score': 0.66, 'support': 51}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1}, 'micro avg': {'precision': 0.5835351089588378, 'recall': 0.12086258776328987, 'f1-score': 0.2002492729538845, 'support': 1994}, 'macro avg': {'precision': 0.2769225045128694, 'recall': 0.07176670839399195, 'f1-score': 0.0927854348160524, 'support': 1994}, 'weighted avg': {'precision': 0.4406302480834981, 'recall': 0.12086258776328987, 'f1-score': 0.16232495737338778, 'support': 1994}, 'samples avg': {'precision': 0.20646158854166666, 'recall': 0.14160388764880952, 'f1-score': 0.157958984375, 'support': 1994}}