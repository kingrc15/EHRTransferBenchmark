Experiment dir: ./exp/Test_phen_northeast_baseline
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.42930489614605905
Train: epoch: 1, loss = 0.4184896419197321
Train: epoch: 1, loss = 0.41497634013493856
Train: epoch: 1, loss = 0.41188208270817994
Train: epoch: 1, loss = 0.4107622219622135
Train: epoch: 1, loss = 0.408873724018534
Train: epoch: 1, loss = 0.4075214766391686
Train: epoch: 1, loss = 0.40592201162129643
Train: epoch: 1, loss = 0.4037496213697725
Train: epoch: 1, loss = 0.4018880785703659
Train: epoch: 1, loss = 0.399980235140432
Train: epoch: 1, loss = 0.3983689875031511
Train: epoch: 1, loss = 0.39693669356978856
Train: epoch: 1, loss = 0.3958230483531952
Train: epoch: 1, loss = 0.39477591308454674
Train: epoch: 1, loss = 0.3938950363686308
Train: epoch: 1, loss = 0.3929076439449016
Train: epoch: 1, loss = 0.3914237281638715
Train:  Epoch 1, Loss=0.3911146033645695, AUC-ROC Macro=0.6623970378615358, AUC-ROC Micro=0.7510240687724177
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.36988560979564983, AUC-ROC Macro=0.7211908671298805, AUC-ROC Micro=0.7850139939648528
Eval task: 2
Eval:  Epoch 1, Loss=0.3937806636095047, AUC-ROC Macro=0.4905193328701425, AUC-ROC Micro=0.5818670542699456
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.374202948063612
Train: epoch: 2, loss = 0.37205265820026395
Train: epoch: 2, loss = 0.37107402411599955
Train: epoch: 2, loss = 0.3702177990041673
Train: epoch: 2, loss = 0.3706241379082203
Train: epoch: 2, loss = 0.3712324929609895
Train: epoch: 2, loss = 0.37150850723896706
Train: epoch: 2, loss = 0.370801731524989
Train: epoch: 2, loss = 0.36968206367558903
Train: epoch: 2, loss = 0.3693792943507433
Train: epoch: 2, loss = 0.36995276054875414
Train: epoch: 2, loss = 0.37005811228727303
Train: epoch: 2, loss = 0.36907120412358874
Train: epoch: 2, loss = 0.36908821015485693
Train: epoch: 2, loss = 0.3687342554529508
Train: epoch: 2, loss = 0.3682840554555878
Train: epoch: 2, loss = 0.367919793764458
Train: epoch: 2, loss = 0.36776713005784484
Train:  Epoch 2, Loss=0.3677308724843539, AUC-ROC Macro=0.7260845428186063, AUC-ROC Micro=0.7924583650306006
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36331014707684517, AUC-ROC Macro=0.737450330642155, AUC-ROC Micro=0.7959372622816918
Eval task: 2
Eval:  Epoch 2, Loss=0.4184868335723877, AUC-ROC Macro=0.48354070974396435, AUC-ROC Micro=0.5802464736741418
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3615624384582043
Train: epoch: 3, loss = 0.36134340077638627
Train: epoch: 3, loss = 0.36210061214864253
Train: epoch: 3, loss = 0.36358870988711717
Train: epoch: 3, loss = 0.3613721744567156
Train: epoch: 3, loss = 0.36196405854076147
Train: epoch: 3, loss = 0.36220273465982505
Train: epoch: 3, loss = 0.36198139497078957
Train: epoch: 3, loss = 0.3618593834588925
Train: epoch: 3, loss = 0.3614137557148933
Train: epoch: 3, loss = 0.36122379710051145
Train: epoch: 3, loss = 0.3615514656094213
Train: epoch: 3, loss = 0.3619090433590687
Train: epoch: 3, loss = 0.3619111157740865
Train: epoch: 3, loss = 0.36146993966400626
Train: epoch: 3, loss = 0.36067627446725964
Train: epoch: 3, loss = 0.3603387489345144
Train: epoch: 3, loss = 0.36027743049793776
Train:  Epoch 3, Loss=0.36012735984468053, AUC-ROC Macro=0.7438817362537578, AUC-ROC Micro=0.8041147521051575
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.35747213537494343, AUC-ROC Macro=0.7466747191970551, AUC-ROC Micro=0.8042221825284387
Eval task: 2
Eval:  Epoch 3, Loss=0.4264685660600662, AUC-ROC Macro=0.4802937555394675, AUC-ROC Micro=0.5698212248608483
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3482495003938675
Train: epoch: 4, loss = 0.3520007216930389
Train: epoch: 4, loss = 0.353305487309893
Train: epoch: 4, loss = 0.35289741326123475
Train: epoch: 4, loss = 0.35388555300235747
Train: epoch: 4, loss = 0.3535136698807279
Train: epoch: 4, loss = 0.3532619082821267
Train: epoch: 4, loss = 0.3534513902757317
Train: epoch: 4, loss = 0.3529422627803352
Train: epoch: 4, loss = 0.3538211668431759
Train: epoch: 4, loss = 0.35427400904622947
Train: epoch: 4, loss = 0.3540429541096091
Train: epoch: 4, loss = 0.3542224069398183
Train: epoch: 4, loss = 0.35452023605150834
Train: epoch: 4, loss = 0.3543449896723032
Train: epoch: 4, loss = 0.35425206357147543
Train: epoch: 4, loss = 0.3544248686555554
Train: epoch: 4, loss = 0.35461222480154697
Train:  Epoch 4, Loss=0.3546005286110772, AUC-ROC Macro=0.7563875926310518, AUC-ROC Micro=0.81230768645177
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3537215267618497, AUC-ROC Macro=0.7551520982013273, AUC-ROC Micro=0.8106281026692597
Eval task: 2
Eval:  Epoch 4, Loss=0.4296426922082901, AUC-ROC Macro=0.49278884257204486, AUC-ROC Micro=0.5769920784544535
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.35116996482014656
Train: epoch: 5, loss = 0.3481758498772979
Train: epoch: 5, loss = 0.3484373240421216
Train: epoch: 5, loss = 0.34937009470537306
Train: epoch: 5, loss = 0.3484275323450565
Train: epoch: 5, loss = 0.34863642531136674
Train: epoch: 5, loss = 0.3493293676525354
Train: epoch: 5, loss = 0.349967421842739
Train: epoch: 5, loss = 0.35004644586808153
Train: epoch: 5, loss = 0.3508644056171179
Train: epoch: 5, loss = 0.35084922891448844
Train: epoch: 5, loss = 0.3503760542348027
Train: epoch: 5, loss = 0.3503209031373262
Train: epoch: 5, loss = 0.34991025602178916
Train: epoch: 5, loss = 0.3498385913819075
Train: epoch: 5, loss = 0.3498623425047845
Train: epoch: 5, loss = 0.3502708505444667
Train: epoch: 5, loss = 0.35015127441535393
Train:  Epoch 5, Loss=0.3502336207597684, AUC-ROC Macro=0.7651789904092801, AUC-ROC Micro=0.8184992737409565
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35369018465280533, AUC-ROC Macro=0.7567342964065447, AUC-ROC Micro=0.8116142034438296
Eval task: 2
Eval:  Epoch 5, Loss=0.44039463996887207, AUC-ROC Macro=0.4909564806882824, AUC-ROC Micro=0.585838981007572
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34248764149844646
Train: epoch: 6, loss = 0.3436724292859435
Train: epoch: 6, loss = 0.34306164080897966
Train: epoch: 6, loss = 0.345061126165092
Train: epoch: 6, loss = 0.34604156582057477
Train: epoch: 6, loss = 0.3453175765648484
Train: epoch: 6, loss = 0.3457160459991012
Train: epoch: 6, loss = 0.346119634360075
Train: epoch: 6, loss = 0.34623964914845096
Train: epoch: 6, loss = 0.3462684888392687
Train: epoch: 6, loss = 0.34701825044371865
Train: epoch: 6, loss = 0.3467095826442043
Train: epoch: 6, loss = 0.34676744039815205
Train: epoch: 6, loss = 0.3471946392580867
Train: epoch: 6, loss = 0.34702407811085384
Train: epoch: 6, loss = 0.346847886107862
Train: epoch: 6, loss = 0.34674369695870316
Train: epoch: 6, loss = 0.3471120259828038
Train:  Epoch 6, Loss=0.34700976048167953, AUC-ROC Macro=0.7715839589851556, AUC-ROC Micro=0.8228721503766363
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3503798382977645, AUC-ROC Macro=0.7640961265032382, AUC-ROC Micro=0.8154626527858806
Eval task: 2
Eval:  Epoch 6, Loss=0.5287296175956726, AUC-ROC Macro=0.5021819899851121, AUC-ROC Micro=0.5863279165461587
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35308249294757843, AUC-ROC Macro=0.764519408858342, AUC-ROC Micro=0.8147984677654295
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.49693459272384644, AUC-ROC Macro=0.4812434944455215, AUC-ROC Micro=0.5930138936971034
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3324518042802811
Train:  Epoch 1, Loss=0.32050705490168835, AUC-ROC Macro=0.5848999217204416, AUC-ROC Micro=0.7486287408503322
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4230612094203631, AUC-ROC Macro=0.7047305341962332, AUC-ROC Micro=0.69629846379001
Eval task: 2
Eval:  Epoch 1, Loss=0.2918437123298645, AUC-ROC Macro=0.6690189995976319, AUC-ROC Micro=0.7947996720855037
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.28806239046156407
Train:  Epoch 2, Loss=0.28581474162378406, AUC-ROC Macro=0.691028370003909, AUC-ROC Micro=0.8153016987644968
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.454401608556509, AUC-ROC Macro=0.6677092884809329, AUC-ROC Micro=0.6535708873680592
Eval task: 2
Eval:  Epoch 2, Loss=0.2804270088672638, AUC-ROC Macro=0.7124338084560451, AUC-ROC Micro=0.8184909337260976
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.27771071434020994
Train:  Epoch 3, Loss=0.273894711185865, AUC-ROC Macro=0.7335811300468282, AUC-ROC Micro=0.8359252264255659
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.4577193384369214, AUC-ROC Macro=0.6694980464352607, AUC-ROC Micro=0.6599392392356416
Eval task: 2
Eval:  Epoch 3, Loss=0.2776925265789032, AUC-ROC Macro=0.7196059669317865, AUC-ROC Micro=0.8239545072597536
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.26385063320398333
Train:  Epoch 4, Loss=0.26574702928754573, AUC-ROC Macro=0.7631809309286892, AUC-ROC Micro=0.8484325672257087
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.4726801725725333, AUC-ROC Macro=0.6587968697797867, AUC-ROC Micro=0.6435423321989193
Eval task: 2
Eval:  Epoch 4, Loss=0.2747970074415207, AUC-ROC Macro=0.7256555438363875, AUC-ROC Micro=0.8271906039485878
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.25768732130527494
Train:  Epoch 5, Loss=0.2596421356688317, AUC-ROC Macro=0.7829844860533595, AUC-ROC Micro=0.8576415614619683
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.47028231372435886, AUC-ROC Macro=0.6564159529443342, AUC-ROC Micro=0.64738347163603
Eval task: 2
Eval:  Epoch 5, Loss=0.27524159848690033, AUC-ROC Macro=0.7313774952058678, AUC-ROC Micro=0.8288230620092293
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.24995540253818035
Train:  Epoch 6, Loss=0.25409776113688365, AUC-ROC Macro=0.7983940661861972, AUC-ROC Micro=0.8653797211723019
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.4804714471101761, AUC-ROC Macro=0.6503291495014151, AUC-ROC Micro=0.6379786314825947
Eval task: 2
Eval:  Epoch 6, Loss=0.2748965322971344, AUC-ROC Macro=0.7266488675353577, AUC-ROC Micro=0.8304615190939895
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.4820099013547103, AUC-ROC Macro=0.6521229473085947, AUC-ROC Micro=0.6405304186607754
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2869964987039566, AUC-ROC Macro=0.7235447011543329, AUC-ROC Micro=0.8263549830742829
{'0': {'precision': 0.3549196787148594, 'recall': 0.540519877675841, 'f1-score': 0.42848484848484847, 'support': 1308}, '1': {'precision': 0.3803921568627451, 'recall': 0.48258706467661694, 'f1-score': 0.42543859649122806, 'support': 402}, '2': {'precision': 0.18155619596541786, 'recall': 0.19148936170212766, 'f1-score': 0.18639053254437868, 'support': 658}, '3': {'precision': 0.3472359328726555, 'recall': 0.707035175879397, 'f1-score': 0.46573982125124136, 'support': 1990}, '4': {'precision': 0.27294117647058824, 'recall': 0.14392059553349876, 'f1-score': 0.1884646628757108, 'support': 806}, '5': {'precision': 0.197265625, 'recall': 0.12982005141388175, 'f1-score': 0.1565891472868217, 'support': 778}, '6': {'precision': 0.2966878083157153, 'recall': 0.32334869431643626, 'f1-score': 0.3094450569643514, 'support': 1302}, '7': {'precision': 0.037037037037037035, 'recall': 0.0023584905660377358, 'f1-score': 0.004434589800443459, 'support': 424}, '8': {'precision': 0.5573770491803278, 'recall': 0.02068126520681265, 'f1-score': 0.03988269794721407, 'support': 1644}, '9': {'precision': 0.5151515151515151, 'recall': 0.008370260955194485, 'f1-score': 0.016472868217054265, 'support': 2031}, '10': {'precision': 0.43859649122807015, 'recall': 0.13089005235602094, 'f1-score': 0.20161290322580644, 'support': 573}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1176}, '12': {'precision': 0.2857142857142857, 'recall': 0.0011299435028248588, 'f1-score': 0.0022509848058525606, 'support': 1770}, '13': {'precision': 0.38497652582159625, 'recall': 0.031587057010785825, 'f1-score': 0.058383766464934136, 'support': 2596}, '14': {'precision': 0.35714285714285715, 'recall': 0.003073140749846343, 'f1-score': 0.006093845216331505, 'support': 1627}, '15': {'precision': 0.42857142857142855, 'recall': 0.012396694214876033, 'f1-score': 0.024096385542168676, 'support': 484}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 795}, '17': {'precision': 0.2727272727272727, 'recall': 0.05514705882352941, 'f1-score': 0.09174311926605502, 'support': 544}, '18': {'precision': 0.15384615384615385, 'recall': 0.005698005698005698, 'f1-score': 0.01098901098901099, 'support': 351}, '19': {'precision': 0.37735849056603776, 'recall': 0.07633587786259542, 'f1-score': 0.12698412698412698, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.8, 'recall': 0.003683241252302026, 'f1-score': 0.007332722273143905, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.8, 'recall': 0.007920792079207921, 'f1-score': 0.01568627450980392, 'support': 505}, 'micro avg': {'precision': 0.324653954118672, 'recall': 0.13218775864107515, 'f1-score': 0.18787810889536186, 'support': 25373}, 'macro avg': {'precision': 0.2975799072475425, 'recall': 0.11511970805903354, 'f1-score': 0.11066063844562106, 'support': 25373}, 'weighted avg': {'precision': 0.3265136892773305, 'recall': 0.13218775864107515, 'f1-score': 0.11642502050946785, 'support': 25373}, 'samples avg': {'precision': 0.23414978350281088, 'recall': 0.10928354231361469, 'f1-score': 0.1346387793470124, 'support': 25373}}
{'0': {'precision': 0.6617647058823529, 'recall': 0.34615384615384615, 'f1-score': 0.45454545454545453, 'support': 130}, '1': {'precision': 0.6382978723404256, 'recall': 0.4411764705882353, 'f1-score': 0.5217391304347826, 'support': 136}, '2': {'precision': 0.4019607843137255, 'recall': 0.29927007299270075, 'f1-score': 0.34309623430962344, 'support': 137}, '3': {'precision': 0.6529850746268657, 'recall': 0.8215962441314554, 'f1-score': 0.7276507276507276, 'support': 213}, '4': {'precision': 0.5454545454545454, 'recall': 0.08, 'f1-score': 0.13953488372093023, 'support': 75}, '5': {'precision': 0.3333333333333333, 'recall': 0.10638297872340426, 'f1-score': 0.16129032258064516, 'support': 94}, '6': {'precision': 0.6153846153846154, 'recall': 0.10810810810810811, 'f1-score': 0.1839080459770115, 'support': 74}, '7': {'precision': 0.6428571428571429, 'recall': 0.225, 'f1-score': 0.33333333333333337, 'support': 40}, '8': {'precision': 0.6666666666666666, 'recall': 0.02666666666666667, 'f1-score': 0.05128205128205129, 'support': 75}, '9': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 65}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 63}, '11': {'precision': 0.5, 'recall': 0.017857142857142856, 'f1-score': 0.03448275862068965, 'support': 56}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 52}, '13': {'precision': 0.45454545454545453, 'recall': 0.09090909090909091, 'f1-score': 0.15151515151515152, 'support': 55}, '14': {'precision': 0.7333333333333333, 'recall': 0.1746031746031746, 'f1-score': 0.28205128205128205, 'support': 63}, '15': {'precision': 0.8571428571428571, 'recall': 0.3157894736842105, 'f1-score': 0.46153846153846156, 'support': 19}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '17': {'precision': 0.5789473684210527, 'recall': 0.13414634146341464, 'f1-score': 0.21782178217821782, 'support': 82}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, 'micro avg': {'precision': 0.5900151285930408, 'recall': 0.25374105400130126, 'f1-score': 0.3548680618744314, 'support': 1537}, 'macro avg': {'precision': 0.3313069501720949, 'recall': 0.12750638443525802, 'f1-score': 0.16255158478953446, 'support': 1537}, 'weighted avg': {'precision': 0.4706876647631222, 'recall': 0.25374105400130126, 'f1-score': 0.28830222810453265, 'support': 1537}, 'samples avg': {'precision': 0.39425223214285715, 'recall': 0.2408838665674603, 'f1-score': 0.2737811233904984, 'support': 1537}}