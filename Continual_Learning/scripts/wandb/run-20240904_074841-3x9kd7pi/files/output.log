
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_northeast
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43572688952088356
Train: epoch: 1, loss = 0.42252251610159874
Train: epoch: 1, loss = 0.4180568438520034
Train: epoch: 1, loss = 0.41564655957743524
Train: epoch: 1, loss = 0.4119037959128618
Train: epoch: 1, loss = 0.40972411025315525
Train: epoch: 1, loss = 0.4084432640565293
Train: epoch: 1, loss = 0.40598998571746053
Train: epoch: 1, loss = 0.40384281883637113
Train: epoch: 1, loss = 0.402477526627481
Train: epoch: 1, loss = 0.40110703131691977
Train: epoch: 1, loss = 0.39936288209011156
Train: epoch: 1, loss = 0.3975576587021351
Train: epoch: 1, loss = 0.3960275698240314
Train: epoch: 1, loss = 0.394673554400603
Train: epoch: 1, loss = 0.39378617410548034
Train: epoch: 1, loss = 0.39262009420815636
Train: epoch: 1, loss = 0.3919092111620638
Train:  Epoch 1, Loss=0.39150339385586924, AUC-ROC Macro=0.6599221018899173, AUC-ROC Micro=0.7503160312427635
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3700565534333388, AUC-ROC Macro=0.7177660395955866, AUC-ROC Micro=0.7836051127024929
Eval task: 2
Eval:  Epoch 1, Loss=0.3928205370903015, AUC-ROC Macro=0.4821059592685409, AUC-ROC Micro=0.5918261879529829
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37233345791697503
Train: epoch: 2, loss = 0.37119224403053525
Train: epoch: 2, loss = 0.3714203259597222
Train: epoch: 2, loss = 0.3719052001275122
Train: epoch: 2, loss = 0.3704758036732674
Train: epoch: 2, loss = 0.3695279116431872
Train: epoch: 2, loss = 0.3689219200398241
Train: epoch: 2, loss = 0.36864912036806347
Train: epoch: 2, loss = 0.368738231236736
Train: epoch: 2, loss = 0.36913062615692616
Train: epoch: 2, loss = 0.3689140875705264
Train: epoch: 2, loss = 0.36895243762681884
Train: epoch: 2, loss = 0.36807670158262434
Train: epoch: 2, loss = 0.3680690260870116
Train: epoch: 2, loss = 0.36809742441773413
Train: epoch: 2, loss = 0.3683209105581045
Train: epoch: 2, loss = 0.36843907690223526
Train: epoch: 2, loss = 0.3678898510005739
Train:  Epoch 2, Loss=0.3678914152516259, AUC-ROC Macro=0.7256428788768224, AUC-ROC Micro=0.7922578052947796
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36172594378391904, AUC-ROC Macro=0.7379492836946766, AUC-ROC Micro=0.7982362474095525
Eval task: 2
Eval:  Epoch 2, Loss=0.42352111637592316, AUC-ROC Macro=0.4850102709475072, AUC-ROC Micro=0.5874475937009884
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.36438045114278794
Train: epoch: 3, loss = 0.35992757517844437
Train: epoch: 3, loss = 0.3587334153304497
Train: epoch: 3, loss = 0.35944735161960123
Train: epoch: 3, loss = 0.36055358648300173
Train: epoch: 3, loss = 0.3603412576392293
Train: epoch: 3, loss = 0.3606668005564383
Train: epoch: 3, loss = 0.3608235085196793
Train: epoch: 3, loss = 0.36056259433428445
Train: epoch: 3, loss = 0.3606454473361373
Train: epoch: 3, loss = 0.36064496695318005
Train: epoch: 3, loss = 0.36124476509168746
Train: epoch: 3, loss = 0.36115480365088354
Train: epoch: 3, loss = 0.3611611941297139
Train: epoch: 3, loss = 0.36090071114897726
Train: epoch: 3, loss = 0.3608689147606492
Train: epoch: 3, loss = 0.3605863735956304
Train: epoch: 3, loss = 0.3597905930586987
Train:  Epoch 3, Loss=0.3598191013152783, AUC-ROC Macro=0.7444831406572041, AUC-ROC Micro=0.8046722686477237
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3572731129825115, AUC-ROC Macro=0.748276099998936, AUC-ROC Micro=0.8050237909387503
Eval task: 2
Eval:  Epoch 3, Loss=0.4282839447259903, AUC-ROC Macro=0.4955827694046674, AUC-ROC Micro=0.5960278863581046
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3522242811322212
Train: epoch: 4, loss = 0.35490076400339604
Train: epoch: 4, loss = 0.3551639311512311
Train: epoch: 4, loss = 0.3545238941721618
Train: epoch: 4, loss = 0.3545348987877369
Train: epoch: 4, loss = 0.35459029698123534
Train: epoch: 4, loss = 0.35518564826675825
Train: epoch: 4, loss = 0.35587843214161696
Train: epoch: 4, loss = 0.35545672692358493
Train: epoch: 4, loss = 0.35555039197951555
Train: epoch: 4, loss = 0.3563154620203105
Train: epoch: 4, loss = 0.3554501550955077
Train: epoch: 4, loss = 0.35581580640604865
Train: epoch: 4, loss = 0.35571140055145534
Train: epoch: 4, loss = 0.3553741004268328
Train: epoch: 4, loss = 0.35579148470424116
Train: epoch: 4, loss = 0.35503527319606615
Train: epoch: 4, loss = 0.3547504253478514
Train:  Epoch 4, Loss=0.35452307225088786, AUC-ROC Macro=0.7561629932396069, AUC-ROC Micro=0.8124551099920372
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3531484703222911, AUC-ROC Macro=0.7586607688385573, AUC-ROC Micro=0.8109299757274058
Eval task: 2
Eval:  Epoch 4, Loss=0.4292772263288498, AUC-ROC Macro=0.4896916541469662, AUC-ROC Micro=0.5826014373179453
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3420832987874746
Train: epoch: 5, loss = 0.34792938489466907
Train: epoch: 5, loss = 0.34871961096922555
Train: epoch: 5, loss = 0.3492108232155442
Train: epoch: 5, loss = 0.3471704538464546
Train: epoch: 5, loss = 0.34851535407205425
Train: epoch: 5, loss = 0.3484800381745611
Train: epoch: 5, loss = 0.3492954066488892
Train: epoch: 5, loss = 0.3491326174719466
Train: epoch: 5, loss = 0.3497527114599943
Train: epoch: 5, loss = 0.3493388871780851
Train: epoch: 5, loss = 0.349427160123984
Train: epoch: 5, loss = 0.34961001850664614
Train: epoch: 5, loss = 0.3503187604674271
Train: epoch: 5, loss = 0.35002676347891487
Train: epoch: 5, loss = 0.3498883708473295
Train: epoch: 5, loss = 0.35006463931763876
Train: epoch: 5, loss = 0.35033119066721863
Train:  Epoch 5, Loss=0.3502695519842653, AUC-ROC Macro=0.765217019786331, AUC-ROC Micro=0.8184412779255835
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3517532708744208, AUC-ROC Macro=0.7617756636493246, AUC-ROC Micro=0.8130689495011143
Eval task: 2
Eval:  Epoch 5, Loss=0.44371502101421356, AUC-ROC Macro=0.481950042974292, AUC-ROC Micro=0.5689910383020507
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34755832962691785
Train: epoch: 6, loss = 0.3461062002927065
Train: epoch: 6, loss = 0.3466751405845086
Train: epoch: 6, loss = 0.34550005339086054
Train: epoch: 6, loss = 0.3464427799582481
Train: epoch: 6, loss = 0.34673380800833303
Train: epoch: 6, loss = 0.3466479820119483
Train: epoch: 6, loss = 0.34698369869962337
Train: epoch: 6, loss = 0.3467249418463972
Train: epoch: 6, loss = 0.34692495853453875
Train: epoch: 6, loss = 0.346833573945544
Train: epoch: 6, loss = 0.34685191135232646
Train: epoch: 6, loss = 0.34689588997799614
Train: epoch: 6, loss = 0.3470516098982521
Train: epoch: 6, loss = 0.34701913308103877
Train: epoch: 6, loss = 0.3467412445088848
Train: epoch: 6, loss = 0.34681947451303985
Train: epoch: 6, loss = 0.3468691126174397
Train:  Epoch 6, Loss=0.3468270391623179, AUC-ROC Macro=0.7717771353133784, AUC-ROC Micro=0.8230556260392248
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3494696306685607, AUC-ROC Macro=0.7640770204892816, AUC-ROC Micro=0.8166914752502972
Eval task: 2
Eval:  Epoch 6, Loss=0.46394121646881104, AUC-ROC Macro=0.47480192876399124, AUC-ROC Micro=0.5784791129354575
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3524705059826374, AUC-ROC Macro=0.7625960147123715, AUC-ROC Micro=0.8152206398724545
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.47136905789375305, AUC-ROC Macro=0.4890587352930188, AUC-ROC Micro=0.592444321261729
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.3467465577274561
Train:  Epoch 1, Loss=0.34125433565017405, AUC-ROC Macro=0.5466150177746969, AUC-ROC Micro=0.7234890586530605
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.34391417478521663, AUC-ROC Macro=0.7575287432081075, AUC-ROC Micro=0.8112798906257661
Eval task: 2
Eval:  Epoch 1, Loss=0.3497440814971924, AUC-ROC Macro=0.6112964185436689, AUC-ROC Micro=0.7653622497148354
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.32001120947301387
Train:  Epoch 2, Loss=0.32139746177645406, AUC-ROC Macro=0.6470804781591238, AUC-ROC Micro=0.7904071595953811
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.34184832870960236, AUC-ROC Macro=0.7580406312173187, AUC-ROC Micro=0.8121493413554453
Eval task: 2
Eval:  Epoch 2, Loss=0.3388356864452362, AUC-ROC Macro=0.6619384256985927, AUC-ROC Micro=0.7908495407973131
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.3120478313416243
Train:  Epoch 3, Loss=0.3124925678743977, AUC-ROC Macro=0.6942105661377086, AUC-ROC Micro=0.815574161764249
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3413466426233451, AUC-ROC Macro=0.7556083005492704, AUC-ROC Micro=0.81083838102899
Eval task: 2
Eval:  Epoch 3, Loss=0.32968875765800476, AUC-ROC Macro=0.6886060539264041, AUC-ROC Micro=0.8065757865760651
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.30529475569725034
Train:  Epoch 4, Loss=0.30571801031483764, AUC-ROC Macro=0.7248455422356688, AUC-ROC Micro=0.8304418448376361
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3418736358483632, AUC-ROC Macro=0.7541080224573007, AUC-ROC Micro=0.8084374769631936
Eval task: 2
Eval:  Epoch 4, Loss=0.32156991958618164, AUC-ROC Macro=0.7000971700851779, AUC-ROC Micro=0.814550720422505
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.29855186238884923
Train:  Epoch 5, Loss=0.29965481357428153, AUC-ROC Macro=0.7497784354920821, AUC-ROC Micro=0.841769160142102
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.3402849646906058, AUC-ROC Macro=0.7525223323055842, AUC-ROC Micro=0.8069514334544612
Eval task: 2
Eval:  Epoch 5, Loss=0.32032229006290436, AUC-ROC Macro=0.707304054038309, AUC-ROC Micro=0.8134708659353163
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2934506370127201
Train:  Epoch 6, Loss=0.29461115710904906, AUC-ROC Macro=0.7645480378447492, AUC-ROC Micro=0.8499393703365048
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.34042734652757645, AUC-ROC Macro=0.7495941305994507, AUC-ROC Micro=0.8045845839651347
Eval task: 2
Eval:  Epoch 6, Loss=0.3178170621395111, AUC-ROC Macro=0.6962350663634702, AUC-ROC Micro=0.8084192957314502
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3650596042474111, AUC-ROC Macro=0.7468519486623325, AUC-ROC Micro=0.8022154352442408
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.3055720329284668, AUC-ROC Macro=0.6719483301465619, AUC-ROC Micro=0.7970143775448436
{'0': {'precision': 0.5769230769230769, 'recall': 0.2408256880733945, 'f1-score': 0.3398058252427184, 'support': 1308}, '1': {'precision': 0.5675675675675675, 'recall': 0.4701492537313433, 'f1-score': 0.5142857142857143, 'support': 402}, '2': {'precision': 0.5666666666666667, 'recall': 0.05167173252279635, 'f1-score': 0.0947075208913649, 'support': 658}, '3': {'precision': 0.5383502170767004, 'recall': 0.18693467336683417, 'f1-score': 0.277508392390899, 'support': 1990}, '4': {'precision': 0.483695652173913, 'recall': 0.11042183622828784, 'f1-score': 0.1797979797979798, 'support': 806}, '5': {'precision': 0.5, 'recall': 0.002570694087403599, 'f1-score': 0.005115089514066496, 'support': 778}, '6': {'precision': 0.6068702290076335, 'recall': 0.12211981566820276, 'f1-score': 0.20332480818414322, 'support': 1302}, '7': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 424}, '8': {'precision': 0.5799739921976593, 'recall': 0.2712895377128954, 'f1-score': 0.369664318276005, 'support': 1644}, '9': {'precision': 0.6732813607370659, 'recall': 0.46774987690792713, 'f1-score': 0.5520046484601977, 'support': 2031}, '10': {'precision': 0.7766497461928934, 'recall': 0.2670157068062827, 'f1-score': 0.39740259740259737, 'support': 573}, '11': {'precision': 0.4947916666666667, 'recall': 0.2423469387755102, 'f1-score': 0.3253424657534247, 'support': 1176}, '12': {'precision': 0.564729867482161, 'recall': 0.3129943502824859, 'f1-score': 0.40276263177026533, 'support': 1770}, '13': {'precision': 0.579064587973274, 'recall': 0.40061633281972264, 'f1-score': 0.4735883424408015, 'support': 2596}, '14': {'precision': 0.524390243902439, 'recall': 0.29071911493546404, 'f1-score': 0.3740608936338474, 'support': 1627}, '15': {'precision': 0.1, 'recall': 0.002066115702479339, 'f1-score': 0.004048582995951418, 'support': 484}, '16': {'precision': 0.4375, 'recall': 0.10566037735849057, 'f1-score': 0.17021276595744683, 'support': 795}, '17': {'precision': 0.5303030303030303, 'recall': 0.06433823529411764, 'f1-score': 0.11475409836065573, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.5, 'recall': 0.022900763358778626, 'f1-score': 0.0437956204379562, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.5739130434782609, 'recall': 0.15770609318996415, 'f1-score': 0.24742268041237114, 'support': 837}, '22': {'precision': 0.6806083650190115, 'recall': 0.494475138121547, 'f1-score': 0.5728, 'support': 1086}, '23': {'precision': 0.5858823529411765, 'recall': 0.289198606271777, 'f1-score': 0.38724727838258166, 'support': 861}, '24': {'precision': 0.5555555555555556, 'recall': 0.2376237623762376, 'f1-score': 0.33287101248266293, 'support': 505}, 'micro avg': {'precision': 0.5839587242026266, 'recall': 0.2453395341504749, 'f1-score': 0.3455166097743735, 'support': 25373}, 'macro avg': {'precision': 0.4798686888745901, 'recall': 0.1924557857436777, 'f1-score': 0.25530093068294607, 'support': 25373}, 'weighted avg': {'precision': 0.53284916426995, 'recall': 0.2453395341504749, 'f1-score': 0.319683628735394, 'support': 25373}, 'samples avg': {'precision': 0.36460942666997354, 'recall': 0.21976168750783867, 'f1-score': 0.252302614612036, 'support': 25373}}
{'0': {'precision': 0.717391304347826, 'recall': 0.25384615384615383, 'f1-score': 0.375, 'support': 130}, '1': {'precision': 0.5164835164835165, 'recall': 0.6911764705882353, 'f1-score': 0.5911949685534591, 'support': 136}, '2': {'precision': 0.4411764705882353, 'recall': 0.21897810218978103, 'f1-score': 0.29268292682926833, 'support': 137}, '3': {'precision': 0.6527196652719666, 'recall': 0.7323943661971831, 'f1-score': 0.6902654867256637, 'support': 213}, '4': {'precision': 0.3333333333333333, 'recall': 0.04, 'f1-score': 0.07142857142857142, 'support': 75}, '5': {'precision': 0.25, 'recall': 0.010638297872340425, 'f1-score': 0.02040816326530612, 'support': 94}, '6': {'precision': 0.5, 'recall': 0.04054054054054054, 'f1-score': 0.075, 'support': 74}, '7': {'precision': 0.27586206896551724, 'recall': 0.2, 'f1-score': 0.2318840579710145, 'support': 40}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 75}, '9': {'precision': 1.0, 'recall': 0.015384615384615385, 'f1-score': 0.030303030303030307, 'support': 65}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 63}, '11': {'precision': 0.35714285714285715, 'recall': 0.08928571428571429, 'f1-score': 0.14285714285714285, 'support': 56}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 52}, '13': {'precision': 0.6666666666666666, 'recall': 0.07272727272727272, 'f1-score': 0.13114754098360654, 'support': 55}, '14': {'precision': 1.0, 'recall': 0.047619047619047616, 'f1-score': 0.0909090909090909, 'support': 63}, '15': {'precision': 0.75, 'recall': 0.3157894736842105, 'f1-score': 0.44444444444444436, 'support': 19}, '16': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '17': {'precision': 0.4, 'recall': 0.12195121951219512, 'f1-score': 0.18691588785046728, 'support': 82}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5}, 'micro avg': {'precision': 0.5560747663551402, 'recall': 0.23227065712426806, 'f1-score': 0.32767324460761815, 'support': 1537}, 'macro avg': {'precision': 0.31443103531199673, 'recall': 0.11401325097789158, 'f1-score': 0.13497765248484261, 'support': 1537}, 'weighted avg': {'precision': 0.44972299440844504, 'recall': 0.23227065712426806, 'f1-score': 0.2505264343484838, 'support': 1537}, 'samples avg': {'precision': 0.35332496279761905, 'recall': 0.22200133308531744, 'f1-score': 0.25137675909160284, 'support': 1537}}