
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_midwest
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.43538754403591157
Train: epoch: 1, loss = 0.4202381586283445
Train: epoch: 1, loss = 0.41727281038959824
Train: epoch: 1, loss = 0.413373134508729
Train: epoch: 1, loss = 0.4108929263651371
Train: epoch: 1, loss = 0.40854374824712675
Train: epoch: 1, loss = 0.40691739504890784
Train: epoch: 1, loss = 0.40583793657831846
Train: epoch: 1, loss = 0.4039776726398203
Train: epoch: 1, loss = 0.40284166026860474
Train: epoch: 1, loss = 0.40101081602275374
Train: epoch: 1, loss = 0.4000970418502887
Train: epoch: 1, loss = 0.399176374903092
Train: epoch: 1, loss = 0.3981944820338062
Train: epoch: 1, loss = 0.3964382966607809
Train: epoch: 1, loss = 0.3953431868785992
Train: epoch: 1, loss = 0.3947106921278379
Train: epoch: 1, loss = 0.3937408899019162
Train:  Epoch 1, Loss=0.39342588036284487, AUC-ROC Macro=0.6545205049557719, AUC-ROC Micro=0.746815951990372
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3747047632932663, AUC-ROC Macro=0.7132268986329726, AUC-ROC Micro=0.7793788189501455
Eval task: 2
Eval:  Epoch 1, Loss=0.32760435342788696, AUC-ROC Macro=0.49353054037319294, AUC-ROC Micro=0.57073476059586
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37227042235434055
Train: epoch: 2, loss = 0.3680370422080159
Train: epoch: 2, loss = 0.37126525036990643
Train: epoch: 2, loss = 0.37226961355656385
Train: epoch: 2, loss = 0.37151526971161364
Train: epoch: 2, loss = 0.37223320024708906
Train: epoch: 2, loss = 0.3725170117084469
Train: epoch: 2, loss = 0.3731297765858471
Train: epoch: 2, loss = 0.3730044084539016
Train: epoch: 2, loss = 0.37294126229733227
Train: epoch: 2, loss = 0.3725813433595679
Train: epoch: 2, loss = 0.37189651225383086
Train: epoch: 2, loss = 0.37160030719752496
Train: epoch: 2, loss = 0.3711548033516322
Train: epoch: 2, loss = 0.37068934622903665
Train: epoch: 2, loss = 0.3707187584042549
Train: epoch: 2, loss = 0.37011365498690046
Train: epoch: 2, loss = 0.3698183559667733
Train:  Epoch 2, Loss=0.369904527408445, AUC-ROC Macro=0.7213858975009919, AUC-ROC Micro=0.7889281194373604
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3633383934696515, AUC-ROC Macro=0.7360723586552202, AUC-ROC Micro=0.7957317529317611
Eval task: 2
Eval:  Epoch 2, Loss=0.3221188932657242, AUC-ROC Macro=0.49730425453375227, AUC-ROC Micro=0.5740885676613625
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3594774546474218
Train: epoch: 3, loss = 0.36393149465322494
Train: epoch: 3, loss = 0.36232149427135785
Train: epoch: 3, loss = 0.36262096624821427
Train: epoch: 3, loss = 0.3641556855142117
Train: epoch: 3, loss = 0.36435510384539765
Train: epoch: 3, loss = 0.3639178003370762
Train: epoch: 3, loss = 0.3630637522693723
Train: epoch: 3, loss = 0.3622087137069967
Train: epoch: 3, loss = 0.362025750271976
Train: epoch: 3, loss = 0.36145121895454146
Train: epoch: 3, loss = 0.3611482986062765
Train: epoch: 3, loss = 0.3614675056303923
Train: epoch: 3, loss = 0.3616444095596671
Train: epoch: 3, loss = 0.3620703199406465
Train: epoch: 3, loss = 0.36194482204969974
Train: epoch: 3, loss = 0.36188184643492977
Train: epoch: 3, loss = 0.361713258040448
Train:  Epoch 3, Loss=0.3616423323093316, AUC-ROC Macro=0.7406261500292314, AUC-ROC Micro=0.8017364432964766
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.357918659845988, AUC-ROC Macro=0.7470927579964807, AUC-ROC Micro=0.8040848006481212
Eval task: 2
Eval:  Epoch 3, Loss=0.3320525288581848, AUC-ROC Macro=0.48845633917081055, AUC-ROC Micro=0.5709459064298616
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.36089228294789794
Train: epoch: 4, loss = 0.3614549324288964
Train: epoch: 4, loss = 0.35861179371674856
Train: epoch: 4, loss = 0.35835274601355194
Train: epoch: 4, loss = 0.3565822171419859
Train: epoch: 4, loss = 0.35619453883419433
Train: epoch: 4, loss = 0.35588891713746956
Train: epoch: 4, loss = 0.3562618751544505
Train: epoch: 4, loss = 0.3559068417135212
Train: epoch: 4, loss = 0.35591279762238265
Train: epoch: 4, loss = 0.3557255062189969
Train: epoch: 4, loss = 0.35600675785914065
Train: epoch: 4, loss = 0.35569698153206936
Train: epoch: 4, loss = 0.355648311498974
Train: epoch: 4, loss = 0.35608838875591753
Train: epoch: 4, loss = 0.3557929912395775
Train: epoch: 4, loss = 0.356033045412863
Train: epoch: 4, loss = 0.3558905251324177
Train:  Epoch 4, Loss=0.3556981133232769, AUC-ROC Macro=0.7538385771197541, AUC-ROC Micro=0.8106879410584162
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.35379618406295776, AUC-ROC Macro=0.7561015822881331, AUC-ROC Micro=0.8103260552922644
Eval task: 2
Eval:  Epoch 4, Loss=0.3449827469885349, AUC-ROC Macro=0.4726835803106846, AUC-ROC Micro=0.5439058815403178
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3522271171957254
Train: epoch: 5, loss = 0.3538658121228218
Train: epoch: 5, loss = 0.35342762870093186
Train: epoch: 5, loss = 0.35286183286458256
Train: epoch: 5, loss = 0.35269803847372533
Train: epoch: 5, loss = 0.3525812576711178
Train: epoch: 5, loss = 0.3526423127736364
Train: epoch: 5, loss = 0.35285946530289947
Train: epoch: 5, loss = 0.35207720579372515
Train: epoch: 5, loss = 0.3521302533969283
Train: epoch: 5, loss = 0.3519551413574002
Train: epoch: 5, loss = 0.35184313336387274
Train: epoch: 5, loss = 0.3519379872542161
Train: epoch: 5, loss = 0.35145037139632873
Train: epoch: 5, loss = 0.35114278866847354
Train: epoch: 5, loss = 0.3507051535556093
Train: epoch: 5, loss = 0.35102711643804524
Train: epoch: 5, loss = 0.35100299034681587
Train:  Epoch 5, Loss=0.350929882958404, AUC-ROC Macro=0.7636913597820845, AUC-ROC Micro=0.8175170885601502
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.35163306444883347, AUC-ROC Macro=0.7619984238979276, AUC-ROC Micro=0.8144252111519485
Eval task: 2
Eval:  Epoch 5, Loss=0.3565341494977474, AUC-ROC Macro=0.4770922930751243, AUC-ROC Micro=0.568722875758152
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.34869903326034546
Train: epoch: 6, loss = 0.347320508658886
Train: epoch: 6, loss = 0.345391652310888
Train: epoch: 6, loss = 0.34729977605864404
Train: epoch: 6, loss = 0.34691758853197097
Train: epoch: 6, loss = 0.34797563785066205
Train: epoch: 6, loss = 0.3483894363152129
Train: epoch: 6, loss = 0.34881963199935856
Train: epoch: 6, loss = 0.348586994210879
Train: epoch: 6, loss = 0.3482055616378784
Train: epoch: 6, loss = 0.3478438750383529
Train: epoch: 6, loss = 0.3479070650351544
Train: epoch: 6, loss = 0.3475410061043042
Train: epoch: 6, loss = 0.3476483441303883
Train: epoch: 6, loss = 0.34740853048364323
Train: epoch: 6, loss = 0.3471379687031731
Train: epoch: 6, loss = 0.34719100238207506
Train: epoch: 6, loss = 0.34729394752946163
Train:  Epoch 6, Loss=0.34728835677489256, AUC-ROC Macro=0.770767864521688, AUC-ROC Micro=0.8224352825719767
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.35179918135205906, AUC-ROC Macro=0.7626786864691149, AUC-ROC Micro=0.8150175919276326
Eval task: 2
Eval:  Epoch 6, Loss=0.3556743897497654, AUC-ROC Macro=0.47513557717702753, AUC-ROC Micro=0.5738579971490222
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3536516899863879, AUC-ROC Macro=0.7643520593234744, AUC-ROC Micro=0.8157991150150449
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.35561322420835495, AUC-ROC Macro=0.48543868027885473, AUC-ROC Micro=0.5729338644039854
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.286445082873106
Train: epoch: 1, loss = 0.2767790937423706
Train: epoch: 1, loss = 0.2712038730581601
Train: epoch: 1, loss = 0.26773332990705967
Train: epoch: 1, loss = 0.2666976942718029
Train: epoch: 1, loss = 0.25881578310082354
Train:  Epoch 1, Loss=0.25519967377854536, AUC-ROC Macro=0.6024168235732766, AUC-ROC Micro=0.7577015871695056
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.3728918532530467, AUC-ROC Macro=0.7381311719065019, AUC-ROC Micro=0.7863079343763104
Eval task: 2
Eval:  Epoch 1, Loss=0.26316639594733715, AUC-ROC Macro=0.6881608909504044, AUC-ROC Micro=0.798462842553783
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.24935149863362313
Train: epoch: 2, loss = 0.2514579087495804
Train: epoch: 2, loss = 0.25021711523334184
Train: epoch: 2, loss = 0.25026079850271343
Train: epoch: 2, loss = 0.24995152027904988
Train: epoch: 2, loss = 0.24382267001395425
Train:  Epoch 2, Loss=0.2406417132817103, AUC-ROC Macro=0.6876611959523057, AUC-ROC Micro=0.8054373798899142
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.3665747009217739, AUC-ROC Macro=0.7414883494660798, AUC-ROC Micro=0.7933273922923809
Eval task: 2
Eval:  Epoch 2, Loss=0.25834760069847107, AUC-ROC Macro=0.711100944635657, AUC-ROC Micro=0.8083373840803303
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.24364428628236057
Train: epoch: 3, loss = 0.2450733091123402
Train: epoch: 3, loss = 0.24470396481454373
Train: epoch: 3, loss = 0.24360606797039508
Train: epoch: 3, loss = 0.24376752329617737
Train: epoch: 3, loss = 0.23863420391455292
Train:  Epoch 3, Loss=0.23596630926420195, AUC-ROC Macro=0.7234392358508549, AUC-ROC Micro=0.8194913185561439
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.36285577341914177, AUC-ROC Macro=0.7449693440199746, AUC-ROC Micro=0.7975819083129861
Eval task: 2
Eval:  Epoch 3, Loss=0.25452929362654686, AUC-ROC Macro=0.7277312676418448, AUC-ROC Micro=0.8165226610423165
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.23986769624054433
Train: epoch: 4, loss = 0.23988591808825732
Train: epoch: 4, loss = 0.23966779516388972
Train: epoch: 4, loss = 0.2399982258398086
Train: epoch: 4, loss = 0.2401380983516574
Train: epoch: 4, loss = 0.23508110273008545
Train:  Epoch 4, Loss=0.23225177102844127, AUC-ROC Macro=0.7427009365089572, AUC-ROC Micro=0.828836390242545
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.3632185173531373, AUC-ROC Macro=0.7444381599310447, AUC-ROC Micro=0.7970471503947303
Eval task: 2
Eval:  Epoch 4, Loss=0.25110357999801636, AUC-ROC Macro=0.7281142756598481, AUC-ROC Micro=0.8221099453128039
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.23730548329651355
Train: epoch: 5, loss = 0.23832501754164695
Train: epoch: 5, loss = 0.23736666104445855
Train: epoch: 5, loss = 0.2372047336306423
Train: epoch: 5, loss = 0.23768523827940224
Train: epoch: 5, loss = 0.23225597151865562
Train:  Epoch 5, Loss=0.22943585374926842, AUC-ROC Macro=0.7567187387294184, AUC-ROC Micro=0.8352512303714529
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.36132748797535896, AUC-ROC Macro=0.7422680077970241, AUC-ROC Micro=0.7968819566638192
Eval task: 2
Eval:  Epoch 5, Loss=0.24973311461508274, AUC-ROC Macro=0.7307940410586956, AUC-ROC Micro=0.8226131409758575
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.2332979951053858
Train: epoch: 6, loss = 0.23534907443448902
Train: epoch: 6, loss = 0.23389102996637423
Train: epoch: 6, loss = 0.2341583141312003
Train: epoch: 6, loss = 0.2344422614276409
Train: epoch: 6, loss = 0.22889989412700137
Train:  Epoch 6, Loss=0.22624621565384748, AUC-ROC Macro=0.7697772749284322, AUC-ROC Micro=0.8411690450905343
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3618791475892067, AUC-ROC Macro=0.7413700718059282, AUC-ROC Micro=0.7946966050731052
Eval task: 2
Eval:  Epoch 6, Loss=0.2474591564387083, AUC-ROC Macro=0.7332256742850258, AUC-ROC Micro=0.8245040082495113
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.3702809661626816, AUC-ROC Macro=0.740900318181264, AUC-ROC Micro=0.7934605851256161
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.2110765092074871, AUC-ROC Macro=0.7249776762734753, AUC-ROC Micro=0.822772853799396
{'0': {'precision': 0.5322763306908267, 'recall': 0.35932721712538224, 'f1-score': 0.4290278411684162, 'support': 1308}, '1': {'precision': 0.6259259259259259, 'recall': 0.42039800995024873, 'f1-score': 0.5029761904761904, 'support': 402}, '2': {'precision': 0.5625, 'recall': 0.013677811550151976, 'f1-score': 0.026706231454005934, 'support': 658}, '3': {'precision': 0.530933633295838, 'recall': 0.2371859296482412, 'f1-score': 0.3278916290378604, 'support': 1990}, '4': {'precision': 0.4523809523809524, 'recall': 0.0707196029776675, 'f1-score': 0.12231759656652359, 'support': 806}, '5': {'precision': 0.3333333333333333, 'recall': 0.005141388174807198, 'f1-score': 0.010126582278481013, 'support': 778}, '6': {'precision': 0.5612903225806452, 'recall': 0.1336405529953917, 'f1-score': 0.21588089330024815, 'support': 1302}, '7': {'precision': 0.17647058823529413, 'recall': 0.007075471698113208, 'f1-score': 0.01360544217687075, 'support': 424}, '8': {'precision': 0.5345528455284553, 'recall': 0.3199513381995134, 'f1-score': 0.4003044140030441, 'support': 1644}, '9': {'precision': 0.6778805719091674, 'recall': 0.396848842934515, 'f1-score': 0.5006211180124224, 'support': 2031}, '10': {'precision': 0.5031315240083507, 'recall': 0.4205933682373473, 'f1-score': 0.45817490494296575, 'support': 573}, '11': {'precision': 0.5028735632183908, 'recall': 0.1488095238095238, 'f1-score': 0.22965879265091863, 'support': 1176}, '12': {'precision': 0.5538116591928252, 'recall': 0.2790960451977401, 'f1-score': 0.3711495116453794, 'support': 1770}, '13': {'precision': 0.6207974980453479, 'recall': 0.30585516178736516, 'f1-score': 0.4098064516129032, 'support': 2596}, '14': {'precision': 0.5, 'recall': 0.31837738168408114, 'f1-score': 0.3890349230191513, 'support': 1627}, '15': {'precision': 0.06896551724137931, 'recall': 0.004132231404958678, 'f1-score': 0.0077972709551656924, 'support': 484}, '16': {'precision': 0.4009009009009009, 'recall': 0.1119496855345912, 'f1-score': 0.17502458210422814, 'support': 795}, '17': {'precision': 0.47619047619047616, 'recall': 0.03676470588235294, 'f1-score': 0.06825938566552901, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.53125, 'recall': 0.0648854961832061, 'f1-score': 0.11564625850340135, 'support': 262}, '20': {'precision': 0.3103448275862069, 'recall': 0.015985790408525755, 'f1-score': 0.0304054054054054, 'support': 563}, '21': {'precision': 0.5195822454308094, 'recall': 0.23775388291517324, 'f1-score': 0.3262295081967213, 'support': 837}, '22': {'precision': 0.6905829596412556, 'recall': 0.425414364640884, 'f1-score': 0.5264957264957265, 'support': 1086}, '23': {'precision': 0.5095447870778267, 'recall': 0.40301974448315914, 'f1-score': 0.4500648508430609, 'support': 861}, '24': {'precision': 0.572289156626506, 'recall': 0.18811881188118812, 'f1-score': 0.28315946348733234, 'support': 505}, 'micro avg': {'precision': 0.5600364132908512, 'recall': 0.24246246009537697, 'f1-score': 0.3384124539303592, 'support': 25373}, 'macro avg': {'precision': 0.4699123847616286, 'recall': 0.19698889437216516, 'f1-score': 0.2556145989600781, 'support': 25373}, 'weighted avg': {'precision': 0.5195417073735744, 'recall': 0.24246246009537697, 'f1-score': 0.3149324008478672, 'support': 25373}, 'samples avg': {'precision': 0.34793787393885056, 'recall': 0.2113127221245615, 'f1-score': 0.2393572143505096, 'support': 25373}}
{'0': {'precision': 0.5930735930735931, 'recall': 0.3277511961722488, 'f1-score': 0.4221879815100154, 'support': 418}, '1': {'precision': 0.4852941176470588, 'recall': 0.1527777777777778, 'f1-score': 0.23239436619718312, 'support': 216}, '2': {'precision': 0.6, 'recall': 0.010416666666666666, 'f1-score': 0.020477815699658702, 'support': 288}, '3': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 252}, '4': {'precision': 0.5434782608695652, 'recall': 0.08680555555555555, 'f1-score': 0.1497005988023952, 'support': 288}, '5': {'precision': 0.4117647058823529, 'recall': 0.05204460966542751, 'f1-score': 0.09240924092409242, 'support': 269}, '6': {'precision': 0.3333333333333333, 'recall': 0.0176678445229682, 'f1-score': 0.03355704697986577, 'support': 283}, '7': {'precision': 0.8571428571428571, 'recall': 0.35294117647058826, 'f1-score': 0.5, 'support': 255}, '8': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 177}, '9': {'precision': 0.5714285714285714, 'recall': 0.11864406779661017, 'f1-score': 0.19649122807017544, 'support': 236}, '10': {'precision': 0.5, 'recall': 0.0273224043715847, 'f1-score': 0.05181347150259067, 'support': 183}, '11': {'precision': 1.0, 'recall': 0.03349282296650718, 'f1-score': 0.06481481481481481, 'support': 209}, '12': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160}, '13': {'precision': 0.35, 'recall': 0.06306306306306306, 'f1-score': 0.10687022900763357, 'support': 111}, '14': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '15': {'precision': 0.775, 'recall': 0.6888888888888889, 'f1-score': 0.7294117647058822, 'support': 90}, '16': {'precision': 0.375, 'recall': 0.043478260869565216, 'f1-score': 0.07792207792207792, 'support': 69}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 25}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8}, 'micro avg': {'precision': 0.6161764705882353, 'recall': 0.11023414890818206, 'f1-score': 0.18701182771702746, 'support': 3801}, 'macro avg': {'precision': 0.29582061757509326, 'recall': 0.07901177339149808, 'f1-score': 0.1071220254454554, 'support': 3801}, 'weighted avg': {'precision': 0.44081863748782396, 'recall': 0.11023414890818206, 'f1-score': 0.15517606994898295, 'support': 3801}, 'samples avg': {'precision': 0.18451741536458333, 'recall': 0.13057919456845238, 'f1-score': 0.14305284288194445, 'support': 3801}}