
[34m[1mwandb[39m[22m: [33mWARNING[39m No relevant files were detected in the specified directory. No code will be logged to your run.
Experiment dir: ./exp/Test_phen_south_baseline
['/data/datasets/mimic3-benchmarks/data/phenotyping', '/data/datasets/eICU2MIMIC/phenotyping_split']
------------------------------------
Task: 1, Epoch: 1
Train: epoch: 1, loss = 0.4339654175937176
Train: epoch: 1, loss = 0.42274991624057295
Train: epoch: 1, loss = 0.415866705874602
Train: epoch: 1, loss = 0.413237313516438
Train: epoch: 1, loss = 0.41212684950232503
Train: epoch: 1, loss = 0.40913165176908173
Train: epoch: 1, loss = 0.40760802110391003
Train: epoch: 1, loss = 0.40660122650675473
Train: epoch: 1, loss = 0.4045968115909232
Train: epoch: 1, loss = 0.40257934500277043
Train: epoch: 1, loss = 0.400229425911199
Train: epoch: 1, loss = 0.39821574500451484
Train: epoch: 1, loss = 0.39662382519589023
Train: epoch: 1, loss = 0.3954874029808811
Train: epoch: 1, loss = 0.3942656989445289
Train: epoch: 1, loss = 0.39281246493570504
Train: epoch: 1, loss = 0.39199366472223224
Train: epoch: 1, loss = 0.39098876879860955
Train:  Epoch 1, Loss=0.39078191146687563, AUC-ROC Macro=0.6623723300828841, AUC-ROC Micro=0.7515919447069952
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.37080711995561916, AUC-ROC Macro=0.7207953095044175, AUC-ROC Micro=0.7833759576138071
Eval task: 2
Eval:  Epoch 1, Loss=0.33020287156105044, AUC-ROC Macro=0.4771729044478674, AUC-ROC Micro=0.5657251000452264
------------------------------------
Task: 1, Epoch: 2
Train: epoch: 2, loss = 0.37326662465929983
Train: epoch: 2, loss = 0.37260560993105174
Train: epoch: 2, loss = 0.37036071638266244
Train: epoch: 2, loss = 0.3700446354970336
Train: epoch: 2, loss = 0.37187543645501137
Train: epoch: 2, loss = 0.3715963408599297
Train: epoch: 2, loss = 0.3709240623776402
Train: epoch: 2, loss = 0.370502409953624
Train: epoch: 2, loss = 0.36995765091644395
Train: epoch: 2, loss = 0.3700422721579671
Train: epoch: 2, loss = 0.3699235116893595
Train: epoch: 2, loss = 0.36929239160070815
Train: epoch: 2, loss = 0.36916429998209843
Train: epoch: 2, loss = 0.36921415323125467
Train: epoch: 2, loss = 0.36867493369678656
Train: epoch: 2, loss = 0.36885160277131945
Train: epoch: 2, loss = 0.36874972694498653
Train: epoch: 2, loss = 0.36897909947567514
Train:  Epoch 2, Loss=0.3690704812188434, AUC-ROC Macro=0.7226317330741285, AUC-ROC Micro=0.7902368573091186
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.36227285116910934, AUC-ROC Macro=0.7392550571031484, AUC-ROC Micro=0.7985123309020274
Eval task: 2
Eval:  Epoch 2, Loss=0.35722731351852416, AUC-ROC Macro=0.47324091198319607, AUC-ROC Micro=0.5579484410392173
------------------------------------
Task: 1, Epoch: 3
Train: epoch: 3, loss = 0.3685068418830633
Train: epoch: 3, loss = 0.36279946520924566
Train: epoch: 3, loss = 0.36167776823043823
Train: epoch: 3, loss = 0.3618811531737447
Train: epoch: 3, loss = 0.3613652749657631
Train: epoch: 3, loss = 0.3613408554097017
Train: epoch: 3, loss = 0.3624034591338464
Train: epoch: 3, loss = 0.3624406665563583
Train: epoch: 3, loss = 0.3623310930861367
Train: epoch: 3, loss = 0.3621369518786669
Train: epoch: 3, loss = 0.3615383285351775
Train: epoch: 3, loss = 0.36130929037928583
Train: epoch: 3, loss = 0.36165680022193836
Train: epoch: 3, loss = 0.36172345336526635
Train: epoch: 3, loss = 0.36192127003272373
Train: epoch: 3, loss = 0.3615296970261261
Train: epoch: 3, loss = 0.3614904194938786
Train: epoch: 3, loss = 0.3615699723197354
Train:  Epoch 3, Loss=0.3614397564606789, AUC-ROC Macro=0.740199815707503, AUC-ROC Micro=0.8020243224489945
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.3576734314362208, AUC-ROC Macro=0.749283846448371, AUC-ROC Micro=0.8049030575175035
Eval task: 2
Eval:  Epoch 3, Loss=0.36684859097003936, AUC-ROC Macro=0.4738791753160272, AUC-ROC Micro=0.5460844015187032
------------------------------------
Task: 1, Epoch: 4
Train: epoch: 4, loss = 0.3563842803239822
Train: epoch: 4, loss = 0.3538746690005064
Train: epoch: 4, loss = 0.35277546947201094
Train: epoch: 4, loss = 0.3546532150916755
Train: epoch: 4, loss = 0.35333149306476114
Train: epoch: 4, loss = 0.35476536316176255
Train: epoch: 4, loss = 0.35521193363836834
Train: epoch: 4, loss = 0.3564626161567867
Train: epoch: 4, loss = 0.35625260279410415
Train: epoch: 4, loss = 0.35630627412348986
Train: epoch: 4, loss = 0.3567566941543059
Train: epoch: 4, loss = 0.35661229967450103
Train: epoch: 4, loss = 0.3564241428845204
Train: epoch: 4, loss = 0.35650183825620585
Train: epoch: 4, loss = 0.3564694011360407
Train: epoch: 4, loss = 0.35606028967536985
Train: epoch: 4, loss = 0.3559872180574081
Train: epoch: 4, loss = 0.35579983485655653
------------- 4, Loss=0.35567302258401856, AUC-ROC Macro=0.7536494945716378, AUC-ROC Micro=0.810798719281679
------------- 4, Loss=0.35567302258401856, AUC-ROC Macro=0.7536494945716378, AUC-ROC Micro=0.810798719281679
Eval task: 1
Eval:  Epoch 4, Loss=0.3545866248508294, AUC-ROC Macro=0.7540472514686836, AUC-ROC Micro=0.809440348204506
Eval task: 2
Eval:  Epoch 4, Loss=0.47257120013237, AUC-ROC Macro=0.463358289167757, AUC-ROC Micro=0.5215387685151933
------------------------------------
Task: 1, Epoch: 5
Train: epoch: 5, loss = 0.3453889307379723
Train: epoch: 5, loss = 0.34683991730213165
Train: epoch: 5, loss = 0.35010290185610454
Train: epoch: 5, loss = 0.35132177205756304
Train: epoch: 5, loss = 0.35192060677707193
Train: epoch: 5, loss = 0.3535694496209423
Train: epoch: 5, loss = 0.35452347615999835
Train: epoch: 5, loss = 0.3542400844022632
Train: epoch: 5, loss = 0.35320599721537693
Train: epoch: 5, loss = 0.35317212259024383
Train: epoch: 5, loss = 0.35254542188888244
Train: epoch: 5, loss = 0.3529163017868996
Train: epoch: 5, loss = 0.35271128663649925
Train: epoch: 5, loss = 0.3526218193663018
Train: epoch: 5, loss = 0.3520288225064675
Train: epoch: 5, loss = 0.3517861685529351
Train: epoch: 5, loss = 0.3517347083240747
Train: epoch: 5, loss = 0.351490533856882
Train:  Epoch 5, Loss=0.35146508454461384, AUC-ROC Macro=0.7623624499879601, AUC-ROC Micro=0.8167131833434718
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.352099496871233, AUC-ROC Macro=0.7578996292321856, AUC-ROC Micro=0.8127251441446834
Eval task: 2
Eval:  Epoch 5, Loss=0.3886581927537918, AUC-ROC Macro=0.46383342160762886, AUC-ROC Micro=0.5281755207115546
------------------------------------
Task: 1, Epoch: 6
Train: epoch: 6, loss = 0.3449353697150946
Train: epoch: 6, loss = 0.3464702517911792
Train: epoch: 6, loss = 0.34609090673426784
Train: epoch: 6, loss = 0.3472191430069506
Train: epoch: 6, loss = 0.3471351444721222
Train: epoch: 6, loss = 0.3477257853001356
Train: epoch: 6, loss = 0.34632153859095915
Train: epoch: 6, loss = 0.3471514998283237
Train: epoch: 6, loss = 0.3477385327882237
Train: epoch: 6, loss = 0.34766727828234434
Train: epoch: 6, loss = 0.3471772116761316
Train: epoch: 6, loss = 0.3475714402832091
Train: epoch: 6, loss = 0.34767889174131245
Train: epoch: 6, loss = 0.3477778032847813
Train: epoch: 6, loss = 0.3478898301968972
Train: epoch: 6, loss = 0.3482154438551515
Train: epoch: 6, loss = 0.34824721914880413
Train: epoch: 6, loss = 0.3479162112002571
Train:  Epoch 6, Loss=0.34798771301701537, AUC-ROC Macro=0.7694975033334873, AUC-ROC Micro=0.8215795081234685
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.3503933983544509, AUC-ROC Macro=0.7630076019984116, AUC-ROC Micro=0.8152999772871077
Eval task: 2
Eval:  Epoch 6, Loss=0.4723863184452057, AUC-ROC Macro=0.46116090772570756, AUC-ROC Micro=0.5226373057243893
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.35283006727695465, AUC-ROC Macro=0.7626081480453927, AUC-ROC Micro=0.8146147997691933
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.4754534482955933, AUC-ROC Macro=0.4653256602606095, AUC-ROC Micro=0.5255461859533419
------------------------------------
Task: 2, Epoch: 1
Train: epoch: 1, loss = 0.30306994311511515
Train: epoch: 1, loss = 0.27989947322756054
Train: epoch: 1, loss = 0.27191648617386815
Train: epoch: 1, loss = 0.2664613289013505
Train: epoch: 1, loss = 0.2634575428813696
Train: epoch: 1, loss = 0.26046933244913817
Train: epoch: 1, loss = 0.2578809184900352
Train:  Epoch 1, Loss=0.25595763863847926, AUC-ROC Macro=0.6303404747712048, AUC-ROC Micro=0.7589692782298635
-------------
Eval task: 1
Eval:  Epoch 1, Loss=0.4871663140753905, AUC-ROC Macro=0.6109646020928817, AUC-ROC Micro=0.6167721183786521
Eval task: 2
Eval:  Epoch 1, Loss=0.2388644903898239, AUC-ROC Macro=0.7056427397074496, AUC-ROC Micro=0.8003078684434727
------------------------------------
Task: 2, Epoch: 2
Train: epoch: 2, loss = 0.2335708676278591
Train: epoch: 2, loss = 0.2354074876755476
Train: epoch: 2, loss = 0.23465289997557798
Train: epoch: 2, loss = 0.23494020083919168
Train: epoch: 2, loss = 0.23482201531529426
Train: epoch: 2, loss = 0.23576404663423697
Train: epoch: 2, loss = 0.23572673731616564
Train:  Epoch 2, Loss=0.23548280358068174, AUC-ROC Macro=0.72320922618283, AUC-ROC Micro=0.810537655997783
-------------
Eval task: 1
Eval:  Epoch 2, Loss=0.5225021106501421, AUC-ROC Macro=0.5902991377335794, AUC-ROC Micro=0.5945414603038451
Eval task: 2
Eval:  Epoch 2, Loss=0.23336427360773088, AUC-ROC Macro=0.7279271182223814, AUC-ROC Micro=0.8132842534278902
------------------------------------
Task: 2, Epoch: 3
Train: epoch: 3, loss = 0.2331993819773197
Train: epoch: 3, loss = 0.23389778058975935
Train: epoch: 3, loss = 0.23100892727573713
Train: epoch: 3, loss = 0.230122338719666
Train: epoch: 3, loss = 0.23003219829499721
Train: epoch: 3, loss = 0.23018549658358098
Train: epoch: 3, loss = 0.23017656284783566
Train:  Epoch 3, Loss=0.23017817018445544, AUC-ROC Macro=0.746653258917572, AUC-ROC Micro=0.8225723132944607
-------------
Eval task: 1
Eval:  Epoch 3, Loss=0.5272158732016882, AUC-ROC Macro=0.5765190255735755, AUC-ROC Micro=0.5919180521197396
Eval task: 2
Eval:  Epoch 3, Loss=0.2317059263586998, AUC-ROC Macro=0.73706194038783, AUC-ROC Micro=0.8170216125743537
------------------------------------
Task: 2, Epoch: 4
Train: epoch: 4, loss = 0.2285388136655092
Train: epoch: 4, loss = 0.22776180148124694
Train: epoch: 4, loss = 0.22624523972471555
Train: epoch: 4, loss = 0.22598572827875615
Train: epoch: 4, loss = 0.22423907767236234
Train: epoch: 4, loss = 0.2242590315764149
Train: epoch: 4, loss = 0.2247950136448656
Train:  Epoch 4, Loss=0.2255640130835295, AUC-ROC Macro=0.7647200247913404, AUC-ROC Micro=0.8322840161038494
-------------
Eval task: 1
Eval:  Epoch 4, Loss=0.5437036727865537, AUC-ROC Macro=0.5733219288907117, AUC-ROC Micro=0.5841536566494478
Eval task: 2
Eval:  Epoch 4, Loss=0.2306365966796875, AUC-ROC Macro=0.7409788527075204, AUC-ROC Micro=0.8200432766873365
------------------------------------
Task: 2, Epoch: 5
Train: epoch: 5, loss = 0.2200795280188322
Train: epoch: 5, loss = 0.22227006124332546
Train: epoch: 5, loss = 0.2228256026779612
Train: epoch: 5, loss = 0.22259752004407346
Train: epoch: 5, loss = 0.221956159286201
Train: epoch: 5, loss = 0.22172261822347838
Train: epoch: 5, loss = 0.2218450330783214
Train:  Epoch 5, Loss=0.22193491827454367, AUC-ROC Macro=0.7781214431341185, AUC-ROC Micro=0.8395072118452587
-------------
Eval task: 1
Eval:  Epoch 5, Loss=0.542897159854571, AUC-ROC Macro=0.5738482781773665, AUC-ROC Micro=0.5894702746001742
Eval task: 2
Eval:  Epoch 5, Loss=0.23093439787626266, AUC-ROC Macro=0.744661950688155, AUC-ROC Micro=0.819782469158977
------------------------------------
Task: 2, Epoch: 6
Train: epoch: 6, loss = 0.21618390649557115
Train: epoch: 6, loss = 0.2187465199828148
Train: epoch: 6, loss = 0.21810824944327276
Train: epoch: 6, loss = 0.21856517256237568
Train: epoch: 6, loss = 0.21849392530322076
Train: epoch: 6, loss = 0.21817198025683562
Train: epoch: 6, loss = 0.21870937658739942
Train:  Epoch 6, Loss=0.2189930250015192, AUC-ROC Macro=0.7878800228947663, AUC-ROC Micro=0.8452599698137809
-------------
Eval task: 1
Eval:  Epoch 6, Loss=0.5458254863818487, AUC-ROC Macro=0.5688217289573079, AUC-ROC Micro=0.5944451822804071
Eval task: 2
Eval:  Epoch 6, Loss=0.23044312000274658, AUC-ROC Macro=0.7487751263567171, AUC-ROC Micro=0.8213315974114369
-------------------------
Testing task: 1
-------------------------
Test:  Epoch 6, Loss=0.5518695736924807, AUC-ROC Macro=0.5692449475009959, AUC-ROC Micro=0.5933743556854896
-------------------------
Testing task: 2
-------------------------
Test:  Epoch 6, Loss=0.22765946984291077, AUC-ROC Macro=0.7551687308573516, AUC-ROC Micro=0.8268182753840672
{'0': {'precision': 0.34634492547906315, 'recall': 0.3730886850152905, 'f1-score': 0.35921972764078025, 'support': 1308}, '1': {'precision': 0.1171875, 'recall': 0.26119402985074625, 'f1-score': 0.16178736517719566, 'support': 402}, '2': {'precision': 0.2, 'recall': 0.00303951367781155, 'f1-score': 0.005988023952095809, 'support': 658}, '3': {'precision': 0.38095238095238093, 'recall': 0.0964824120603015, 'f1-score': 0.15396952686447474, 'support': 1990}, '4': {'precision': 0.25846153846153846, 'recall': 0.10421836228287841, 'f1-score': 0.14854111405835543, 'support': 806}, '5': {'precision': 0.1642512077294686, 'recall': 0.043701799485861184, 'f1-score': 0.06903553299492386, 'support': 778}, '6': {'precision': 0.3233256351039261, 'recall': 0.10752688172043011, 'f1-score': 0.16138328530259363, 'support': 1302}, '7': {'precision': 0.08888888888888889, 'recall': 0.009433962264150943, 'f1-score': 0.017057569296375266, 'support': 424}, '8': {'precision': 0.5595238095238095, 'recall': 0.028588807785888078, 'f1-score': 0.05439814814814814, 'support': 1644}, '9': {'precision': 0.4117647058823529, 'recall': 0.0034465780403741997, 'f1-score': 0.006835937499999999, 'support': 2031}, '10': {'precision': 0.23880597014925373, 'recall': 0.027923211169284468, 'f1-score': 0.05, 'support': 573}, '11': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1176}, '12': {'precision': 0.39473684210526316, 'recall': 0.00847457627118644, 'f1-score': 0.016592920353982302, 'support': 1770}, '13': {'precision': 0.3541666666666667, 'recall': 0.05893682588597843, 'f1-score': 0.10105680317040952, 'support': 2596}, '14': {'precision': 0.10108303249097472, 'recall': 0.034419176398279044, 'f1-score': 0.05135259055479138, 'support': 1627}, '15': {'precision': 0.08522727272727272, 'recall': 0.030991735537190084, 'f1-score': 0.045454545454545456, 'support': 484}, '16': {'precision': 0.10457516339869281, 'recall': 0.04025157232704402, 'f1-score': 0.0581289736603088, 'support': 795}, '17': {'precision': 0.6666666666666666, 'recall': 0.003676470588235294, 'f1-score': 0.007312614259597807, 'support': 544}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 351}, '19': {'precision': 0.2, 'recall': 0.011450381679389313, 'f1-score': 0.021660649819494584, 'support': 262}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 563}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 837}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1086}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 861}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 505}, 'micro avg': {'precision': 0.25253439536567707, 'recall': 0.05497970283372088, 'f1-score': 0.09030002912904166, 'support': 25373}, 'macro avg': {'precision': 0.19983848824904876, 'recall': 0.04987379928161279, 'f1-score': 0.059591013128322906, 'support': 25373}, 'weighted avg': {'precision': 0.25222063039663145, 'recall': 0.05497970283372088, 'f1-score': 0.07177386427306151, 'support': 25373}, 'samples avg': {'precision': 0.10124963831018519, 'recall': 0.039081074808183035, 'f1-score': 0.051003477528940716, 'support': 25373}}
{'0': {'precision': 0.6693333333333333, 'recall': 0.455535390199637, 'f1-score': 0.5421166306695464, 'support': 551}, '1': {'precision': 0.6029411764705882, 'recall': 0.1883614088820827, 'f1-score': 0.2870478413068845, 'support': 653}, '2': {'precision': 0.625, 'recall': 0.023474178403755867, 'f1-score': 0.04524886877828054, 'support': 426}, '3': {'precision': 0.5420560747663551, 'recall': 0.14180929095354522, 'f1-score': 0.22480620155038758, 'support': 409}, '4': {'precision': 0.23809523809523808, 'recall': 0.02040816326530612, 'f1-score': 0.037593984962406006, 'support': 245}, '5': {'precision': 0.5932203389830508, 'recall': 0.09776536312849161, 'f1-score': 0.16786570743405274, 'support': 358}, '6': {'precision': 0.42857142857142855, 'recall': 0.036885245901639344, 'f1-score': 0.0679245283018868, 'support': 244}, '7': {'precision': 0.7222222222222222, 'recall': 0.17687074829931973, 'f1-score': 0.28415300546448086, 'support': 294}, '8': {'precision': 0.8, 'recall': 0.015209125475285171, 'f1-score': 0.029850746268656716, 'support': 263}, '9': {'precision': 0.759493670886076, 'recall': 0.2158273381294964, 'f1-score': 0.33613445378151263, 'support': 278}, '10': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 208}, '11': {'precision': 0.5076923076923077, 'recall': 0.13253012048192772, 'f1-score': 0.21019108280254778, 'support': 249}, '12': {'precision': 1.0, 'recall': 0.009216589861751152, 'f1-score': 0.0182648401826484, 'support': 217}, '13': {'precision': 0.6060606060606061, 'recall': 0.15151515151515152, 'f1-score': 0.24242424242424246, 'support': 132}, '14': {'precision': 0.6271186440677966, 'recall': 0.16371681415929204, 'f1-score': 0.2596491228070176, 'support': 226}, '15': {'precision': 0.6914893617021277, 'recall': 0.6190476190476191, 'f1-score': 0.6532663316582915, 'support': 105}, '16': {'precision': 0.525, 'recall': 0.15441176470588236, 'f1-score': 0.23863636363636365, 'support': 136}, '17': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 76}, '18': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78}, '19': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71}, '20': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61}, '21': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42}, '22': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26}, '23': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21}, '24': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22}, 'micro avg': {'precision': 0.6235107227958697, 'recall': 0.14561305880170655, 'f1-score': 0.2360902255639098, 'support': 5391}, 'macro avg': {'precision': 0.3975317761140452, 'recall': 0.10410337249640732, 'f1-score': 0.14580695808116825, 'support': 5391}, 'weighted avg': {'precision': 0.5506909641504706, 'recall': 0.14561305880170655, 'f1-score': 0.20703332644886072, 'support': 5391}, 'samples avg': {'precision': 0.22685546875, 'recall': 0.14284598214285715, 'f1-score': 0.16107525070415696, 'support': 5391}}